{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Kudu 1.4.0 \u4e2d\u6587\u6587\u6863","title":"Kudu 1.4.0 \u4e2d\u6587\u6587\u6863"},{"location":"#kudu-140","text":"","title":"Kudu 1.4.0 \u4e2d\u6587\u6587\u6863"},{"location":"1/","text":"\u4ecb\u7ecd Kudu \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/index.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813605 \u8d21\u732e\u8005 : \u90a3\u4f0a\u62b9\u5fae\u7b11 \uff0c ApacheCN \uff0c Apache\u4e2d\u6587\u7f51 Kudu \u662f\u4e00\u4e2a\u9488\u5bf9 Apache Hadoop \u5e73\u53f0\u800c\u5f00\u53d1\u7684\u5217\u5f0f\u5b58\u50a8\u7ba1\u7406\u5668\u3002 Kudu \u5171\u4eab Hadoop \u751f\u6001\u7cfb\u7edf\u5e94\u7528\u7684\u5e38\u89c1\u6280\u672f\u7279\u6027: \u5b83\u5728 commodity hardware \uff08\u5546\u54c1\u786c\u4ef6\uff09\u4e0a\u8fd0\u884c\uff0c horizontally scalable \uff08\u6c34\u5e73\u53ef\u6269\u5c55\uff09\uff0c\u5e76\u652f\u6301 highly available \uff08\u9ad8\u53ef\u7528\uff09\u6027\u64cd\u4f5c\u3002 \u6b64\u5916\uff0c Kudu \u8fd8\u6709\u66f4\u591a\u4f18\u5316\u7684\u7279\u70b9\uff1a OLAP \u5de5\u4f5c\u7684\u5feb\u901f\u5904\u7406\u3002 \u4e0e MapReduce \uff0c Spark \u548c\u5176\u4ed6 Hadoop \u751f\u6001\u7cfb\u7edf\u7ec4\u4ef6\u96c6\u6210\u3002 \u4e0e Apache Impala\uff08incubating\uff09 \u7d27\u5bc6\u96c6\u6210\uff0c\u4f7f\u5176\u4e0e Apache Parquet \u4e00\u8d77\u4f7f\u7528 HDFS \u6210\u4e3a\u4e00\u4e2a\u5f88\u597d\u7684\u53ef\u53d8\u7684\u66ff\u4ee3\u65b9\u6848\u3002 \u5f3a\u5927\u800c\u7075\u6d3b\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u5141\u8bb8\u60a8\u6839\u636e\u6bcf\u4e2a per-request \uff08\u8bf7\u6c42\u9009\u62e9\uff09\u4e00\u81f4\u6027\u8981\u6c42\uff0c\u5305\u62ec strict-serializable \uff08\u4e25\u683c\u53ef\u5e8f\u5217\u5316\uff09\u4e00\u81f4\u6027\u7684\u9009\u9879\u3002 \u9488\u5bf9\u540c\u65f6\u8fd0\u884c\u987a\u5e8f\u548c\u968f\u673a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u60c5\u51b5\u6027\u80fd\u5f88\u597d\u3002 \u4f7f\u7528 Cloudera Manager \u8f7b\u677e\u7ef4\u62a4\u548c\u7ba1\u7406\u3002 High availability \uff08\u9ad8\u53ef\u7528\u6027\uff09\u3002 Tablet server \u548c Master \u4f7f\u7528 Raft Consensus Algorithm \u6765\u4fdd\u8bc1\u8282\u70b9\u7684\u9ad8\u53ef\u7528\uff0c\u786e\u4fdd\u53ea\u8981\u6709\u4e00\u534a\u4ee5\u4e0a\u7684\u526f\u672c\u53ef\u7528\uff0c\u8be5 tablet \u4fbf\u53ef\u7528\u4e8e\u8bfb\u5199\u3002\u4f8b\u5982\uff0c\u5982\u679c 3 \u4e2a\u526f\u672c\u4e2d\u6709 2 \u4e2a\u6216 5 \u4e2a\u526f\u672c\u4e2d\u7684 3 \u4e2a\u53ef\u7528\uff0c\u5219\u8be5 tablet \u53ef\u7528\u3002\u5373\u4f7f\u5728 leader tablet \u51fa\u73b0\u6545\u969c\u7684\u60c5\u51b5\u4e0b\uff0c\u8bfb\u53d6\u529f\u80fd\u4e5f\u53ef\u4ee5\u901a\u8fc7 read-only \uff08\u53ea\u8bfb\u7684\uff09 follower tablets \u6765\u8fdb\u884c\u670d\u52a1\u3002 \u7ed3\u6784\u5316\u6570\u636e\u6a21\u578b\u3002 \u901a\u8fc7\u7ed3\u5408\u8fd9\u4e9b\u6240\u6709\u7684\u7279\u6027\uff0c Kudu \u7684\u76ee\u6807\u662f\u652f\u6301\u5e94\u7528\u5bb6\u5ead\u4e2d\u90a3\u4e9b\u96be\u4ee5\u5728\u5f53\u524d Hadoop \u5b58\u50a8\u6280\u672f\u4e2d\u5b9e\u73b0\u7684\u5e94\u7528\u3002 Kudu \u5e38\u89c1\u7684\u51e0\u4e2a\u5e94\u7528\u573a\u666f: \u5b9e\u65f6\u66f4\u65b0\u7684\u5e94\u7528\u3002\u521a\u521a\u5230\u8fbe\u7684\u6570\u636e\u5c31\u9a6c\u4e0a\u8981\u88ab\u7ec8\u7aef\u7528\u6237\u4f7f\u7528\u8bbf\u95ee\u5230\u3002 \u65f6\u95f4\u5e8f\u5217\u76f8\u5173\u7684\u5e94\u7528\uff0c\u9700\u8981\u540c\u65f6\u652f\u6301\uff1a \u6839\u636e\u6d77\u91cf\u5386\u53f2\u6570\u636e\u67e5\u8be2\u3002 \u5fc5\u987b\u975e\u5e38\u5feb\u5730\u8fd4\u56de\u5173\u4e8e\u5355\u4e2a\u5b9e\u4f53\u7684\u7ec6\u7c92\u5ea6\u67e5\u8be2\u3002 \u5b9e\u65f6\u9884\u6d4b\u6a21\u578b\u7684\u5e94\u7528\uff0c\u652f\u6301\u6839\u636e\u6240\u6709\u5386\u53f2\u6570\u636e\u5468\u671f\u5730\u66f4\u65b0\u6a21\u578b\u3002 \u6709\u5173\u8fd9\u4e9b\u548c\u5176\u4ed6\u65b9\u6848\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Example Use Cases \u3002 Kudu-Impala \u96c6\u6210\u7279\u6027 CREATE/ALTER/DROP TABLE Impala \u652f\u6301\u4f7f\u7528 Kudu \u4f5c\u4e3a\u6301\u4e45\u5c42\u6765 creating \uff08\u521b\u5efa\uff09\uff0c altering \uff08\u4fee\u6539\uff09\u548c dropping \uff08\u5220\u9664\uff09\u8868\u3002\u8fd9\u4e9b\u8868\u9075\u5faa\u4e0e Impala \u4e2d\u5176\u4ed6\u8868\u683c\u76f8\u540c\u7684 I nternal / external \uff08\u5185\u90e8 / \u5916\u90e8\uff09\u65b9\u6cd5\uff0c\u5141\u8bb8\u7075\u6d3b\u7684\u6570\u636e\u91c7\u96c6\u548c\u67e5\u8be2\u3002 INSERT \u6570\u636e\u53ef\u4ee5\u4f7f\u7528\u4e0e\u90a3\u4e9b\u4f7f\u7528 HDFS \u6216 HBase \u6301\u4e45\u6027\u7684\u4efb\u4f55\u5176\u4ed6 Impala \u8868\u76f8\u540c\u7684\u8bed\u6cd5\u63d2\u5165 Impala \u4e2d\u7684 Kudu \u8868\u3002 UPDATE / DELETE Impala \u652f\u6301 UPDATE \u548c DELETE SQL \u547d\u4ee4\u9010\u884c\u6216\u6279\u5904\u7406\u4fee\u6539 Kudu \u8868\u4e2d\u7684\u5df2\u6709\u7684\u6570\u636e\u3002\u9009\u62e9 SQL \u547d\u4ee4\u7684\u8bed\u6cd5\u4e0e\u73b0\u6709\u6807\u51c6\u5c3d\u53ef\u80fd\u517c\u5bb9\u3002\u9664\u4e86\u7b80\u5355 DELETE \u6216 UPDATE \u547d\u4ee4\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5 FROM \u5728\u5b50\u67e5\u8be2\u4e2d\u6307\u5b9a\u5e26\u6709\u5b50\u53e5\u7684\u590d\u6742\u8fde\u63a5\u3002 Flexible Partitioning\uff08\u7075\u6d3b\u5206\u533a\uff09 \u4e0e Hive \u4e2d\u7684\u8868\u5206\u533a\u7c7b\u4f3c\uff0c Kudu \u5141\u8bb8\u60a8\u901a\u8fc7 hash \u6216\u8303\u56f4\u52a8\u6001\u9884\u5206\u5272\u6210\u9884\u5b9a\u4e49\u6570\u91cf\u7684 tablets \uff0c\u4ee5\u4fbf\u5728\u96c6\u7fa4\u4e2d\u5747\u5300\u5206\u5e03\u5199\u5165\u548c\u67e5\u8be2\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u4efb\u610f\u6570\u91cf\u7684 primary key \uff08\u4e3b\u952e\uff09\u5217\uff0c\u4efb\u610f\u6570\u91cf\u7684 hashes \u548c\u53ef\u9009\u7684 list of split rows \u6765\u8fdb\u884c\u5206\u533a\u3002\u53c2\u89c1 \u6a21\u5f0f\u8bbe\u8ba1 \u3002 Parallel Scan\uff08\u5e76\u884c\u626b\u63cf\uff09 \u4e3a\u4e86\u5728\u73b0\u4ee3\u786c\u4ef6\u4e0a\u5b9e\u73b0\u6700\u9ad8\u7684\u6027\u80fd\uff0c Impala \u4f7f\u7528\u7684 Kudu \u5ba2\u6237\u7aef\u53ef\u4ee5\u8de8\u591a\u4e2a tablets \u626b\u63cf\u3002 High-efficiency queries\uff08\u9ad8\u6548\u67e5\u8be2\uff09 \u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c Impala \u5c06\u8c13\u8bcd\u8bc4\u4f30\u4e0b\u63a8\u5230 Kudu \uff0c\u4ee5\u4fbf\u4f7f\u8c13\u8bcd\u8bc4\u4f30\u4e3a\u5c3d\u53ef\u80fd\u63a5\u8fd1\u6570\u636e\u3002\u5728\u8bb8\u591a\u4efb\u52a1\u4e2d\uff0c\u67e5\u8be2\u6027\u80fd\u4e0e Parquet \u76f8\u5f53\u3002 \u6709\u5173\u4f7f\u7528 Impala \u67e5\u8be2\u5b58\u50a8\u5728 Kudu \u4e2d\u7684\u6570\u636e\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Impala \u6587\u6863\u3002 \u6982\u5ff5\u548c\u672f\u8bed Columnar Data Store \uff08\u5217\u5f0f\u6570\u636e\u5b58\u50a8\uff09 Kudu \u662f\u4e00\u4e2a columnar data store \uff08\u5217\u5f0f\u6570\u636e\u5b58\u50a8\uff09 \u3002\u5217\u5f0f\u6570\u636e\u5b58\u50a8\u5728\u5f3a\u7c7b\u578b\u5217\u4e2d\u3002\u7531\u4e8e\u51e0\u4e2a\u539f\u56e0\uff0c\u901a\u8fc7\u9002\u5f53\u7684\u8bbe\u8ba1\uff0c Kudu \u5bf9 analytical \uff08\u5206\u6790\uff09\u6216 warehousing \uff08\u6570\u636e\u4ed3\u5e93\uff09\u5de5\u4f5c\u4f1a\u975e\u5e38\u51fa\u8272\u3002 Read Efficiency \uff08\u9ad8\u6548\u8bfb\u53d6\uff09 \u5bf9\u4e8e\u5206\u6790\u67e5\u8be2\uff0c\u5141\u8bb8\u8bfb\u53d6\u5355\u4e2a\u5217\u6216\u8be5\u5217\u7684\u4e00\u90e8\u5206\u540c\u65f6\u5ffd\u7565\u5176\u4ed6\u5217\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u5728\u78c1\u76d8\u4e0a\u8bfb\u53d6\u66f4\u5c11\u5757\u6765\u5b8c\u6210\u67e5\u8be2\u3002\u4e0e\u57fa\u4e8e\u884c\u7684\u5b58\u50a8\u76f8\u6bd4\uff0c\u5373\u4f7f\u53ea\u8fd4\u56de\u51e0\u5217\u7684\u503c\uff0c\u4ecd\u9700\u8981\u8bfb\u53d6\u6574\u884c\u6570\u636e\u3002 Data Compression \uff08\u6570\u636e\u538b\u7f29\uff09 \u7531\u4e8e\u7ed9\u5b9a\u7684\u5217\u53ea\u5305\u542b\u4e00\u79cd\u7c7b\u578b\u7684\u6570\u636e\uff0c\u57fa\u4e8e\u6a21\u5f0f\u7684\u538b\u7f29\u6bd4\u538b\u7f29\u6df7\u5408\u6570\u636e\u7c7b\u578b\uff08\u5728\u57fa\u4e8e\u884c\u7684\u89e3\u51b3\u65b9\u6848\u4e2d\u4f7f\u7528\uff09\u65f6\u66f4\u6709\u6548\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002\u7ed3\u5408\u4ece\u5217\u8bfb\u53d6\u6570\u636e\u7684\u6548\u7387\uff0c\u538b\u7f29\u5141\u8bb8\u60a8\u5728\u4ece\u78c1\u76d8\u8bfb\u53d6\u66f4\u5c11\u7684\u5757\u65f6\u5b8c\u6210\u67e5\u8be2\u3002\u8bf7\u53c2\u9605 \u6570\u636e\u538b\u7f29 Table \uff08\u8868\uff09 \u4e00\u5f20 _ talbe _\u662f\u6570\u636e\u5b58\u50a8\u5728 Kudu \u7684\u4f4d\u7f6e\u3002\u8868\u5177\u6709 schema \u548c\u5168\u5c40\u6709\u5e8f\u7684 primary key \uff08\u4e3b\u952e\uff09\u3002 table \u88ab\u5206\u6210\u79f0\u4e3a tablets \u7684 segments \u3002 Tablet \u4e00\u4e2a tablet \u662f\u4e00\u5f20 table \u8fde\u7eed\u7684 segment \uff0c\u4e0e\u5176\u5b83\u6570\u636e\u5b58\u50a8\u5f15\u64ce\u6216\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684 partition \uff08\u5206\u533a\uff09\u76f8\u4f3c\u3002\u7ed9\u5b9a\u7684 tablet \u5197\u4f59\u5230\u591a\u4e2a tablet \u670d\u52a1\u5668\u4e0a\uff0c\u5e76\u4e14\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c\u5176\u4e2d\u4e00\u4e2a\u526f\u672c\u88ab\u8ba4\u4e3a\u662f leader tablet \u3002\u4efb\u4f55\u526f\u672c\u90fd\u53ef\u4ee5\u5bf9\u8bfb\u53d6\u8fdb\u884c\u670d\u52a1\uff0c\u5e76\u4e14\u5199\u5165\u65f6\u9700\u8981\u5728\u4e3a tablet \u670d\u52a1\u7684\u4e00\u7ec4 tablet server \u4e4b\u95f4\u8fbe\u6210\u4e00\u81f4\u6027\u3002 Tablet Server \u4e00\u4e2a tablet server \u5b58\u50a8 tablet \u548c\u4e3a tablet \u5411 client \u63d0\u4f9b\u670d\u52a1\u3002\u5bf9\u4e8e\u7ed9\u5b9a\u7684 tablet \uff0c\u4e00\u4e2a tablet server \u5145\u5f53 leader\uff0c\u5176\u4ed6 tablet server \u5145\u5f53\u8be5 tablet \u7684 follower \u526f\u672c\u3002\u53ea\u6709 leader \u670d\u52a1\u5199\u8bf7\u6c42\uff0c\u7136\u800c leader \u6216 followers \u4e3a\u6bcf\u4e2a\u670d\u52a1\u63d0\u4f9b\u8bfb\u8bf7\u6c42\u3002 leader \u4f7f\u7528 Raft Consensus Algorithm \u6765\u8fdb\u884c\u9009\u4e3e \u3002\u4e00\u4e2a tablet server \u53ef\u4ee5\u670d\u52a1\u591a\u4e2a tablets \uff0c\u5e76\u4e14\u4e00\u4e2a tablet \u53ef\u4ee5\u88ab\u591a\u4e2a tablet servers \u670d\u52a1\u7740\u3002 Master \u8be5 master \u4fdd\u6301\u8ddf\u8e2a\u6240\u6709\u7684 tablets \uff0c tablet servers \uff0c Catalog Table \u548c\u5176\u5b83\u4e0e\u96c6\u7fa4\u76f8\u5173\u7684 metadata \u3002\u5728\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u8d77\u4f5c\u7528\u7684 master \uff08\u4e5f\u5c31\u662f leader \uff09\u3002\u5982\u679c\u5f53\u524d\u7684 leader \u6d88\u5931\uff0c\u5219\u9009\u4e3e\u51fa\u4e00\u4e2a\u65b0\u7684 master \uff0c\u4f7f\u7528 Raft Consensus Algorithm \u6765\u8fdb\u884c\u9009\u4e3e\u3002 master \u8fd8\u534f\u8c03\u5ba2\u6237\u7aef\u7684 metadata operations \uff08\u5143\u6570\u636e\u64cd\u4f5c\uff09\u3002\u4f8b\u5982\uff0c\u5f53\u521b\u5efa\u65b0\u8868\u65f6\uff0c\u5ba2\u6237\u7aef\u5185\u90e8\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9 master \u3002 master \u5c06\u65b0\u8868\u7684\u5143\u6570\u636e\u5199\u5165 catalog table \uff0c\u5e76\u534f\u8c03\u5728 tablet server \u4e0a\u521b\u5efa tablet \u7684\u8fc7\u7a0b\u3002 \u6240\u6709 master \u7684\u6570\u636e\u90fd\u5b58\u50a8\u5728\u4e00\u4e2a tablet \u4e2d\uff0c\u53ef\u4ee5\u590d\u5236\u5230\u6240\u6709\u5176\u4ed6\u5019\u9009\u7684 master \u3002 tablet server \u4ee5\u8bbe\u5b9a\u7684\u95f4\u9694\u5411 master \u53d1\u51fa\u5fc3\u8df3\uff08\u9ed8\u8ba4\u503c\u4e3a\u6bcf\u79d2\u4e00\u6b21\uff09\u3002 Raft Consensus Algorithm Kudu \u4f7f\u7528 Raft consensus algorithm \u4f5c\u4e3a\u786e\u4fdd\u5e38\u89c4 tablet \u548c master \u6570\u636e\u7684\u5bb9\u9519\u6027\u548c\u4e00\u81f4\u6027\u7684\u624b\u6bb5\u3002\u901a\u8fc7 Raft \uff0c tablet \u7684\u591a\u4e2a\u526f\u672c\u9009\u4e3e\u51fa_ leader \uff0c\u5b83\u8d1f\u8d23\u63a5\u53d7\u4ee5\u53ca\u590d\u5236\u5230 follower _\u526f\u672c\u7684\u5199\u5165\u3002\u4e00\u65e6\u5199\u5165\u7684\u6570\u636e\u5728\u5927\u591a\u6570\u526f\u672c\u4e2d\u6301\u4e45\u5316\u540e\uff0c\u5c31\u4f1a\u5411\u5ba2\u6237\u786e\u8ba4\u3002\u7ed9\u5b9a\u7684\u4e00\u7ec4 N \u526f\u672c\uff08\u901a\u5e38\u4e3a 3 \u6216 5 \u4e2a\uff09\u80fd\u591f\u63a5\u53d7\u6700\u591a **(N - 1)/2** \u9519\u8bef\u7684\u526f\u672c\u7684\u5199\u5165\u3002 Catalog Table\uff08\u76ee\u5f55\u8868\uff09 _ catalog talbe _\u662f Kudu \u7684 metadata \uff08\u5143\u6570\u636e\u4e2d\uff09\u7684\u4e2d\u5fc3\u4f4d\u7f6e\u3002\u5b83\u5b58\u50a8\u6709\u5173 tables \u548c tablets \u7684\u4fe1\u606f\u3002\u8be5 catalog table \uff08\u76ee\u5f55\u8868\uff09\u53ef\u80fd\u4e0d\u4f1a\u88ab\u76f4\u63a5\u8bfb\u53d6\u6216\u5199\u5165\u3002\u76f8\u53cd\uff0c\u5b83\u53ea\u80fd\u901a\u8fc7\u5ba2\u6237\u7aef API \u4e2d\u516c\u5f00\u7684\u5143\u6570\u636e\u64cd\u4f5c\u8bbf\u95ee\u3002 catalog table \u5b58\u50a8\u4e24\u7c7b\u5143\u6570\u636e\u3002 Tables table schemas , locations , and states \uff08\u8868\u7ed3\u6784\uff0c\u4f4d\u7f6e \u548c\u72b6\u6001\uff09 Tablets \u73b0\u6709 tablet \u7684\u5217\u8868\uff0c\u6bcf\u4e2a tablet \u7684 \u526f\u672c\u6240\u5728\u54ea\u4e9b tablet server \uff0c tablet \u7684\u5f53\u524d\u72b6\u6001\u4ee5\u53ca\u5f00\u59cb\u548c\u7ed3\u675f\u7684 keys \uff08\u952e\uff09\u3002 Logical Replication \uff08\u903b\u8f91\u590d\u5236\uff09 Kudu \u590d\u5236\u64cd\u4f5c\uff0c\u4e0d\u662f\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u3002\u8fd9\u88ab\u79f0\u4e3a logical replication \uff08__\u903b\u8f91\u590d\u5236\uff09 \uff0c\u800c\u4e0d\u662f physical replication \uff08__\u7269\u7406\u590d\u5236\uff09 \u3002\u8fd9\u6709\u51e0\u4e2a\u4f18\u70b9 : \u867d\u7136 insert \uff08\u63d2\u5165\uff09\u548c update \uff08\u66f4\u65b0\uff09\u786e\u5b9e\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u6570\u636e\uff0c deletes \uff08\u5220\u9664\uff09\u4e0d\u9700\u8981\u79fb\u52a8\u4efb\u4f55\u6570\u636e\u3002 delete \uff08\u5220\u9664\uff09\u64cd\u4f5c\u88ab\u53d1\u9001\u5230\u6bcf\u4e2a tablet server \uff0c\u5b83\u5728\u672c\u5730\u6267\u884c\u5220\u9664\u3002 \u7269\u7406\u64cd\u4f5c\uff0c\u5982 compaction \uff0c\u4e0d\u9700\u8981\u901a\u8fc7 Kudu \u7684\u7f51\u7edc\u4f20\u8f93\u6570\u636e\u3002\u8fd9\u4e0e\u4f7f\u7528 HDFS \u7684\u5b58\u50a8\u7cfb\u7edf\u4e0d\u540c\uff0c\u5176\u4e2d blocks \uff08\u5757\uff09\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u4ee5\u6ee1\u8db3\u6240\u9700\u6570\u91cf\u7684\u526f\u672c\u3002 tablet \u4e0d\u9700\u8981\u5728\u540c\u4e00\u65f6\u95f4\u6216\u76f8\u540c\u7684\u65f6\u95f4\u8868\u4e0a\u6267\u884c\u538b\u7f29\uff0c\u6216\u8005\u5728\u7269\u7406\u5b58\u50a8\u5c42\u4e0a\u4fdd\u6301\u540c\u6b65\u3002\u8fd9\u4f1a\u51cf\u5c11\u7531\u4e8e\u538b\u7f29\u6216\u5927\u91cf\u5199\u5165\u8d1f\u8f7d\u800c\u5bfc\u81f4\u6240\u6709 tablet server \u540c\u65f6\u9047\u5230\u9ad8\u5ef6\u8fdf\u7684\u673a\u4f1a\u3002 \u67b6\u6784\u6982\u8ff0 \u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u5177\u6709\u4e09\u4e2a master \u548c\u591a\u4e2a tablet server \u7684 Kudu \u96c6\u7fa4\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u90fd\u652f\u6301\u591a\u4e2a tablet \u3002\u5b83\u8bf4\u660e\u4e86\u5982\u4f55\u4f7f\u7528 Raft \u5171\u8bc6\u6765\u5141\u8bb8 master \u548c tablet server \u7684 leader \u548c f ollow \u3002\u6b64\u5916\uff0c tablet server \u53ef\u4ee5\u6210\u4e3a\u67d0\u4e9b tablet \u7684 leader \uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6 tablet \u7684 follower \u3002 leader \u4ee5\u91d1\u8272\u663e\u793a\uff0c\u800c follower \u5219\u663e\u793a\u4e3a\u84dd\u8272\u3002 \u6848\u4f8b\u793a\u4f8b Streaming Input with Near Real Time Availability \uff08\u5177\u6709\u8fd1\u5b9e\u65f6\u53ef\u7528\u6027\u7684\u6d41\u8f93\u5165\uff09 \u6570\u636e\u5206\u6790\u4e2d\u7684\u4e00\u4e2a\u5171\u540c\u6311\u6218\u5c31\u662f\u65b0\u6570\u636e\u5feb\u901f\u800c\u4e0d\u65ad\u5730\u5230\u8fbe\uff0c\u540c\u6837\u7684\u6570\u636e\u9700\u8981\u9760\u8fd1\u5b9e\u65f6\u7684\u8bfb\u53d6\uff0c\u626b\u63cf\u548c\u66f4\u65b0\u3002Kudu \u901a\u8fc7\u9ad8\u6548\u7684\u5217\u5f0f\u626b\u63cf\u63d0\u4f9b\u4e86\u5feb\u901f\u63d2\u5165\u548c\u66f4\u65b0\u7684\u5f3a\u5927\u7ec4\u5408\uff0c\u4ece\u800c\u5728\u5355\u4e2a\u5b58\u50a8\u5c42\u4e0a\u5b9e\u73b0\u4e86\u5b9e\u65f6\u5206\u6790\u7528\u4f8b\u3002 Time-series application with widely varying access patterns \uff08\u5177\u6709\u5e7f\u6cdb\u53d8\u5316\u7684\u8bbf\u95ee\u6a21\u5f0f\u7684\u65f6\u95f4\u5e8f\u5217\u5e94\u7528\uff09 time-series \uff08\u65f6\u95f4\u5e8f\u5217\uff09\u6a21\u5f0f\u662f\u6839\u636e\u5176\u53d1\u751f\u65f6\u95f4\u7ec4\u7ec7\u548c\u952e\u5165\u6570\u636e\u70b9\u7684\u6a21\u5f0f\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u8c03\u67e5\u6307\u6807\u7684\u6027\u80fd\uff0c\u6216\u8005\u6839\u636e\u8fc7\u53bb\u7684\u6570\u636e\u5c1d\u8bd5\u9884\u6d4b\u672a\u6765\u7684\u884c\u4e3a\u3002\u4f8b\u5982\uff0c\u65f6\u95f4\u5e8f\u5217\u7684\u5ba2\u6237\u6570\u636e\u53ef\u4ee5\u7528\u4e8e\u5b58\u50a8\u8d2d\u4e70\u70b9\u51fb\u6d41\u5386\u53f2\u5e76\u9884\u6d4b\u672a\u6765\u7684\u8d2d\u4e70\uff0c\u6216\u7531\u5ba2\u6237\u652f\u6301\u4ee3\u8868\u4f7f\u7528\u3002\u867d\u7136\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u5206\u6790\u6b63\u5728\u53d1\u751f\uff0c\u63d2\u5165\u548c\u66f4\u6362\u4e5f\u53ef\u80fd\u5355\u72ec\u548c\u6279\u91cf\u5730\u53d1\u751f\uff0c\u5e76\u4e14\u7acb\u5373\u53ef\u7528\u4e8e\u8bfb\u53d6\u5de5\u4f5c\u8d1f\u8f7d\u3002 Kudu \u53ef\u4ee5\u7528 scalable \uff08\u53ef\u6269\u5c55\uff09\u548c efficient \uff08\u9ad8\u6548\u7684\uff09\u65b9\u5f0f\u540c\u65f6\u5904\u7406\u6240\u6709\u8fd9\u4e9b\u8bbf\u95ee\u6a21\u5f0f\u3002\u7531\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0c Kudu \u975e\u5e38\u9002\u5408\u65f6\u95f4\u5e8f\u5217\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u968f\u7740 Kudu \u5bf9\u57fa\u4e8e hash \u7684\u5206\u533a\u7684\u652f\u6301\uff0c\u7ed3\u5408\u5176\u5bf9\u590d\u5408 row keys \uff08\u884c\u952e\uff09\u7684\u672c\u5730\u652f\u6301\uff0c\u5c06\u8bb8\u591a\u670d\u52a1\u5668\u4e0a\u7684\u8868\u8bbe\u7f6e\u6210\u5f88\u7b80\u5355\uff0c\u800c\u4e0d\u4f1a\u5728\u4f7f\u7528\u8303\u56f4\u5206\u533a\u65f6\u901a\u5e38\u89c2\u5bdf\u5230\u201c hotspotting \uff08\u70ed\u70b9\uff09\u201d\u7684\u98ce\u9669\u3002 Kudu \u7684\u5217\u5f0f\u5b58\u50a8\u5f15\u64ce\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e5f\u662f\u6709\u76ca\u7684\uff0c\u56e0\u4e3a\u8bb8\u591a\u65f6\u95f4\u5e8f\u5217\u5de5\u4f5c\u8d1f\u8f7d\u53ea\u8bfb\u53d6\u4e86\u51e0\u5217\uff0c\u800c\u4e0d\u662f\u6574\u884c\u3002 \u8fc7\u53bb\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u591a\u4e2a\u6570\u636e\u5b58\u50a8\u6765\u5904\u7406\u4e0d\u540c\u7684\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u3002\u8fd9\u79cd\u505a\u6cd5\u589e\u52a0\u4e86\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7684\u590d\u6742\u6027\uff0c\u5e76\u91cd\u590d\u4e86\u6570\u636e\uff0c\u4f7f\u6240\u9700\u5b58\u50a8\u91cf\u589e\u52a0\u4e86\u4e00\u500d\uff08\u6216\u66f4\u7cdf\uff09\u3002 Kudu \u53ef\u4ee5\u672c\u5730\u548c\u9ad8\u6548\u5730\u5904\u7406\u6240\u6709\u8fd9\u4e9b\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c\u65e0\u9700\u5c06\u5de5\u4f5c\u5378\u8f7d\u5230\u5176\u4ed6\u6570\u636e\u5b58\u50a8\u3002 Predictive Modeling \uff08\u9884\u6d4b\u5efa\u6a21\uff09 \u6570\u636e\u79d1\u5b66\u5bb6\u7ecf\u5e38\u4ece\u5927\u91cf\u6570\u636e\u4e2d\u5f00\u53d1\u9884\u6d4b\u5b66\u4e60\u6a21\u578b\u3002\u6a21\u578b\u548c\u6570\u636e\u53ef\u80fd\u9700\u8981\u5728\u5b66\u4e60\u53d1\u751f\u65f6\u6216\u968f\u7740\u5efa\u6a21\u60c5\u51b5\u7684\u53d8\u5316\u800c\u7ecf\u5e38\u66f4\u65b0\u6216\u4fee\u6539\u3002\u6b64\u5916\uff0c\u79d1\u5b66\u5bb6\u53ef\u80fd\u60f3\u6539\u53d8\u6a21\u578b\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u56e0\u7d20\uff0c\u770b\u770b\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u5728 HDFS \u4e2d\u66f4\u65b0\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u7684\u5927\u91cf\u6570\u636e\u662f\u8d44\u6e90\u5bc6\u96c6\u578b\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u9700\u8981\u88ab\u5b8c\u5168\u91cd\u5199\u3002\u5728 Kudu \uff0c\u66f4\u65b0\u53d1\u751f\u5728\u8fd1\u4e4e\u5b9e\u65f6\u3002\u79d1\u5b66\u5bb6\u53ef\u4ee5\u8c03\u6574\u503c\uff0c\u91cd\u65b0\u8fd0\u884c\u67e5\u8be2\uff0c\u5e76\u4ee5\u79d2\u6216\u5206\u949f\u800c\u4e0d\u662f\u51e0\u5c0f\u65f6\u6216\u51e0\u5929\u5237\u65b0\u56fe\u5f62\u3002\u6b64\u5916\uff0c\u6279\u5904\u7406\u6216\u589e\u91cf\u7b97\u6cd5\u53ef\u4ee5\u968f\u65f6\u5728\u6570\u636e\u4e0a\u8fd0\u884c\uff0c\u5177\u6709\u63a5\u8fd1\u5b9e\u65f6\u7684\u7ed3\u679c\u3002 Combining Data In Kudu With Legacy Systems \uff08\u7ed3\u5408 Kudu \u4e0e\u9057\u7559\u7cfb\u7edf\u7684\u6570\u636e\uff09 \u516c\u53f8\u4ece\u591a\u4e2a\u6765\u6e90\u751f\u6210\u6570\u636e\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u5404\u79cd\u7cfb\u7edf\u548c\u683c\u5f0f\u4e2d\u3002\u4f8b\u5982\uff0c\u60a8\u7684\u4e00\u4e9b\u6570\u636e\u53ef\u80fd\u5b58\u50a8\u5728 Kudu \uff0c\u4e00\u4e9b\u5728\u4f20\u7edf\u7684 RDBMS \u4e2d\uff0c\u4e00\u4e9b\u5728 HDFS \u4e2d\u7684\u6587\u4ef6\u4e2d\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Impala \u8bbf\u95ee\u548c\u67e5\u8be2\u6240\u6709\u8fd9\u4e9b\u6e90\u548c\u683c\u5f0f\uff0c\u800c\u65e0\u9700\u66f4\u6539\u65e7\u7248\u7cfb\u7edf\u3002 \u4e0b\u4e00\u6b65 Kudu \u5165\u95e8\u6307\u5357 \u5b89\u88c5\u6307\u5357","title":"\u4ecb\u7ecd Kudu"},{"location":"1/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/index.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813605 \u8d21\u732e\u8005 : \u90a3\u4f0a\u62b9\u5fae\u7b11 \uff0c ApacheCN \uff0c Apache\u4e2d\u6587\u7f51 Kudu \u662f\u4e00\u4e2a\u9488\u5bf9 Apache Hadoop \u5e73\u53f0\u800c\u5f00\u53d1\u7684\u5217\u5f0f\u5b58\u50a8\u7ba1\u7406\u5668\u3002 Kudu \u5171\u4eab Hadoop \u751f\u6001\u7cfb\u7edf\u5e94\u7528\u7684\u5e38\u89c1\u6280\u672f\u7279\u6027: \u5b83\u5728 commodity hardware \uff08\u5546\u54c1\u786c\u4ef6\uff09\u4e0a\u8fd0\u884c\uff0c horizontally scalable \uff08\u6c34\u5e73\u53ef\u6269\u5c55\uff09\uff0c\u5e76\u652f\u6301 highly available \uff08\u9ad8\u53ef\u7528\uff09\u6027\u64cd\u4f5c\u3002 \u6b64\u5916\uff0c Kudu \u8fd8\u6709\u66f4\u591a\u4f18\u5316\u7684\u7279\u70b9\uff1a OLAP \u5de5\u4f5c\u7684\u5feb\u901f\u5904\u7406\u3002 \u4e0e MapReduce \uff0c Spark \u548c\u5176\u4ed6 Hadoop \u751f\u6001\u7cfb\u7edf\u7ec4\u4ef6\u96c6\u6210\u3002 \u4e0e Apache Impala\uff08incubating\uff09 \u7d27\u5bc6\u96c6\u6210\uff0c\u4f7f\u5176\u4e0e Apache Parquet \u4e00\u8d77\u4f7f\u7528 HDFS \u6210\u4e3a\u4e00\u4e2a\u5f88\u597d\u7684\u53ef\u53d8\u7684\u66ff\u4ee3\u65b9\u6848\u3002 \u5f3a\u5927\u800c\u7075\u6d3b\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u5141\u8bb8\u60a8\u6839\u636e\u6bcf\u4e2a per-request \uff08\u8bf7\u6c42\u9009\u62e9\uff09\u4e00\u81f4\u6027\u8981\u6c42\uff0c\u5305\u62ec strict-serializable \uff08\u4e25\u683c\u53ef\u5e8f\u5217\u5316\uff09\u4e00\u81f4\u6027\u7684\u9009\u9879\u3002 \u9488\u5bf9\u540c\u65f6\u8fd0\u884c\u987a\u5e8f\u548c\u968f\u673a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u60c5\u51b5\u6027\u80fd\u5f88\u597d\u3002 \u4f7f\u7528 Cloudera Manager \u8f7b\u677e\u7ef4\u62a4\u548c\u7ba1\u7406\u3002 High availability \uff08\u9ad8\u53ef\u7528\u6027\uff09\u3002 Tablet server \u548c Master \u4f7f\u7528 Raft Consensus Algorithm \u6765\u4fdd\u8bc1\u8282\u70b9\u7684\u9ad8\u53ef\u7528\uff0c\u786e\u4fdd\u53ea\u8981\u6709\u4e00\u534a\u4ee5\u4e0a\u7684\u526f\u672c\u53ef\u7528\uff0c\u8be5 tablet \u4fbf\u53ef\u7528\u4e8e\u8bfb\u5199\u3002\u4f8b\u5982\uff0c\u5982\u679c 3 \u4e2a\u526f\u672c\u4e2d\u6709 2 \u4e2a\u6216 5 \u4e2a\u526f\u672c\u4e2d\u7684 3 \u4e2a\u53ef\u7528\uff0c\u5219\u8be5 tablet \u53ef\u7528\u3002\u5373\u4f7f\u5728 leader tablet \u51fa\u73b0\u6545\u969c\u7684\u60c5\u51b5\u4e0b\uff0c\u8bfb\u53d6\u529f\u80fd\u4e5f\u53ef\u4ee5\u901a\u8fc7 read-only \uff08\u53ea\u8bfb\u7684\uff09 follower tablets \u6765\u8fdb\u884c\u670d\u52a1\u3002 \u7ed3\u6784\u5316\u6570\u636e\u6a21\u578b\u3002 \u901a\u8fc7\u7ed3\u5408\u8fd9\u4e9b\u6240\u6709\u7684\u7279\u6027\uff0c Kudu \u7684\u76ee\u6807\u662f\u652f\u6301\u5e94\u7528\u5bb6\u5ead\u4e2d\u90a3\u4e9b\u96be\u4ee5\u5728\u5f53\u524d Hadoop \u5b58\u50a8\u6280\u672f\u4e2d\u5b9e\u73b0\u7684\u5e94\u7528\u3002 Kudu \u5e38\u89c1\u7684\u51e0\u4e2a\u5e94\u7528\u573a\u666f: \u5b9e\u65f6\u66f4\u65b0\u7684\u5e94\u7528\u3002\u521a\u521a\u5230\u8fbe\u7684\u6570\u636e\u5c31\u9a6c\u4e0a\u8981\u88ab\u7ec8\u7aef\u7528\u6237\u4f7f\u7528\u8bbf\u95ee\u5230\u3002 \u65f6\u95f4\u5e8f\u5217\u76f8\u5173\u7684\u5e94\u7528\uff0c\u9700\u8981\u540c\u65f6\u652f\u6301\uff1a \u6839\u636e\u6d77\u91cf\u5386\u53f2\u6570\u636e\u67e5\u8be2\u3002 \u5fc5\u987b\u975e\u5e38\u5feb\u5730\u8fd4\u56de\u5173\u4e8e\u5355\u4e2a\u5b9e\u4f53\u7684\u7ec6\u7c92\u5ea6\u67e5\u8be2\u3002 \u5b9e\u65f6\u9884\u6d4b\u6a21\u578b\u7684\u5e94\u7528\uff0c\u652f\u6301\u6839\u636e\u6240\u6709\u5386\u53f2\u6570\u636e\u5468\u671f\u5730\u66f4\u65b0\u6a21\u578b\u3002 \u6709\u5173\u8fd9\u4e9b\u548c\u5176\u4ed6\u65b9\u6848\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Example Use Cases \u3002","title":"\u4ecb\u7ecd Kudu"},{"location":"1/#kudu-impala","text":"CREATE/ALTER/DROP TABLE Impala \u652f\u6301\u4f7f\u7528 Kudu \u4f5c\u4e3a\u6301\u4e45\u5c42\u6765 creating \uff08\u521b\u5efa\uff09\uff0c altering \uff08\u4fee\u6539\uff09\u548c dropping \uff08\u5220\u9664\uff09\u8868\u3002\u8fd9\u4e9b\u8868\u9075\u5faa\u4e0e Impala \u4e2d\u5176\u4ed6\u8868\u683c\u76f8\u540c\u7684 I nternal / external \uff08\u5185\u90e8 / \u5916\u90e8\uff09\u65b9\u6cd5\uff0c\u5141\u8bb8\u7075\u6d3b\u7684\u6570\u636e\u91c7\u96c6\u548c\u67e5\u8be2\u3002 INSERT \u6570\u636e\u53ef\u4ee5\u4f7f\u7528\u4e0e\u90a3\u4e9b\u4f7f\u7528 HDFS \u6216 HBase \u6301\u4e45\u6027\u7684\u4efb\u4f55\u5176\u4ed6 Impala \u8868\u76f8\u540c\u7684\u8bed\u6cd5\u63d2\u5165 Impala \u4e2d\u7684 Kudu \u8868\u3002 UPDATE / DELETE Impala \u652f\u6301 UPDATE \u548c DELETE SQL \u547d\u4ee4\u9010\u884c\u6216\u6279\u5904\u7406\u4fee\u6539 Kudu \u8868\u4e2d\u7684\u5df2\u6709\u7684\u6570\u636e\u3002\u9009\u62e9 SQL \u547d\u4ee4\u7684\u8bed\u6cd5\u4e0e\u73b0\u6709\u6807\u51c6\u5c3d\u53ef\u80fd\u517c\u5bb9\u3002\u9664\u4e86\u7b80\u5355 DELETE \u6216 UPDATE \u547d\u4ee4\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5 FROM \u5728\u5b50\u67e5\u8be2\u4e2d\u6307\u5b9a\u5e26\u6709\u5b50\u53e5\u7684\u590d\u6742\u8fde\u63a5\u3002 Flexible Partitioning\uff08\u7075\u6d3b\u5206\u533a\uff09 \u4e0e Hive \u4e2d\u7684\u8868\u5206\u533a\u7c7b\u4f3c\uff0c Kudu \u5141\u8bb8\u60a8\u901a\u8fc7 hash \u6216\u8303\u56f4\u52a8\u6001\u9884\u5206\u5272\u6210\u9884\u5b9a\u4e49\u6570\u91cf\u7684 tablets \uff0c\u4ee5\u4fbf\u5728\u96c6\u7fa4\u4e2d\u5747\u5300\u5206\u5e03\u5199\u5165\u548c\u67e5\u8be2\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u4efb\u610f\u6570\u91cf\u7684 primary key \uff08\u4e3b\u952e\uff09\u5217\uff0c\u4efb\u610f\u6570\u91cf\u7684 hashes \u548c\u53ef\u9009\u7684 list of split rows \u6765\u8fdb\u884c\u5206\u533a\u3002\u53c2\u89c1 \u6a21\u5f0f\u8bbe\u8ba1 \u3002 Parallel Scan\uff08\u5e76\u884c\u626b\u63cf\uff09 \u4e3a\u4e86\u5728\u73b0\u4ee3\u786c\u4ef6\u4e0a\u5b9e\u73b0\u6700\u9ad8\u7684\u6027\u80fd\uff0c Impala \u4f7f\u7528\u7684 Kudu \u5ba2\u6237\u7aef\u53ef\u4ee5\u8de8\u591a\u4e2a tablets \u626b\u63cf\u3002 High-efficiency queries\uff08\u9ad8\u6548\u67e5\u8be2\uff09 \u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c Impala \u5c06\u8c13\u8bcd\u8bc4\u4f30\u4e0b\u63a8\u5230 Kudu \uff0c\u4ee5\u4fbf\u4f7f\u8c13\u8bcd\u8bc4\u4f30\u4e3a\u5c3d\u53ef\u80fd\u63a5\u8fd1\u6570\u636e\u3002\u5728\u8bb8\u591a\u4efb\u52a1\u4e2d\uff0c\u67e5\u8be2\u6027\u80fd\u4e0e Parquet \u76f8\u5f53\u3002 \u6709\u5173\u4f7f\u7528 Impala \u67e5\u8be2\u5b58\u50a8\u5728 Kudu \u4e2d\u7684\u6570\u636e\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Impala \u6587\u6863\u3002","title":"Kudu-Impala \u96c6\u6210\u7279\u6027"},{"location":"1/#_1","text":"Columnar Data Store \uff08\u5217\u5f0f\u6570\u636e\u5b58\u50a8\uff09 Kudu \u662f\u4e00\u4e2a columnar data store \uff08\u5217\u5f0f\u6570\u636e\u5b58\u50a8\uff09 \u3002\u5217\u5f0f\u6570\u636e\u5b58\u50a8\u5728\u5f3a\u7c7b\u578b\u5217\u4e2d\u3002\u7531\u4e8e\u51e0\u4e2a\u539f\u56e0\uff0c\u901a\u8fc7\u9002\u5f53\u7684\u8bbe\u8ba1\uff0c Kudu \u5bf9 analytical \uff08\u5206\u6790\uff09\u6216 warehousing \uff08\u6570\u636e\u4ed3\u5e93\uff09\u5de5\u4f5c\u4f1a\u975e\u5e38\u51fa\u8272\u3002 Read Efficiency \uff08\u9ad8\u6548\u8bfb\u53d6\uff09 \u5bf9\u4e8e\u5206\u6790\u67e5\u8be2\uff0c\u5141\u8bb8\u8bfb\u53d6\u5355\u4e2a\u5217\u6216\u8be5\u5217\u7684\u4e00\u90e8\u5206\u540c\u65f6\u5ffd\u7565\u5176\u4ed6\u5217\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u5728\u78c1\u76d8\u4e0a\u8bfb\u53d6\u66f4\u5c11\u5757\u6765\u5b8c\u6210\u67e5\u8be2\u3002\u4e0e\u57fa\u4e8e\u884c\u7684\u5b58\u50a8\u76f8\u6bd4\uff0c\u5373\u4f7f\u53ea\u8fd4\u56de\u51e0\u5217\u7684\u503c\uff0c\u4ecd\u9700\u8981\u8bfb\u53d6\u6574\u884c\u6570\u636e\u3002 Data Compression \uff08\u6570\u636e\u538b\u7f29\uff09 \u7531\u4e8e\u7ed9\u5b9a\u7684\u5217\u53ea\u5305\u542b\u4e00\u79cd\u7c7b\u578b\u7684\u6570\u636e\uff0c\u57fa\u4e8e\u6a21\u5f0f\u7684\u538b\u7f29\u6bd4\u538b\u7f29\u6df7\u5408\u6570\u636e\u7c7b\u578b\uff08\u5728\u57fa\u4e8e\u884c\u7684\u89e3\u51b3\u65b9\u6848\u4e2d\u4f7f\u7528\uff09\u65f6\u66f4\u6709\u6548\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002\u7ed3\u5408\u4ece\u5217\u8bfb\u53d6\u6570\u636e\u7684\u6548\u7387\uff0c\u538b\u7f29\u5141\u8bb8\u60a8\u5728\u4ece\u78c1\u76d8\u8bfb\u53d6\u66f4\u5c11\u7684\u5757\u65f6\u5b8c\u6210\u67e5\u8be2\u3002\u8bf7\u53c2\u9605 \u6570\u636e\u538b\u7f29 Table \uff08\u8868\uff09 \u4e00\u5f20 _ talbe _\u662f\u6570\u636e\u5b58\u50a8\u5728 Kudu \u7684\u4f4d\u7f6e\u3002\u8868\u5177\u6709 schema \u548c\u5168\u5c40\u6709\u5e8f\u7684 primary key \uff08\u4e3b\u952e\uff09\u3002 table \u88ab\u5206\u6210\u79f0\u4e3a tablets \u7684 segments \u3002 Tablet \u4e00\u4e2a tablet \u662f\u4e00\u5f20 table \u8fde\u7eed\u7684 segment \uff0c\u4e0e\u5176\u5b83\u6570\u636e\u5b58\u50a8\u5f15\u64ce\u6216\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u7684 partition \uff08\u5206\u533a\uff09\u76f8\u4f3c\u3002\u7ed9\u5b9a\u7684 tablet \u5197\u4f59\u5230\u591a\u4e2a tablet \u670d\u52a1\u5668\u4e0a\uff0c\u5e76\u4e14\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c\u5176\u4e2d\u4e00\u4e2a\u526f\u672c\u88ab\u8ba4\u4e3a\u662f leader tablet \u3002\u4efb\u4f55\u526f\u672c\u90fd\u53ef\u4ee5\u5bf9\u8bfb\u53d6\u8fdb\u884c\u670d\u52a1\uff0c\u5e76\u4e14\u5199\u5165\u65f6\u9700\u8981\u5728\u4e3a tablet \u670d\u52a1\u7684\u4e00\u7ec4 tablet server \u4e4b\u95f4\u8fbe\u6210\u4e00\u81f4\u6027\u3002 Tablet Server \u4e00\u4e2a tablet server \u5b58\u50a8 tablet \u548c\u4e3a tablet \u5411 client \u63d0\u4f9b\u670d\u52a1\u3002\u5bf9\u4e8e\u7ed9\u5b9a\u7684 tablet \uff0c\u4e00\u4e2a tablet server \u5145\u5f53 leader\uff0c\u5176\u4ed6 tablet server \u5145\u5f53\u8be5 tablet \u7684 follower \u526f\u672c\u3002\u53ea\u6709 leader \u670d\u52a1\u5199\u8bf7\u6c42\uff0c\u7136\u800c leader \u6216 followers \u4e3a\u6bcf\u4e2a\u670d\u52a1\u63d0\u4f9b\u8bfb\u8bf7\u6c42\u3002 leader \u4f7f\u7528 Raft Consensus Algorithm \u6765\u8fdb\u884c\u9009\u4e3e \u3002\u4e00\u4e2a tablet server \u53ef\u4ee5\u670d\u52a1\u591a\u4e2a tablets \uff0c\u5e76\u4e14\u4e00\u4e2a tablet \u53ef\u4ee5\u88ab\u591a\u4e2a tablet servers \u670d\u52a1\u7740\u3002 Master \u8be5 master \u4fdd\u6301\u8ddf\u8e2a\u6240\u6709\u7684 tablets \uff0c tablet servers \uff0c Catalog Table \u548c\u5176\u5b83\u4e0e\u96c6\u7fa4\u76f8\u5173\u7684 metadata \u3002\u5728\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u8d77\u4f5c\u7528\u7684 master \uff08\u4e5f\u5c31\u662f leader \uff09\u3002\u5982\u679c\u5f53\u524d\u7684 leader \u6d88\u5931\uff0c\u5219\u9009\u4e3e\u51fa\u4e00\u4e2a\u65b0\u7684 master \uff0c\u4f7f\u7528 Raft Consensus Algorithm \u6765\u8fdb\u884c\u9009\u4e3e\u3002 master \u8fd8\u534f\u8c03\u5ba2\u6237\u7aef\u7684 metadata operations \uff08\u5143\u6570\u636e\u64cd\u4f5c\uff09\u3002\u4f8b\u5982\uff0c\u5f53\u521b\u5efa\u65b0\u8868\u65f6\uff0c\u5ba2\u6237\u7aef\u5185\u90e8\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9 master \u3002 master \u5c06\u65b0\u8868\u7684\u5143\u6570\u636e\u5199\u5165 catalog table \uff0c\u5e76\u534f\u8c03\u5728 tablet server \u4e0a\u521b\u5efa tablet \u7684\u8fc7\u7a0b\u3002 \u6240\u6709 master \u7684\u6570\u636e\u90fd\u5b58\u50a8\u5728\u4e00\u4e2a tablet \u4e2d\uff0c\u53ef\u4ee5\u590d\u5236\u5230\u6240\u6709\u5176\u4ed6\u5019\u9009\u7684 master \u3002 tablet server \u4ee5\u8bbe\u5b9a\u7684\u95f4\u9694\u5411 master \u53d1\u51fa\u5fc3\u8df3\uff08\u9ed8\u8ba4\u503c\u4e3a\u6bcf\u79d2\u4e00\u6b21\uff09\u3002 Raft Consensus Algorithm Kudu \u4f7f\u7528 Raft consensus algorithm \u4f5c\u4e3a\u786e\u4fdd\u5e38\u89c4 tablet \u548c master \u6570\u636e\u7684\u5bb9\u9519\u6027\u548c\u4e00\u81f4\u6027\u7684\u624b\u6bb5\u3002\u901a\u8fc7 Raft \uff0c tablet \u7684\u591a\u4e2a\u526f\u672c\u9009\u4e3e\u51fa_ leader \uff0c\u5b83\u8d1f\u8d23\u63a5\u53d7\u4ee5\u53ca\u590d\u5236\u5230 follower _\u526f\u672c\u7684\u5199\u5165\u3002\u4e00\u65e6\u5199\u5165\u7684\u6570\u636e\u5728\u5927\u591a\u6570\u526f\u672c\u4e2d\u6301\u4e45\u5316\u540e\uff0c\u5c31\u4f1a\u5411\u5ba2\u6237\u786e\u8ba4\u3002\u7ed9\u5b9a\u7684\u4e00\u7ec4 N \u526f\u672c\uff08\u901a\u5e38\u4e3a 3 \u6216 5 \u4e2a\uff09\u80fd\u591f\u63a5\u53d7\u6700\u591a **(N - 1)/2** \u9519\u8bef\u7684\u526f\u672c\u7684\u5199\u5165\u3002 Catalog Table\uff08\u76ee\u5f55\u8868\uff09 _ catalog talbe _\u662f Kudu \u7684 metadata \uff08\u5143\u6570\u636e\u4e2d\uff09\u7684\u4e2d\u5fc3\u4f4d\u7f6e\u3002\u5b83\u5b58\u50a8\u6709\u5173 tables \u548c tablets \u7684\u4fe1\u606f\u3002\u8be5 catalog table \uff08\u76ee\u5f55\u8868\uff09\u53ef\u80fd\u4e0d\u4f1a\u88ab\u76f4\u63a5\u8bfb\u53d6\u6216\u5199\u5165\u3002\u76f8\u53cd\uff0c\u5b83\u53ea\u80fd\u901a\u8fc7\u5ba2\u6237\u7aef API \u4e2d\u516c\u5f00\u7684\u5143\u6570\u636e\u64cd\u4f5c\u8bbf\u95ee\u3002 catalog table \u5b58\u50a8\u4e24\u7c7b\u5143\u6570\u636e\u3002 Tables table schemas , locations , and states \uff08\u8868\u7ed3\u6784\uff0c\u4f4d\u7f6e \u548c\u72b6\u6001\uff09 Tablets \u73b0\u6709 tablet \u7684\u5217\u8868\uff0c\u6bcf\u4e2a tablet \u7684 \u526f\u672c\u6240\u5728\u54ea\u4e9b tablet server \uff0c tablet \u7684\u5f53\u524d\u72b6\u6001\u4ee5\u53ca\u5f00\u59cb\u548c\u7ed3\u675f\u7684 keys \uff08\u952e\uff09\u3002 Logical Replication \uff08\u903b\u8f91\u590d\u5236\uff09 Kudu \u590d\u5236\u64cd\u4f5c\uff0c\u4e0d\u662f\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u3002\u8fd9\u88ab\u79f0\u4e3a logical replication \uff08__\u903b\u8f91\u590d\u5236\uff09 \uff0c\u800c\u4e0d\u662f physical replication \uff08__\u7269\u7406\u590d\u5236\uff09 \u3002\u8fd9\u6709\u51e0\u4e2a\u4f18\u70b9 : \u867d\u7136 insert \uff08\u63d2\u5165\uff09\u548c update \uff08\u66f4\u65b0\uff09\u786e\u5b9e\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u6570\u636e\uff0c deletes \uff08\u5220\u9664\uff09\u4e0d\u9700\u8981\u79fb\u52a8\u4efb\u4f55\u6570\u636e\u3002 delete \uff08\u5220\u9664\uff09\u64cd\u4f5c\u88ab\u53d1\u9001\u5230\u6bcf\u4e2a tablet server \uff0c\u5b83\u5728\u672c\u5730\u6267\u884c\u5220\u9664\u3002 \u7269\u7406\u64cd\u4f5c\uff0c\u5982 compaction \uff0c\u4e0d\u9700\u8981\u901a\u8fc7 Kudu \u7684\u7f51\u7edc\u4f20\u8f93\u6570\u636e\u3002\u8fd9\u4e0e\u4f7f\u7528 HDFS \u7684\u5b58\u50a8\u7cfb\u7edf\u4e0d\u540c\uff0c\u5176\u4e2d blocks \uff08\u5757\uff09\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u4ee5\u6ee1\u8db3\u6240\u9700\u6570\u91cf\u7684\u526f\u672c\u3002 tablet \u4e0d\u9700\u8981\u5728\u540c\u4e00\u65f6\u95f4\u6216\u76f8\u540c\u7684\u65f6\u95f4\u8868\u4e0a\u6267\u884c\u538b\u7f29\uff0c\u6216\u8005\u5728\u7269\u7406\u5b58\u50a8\u5c42\u4e0a\u4fdd\u6301\u540c\u6b65\u3002\u8fd9\u4f1a\u51cf\u5c11\u7531\u4e8e\u538b\u7f29\u6216\u5927\u91cf\u5199\u5165\u8d1f\u8f7d\u800c\u5bfc\u81f4\u6240\u6709 tablet server \u540c\u65f6\u9047\u5230\u9ad8\u5ef6\u8fdf\u7684\u673a\u4f1a\u3002","title":"\u6982\u5ff5\u548c\u672f\u8bed"},{"location":"1/#_2","text":"\u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u5177\u6709\u4e09\u4e2a master \u548c\u591a\u4e2a tablet server \u7684 Kudu \u96c6\u7fa4\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u90fd\u652f\u6301\u591a\u4e2a tablet \u3002\u5b83\u8bf4\u660e\u4e86\u5982\u4f55\u4f7f\u7528 Raft \u5171\u8bc6\u6765\u5141\u8bb8 master \u548c tablet server \u7684 leader \u548c f ollow \u3002\u6b64\u5916\uff0c tablet server \u53ef\u4ee5\u6210\u4e3a\u67d0\u4e9b tablet \u7684 leader \uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6 tablet \u7684 follower \u3002 leader \u4ee5\u91d1\u8272\u663e\u793a\uff0c\u800c follower \u5219\u663e\u793a\u4e3a\u84dd\u8272\u3002","title":"\u67b6\u6784\u6982\u8ff0"},{"location":"1/#_3","text":"Streaming Input with Near Real Time Availability \uff08\u5177\u6709\u8fd1\u5b9e\u65f6\u53ef\u7528\u6027\u7684\u6d41\u8f93\u5165\uff09 \u6570\u636e\u5206\u6790\u4e2d\u7684\u4e00\u4e2a\u5171\u540c\u6311\u6218\u5c31\u662f\u65b0\u6570\u636e\u5feb\u901f\u800c\u4e0d\u65ad\u5730\u5230\u8fbe\uff0c\u540c\u6837\u7684\u6570\u636e\u9700\u8981\u9760\u8fd1\u5b9e\u65f6\u7684\u8bfb\u53d6\uff0c\u626b\u63cf\u548c\u66f4\u65b0\u3002Kudu \u901a\u8fc7\u9ad8\u6548\u7684\u5217\u5f0f\u626b\u63cf\u63d0\u4f9b\u4e86\u5feb\u901f\u63d2\u5165\u548c\u66f4\u65b0\u7684\u5f3a\u5927\u7ec4\u5408\uff0c\u4ece\u800c\u5728\u5355\u4e2a\u5b58\u50a8\u5c42\u4e0a\u5b9e\u73b0\u4e86\u5b9e\u65f6\u5206\u6790\u7528\u4f8b\u3002 Time-series application with widely varying access patterns \uff08\u5177\u6709\u5e7f\u6cdb\u53d8\u5316\u7684\u8bbf\u95ee\u6a21\u5f0f\u7684\u65f6\u95f4\u5e8f\u5217\u5e94\u7528\uff09 time-series \uff08\u65f6\u95f4\u5e8f\u5217\uff09\u6a21\u5f0f\u662f\u6839\u636e\u5176\u53d1\u751f\u65f6\u95f4\u7ec4\u7ec7\u548c\u952e\u5165\u6570\u636e\u70b9\u7684\u6a21\u5f0f\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u8c03\u67e5\u6307\u6807\u7684\u6027\u80fd\uff0c\u6216\u8005\u6839\u636e\u8fc7\u53bb\u7684\u6570\u636e\u5c1d\u8bd5\u9884\u6d4b\u672a\u6765\u7684\u884c\u4e3a\u3002\u4f8b\u5982\uff0c\u65f6\u95f4\u5e8f\u5217\u7684\u5ba2\u6237\u6570\u636e\u53ef\u4ee5\u7528\u4e8e\u5b58\u50a8\u8d2d\u4e70\u70b9\u51fb\u6d41\u5386\u53f2\u5e76\u9884\u6d4b\u672a\u6765\u7684\u8d2d\u4e70\uff0c\u6216\u7531\u5ba2\u6237\u652f\u6301\u4ee3\u8868\u4f7f\u7528\u3002\u867d\u7136\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u5206\u6790\u6b63\u5728\u53d1\u751f\uff0c\u63d2\u5165\u548c\u66f4\u6362\u4e5f\u53ef\u80fd\u5355\u72ec\u548c\u6279\u91cf\u5730\u53d1\u751f\uff0c\u5e76\u4e14\u7acb\u5373\u53ef\u7528\u4e8e\u8bfb\u53d6\u5de5\u4f5c\u8d1f\u8f7d\u3002 Kudu \u53ef\u4ee5\u7528 scalable \uff08\u53ef\u6269\u5c55\uff09\u548c efficient \uff08\u9ad8\u6548\u7684\uff09\u65b9\u5f0f\u540c\u65f6\u5904\u7406\u6240\u6709\u8fd9\u4e9b\u8bbf\u95ee\u6a21\u5f0f\u3002\u7531\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0c Kudu \u975e\u5e38\u9002\u5408\u65f6\u95f4\u5e8f\u5217\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u968f\u7740 Kudu \u5bf9\u57fa\u4e8e hash \u7684\u5206\u533a\u7684\u652f\u6301\uff0c\u7ed3\u5408\u5176\u5bf9\u590d\u5408 row keys \uff08\u884c\u952e\uff09\u7684\u672c\u5730\u652f\u6301\uff0c\u5c06\u8bb8\u591a\u670d\u52a1\u5668\u4e0a\u7684\u8868\u8bbe\u7f6e\u6210\u5f88\u7b80\u5355\uff0c\u800c\u4e0d\u4f1a\u5728\u4f7f\u7528\u8303\u56f4\u5206\u533a\u65f6\u901a\u5e38\u89c2\u5bdf\u5230\u201c hotspotting \uff08\u70ed\u70b9\uff09\u201d\u7684\u98ce\u9669\u3002 Kudu \u7684\u5217\u5f0f\u5b58\u50a8\u5f15\u64ce\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e5f\u662f\u6709\u76ca\u7684\uff0c\u56e0\u4e3a\u8bb8\u591a\u65f6\u95f4\u5e8f\u5217\u5de5\u4f5c\u8d1f\u8f7d\u53ea\u8bfb\u53d6\u4e86\u51e0\u5217\uff0c\u800c\u4e0d\u662f\u6574\u884c\u3002 \u8fc7\u53bb\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u591a\u4e2a\u6570\u636e\u5b58\u50a8\u6765\u5904\u7406\u4e0d\u540c\u7684\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u3002\u8fd9\u79cd\u505a\u6cd5\u589e\u52a0\u4e86\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7684\u590d\u6742\u6027\uff0c\u5e76\u91cd\u590d\u4e86\u6570\u636e\uff0c\u4f7f\u6240\u9700\u5b58\u50a8\u91cf\u589e\u52a0\u4e86\u4e00\u500d\uff08\u6216\u66f4\u7cdf\uff09\u3002 Kudu \u53ef\u4ee5\u672c\u5730\u548c\u9ad8\u6548\u5730\u5904\u7406\u6240\u6709\u8fd9\u4e9b\u8bbf\u95ee\u6a21\u5f0f\uff0c\u800c\u65e0\u9700\u5c06\u5de5\u4f5c\u5378\u8f7d\u5230\u5176\u4ed6\u6570\u636e\u5b58\u50a8\u3002 Predictive Modeling \uff08\u9884\u6d4b\u5efa\u6a21\uff09 \u6570\u636e\u79d1\u5b66\u5bb6\u7ecf\u5e38\u4ece\u5927\u91cf\u6570\u636e\u4e2d\u5f00\u53d1\u9884\u6d4b\u5b66\u4e60\u6a21\u578b\u3002\u6a21\u578b\u548c\u6570\u636e\u53ef\u80fd\u9700\u8981\u5728\u5b66\u4e60\u53d1\u751f\u65f6\u6216\u968f\u7740\u5efa\u6a21\u60c5\u51b5\u7684\u53d8\u5316\u800c\u7ecf\u5e38\u66f4\u65b0\u6216\u4fee\u6539\u3002\u6b64\u5916\uff0c\u79d1\u5b66\u5bb6\u53ef\u80fd\u60f3\u6539\u53d8\u6a21\u578b\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u56e0\u7d20\uff0c\u770b\u770b\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u5728 HDFS \u4e2d\u66f4\u65b0\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u7684\u5927\u91cf\u6570\u636e\u662f\u8d44\u6e90\u5bc6\u96c6\u578b\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u9700\u8981\u88ab\u5b8c\u5168\u91cd\u5199\u3002\u5728 Kudu \uff0c\u66f4\u65b0\u53d1\u751f\u5728\u8fd1\u4e4e\u5b9e\u65f6\u3002\u79d1\u5b66\u5bb6\u53ef\u4ee5\u8c03\u6574\u503c\uff0c\u91cd\u65b0\u8fd0\u884c\u67e5\u8be2\uff0c\u5e76\u4ee5\u79d2\u6216\u5206\u949f\u800c\u4e0d\u662f\u51e0\u5c0f\u65f6\u6216\u51e0\u5929\u5237\u65b0\u56fe\u5f62\u3002\u6b64\u5916\uff0c\u6279\u5904\u7406\u6216\u589e\u91cf\u7b97\u6cd5\u53ef\u4ee5\u968f\u65f6\u5728\u6570\u636e\u4e0a\u8fd0\u884c\uff0c\u5177\u6709\u63a5\u8fd1\u5b9e\u65f6\u7684\u7ed3\u679c\u3002 Combining Data In Kudu With Legacy Systems \uff08\u7ed3\u5408 Kudu \u4e0e\u9057\u7559\u7cfb\u7edf\u7684\u6570\u636e\uff09 \u516c\u53f8\u4ece\u591a\u4e2a\u6765\u6e90\u751f\u6210\u6570\u636e\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u5404\u79cd\u7cfb\u7edf\u548c\u683c\u5f0f\u4e2d\u3002\u4f8b\u5982\uff0c\u60a8\u7684\u4e00\u4e9b\u6570\u636e\u53ef\u80fd\u5b58\u50a8\u5728 Kudu \uff0c\u4e00\u4e9b\u5728\u4f20\u7edf\u7684 RDBMS \u4e2d\uff0c\u4e00\u4e9b\u5728 HDFS \u4e2d\u7684\u6587\u4ef6\u4e2d\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Impala \u8bbf\u95ee\u548c\u67e5\u8be2\u6240\u6709\u8fd9\u4e9b\u6e90\u548c\u683c\u5f0f\uff0c\u800c\u65e0\u9700\u66f4\u6539\u65e7\u7248\u7cfb\u7edf\u3002","title":"\u6848\u4f8b\u793a\u4f8b"},{"location":"1/#_4","text":"Kudu \u5165\u95e8\u6307\u5357 \u5b89\u88c5\u6307\u5357","title":"\u4e0b\u4e00\u6b65"},{"location":"10/","text":"Kudu Security ( \u5b89\u5168 ) \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/security.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813635 \u8d21\u732e\u8005 : \u5c0f\u7476 \uff0c ApacheCN \uff0c Apache\u4e2d\u6587\u7f51 Kudu \u5305\u62ec\u5b89\u5168\u529f\u80fd\uff0c\u5b83\u53ef\u4ee5\u8ba9\u96c6\u7fa4\u66f4\u5b89\u5168\u4ee5\u9632\u6b62\u672a\u6388\u6743\u7684\u7528\u6237\u8bbf\u95ee\u3002\u672c\u6307\u5357\u4ecb\u7ecd\u4e86 Kudu \u63d0\u4f9b\u7684\u5b89\u5168\u529f\u80fd\uff0c\u5217\u51fa\u4e86\u5fc5\u8981\u7684\u914d\u7f6e\u9009\u9879\u3002 Known Limitations \u5305\u542b\u4e86 Kudu \u4e2d\u5b89\u5168\u517c\u5bb9\u6027\u65b9\u9762\u4e0d\u8db3\u7684\u5217\u8868\u3002 Authentication \uff08\u8ba4\u8bc1\uff09 Kudu \u53ef\u4ee5\u914d\u7f6e\u4e3a\u5728\u670d\u52a1\u5668\u4e4b\u95f4\u548c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u5b9e\u65bd\u5b89\u5168\u8ba4\u8bc1\u3002\u8eab\u4efd\u9a8c\u8bc1\u53ef\u9632\u6b62\u4e0d\u53d7\u4fe1\u4efb\u7684\u884c\u4e3a\u8005\u8bbf\u95ee Kudu \uff0c\u5e76\u5b89\u5168\u5730\u8bc6\u522b\u8fde\u63a5\u7684\u7528\u6237\u6216\u670d\u52a1\u4ee5\u8fdb\u884c\u6388\u6743\u68c0\u67e5\u3002Kudu \u7684\u8ba4\u8bc1\u65e8\u5728\u901a\u8fc7\u4f7f\u7528 Kerberos \u4e0e\u5176\u4ed6\u5b89\u5168\u7684 Hadoop \u7ec4\u4ef6\u8fdb\u884c\u4e92\u64cd\u4f5c\u3002 \u53ef\u4ee5\u5728 Kudu servers \u4e0a\u4f7f\u7528 **--rpc-authentication** \u6807\u8bb0\u6765\u914d\u7f6e\u8ba4\u8bc1 \uff0c\u5b83\u53ef\u4ee5\u88ab\u8bbe\u7f6e\u4e3a required \uff0c optional \uff0c\u6216 disabled \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6807\u8bb0\u8bbe\u7f6e\u4e3a optional \u3002\u5f53\u8bbe\u7f6e\u4e3a **required** \u65f6\uff0c Kudu \u5c06\u62d2\u7edd\u5ba2\u6237\u7aef\u548c\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u51ed\u8bc1\u7684\u670d\u52a1\u5668\u7684\u8fde\u63a5\u3002\u5f53\u8bbe\u7f6e\u4e3a **optional** \u65f6 \uff0c Kudu \u5c06\u5c1d\u8bd5\u4f7f\u7528\u5f3a\u8eab\u4efd\u9a8c\u8bc1\u3002\u5f53\u914d\u7f6e\u4e3a **disabled** \u6216\u9488\u5bf9 \u201c optional \u201d \u7684\u5f3a\u8ba4\u8bc1\u5931\u8d25\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c Kudu \u5c06\u53ea\u5141\u8bb8\u6765\u81ea\u53d7\u4fe1\u4efb\u5b50\u7f51\u7684\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fde\u63a5\uff0c\u5b83\u4eec\u662f\u975e\u79c1\u6709\u7f51\u7edc\uff08127.0.0.0.08,10.0.0.08,172.16.0.0/12,192.168.0.0/16,169.254.0.0 / 16\uff09\u548c\u672c\u5730\u7f51\u7edc\u63a5\u53e3\u7684\u672c\u5730\u5b50\u7f51\u3002\u6765\u81ea\u53ef\u516c\u5f00\u8def\u7531\u7684 IP \u7684\u672a\u8ba4\u8bc1\u8fde\u63a5\u5c06\u88ab\u62d2\u7edd\u3002 \u53ef\u4fe1\u4efb\u7684\u5b50\u7f51\u53ef\u4ee5\u4f7f\u7528 **--trusted_subnets** \u6807\u8bb0 \u8fdb\u884c\u914d\u7f6e\uff0c\u8be5\u6807\u8bb0\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4ee5\u9017\u53f7\u5206\u9694\u7684 CIDR \u8868\u793a\u6cd5\u7684 IP \u5757\u3002\u5c06\u5176\u8bbe\u7f6e\u4e3a \u201c 0.0.0.0/0 \u201d \u4ee5\u5141\u8bb8\u6765\u81ea\u6240\u6709\u8fdc\u7a0b IP \u5730\u5740\u7684\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fde\u63a5\u3002\u4f46\u662f\uff0c\u5982\u679c\u7f51\u7edc\u8bbf\u95ee\u4e0d\u53d7\u9632\u706b\u5899\u7684\u9650\u5236\uff0c\u6076\u610f\u7528\u6237\u53ef\u80fd\u4f1a\u83b7\u5f97\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\u3002\u5982\u679c\u8ba4\u8bc1\u88ab\u914d\u7f6e\u4e3a required \uff0c\u8fd9\u53ef\u4ee5\u51cf\u5c11\u8fd9\u6837\u7684\u884c\u4e3a\u3002 \u8b66\u544a : \u5f53 --rpc-authentication \u6807\u8bb0\u8bbe\u7f6e\u4e3a optional \u65f6\uff0c\u8be5\u96c6\u7fa4\u4e0d\u4f1a\u963b\u6b62\u6765\u81ea\u672a\u6388\u6743\u7528\u6237\u7684\u8bbf\u95ee\u8bf7\u6c42\u3002\u8981\u4fdd\u62a4\u96c6\u7fa4\uff0c\u8bf7\u4f7f\u7528 --rpc-authentication=required \u3002 Internal PKI Kudu \u4f7f\u7528\u5185\u90e8 PKI \u7cfb\u7edf\u5411\u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u5668\u53d1\u51fa X.509 \u8bc1\u4e66\u3002\u5177\u6709\u83b7\u5f97\u8bc1\u4e66\u7684\u5bf9\u7b49\u4f53\u4e4b\u95f4\u7684\u8fde\u63a5\u5c06\u4f7f\u7528 TLS \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8fd9\u4e0d\u9700\u8981\u8054\u7cfb Kerberos KDC \u3002\u8fd9\u4e9b\u8bc1\u4e66_ only \uff08\u4ec5\u4ec5\uff09_\u7528\u4e8e Kudu \u670d\u52a1\u5668\u4e4b\u95f4\u4ee5\u53ca Kudu \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u5185\u90e8\u901a\u4fe1\u3002\u8fd9\u4e9b\u8bc1\u4e66\u6c38\u8fdc\u4e0d\u4f1a\u5728\u9762\u5411\u516c\u4f17\u7684\u534f\u8bae\u4e2d\u5448\u73b0\u3002 \u901a\u8fc7\u4f7f\u7528\u5185\u90e8\u9881\u53d1\u7684\u8bc1\u4e66\uff0c Kudu \u63d0\u4f9b\u5f3a\u5927\u7684\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\uff0c\u53ef\u6269\u5c55\u5230\u5de8\u5927\u7684\u7fa4\u96c6\uff0c\u5e76\u5141\u8bb8\u4f7f\u7528 TLS \u52a0\u5bc6\uff0c\u800c\u65e0\u9700\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u624b\u52a8\u90e8\u7f72\u8bc1\u4e66\u3002 Authentication Tokens \uff08 \u8ba4\u8bc1\u4ee4\u724c \uff09 \u5728\u5bf9\u5b89\u5168\u7684\u7fa4\u96c6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u540e\uff0c Kudu \u5ba2\u6237\u7aef\u5c06\u81ea\u52a8\u5411 Kudu \u4e3b\u673a\u8bf7\u6c42\u4e00\u4e2a\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u3002\u8ba4\u8bc1\u4ee4\u724c\u5c01\u88c5\u8ba4\u8bc1\u7528\u6237\u7684\u8eab\u4efd\uff0c\u5e76\u643a\u5e26 master \u7684 RSA \u7b7e\u540d\uff0c\u4ee5\u4fbf\u9a8c\u8bc1\u5176\u771f\u5b9e\u6027\u3002 \u8be5\u4ee4\u724c\u5c06\u7528\u4e8e\u9a8c\u8bc1\u540e\u7eed\u8fde\u63a5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u4ec5\u5728\u4e03\u5929\u5185\u6709\u6548\uff0c\u56e0\u6b64\u5373\u4f7f\u4ee4\u724c\u906d\u5230\u5165\u4fb5\uff0c\u4e5f\u4e0d\u80fd\u65e0\u9650\u671f\u5730\u4f7f\u7528\u4ee4\u724c\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u5e94\u5bf9\u7528\u6237\u5b8c\u5168\u900f\u660e\u3002\u901a\u8fc7\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\uff0c Kudu \u53ef\u4ee5\u5229\u7528\u5f3a\u5927\u7684\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\uff0c\u800c\u65e0\u9700\u652f\u4ed8\u4e0e\u6bcf\u4e2a\u8fde\u63a5\u7684\u4e2d\u592e\u673a\u6784\u8fdb\u884c\u901a\u4fe1\u7684\u53ef\u6269\u5c55\u6027\u6210\u672c\u3002 \u5f53\u4e0e\u5206\u5e03\u5f0f\u8ba1\u7b97\u6846\u67b6\uff08\u5982 Spark \uff09\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u53ef\u4ee5\u7b80\u5316\u914d\u7f6e\u5e76\u63d0\u9ad8\u5b89\u5168\u6027\u3002\u4f8b\u5982\uff0c Kudu Spark connector \uff08\u8fde\u63a5\u5668\uff09\u5c06\u5728\u89c4\u5212\u9636\u6bb5\u81ea\u52a8\u68c0\u7d22\u8ba4\u8bc1\u4ee4\u724c\uff0c\u5e76\u5c06\u4ee4\u724c\u5206\u53d1\u5230\u4efb\u52a1\u3002\u8fd9\u6837\uff0c Spark \u53ef\u4ee5\u5bf9\u53d7\u4fdd\u62a4\u7684 Kudu \u96c6\u7fa4\u5de5\u4f5c\uff0c\u53ea\u6709 planner node \u5177\u6709 Kerberos \u51ed\u636e\u3002 Scalability \uff08\u53ef\u6269\u5c55\u6027\uff09 Kudu \u8ba4\u8bc1\u65e8\u5728\u6269\u5c55\u5230\u6570\u5343\u4e2a\u8282\u70b9\uff0c\u8fd9\u9700\u8981\u907f\u514d\u4e0e\u4e2d\u592e\u8ba4\u8bc1\u673a\u6784\uff08\u5982 Kerberos KDC \uff09\u7684\u4e0d\u5fc5\u8981\u7684\u534f\u8c03\u3002\u76f8\u53cd\uff0c Kudu \u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5c06\u4f7f\u7528 Kerberos \u4e0e Kudu \u4e3b\u673a\u5efa\u7acb\u521d\u59cb\u4fe1\u4efb\uff0c\u7136\u540e\u4f7f\u7528\u5907\u7528\u51ed\u636e\u8fdb\u884c\u540e\u7eed\u8fde\u63a5\u3002\u7279\u522b\u662f\uff0c master \u5c06\u5411\u670d\u52a1\u5668\u53d1\u51fa\u5185\u90e8 X.509 \u8bc1\u4e66\uff0c\u5411\u5ba2\u6237\u7aef\u53d1\u51fa\u4e34\u65f6\u8ba4\u8bc1\u4ee4\u724c\u3002 Encryption\uff08\u52a0\u5bc6\uff09 Kudu \u5141\u8bb8\u4f7f\u7528 TLS \u5bf9\u670d\u52a1\u5668\u4e4b\u95f4\u4ee5\u53ca\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\u8fdb\u884c\u52a0\u5bc6\u3002 \u53ef\u4ee5\u5728 Kudu servers \u4e0a\u4f7f\u7528 **--rpc-encryption** \u6807\u8bb0\u6765\u914d\u7f6e\u52a0\u5bc6 \uff0c\u5b83\u53ef\u4ee5\u88ab\u8bbe\u7f6e\u4e3a required \uff0c optional \u6216 disabled \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6807\u5fd7\u8bbe\u7f6e\u4e3a optional \u3002\u5f53\u914d\u7f6e\u4e3a **required** \u65f6\uff0c Kudu \u5c06\u62d2\u7edd\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\u3002\u5f53\u914d\u7f6e\u4e3a **optional** \u65f6 \uff0c Kudu \u5c06\u5c1d\u8bd5\u4f7f\u7528\u52a0\u5bc6\u3002\u4e0e\u8ba4\u8bc1\u76f8\u540c\uff0c\u5f53\u914d\u7f6e\u4e3a disabled \u6216\u9488\u5bf9 **optional** \u7684\u60c5\u51b5\u4e0b\u52a0\u5bc6\u5931\u8d25 \uff0c Kudu \u5c06\u53ea\u5141\u8bb8\u6765\u81ea\u53d7\u4fe1\u4efb\u7684\u5b50\u7f51\u7684\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\uff0c\u5e76\u62d2\u7edd\u516c\u5f00\u53ef\u8def\u7531\u7684 IP \u7684\u4efb\u4f55\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\u3002\u8981\u4fdd\u62a4\u7fa4\u96c6\uff0c\u8bf7\u4f7f\u7528 --rpc-encryption=required \u3002 \u8b66\u544a : Kudu \u5c06\u81ea\u52a8\u5173\u95ed\u672c\u5730\u73af\u56de\u8fde\u63a5\u4e0a\u7684\u52a0\u5bc6\uff0c\u56e0\u4e3a\u6765\u81ea\u8fd9\u4e9b\u8fde\u63a5\u7684\u6d41\u91cf\u4e0d\u4f1a\u4ece\u5916\u90e8\u66b4\u9732\u51fa\u6765\u3002\u8fd9\u5141\u8bb8\u50cf Spark \u548c Impala \u8fd9\u6837\u7684\u4f4d\u7f6e\u611f\u77e5\u8ba1\u7b97\u6846\u67b6\u907f\u514d\u52a0\u5bc6\u5f00\u9500\uff0c\u540c\u65f6\u786e\u4fdd\u6570\u636e\u7684\u673a\u5bc6\u6027\u3002 Coarse-Grained Authorization\uff08\u7c97\u7c92\u5ea6\u6388\u6743\uff09 Kudu \u652f\u6301\u57fa\u4e8e\u8ba4\u8bc1\u7684\u5ba2\u6237\u7aef Kerberos \u4e3b\u4f53\uff08\u5373\u7528\u6237\u6216\u670d\u52a1\uff09\u5bf9\u5ba2\u6237\u7aef\u8bf7\u6c42\u8fdb\u884c\u7c97\u7c92\u5ea6\u6388\u6743\u3002\u53ef\u4ee5\u914d\u7f6e\u7684\u4e24\u4e2a\u7ea7\u522b\u7684\u8bbf\u95ee\u662f : Superuser \uff08\u8d85\u7ea7\u7528\u6237\uff09- \u88ab\u6388\u6743\u4e3a\u8d85\u7ea7\u7528\u6237\u7684 principals \u80fd\u591f\u6267\u884c\u67d0\u4e9b\u7ba1\u7406\u529f\u80fd\uff0c\u4f8b\u5982\u4f7f\u7528 kudu \u547d\u4ee4\u884c\u5de5\u5177\u8bca\u65ad\u6216\u4fee\u590d\u7fa4\u96c6\u95ee\u9898\u3002 User \uff08\u7528\u6237\uff09- \u6388\u6743\u4e3a\u7528\u6237 principals \u90fd\u80fd\u591f\u5728 Kudu \u96c6\u7fa4\u4e2d\u8bbf\u95ee\u548c\u4fee\u6539\u6240\u6709\u6570\u636e\u3002\u8fd9\u5305\u62ec create \uff08\u521b\u5efa\uff09\uff0c drop \uff08\u5220\u9664\uff09\u548c alter \uff08\u66f4\u6539\uff09\u8868\u4ee5\u53ca read \uff08\u8bfb\u53d6\uff09\uff0c insert \uff08\u63d2\u5165\uff09\uff0c update \uff08\u66f4\u65b0\uff09\u548c delete \uff08\u5220\u9664\uff09\u6570\u636e\u7684\u529f\u80fd\u3002 \u8b66\u544a : \u5728\u5185\u90e8\uff0c Kudu \u9488\u5bf9\u5b88\u62a4\u8fdb\u7a0b\u672c\u8eab\u5177\u6709\u7b2c\u4e09\u7684\u8bbf\u95ee\u7ea7\u522b\u3002\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u7528\u6237\u65e0\u6cd5\u8fde\u63a5\u5230\u96c6\u7fa4\uff0c\u5e76\u53ef\u4ee5\u4f5c\u4e3a tablet server \u3002 \u4f7f\u7528\u767d\u540d\u5355\u6837\u5f0f\u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08 ACL \uff09\u6388\u4e88\u8bbf\u95ee\u7ea7\u522b\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u7ea7\u522b\u4e2d\u7684\u6bcf\u4e00\u7ea7\u90fd\u53ef\u4ee5\u8bbf\u95ee\u3002\u6bcf\u4e2a\u8bbf\u95ee\u63a7\u5236\u5217\u8868\u6307\u5b9a\u4ee5\u9017\u53f7\u5206\u9694\u7684\u7528\u6237\u5217\u8868\uff0c\u6216\u8005\u53ef\u4ee5\u8bbe\u7f6e ***** \u4e3a\u8868\u793a\u6240\u6709\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u80fd\u591f\u4ee5\u6307\u5b9a\u7ea7\u522b\u83b7\u5f97\u8bbf\u95ee\u6743\u9650\u3002\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u4e0b\u9762\u7684 \u914d\u7f6e\u5b89\u5168\u7684 Kudu \u7fa4\u96c6 \u3002 \u8b66\u544a : \u7528\u6237 ACL \u7684\u9ed8\u8ba4\u503c\u662f * \u5141\u8bb8\u6240\u6709\u7528\u6237\u8bbf\u95ee\u96c6\u7fa4\u3002\u4f46\u662f\uff0c\u5982\u679c\u542f\u7528\u4e86\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8fd9\u4ecd\u7136\u9650\u5236\u5bf9\u53ea\u80fd\u901a\u8fc7 Kerberos \u6210\u529f\u9a8c\u8bc1\u7684\u7528\u6237\u7684\u8bbf\u95ee\u3002\u4e0e Kudu server \u5728\u540c\u4e00\u7f51\u7edc\u4e0a\u7684\u672a\u8ba4\u8bc1\u7528\u6237\u5c06\u65e0\u6cd5\u8bbf\u95ee\u96c6\u7fa4\u3002 Web UI Encryption \uff08\u52a0\u5bc6\uff09 \u53ef\u4ee5\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5668\u63d0\u4f9b TLS \u8bc1\u4e66\uff0c\u5c06 Kudu Web UI \u914d\u7f6e\u4e3a\u4f7f\u7528\u5b89\u5168\u7684 HTTPS \u52a0\u5bc6\u3002\u6709\u5173 Web UI HTTPS \u914d\u7f6e\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u914d\u7f6e\u5b89\u5168\u7684 Kudu \u96c6\u7fa4 \u3002 Web UI Redaction \u4e3a\u4e86\u9632\u6b62\u5728 Web UI \u4e2d\u66b4\u9732\u654f\u611f\u6570\u636e\uff0c\u6240\u6709\u884c\u6570\u636e\u90fd\u88ab\u4fee\u6539\u3002\u8868\u5143\u6570\u636e\uff0c\u5982\u8868\u540d\uff0c\u5217\u540d\u548c\u5206\u533a\u4fe1\u606f\u4e0d\u4f1a\u88ab\u4fee\u6539\u3002\u53ef\u4ee5\u901a\u8fc7\u5728 Kudu server \u4e0a\u8bbe\u7f6e --webserver-enabled=false \u6807\u8bb0 \u6765\u5b8c\u5168\u7981\u7528 Web UI \u3002 \u8b66\u544a : \u7981\u7528 Web UI \u4e5f\u5c06\u7981\u7528 REST endpoints \uff0c\u4f8b\u5982 /metrics \u3002\u76d1\u63a7\u7cfb\u7edf\u4f9d\u9760\u8fd9\u4e9b endpoints \u6765\u6536\u96c6 metrics \u6307\u6807\u6570\u636e\u3002 Log Security\uff08\u65e5\u5fd7\u5b89\u5168\uff09 \u4e3a\u4e86\u9632\u6b62\u654f\u611f\u6570\u636e\u5305\u542b\u5728 Kudu \u670d\u52a1\u5668\u65e5\u5fd7\u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u4fee\u6539\u6240\u6709\u884c\u6570\u636e\u3002\u8be5\u529f\u80fd\u53ef\u4ee5\u914d\u7f6e **--redact** \u6807\u8bb0\u6765\u5173\u95ed \u3002 Configuring a Secure Kudu Cluster \uff08\u914d\u7f6e\u5b89\u5168\u7684 Kudu \u96c6\u7fa4\uff09 \u5e94\u5728\u6240\u6709\u670d\u52a1\u5668\uff08 master \u548c tablet server \uff09\u4e0a\u8bbe\u7f6e\u4ee5\u4e0b\u914d\u7f6e\u53c2\u6570\uff0c\u4ee5\u786e\u4fdd Kudu \u96c6\u7fa4\u5b89\u5168 : # Connection Security #-------------------- --rpc-authentication=required --rpc-encryption=required --keytab-file=<path-to-kerberos-keytab> # Web UI Security #-------------------- --webserver-certificate-file=<path-to-cert-pem> --webserver-private-key-file=<path-to-key-pem> # optional --webserver-private-key-password-cmd=<password-cmd> # If you prefer to disable the web UI entirely: --webserver-enabled=false # Coarse-grained authorization #-------------------------------- # This example ACL setup allows the 'impala' user as well as the # 'nightly_etl_service_account' principal access to all data in the # Kudu cluster. The 'hadoopadmin' user is allowed to use administrative # tooling. Note that, by granting access to 'impala', other users # may access data in Kudu via the Impala service subject to its own # authorization rules. --user-acl=impala,nightly_etl_service_account --superuser-acl=hadoopadmin \u6709\u5173\u8fd9\u4e9b\u6807\u8bb0\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u914d\u7f6e\u6807\u8bb0\u6307\u5357\u3002 Known Limitations\uff08\u5df2\u77e5\u9650\u5236\uff09 Kudu \u6709\u4e00\u4e9b\u5df2\u77e5\u7684\u5b89\u5168\u9650\u5236 : Long-lived Tokens \uff08\u5e38\u7528\u7684\u4ee4\u724c\uff09 Java Kudu \u5ba2\u6237\u7aef\u5728\u521d\u59cb tokens \uff08\u4ee4\u724c\uff09\u5230\u671f\u540e\u4e0d\u4f1a\u81ea\u52a8\u8bf7\u6c42\u65b0\u7684 authn tokens \uff08\u4ee4\u724c\uff09\uff0c\u56e0\u6b64\u4e0d\u652f\u6301\u957f\u671f\u5b58\u5728\u7684\u5b89\u5168\u96c6\u7fa4\u4e2d\u7684 Java \u5ba2\u6237\u7aef\u3002\u7136\u800c\uff0c\u9488\u5bf9 C \u7684 Kudu \u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u8bf7\u6c42\u65b0\u7684 authn tokens \u4ee4\u724c\uff0c\u56e0\u6b64\u652f\u6301\u5b89\u5168\u96c6\u7fa4\u4e2d\u957f\u4e45\u7684 C \u5ba2\u6237\u7aef\uff08\u5373\u8d85\u51fa authn token \u4ee4\u724c\u751f\u5b58\u671f\uff09\u3002 Custom Kerberos Principal \uff08\u81ea\u5b9a\u4e49 kerberos \u4e3b\u4f53\uff09 Kudu \u4e0d\u652f\u6301\u4e3a Kudu \u8fdb\u7a0b\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u670d\u52a1 principal \u3002 principal \u5fc5\u987b\u662f ' kudu '\u3002 External PKI Kudu \u4e0d\u652f\u6301\u5916\u90e8\u9881\u53d1\u7684\u5185\u90e8\u7ebf\u8def\u52a0\u5bc6\u8bc1\u4e66\uff08\u670d\u52a1\u5668\u5230\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\uff09\u3002\u7ec6\u7c92\u5ea6\u6388\u6743 Kudu \u65e0\u6cd5\u6839\u636e\u64cd\u4f5c\u7c7b\u578b\u6216\u76ee\u6807\uff08\u8868\uff0c\u5217\u7b49\uff09\u9650\u5236\u8bbf\u95ee\u3002ACL \u76ee\u524d\u4e0d\u652f\u6301\u57fa\u4e8e\u7ec4\u4e2d\u6210\u5458\u8d44\u683c\u7684\u6388\u6743\u3002 On-disk Encryption \uff08\u78c1\u76d8\u52a0\u5bc6\uff09 Kudu \u6ca1\u6709\u5185\u7f6e\u7684\u78c1\u76d8\u52a0\u5bc6\u3002\u7136\u800c\uff0c Kudu \u53ef\u4ee5\u4f7f\u7528\u5168\u76d8\u52a0\u5bc6\u5de5\u5177\uff0c\u5982 dm-crypt \u3002 Web UI Authentication\uff08\u8ba4\u8bc1\uff09 Kudu Web UI \u7f3a\u5c11\u57fa\u4e8e Kerberos \u7684\u8eab\u4efd\u9a8c\u8bc1\uff08 SPNEGO \uff09\uff0c\u56e0\u6b64\u4e0d\u80fd\u57fa\u4e8e Kerberos \u7684 principals \u8fdb\u884c\u8bbf\u95ee\u9650\u5236\u3002 Flume Integration\uff08Flume \u96c6\u6210\uff09 \u9700\u8981\u9a8c\u8bc1\u6216\u52a0\u5bc6\u7684\u5b89\u5168 Kudu \u96c6\u7fa4\u4e0d\u652f\u6301 Flume \u96c6\u6210\u3002","title":"Kudu Security ( \u5b89\u5168 )"},{"location":"10/#kudu-security","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/security.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813635 \u8d21\u732e\u8005 : \u5c0f\u7476 \uff0c ApacheCN \uff0c Apache\u4e2d\u6587\u7f51 Kudu \u5305\u62ec\u5b89\u5168\u529f\u80fd\uff0c\u5b83\u53ef\u4ee5\u8ba9\u96c6\u7fa4\u66f4\u5b89\u5168\u4ee5\u9632\u6b62\u672a\u6388\u6743\u7684\u7528\u6237\u8bbf\u95ee\u3002\u672c\u6307\u5357\u4ecb\u7ecd\u4e86 Kudu \u63d0\u4f9b\u7684\u5b89\u5168\u529f\u80fd\uff0c\u5217\u51fa\u4e86\u5fc5\u8981\u7684\u914d\u7f6e\u9009\u9879\u3002 Known Limitations \u5305\u542b\u4e86 Kudu \u4e2d\u5b89\u5168\u517c\u5bb9\u6027\u65b9\u9762\u4e0d\u8db3\u7684\u5217\u8868\u3002","title":"Kudu Security ( \u5b89\u5168 )"},{"location":"10/#authentication","text":"Kudu \u53ef\u4ee5\u914d\u7f6e\u4e3a\u5728\u670d\u52a1\u5668\u4e4b\u95f4\u548c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u5b9e\u65bd\u5b89\u5168\u8ba4\u8bc1\u3002\u8eab\u4efd\u9a8c\u8bc1\u53ef\u9632\u6b62\u4e0d\u53d7\u4fe1\u4efb\u7684\u884c\u4e3a\u8005\u8bbf\u95ee Kudu \uff0c\u5e76\u5b89\u5168\u5730\u8bc6\u522b\u8fde\u63a5\u7684\u7528\u6237\u6216\u670d\u52a1\u4ee5\u8fdb\u884c\u6388\u6743\u68c0\u67e5\u3002Kudu \u7684\u8ba4\u8bc1\u65e8\u5728\u901a\u8fc7\u4f7f\u7528 Kerberos \u4e0e\u5176\u4ed6\u5b89\u5168\u7684 Hadoop \u7ec4\u4ef6\u8fdb\u884c\u4e92\u64cd\u4f5c\u3002 \u53ef\u4ee5\u5728 Kudu servers \u4e0a\u4f7f\u7528 **--rpc-authentication** \u6807\u8bb0\u6765\u914d\u7f6e\u8ba4\u8bc1 \uff0c\u5b83\u53ef\u4ee5\u88ab\u8bbe\u7f6e\u4e3a required \uff0c optional \uff0c\u6216 disabled \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6807\u8bb0\u8bbe\u7f6e\u4e3a optional \u3002\u5f53\u8bbe\u7f6e\u4e3a **required** \u65f6\uff0c Kudu \u5c06\u62d2\u7edd\u5ba2\u6237\u7aef\u548c\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u51ed\u8bc1\u7684\u670d\u52a1\u5668\u7684\u8fde\u63a5\u3002\u5f53\u8bbe\u7f6e\u4e3a **optional** \u65f6 \uff0c Kudu \u5c06\u5c1d\u8bd5\u4f7f\u7528\u5f3a\u8eab\u4efd\u9a8c\u8bc1\u3002\u5f53\u914d\u7f6e\u4e3a **disabled** \u6216\u9488\u5bf9 \u201c optional \u201d \u7684\u5f3a\u8ba4\u8bc1\u5931\u8d25\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c Kudu \u5c06\u53ea\u5141\u8bb8\u6765\u81ea\u53d7\u4fe1\u4efb\u5b50\u7f51\u7684\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fde\u63a5\uff0c\u5b83\u4eec\u662f\u975e\u79c1\u6709\u7f51\u7edc\uff08127.0.0.0.08,10.0.0.08,172.16.0.0/12,192.168.0.0/16,169.254.0.0 / 16\uff09\u548c\u672c\u5730\u7f51\u7edc\u63a5\u53e3\u7684\u672c\u5730\u5b50\u7f51\u3002\u6765\u81ea\u53ef\u516c\u5f00\u8def\u7531\u7684 IP \u7684\u672a\u8ba4\u8bc1\u8fde\u63a5\u5c06\u88ab\u62d2\u7edd\u3002 \u53ef\u4fe1\u4efb\u7684\u5b50\u7f51\u53ef\u4ee5\u4f7f\u7528 **--trusted_subnets** \u6807\u8bb0 \u8fdb\u884c\u914d\u7f6e\uff0c\u8be5\u6807\u8bb0\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4ee5\u9017\u53f7\u5206\u9694\u7684 CIDR \u8868\u793a\u6cd5\u7684 IP \u5757\u3002\u5c06\u5176\u8bbe\u7f6e\u4e3a \u201c 0.0.0.0/0 \u201d \u4ee5\u5141\u8bb8\u6765\u81ea\u6240\u6709\u8fdc\u7a0b IP \u5730\u5740\u7684\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fde\u63a5\u3002\u4f46\u662f\uff0c\u5982\u679c\u7f51\u7edc\u8bbf\u95ee\u4e0d\u53d7\u9632\u706b\u5899\u7684\u9650\u5236\uff0c\u6076\u610f\u7528\u6237\u53ef\u80fd\u4f1a\u83b7\u5f97\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\u3002\u5982\u679c\u8ba4\u8bc1\u88ab\u914d\u7f6e\u4e3a required \uff0c\u8fd9\u53ef\u4ee5\u51cf\u5c11\u8fd9\u6837\u7684\u884c\u4e3a\u3002 \u8b66\u544a : \u5f53 --rpc-authentication \u6807\u8bb0\u8bbe\u7f6e\u4e3a optional \u65f6\uff0c\u8be5\u96c6\u7fa4\u4e0d\u4f1a\u963b\u6b62\u6765\u81ea\u672a\u6388\u6743\u7528\u6237\u7684\u8bbf\u95ee\u8bf7\u6c42\u3002\u8981\u4fdd\u62a4\u96c6\u7fa4\uff0c\u8bf7\u4f7f\u7528 --rpc-authentication=required \u3002","title":"Authentication\uff08\u8ba4\u8bc1\uff09"},{"location":"10/#internal-pki","text":"Kudu \u4f7f\u7528\u5185\u90e8 PKI \u7cfb\u7edf\u5411\u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u5668\u53d1\u51fa X.509 \u8bc1\u4e66\u3002\u5177\u6709\u83b7\u5f97\u8bc1\u4e66\u7684\u5bf9\u7b49\u4f53\u4e4b\u95f4\u7684\u8fde\u63a5\u5c06\u4f7f\u7528 TLS \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8fd9\u4e0d\u9700\u8981\u8054\u7cfb Kerberos KDC \u3002\u8fd9\u4e9b\u8bc1\u4e66_ only \uff08\u4ec5\u4ec5\uff09_\u7528\u4e8e Kudu \u670d\u52a1\u5668\u4e4b\u95f4\u4ee5\u53ca Kudu \u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u5185\u90e8\u901a\u4fe1\u3002\u8fd9\u4e9b\u8bc1\u4e66\u6c38\u8fdc\u4e0d\u4f1a\u5728\u9762\u5411\u516c\u4f17\u7684\u534f\u8bae\u4e2d\u5448\u73b0\u3002 \u901a\u8fc7\u4f7f\u7528\u5185\u90e8\u9881\u53d1\u7684\u8bc1\u4e66\uff0c Kudu \u63d0\u4f9b\u5f3a\u5927\u7684\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\uff0c\u53ef\u6269\u5c55\u5230\u5de8\u5927\u7684\u7fa4\u96c6\uff0c\u5e76\u5141\u8bb8\u4f7f\u7528 TLS \u52a0\u5bc6\uff0c\u800c\u65e0\u9700\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u624b\u52a8\u90e8\u7f72\u8bc1\u4e66\u3002","title":"Internal PKI"},{"location":"10/#authentication-tokens","text":"\u5728\u5bf9\u5b89\u5168\u7684\u7fa4\u96c6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u540e\uff0c Kudu \u5ba2\u6237\u7aef\u5c06\u81ea\u52a8\u5411 Kudu \u4e3b\u673a\u8bf7\u6c42\u4e00\u4e2a\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u3002\u8ba4\u8bc1\u4ee4\u724c\u5c01\u88c5\u8ba4\u8bc1\u7528\u6237\u7684\u8eab\u4efd\uff0c\u5e76\u643a\u5e26 master \u7684 RSA \u7b7e\u540d\uff0c\u4ee5\u4fbf\u9a8c\u8bc1\u5176\u771f\u5b9e\u6027\u3002 \u8be5\u4ee4\u724c\u5c06\u7528\u4e8e\u9a8c\u8bc1\u540e\u7eed\u8fde\u63a5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u4ec5\u5728\u4e03\u5929\u5185\u6709\u6548\uff0c\u56e0\u6b64\u5373\u4f7f\u4ee4\u724c\u906d\u5230\u5165\u4fb5\uff0c\u4e5f\u4e0d\u80fd\u65e0\u9650\u671f\u5730\u4f7f\u7528\u4ee4\u724c\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u5e94\u5bf9\u7528\u6237\u5b8c\u5168\u900f\u660e\u3002\u901a\u8fc7\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\uff0c Kudu \u53ef\u4ee5\u5229\u7528\u5f3a\u5927\u7684\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\uff0c\u800c\u65e0\u9700\u652f\u4ed8\u4e0e\u6bcf\u4e2a\u8fde\u63a5\u7684\u4e2d\u592e\u673a\u6784\u8fdb\u884c\u901a\u4fe1\u7684\u53ef\u6269\u5c55\u6027\u6210\u672c\u3002 \u5f53\u4e0e\u5206\u5e03\u5f0f\u8ba1\u7b97\u6846\u67b6\uff08\u5982 Spark \uff09\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u53ef\u4ee5\u7b80\u5316\u914d\u7f6e\u5e76\u63d0\u9ad8\u5b89\u5168\u6027\u3002\u4f8b\u5982\uff0c Kudu Spark connector \uff08\u8fde\u63a5\u5668\uff09\u5c06\u5728\u89c4\u5212\u9636\u6bb5\u81ea\u52a8\u68c0\u7d22\u8ba4\u8bc1\u4ee4\u724c\uff0c\u5e76\u5c06\u4ee4\u724c\u5206\u53d1\u5230\u4efb\u52a1\u3002\u8fd9\u6837\uff0c Spark \u53ef\u4ee5\u5bf9\u53d7\u4fdd\u62a4\u7684 Kudu \u96c6\u7fa4\u5de5\u4f5c\uff0c\u53ea\u6709 planner node \u5177\u6709 Kerberos \u51ed\u636e\u3002","title":"Authentication Tokens\uff08\u8ba4\u8bc1\u4ee4\u724c\uff09"},{"location":"10/#scalability","text":"Kudu \u8ba4\u8bc1\u65e8\u5728\u6269\u5c55\u5230\u6570\u5343\u4e2a\u8282\u70b9\uff0c\u8fd9\u9700\u8981\u907f\u514d\u4e0e\u4e2d\u592e\u8ba4\u8bc1\u673a\u6784\uff08\u5982 Kerberos KDC \uff09\u7684\u4e0d\u5fc5\u8981\u7684\u534f\u8c03\u3002\u76f8\u53cd\uff0c Kudu \u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5c06\u4f7f\u7528 Kerberos \u4e0e Kudu \u4e3b\u673a\u5efa\u7acb\u521d\u59cb\u4fe1\u4efb\uff0c\u7136\u540e\u4f7f\u7528\u5907\u7528\u51ed\u636e\u8fdb\u884c\u540e\u7eed\u8fde\u63a5\u3002\u7279\u522b\u662f\uff0c master \u5c06\u5411\u670d\u52a1\u5668\u53d1\u51fa\u5185\u90e8 X.509 \u8bc1\u4e66\uff0c\u5411\u5ba2\u6237\u7aef\u53d1\u51fa\u4e34\u65f6\u8ba4\u8bc1\u4ee4\u724c\u3002","title":"Scalability\uff08\u53ef\u6269\u5c55\u6027\uff09"},{"location":"10/#encryption","text":"","title":"Encryption\uff08\u52a0\u5bc6\uff09"},{"location":"10/#kudu-tls","text":"\u53ef\u4ee5\u5728 Kudu servers \u4e0a\u4f7f\u7528 **--rpc-encryption** \u6807\u8bb0\u6765\u914d\u7f6e\u52a0\u5bc6 \uff0c\u5b83\u53ef\u4ee5\u88ab\u8bbe\u7f6e\u4e3a required \uff0c optional \u6216 disabled \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6807\u5fd7\u8bbe\u7f6e\u4e3a optional \u3002\u5f53\u914d\u7f6e\u4e3a **required** \u65f6\uff0c Kudu \u5c06\u62d2\u7edd\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\u3002\u5f53\u914d\u7f6e\u4e3a **optional** \u65f6 \uff0c Kudu \u5c06\u5c1d\u8bd5\u4f7f\u7528\u52a0\u5bc6\u3002\u4e0e\u8ba4\u8bc1\u76f8\u540c\uff0c\u5f53\u914d\u7f6e\u4e3a disabled \u6216\u9488\u5bf9 **optional** \u7684\u60c5\u51b5\u4e0b\u52a0\u5bc6\u5931\u8d25 \uff0c Kudu \u5c06\u53ea\u5141\u8bb8\u6765\u81ea\u53d7\u4fe1\u4efb\u7684\u5b50\u7f51\u7684\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\uff0c\u5e76\u62d2\u7edd\u516c\u5f00\u53ef\u8def\u7531\u7684 IP \u7684\u4efb\u4f55\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\u3002\u8981\u4fdd\u62a4\u7fa4\u96c6\uff0c\u8bf7\u4f7f\u7528 --rpc-encryption=required \u3002 \u8b66\u544a : Kudu \u5c06\u81ea\u52a8\u5173\u95ed\u672c\u5730\u73af\u56de\u8fde\u63a5\u4e0a\u7684\u52a0\u5bc6\uff0c\u56e0\u4e3a\u6765\u81ea\u8fd9\u4e9b\u8fde\u63a5\u7684\u6d41\u91cf\u4e0d\u4f1a\u4ece\u5916\u90e8\u66b4\u9732\u51fa\u6765\u3002\u8fd9\u5141\u8bb8\u50cf Spark \u548c Impala \u8fd9\u6837\u7684\u4f4d\u7f6e\u611f\u77e5\u8ba1\u7b97\u6846\u67b6\u907f\u514d\u52a0\u5bc6\u5f00\u9500\uff0c\u540c\u65f6\u786e\u4fdd\u6570\u636e\u7684\u673a\u5bc6\u6027\u3002","title":"Kudu \u5141\u8bb8\u4f7f\u7528 TLS\u00a0\u5bf9\u670d\u52a1\u5668\u4e4b\u95f4\u4ee5\u53ca\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\u8fdb\u884c\u52a0\u5bc6\u3002"},{"location":"10/#coarse-grained-authorization","text":"Kudu \u652f\u6301\u57fa\u4e8e\u8ba4\u8bc1\u7684\u5ba2\u6237\u7aef Kerberos \u4e3b\u4f53\uff08\u5373\u7528\u6237\u6216\u670d\u52a1\uff09\u5bf9\u5ba2\u6237\u7aef\u8bf7\u6c42\u8fdb\u884c\u7c97\u7c92\u5ea6\u6388\u6743\u3002\u53ef\u4ee5\u914d\u7f6e\u7684\u4e24\u4e2a\u7ea7\u522b\u7684\u8bbf\u95ee\u662f : Superuser \uff08\u8d85\u7ea7\u7528\u6237\uff09- \u88ab\u6388\u6743\u4e3a\u8d85\u7ea7\u7528\u6237\u7684 principals \u80fd\u591f\u6267\u884c\u67d0\u4e9b\u7ba1\u7406\u529f\u80fd\uff0c\u4f8b\u5982\u4f7f\u7528 kudu \u547d\u4ee4\u884c\u5de5\u5177\u8bca\u65ad\u6216\u4fee\u590d\u7fa4\u96c6\u95ee\u9898\u3002 User \uff08\u7528\u6237\uff09- \u6388\u6743\u4e3a\u7528\u6237 principals \u90fd\u80fd\u591f\u5728 Kudu \u96c6\u7fa4\u4e2d\u8bbf\u95ee\u548c\u4fee\u6539\u6240\u6709\u6570\u636e\u3002\u8fd9\u5305\u62ec create \uff08\u521b\u5efa\uff09\uff0c drop \uff08\u5220\u9664\uff09\u548c alter \uff08\u66f4\u6539\uff09\u8868\u4ee5\u53ca read \uff08\u8bfb\u53d6\uff09\uff0c insert \uff08\u63d2\u5165\uff09\uff0c update \uff08\u66f4\u65b0\uff09\u548c delete \uff08\u5220\u9664\uff09\u6570\u636e\u7684\u529f\u80fd\u3002 \u8b66\u544a : \u5728\u5185\u90e8\uff0c Kudu \u9488\u5bf9\u5b88\u62a4\u8fdb\u7a0b\u672c\u8eab\u5177\u6709\u7b2c\u4e09\u7684\u8bbf\u95ee\u7ea7\u522b\u3002\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u7528\u6237\u65e0\u6cd5\u8fde\u63a5\u5230\u96c6\u7fa4\uff0c\u5e76\u53ef\u4ee5\u4f5c\u4e3a tablet server \u3002 \u4f7f\u7528\u767d\u540d\u5355\u6837\u5f0f\u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08 ACL \uff09\u6388\u4e88\u8bbf\u95ee\u7ea7\u522b\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u7ea7\u522b\u4e2d\u7684\u6bcf\u4e00\u7ea7\u90fd\u53ef\u4ee5\u8bbf\u95ee\u3002\u6bcf\u4e2a\u8bbf\u95ee\u63a7\u5236\u5217\u8868\u6307\u5b9a\u4ee5\u9017\u53f7\u5206\u9694\u7684\u7528\u6237\u5217\u8868\uff0c\u6216\u8005\u53ef\u4ee5\u8bbe\u7f6e ***** \u4e3a\u8868\u793a\u6240\u6709\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u80fd\u591f\u4ee5\u6307\u5b9a\u7ea7\u522b\u83b7\u5f97\u8bbf\u95ee\u6743\u9650\u3002\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u4e0b\u9762\u7684 \u914d\u7f6e\u5b89\u5168\u7684 Kudu \u7fa4\u96c6 \u3002 \u8b66\u544a : \u7528\u6237 ACL \u7684\u9ed8\u8ba4\u503c\u662f * \u5141\u8bb8\u6240\u6709\u7528\u6237\u8bbf\u95ee\u96c6\u7fa4\u3002\u4f46\u662f\uff0c\u5982\u679c\u542f\u7528\u4e86\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8fd9\u4ecd\u7136\u9650\u5236\u5bf9\u53ea\u80fd\u901a\u8fc7 Kerberos \u6210\u529f\u9a8c\u8bc1\u7684\u7528\u6237\u7684\u8bbf\u95ee\u3002\u4e0e Kudu server \u5728\u540c\u4e00\u7f51\u7edc\u4e0a\u7684\u672a\u8ba4\u8bc1\u7528\u6237\u5c06\u65e0\u6cd5\u8bbf\u95ee\u96c6\u7fa4\u3002","title":"Coarse-Grained Authorization\uff08\u7c97\u7c92\u5ea6\u6388\u6743\uff09"},{"location":"10/#web-ui-encryption","text":"\u53ef\u4ee5\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5668\u63d0\u4f9b TLS \u8bc1\u4e66\uff0c\u5c06 Kudu Web UI \u914d\u7f6e\u4e3a\u4f7f\u7528\u5b89\u5168\u7684 HTTPS \u52a0\u5bc6\u3002\u6709\u5173 Web UI HTTPS \u914d\u7f6e\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u914d\u7f6e\u5b89\u5168\u7684 Kudu \u96c6\u7fa4 \u3002","title":"Web UI Encryption\uff08\u52a0\u5bc6\uff09"},{"location":"10/#web-ui-redaction","text":"\u4e3a\u4e86\u9632\u6b62\u5728 Web UI \u4e2d\u66b4\u9732\u654f\u611f\u6570\u636e\uff0c\u6240\u6709\u884c\u6570\u636e\u90fd\u88ab\u4fee\u6539\u3002\u8868\u5143\u6570\u636e\uff0c\u5982\u8868\u540d\uff0c\u5217\u540d\u548c\u5206\u533a\u4fe1\u606f\u4e0d\u4f1a\u88ab\u4fee\u6539\u3002\u53ef\u4ee5\u901a\u8fc7\u5728 Kudu server \u4e0a\u8bbe\u7f6e --webserver-enabled=false \u6807\u8bb0 \u6765\u5b8c\u5168\u7981\u7528 Web UI \u3002 \u8b66\u544a : \u7981\u7528 Web UI \u4e5f\u5c06\u7981\u7528 REST endpoints \uff0c\u4f8b\u5982 /metrics \u3002\u76d1\u63a7\u7cfb\u7edf\u4f9d\u9760\u8fd9\u4e9b endpoints \u6765\u6536\u96c6 metrics \u6307\u6807\u6570\u636e\u3002","title":"Web UI Redaction"},{"location":"10/#log-security","text":"\u4e3a\u4e86\u9632\u6b62\u654f\u611f\u6570\u636e\u5305\u542b\u5728 Kudu \u670d\u52a1\u5668\u65e5\u5fd7\u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u4fee\u6539\u6240\u6709\u884c\u6570\u636e\u3002\u8be5\u529f\u80fd\u53ef\u4ee5\u914d\u7f6e **--redact** \u6807\u8bb0\u6765\u5173\u95ed \u3002","title":"Log Security\uff08\u65e5\u5fd7\u5b89\u5168\uff09"},{"location":"10/#configuring-a-secure-kudu-cluster-kudu","text":"\u5e94\u5728\u6240\u6709\u670d\u52a1\u5668\uff08 master \u548c tablet server \uff09\u4e0a\u8bbe\u7f6e\u4ee5\u4e0b\u914d\u7f6e\u53c2\u6570\uff0c\u4ee5\u786e\u4fdd Kudu \u96c6\u7fa4\u5b89\u5168 : # Connection Security #-------------------- --rpc-authentication=required --rpc-encryption=required --keytab-file=<path-to-kerberos-keytab> # Web UI Security #-------------------- --webserver-certificate-file=<path-to-cert-pem> --webserver-private-key-file=<path-to-key-pem> # optional --webserver-private-key-password-cmd=<password-cmd> # If you prefer to disable the web UI entirely: --webserver-enabled=false # Coarse-grained authorization #-------------------------------- # This example ACL setup allows the 'impala' user as well as the # 'nightly_etl_service_account' principal access to all data in the # Kudu cluster. The 'hadoopadmin' user is allowed to use administrative # tooling. Note that, by granting access to 'impala', other users # may access data in Kudu via the Impala service subject to its own # authorization rules. --user-acl=impala,nightly_etl_service_account --superuser-acl=hadoopadmin \u6709\u5173\u8fd9\u4e9b\u6807\u8bb0\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u914d\u7f6e\u6807\u8bb0\u6307\u5357\u3002","title":"Configuring a Secure Kudu Cluster\uff08\u914d\u7f6e\u5b89\u5168\u7684 Kudu \u96c6\u7fa4\uff09"},{"location":"10/#known-limitations","text":"Kudu \u6709\u4e00\u4e9b\u5df2\u77e5\u7684\u5b89\u5168\u9650\u5236 : Long-lived Tokens \uff08\u5e38\u7528\u7684\u4ee4\u724c\uff09 Java Kudu \u5ba2\u6237\u7aef\u5728\u521d\u59cb tokens \uff08\u4ee4\u724c\uff09\u5230\u671f\u540e\u4e0d\u4f1a\u81ea\u52a8\u8bf7\u6c42\u65b0\u7684 authn tokens \uff08\u4ee4\u724c\uff09\uff0c\u56e0\u6b64\u4e0d\u652f\u6301\u957f\u671f\u5b58\u5728\u7684\u5b89\u5168\u96c6\u7fa4\u4e2d\u7684 Java \u5ba2\u6237\u7aef\u3002\u7136\u800c\uff0c\u9488\u5bf9 C \u7684 Kudu \u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u8bf7\u6c42\u65b0\u7684 authn tokens \u4ee4\u724c\uff0c\u56e0\u6b64\u652f\u6301\u5b89\u5168\u96c6\u7fa4\u4e2d\u957f\u4e45\u7684 C \u5ba2\u6237\u7aef\uff08\u5373\u8d85\u51fa authn token \u4ee4\u724c\u751f\u5b58\u671f\uff09\u3002 Custom Kerberos Principal \uff08\u81ea\u5b9a\u4e49 kerberos \u4e3b\u4f53\uff09 Kudu \u4e0d\u652f\u6301\u4e3a Kudu \u8fdb\u7a0b\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u670d\u52a1 principal \u3002 principal \u5fc5\u987b\u662f ' kudu '\u3002 External PKI Kudu \u4e0d\u652f\u6301\u5916\u90e8\u9881\u53d1\u7684\u5185\u90e8\u7ebf\u8def\u52a0\u5bc6\u8bc1\u4e66\uff08\u670d\u52a1\u5668\u5230\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\uff09\u3002\u7ec6\u7c92\u5ea6\u6388\u6743 Kudu \u65e0\u6cd5\u6839\u636e\u64cd\u4f5c\u7c7b\u578b\u6216\u76ee\u6807\uff08\u8868\uff0c\u5217\u7b49\uff09\u9650\u5236\u8bbf\u95ee\u3002ACL \u76ee\u524d\u4e0d\u652f\u6301\u57fa\u4e8e\u7ec4\u4e2d\u6210\u5458\u8d44\u683c\u7684\u6388\u6743\u3002 On-disk Encryption \uff08\u78c1\u76d8\u52a0\u5bc6\uff09 Kudu \u6ca1\u6709\u5185\u7f6e\u7684\u78c1\u76d8\u52a0\u5bc6\u3002\u7136\u800c\uff0c Kudu \u53ef\u4ee5\u4f7f\u7528\u5168\u76d8\u52a0\u5bc6\u5de5\u5177\uff0c\u5982 dm-crypt \u3002 Web UI Authentication\uff08\u8ba4\u8bc1\uff09 Kudu Web UI \u7f3a\u5c11\u57fa\u4e8e Kerberos \u7684\u8eab\u4efd\u9a8c\u8bc1\uff08 SPNEGO \uff09\uff0c\u56e0\u6b64\u4e0d\u80fd\u57fa\u4e8e Kerberos \u7684 principals \u8fdb\u884c\u8bbf\u95ee\u9650\u5236\u3002 Flume Integration\uff08Flume \u96c6\u6210\uff09 \u9700\u8981\u9a8c\u8bc1\u6216\u52a0\u5bc6\u7684\u5b89\u5168 Kudu \u96c6\u7fa4\u4e0d\u652f\u6301 Flume \u96c6\u6210\u3002","title":"Known Limitations\uff08\u5df2\u77e5\u9650\u5236\uff09"},{"location":"11/","text":"Kudu Transaction Semantics ( \u4e8b\u52a1\u8bed\u4e49 ) \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/transaction_semantics.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813638 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Apache Kudu \u7684 Transaction Semantics ( \u4e8b\u52a1\u8bed\u4e49 ) \u8fd9\u662f Kudu \u7684 \u4ea4\u6613\u548c\u4e00\u81f4\u6027\u8bed\u4e49\u7684\u7b80\u8981\u4ecb\u7ecd\u3002\u5bf9\u4e8e\u8fd9\u91cc\u63d0\u5230\u7684\u5927\u90e8\u5206\u5185\u5bb9\u7684\u6df1\u5165\u6280\u672f\u8bba\u8ff0\uff0c\u4e3a\u4ec0\u4e48\u662f\u6b63\u786e\u7684\uff0c\u8bf7\u53c2\u9605\u6280\u672f\u62a5\u544a [1] \u3002 Kudu \u7684 transactional semantics ( \u4e8b\u52a1\u8bed\u4e49 )\u548c\u4f53\u7cfb\u7ed3\u6784\u53d7\u5230 Spanner [2] \u548c Calvin [3] \u7b49\u6700\u5148\u8fdb\u7684\u7cfb\u7edf\u7684\u542f\u53d1\u3002 Kudu \u5efa\u7acb\u5728\u6570\u5341\u5e74\u7684\u6570\u636e\u5e93\u7814\u7a76\u57fa\u7840\u4e4b\u4e0a\u3002\u6838\u5fc3\u7406\u5ff5\u662f\u901a\u8fc7\u63d0\u4f9b\u7b80\u5355\uff0c\u5f3a\u5927\u7684\u8bed\u4e49\u7684\u4e8b\u52a1\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u7684\u751f\u6d3b\u66f4\u8f7b\u677e\uff0c\u800c\u4e0d\u4f1a\u727a\u7272\u6027\u80fd\u6216\u8c03\u6574\u5230\u4e0d\u540c\u9700\u6c42\u7684\u80fd\u529b\u3002 Kudu \u65e8\u5728\u6700\u7ec8\u5b8c\u5168\u83b7\u5f97 ACID \uff0c\u4f46\u662f\u591a tablet \u4e8b\u52a1\u5c1a\u672a\u5b9e\u65bd\u3002\u56e0\u6b64\uff0c\u672c\u6b21\u8ba8\u8bba\u7684\u91cd\u70b9\u662f\u5355\u7247\u5199\u5165\u64cd\u4f5c\uff0c\u53ea\u662f\u7b80\u5355\u5730\u89e6\u6478\u591a tablets \u8bfb\u53d6\u3002\u6700\u7ec8 Kudu \u5c06\u652f\u6301\u5b8c\u5168\u4e25\u683c\u7684\u53ef\u5e8f\u5217\u5316\u8bed\u4e49\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5b83\u5df2\u7ecf\u5728\u6709\u9650\u7684\u8303\u56f4\u5185\uff0c\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u89d2\u843d\u90fd\u88ab\u8986\u76d6\uff0c\u56e0\u4e3a\u8fd9\u4ecd\u7136\u662f\u4e00\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\u3002 Kudu \u76ee\u524d\u5141\u8bb8\u4ee5\u4e0b\u64cd\u4f5c\uff1a Write operations ( \u5199\u5165\u64cd\u4f5c ) \u662f\u5728\u5177\u6709\u591a\u4e2a\u526f\u672c\u7684\u5355\u4e2a tablet \u4e2d\u5728\u5b58\u50a8\u5f15\u64ce\u4e2d\u63d2\u5165\uff0c\u66f4\u65b0\u6216\u5220\u9664\u7684 sets of rows ( \u884c\u96c6 ) \u3002\u5199\u64cd\u4f5c\u6ca1\u6709\u5355\u72ec\u7684 \u201cread sets\u201d \uff0c\u5373\u5b83\u4eec\u5728\u6267\u884c\u5199\u5165\u4e4b\u524d\u4e0d\u626b\u63cf\u73b0\u6709\u6570\u636e\u3002\u6bcf\u4e2a\u5199\u5165\u4ec5\u6d89\u53ca\u5373\u5c06\u66f4\u6539\u7684\u884c\u7684\u5148\u524d\u72b6\u6001\u3002\u7528\u6237\u660e\u786e\u4e0d\u5199 \u201ccommitted\u201d \u3002\u76f8\u53cd\uff0c\u5b83\u4eec\u5c06\u5728\u7cfb\u7edf\u5b8c\u6210\u540e\u81ea\u52a8\u63d0\u4ea4\u3002 Scans ( \u626b\u63cf ) \u662f\u53ef\u4ee5\u904d\u5386\u591a\u4e2a tablets \u5e76\u8bfb\u53d6\u4fe1\u606f\u7684\u8bfb\u53d6\u64cd\u4f5c\uff0c\u5177\u6709\u4e00\u81f4\u6027\u6216\u6b63\u786e\u6027\u4fdd\u8bc1\u3002\u626b\u63cf\u53ef\u4ee5\u6267\u884c\u65f6\u95f4\u884c\u8fdb\u8bfb\u53d6\uff0c\u5373\u7528\u6237\u80fd\u591f\u8bbe\u7f6e\u8fc7\u53bb\u7684\u626b\u63cf\u65f6\u95f4\u6233\uff0c\u5e76\u8fd4\u56de\u5728\u8be5\u65f6\u95f4\u70b9\u53cd\u6620\u5b58\u50a8\u5f15\u64ce\u7684\u72b6\u6001\u7684\u7ed3\u679c\u3002 \u91cd\u8981 \u5f00\u59cb\u4e4b\u524d \u591a\u6b21\u63d0\u5230\u672f\u8bed\u65f6\u95f4\u6233\u6765\u8bf4\u660e\u529f\u80fd\uff0c\u4f46\u662f\u65f6\u95f4\u6233\u662f\u7528\u6237\u6700\u4e0d\u53ef\u89c1\u7684\u5185\u90e8\u6982\u5ff5\uff0c\u9664\u4e86\u5728 KuduScanner \u4e0a\u8bbe\u7f6e\u65f6\u95f4\u6233\u3002 \u6211\u4eec\u901a\u5e38\u6307\u7684\u662f C ++ client \u7684\u65b9\u6cd5\u548c\u7c7b\u3002\u867d\u7136 Java \u5ba2\u6237\u7aef\u5927\u591a\u5177\u6709\u7c7b\u4f3c\u7684\u65b9\u6cd5\u548c\u7c7b\uff0c\u4f46\u662f API \u7684\u786e\u5207\u540d\u79f0\u53ef\u80fd\u4e0d\u540c\u3002 Single tablet write operations ( \u5355 tablet \u5199\u5165\u64cd\u4f5c ) Kudu \u91c7\u7528 Multiverion \u5e76\u53d1\u63a7\u5236 \uff08 MVCC \uff09 \u548c Raft \u4e00\u81f4\u6027\u7b97\u6cd5 [4] \u3002 Kudu \u7684\u6bcf\u4e2a\u5199\u5165\u64cd\u4f5c\u5fc5\u987b\u7ecf\u8fc7 tablet \u7684\u9886\u5bfc\u3002 leader \u5c06\u4e3a\u5176\u5c06\u66f4\u6539\u7684\u884c\u83b7\u53d6\u6240\u6709\u9501\u3002 leader \u5728\u63d0\u4ea4\u5199\u5165\u590d\u5236\u4e4b\u524d\u5206\u914d\u5199\u5165\u65f6\u95f4\u6233\u3002\u8fd9\u4e2a\u65f6\u95f4\u6233\u662f MVCC \u4e2d\u7684 write \u7684 \u201ctag\u201d \u3002 \u5728\u5927\u591a\u6570\u526f\u672c\u786e\u8ba4\u66f4\u6539\u540e\uff0c\u5b9e\u9645\u7684\u884c\u5c06\u88ab\u66f4\u6539\u3002 \u66f4\u6539\u5b8c\u6210\u540e\uff0c\u5b83\u4eec\u53ef\u4ee5\u4ee5\u539f\u5b50\u65b9\u5f0f\u540c\u65f6\u8fdb\u884c\u5199\u5165\u548c\u8bfb\u53d6\u3002 tablets \u7684\u6240\u6709\u526f\u672c\u90fd\u9075\u5faa\u76f8\u540c\u7684\u64cd\u4f5c\u987a\u5e8f\uff0c\u5982\u679c\u4e3a\u5199\u5165\u64cd\u4f5c\u5206\u914d\u65f6\u95f4\u6233 n \u5e76\u66f4\u6539 \u884c x \uff0c\u5219\u4fdd\u8bc1\u65f6\u95f4\u6233 m > n \u7684\u7b2c\u4e8c\u6b21\u5199\u5165\u64cd\u4f5c\u53ef\u4ee5\u770b\u5230 x \u7684\u65b0\u503c\u3002 \u9501\u5b9a\u91c7\u96c6\u548c\u65f6\u95f4\u6233\u5206\u914d\u7684\u8fd9\u79cd\u4e25\u683c\u6392\u5e8f\u901a\u8fc7\u534f\u5546\u4e00\u81f4\u7684\u65b9\u5f0f\u5f3a\u5236\u6267\u884c tablets \u7684\u6240\u6709\u526f\u672c\u3002\u56e0\u6b64\uff0c\u76f8\u5bf9\u4e8e\u540c\u4e00\u4e2a\u5e73\u677f\u7535\u8111\u4e2d\u7684\u5176\u4ed6\u5199\u5165\uff0c\u5173\u4e8e\u65f6\u949f\u5206\u914d\u7684\u65f6\u95f4\u6233\uff0c\u5199\u5165\u64cd\u4f5c\u662f\u5b8c\u5168\u6392\u5e8f\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5199\u5165\u5177\u6709\u4e25\u683c\u7684\u53ef\u5e8f\u5217\u5316\u8bed\u4e49\uff0c\u5c3d\u7ba1\u5728\u4e00\u4e2a\u516c\u8ba4\u7684\u6709\u9650\u7684\u4e0a\u4e0b\u6587\u4e2d\u3002\u6709\u5173\u8fd9\u4e9b\u8bed\u4e49\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u8bf7\u53c2\u9605\u8fd9\u7bc7 \u535a\u5ba2\u6587\u7ae0 \u3002 \u867d\u7136\u5728 ACID \u610f\u4e49\u4e0a\u7684\u9694\u79bb\u548c\u8010\u7528\u6027\uff0c\u591a\u884c\u5199\u5165\u64cd\u4f5c\u5c1a\u672a\u5b8c\u5168\u539f\u5b50\u5316\u3002\u6279\u91cf\u64cd\u4f5c\u4e2d\u5355\u6b21\u5199\u5165\u7684\u6545\u969c\u4e0d\u4f1a\u56de\u6eda\u64cd\u4f5c\uff0c\u800c\u662f\u4ea7\u751f\u6bcf\u884c\u9519\u8bef\u3002 Writing to multiple tablets ( \u5199\u5165\u591a\u4e2a tablets ) Kudu \u8fd8\u4e0d\u652f\u6301\u8de8\u591a\u4e2a tablets \u7684\u4e8b\u52a1\u3002\u4f46\u662f\uff0c\u4e00\u81f4\u7684\u5feb\u7167\u8bfb\u53d6\u662f\u53ef\u80fd\u7684\uff08\u5982\u5f53\u524d\u5b9e\u73b0\u4e2d\u7684\u8b66\u544a\uff09\uff0c\u5982\u4e0b\u6240\u8ff0\u3002 Kudu \u5ba2\u6237\u7aef\u7684\u5199\u5165\u53ef\u9009\u5730\u7f13\u51b2\u5728\u5185\u5b58\u4e2d\uff0c\u76f4\u5230\u5b83\u4eec\u88ab\u5237\u65b0\u5e76\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002\u5f53\u5ba2\u6237\u7aef\u7684\u4f1a\u8bdd\u5237\u65b0\u65f6\uff0c\u6bcf\u4e2a tablet \u7684\u884c\u88ab\u6279\u5904\u7406\u5728\u4e00\u8d77\uff0c\u5e76\u53d1\u9001\u5230\u6258\u7ba1 tablet \u7684 leader replica \u7684 tablet servers \u3002\u7531\u4e8e\u6ca1\u6709 inter-tablet \u4e8b\u52a1\uff0c\u8fd9\u4e9b\u6279\u6b21\u4e2d\u7684\u6bcf\u4e00\u4e2a\u4ee3\u8868\u5177\u6709\u81ea\u5df1\u7684\u65f6\u95f4\u6233\u7684\u5355\u72ec\u7684\u72ec\u7acb\u5199\u5165\u64cd\u4f5c\u3002\u7136\u800c\uff0c\u5ba2\u6237\u7aef API \u63d0\u4f9b\u4e86\u5bf9\u5206\u914d\u7684\u65f6\u95f4\u6233\u65bd\u52a0\u4e00\u4e9b\u7ea6\u675f\u7684\u9009\u9879\uff0c\u4ee5\u53ca\u5ba2\u6237\u7aef\u5982\u4f55\u89c2\u5bdf\u5bf9\u4e0d\u540c tablet \u7684\u5199\u5165\u3002 Kudu \u50cf Spanner \u4e00\u6837\u88ab\u8bbe\u8ba1\u4e3a\u5916\u90e8\u4e00\u81f4 [5] \uff0c\u5373\u4f7f\u5728\u8de8\u591a\u4e2a\u5e73\u677f\u7535\u8111\u751a\u81f3\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u60c5\u51b5\u4e0b\u4e5f\u80fd\u4fdd\u6301\u4e00\u81f4\u6027\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u5199\u5165\u64cd\u4f5c\u5728\u5e73\u677f\u7535\u8111 A \u4e0a\u66f4\u6539\u9879\u76ee x \uff0c\u5e76\u4e14\u4ee5\u4e0b\u5199\u5165\u64cd\u4f5c\u5728\u5e73\u677f\u7535\u8111 B \u4e0a\u66f4\u6539\u9879\u76ee y \uff0c\u5219\u53ef\u80fd\u9700\u8981\u5f3a\u5236\u6267\u884c\uff0c\u5982\u679c\u89c2\u5bdf\u5230 y \u7684\u66f4\u6539\uff0c\u5219 x \u7684\u66f4\u6539\u4e5f\u5fc5\u987b\u4e3a\u89c2\u5bdf\u5230\u7684\u3002\u6709\u5f88\u591a\u4f8b\u5b50\u53ef\u4ee5\u8bf4\u662f\u91cd\u8981\u7684\u3002\u4f8b\u5982\uff0c\u5982\u679c Kudu \u6b63\u5728\u5b58\u50a8\u7528\u4e8e\u8fdb\u4e00\u6b65\u5206\u6790\u7684\u70b9\u51fb\u6d41\uff0c\u5e76\u4e14\u4e24\u6b21\u70b9\u51fb\u76f8\u4e92\u5173\u8054\uff0c\u4f46\u5b58\u50a8\u5728\u4e0d\u540c\u7684 tablet \u4e2d\uff0c\u5219\u540e\u7eed\u70b9\u51fb\u5e94\u8be5\u88ab\u5206\u914d\u540e\u7eed\u65f6\u95f4\u6233\uff0c\u4ee5\u4fbf\u6355\u83b7\u5b83\u4eec\u4e4b\u95f4\u7684\u56e0\u679c\u5173\u7cfb\u3002 CLIENT_PROPAGATED Consistency Kudu \u7684\u9ed8\u8ba4\u5916\u90e8\u4e00\u81f4\u6027\u6a21\u5f0f\u79f0\u4e3a CLIENT_PROPAGATED \u3002\u6709\u5173\u5982\u4f55\u5de5\u4f5c\u7684\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605 [1] \u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u6b64\u6a21\u5f0f\u4f1a\u5bfc\u81f4\u5355\u4e2a\u5ba2\u6237\u7aef\u7684\u5199\u5165\u81ea\u52a8\u5728\u5916\u90e8\u4fdd\u6301\u4e00\u81f4\u3002\u5728\u4e0a\u8ff0 Clickstream \u573a\u666f\u4e2d\uff0c\u5982\u679c\u4e24\u4e2a\u70b9\u51fb\u662f\u7531\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u5b9e\u4f8b\u63d0\u4ea4\u7684\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u624b\u52a8\u5c06\u65f6\u95f4\u6233\u4ece\u4e00\u4e2a\u5ba2\u6237\u7aef\u4f20\u64ad\u5230\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u4ee5\u4fbf\u6355\u83b7\u56e0\u679c\u5173\u7cfb\u3002 \u5ba2\u6237\u7aef a \u548c b \u4e4b\u95f4\u7684\u65f6\u95f4\u6233\u53ef\u4ee5\u4f20\u64ad\u5982\u4e0b\uff1a Java Client \u8c03\u7528 AsyncKuduClient#getLastPropagatedTimestamp() \u5728\u5ba2\u6237\u7aef a \uff0c\u5c06\u65f6\u95f4\u6233\u4f20\u64ad\u5230\u5ba2\u6237\u7aef b \uff0c\u5e76\u5728\u5ba2\u6237\u7aef b \u4e0a\u8c03\u7528 AsyncKuduClient#setLastPropagatedTimestamp() \u3002 C++ Client \u5728\u5ba2\u6237\u7aef a \u4e0a\u8c03\u7528 KuduClient::GetLatestObservedTimestamp() \uff0c\u5c06\u65f6\u95f4\u6233\u4f20\u64ad\u5230\u5ba2\u6237\u7aef b \uff0c\u5e76\u5728\u5ba2\u6237\u7aef b \u4e0a\u8c03\u7528 KuduClient::SetLatestObservedTimestamp() \u3002 COMMIT_WAIT Consistency Kudu \u8fd8\u6709\u4e00\u4e2a\u5728 Google \u7684 Spanner \u4e2d\u4f7f\u7528\u7684\u5916\u90e8\u4e00\u81f4\u6027\u6a21\u578b\u7684\u5b9e\u9a8c\u5b9e\u73b0\uff0c\u79f0\u4e3a COMMIT_WAIT \u3002 COMMIT_WAIT \u901a\u8fc7\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u8ba1\u7b97\u673a\u4e0a\u7d27\u5bc6\u540c\u6b65\u65f6\u949f\u6765\u8d77\u4f5c\u7528\u3002\u7136\u540e\uff0c\u5f53\u53d1\u751f\u5199\u5165\u65f6\uff0c\u5206\u914d\u65f6\u95f4\u6233\uff0c\u5e76\u4e14\u5728\u901a\u8fc7\u8db3\u591f\u7684\u65f6\u95f4\u4e4b\u524d\u5199\u5165\u7684\u7ed3\u679c\u4e0d\u53ef\u89c1\uff0c\u4f7f\u5f97\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u8ba1\u7b97\u673a\u4e0d\u53ef\u80fd\u4e3a\u4e0b\u4e00\u6b21\u5199\u5165\u5206\u914d\u8f83\u4f4e\u7684\u65f6\u95f4\u6233\u3002 \u5f53\u4f7f\u7528\u6b64\u6a21\u5f0f\u65f6\uff0c\u5199\u5165\u7684\u5ef6\u8fdf\u4e0e\u6240\u6709\u96c6\u7fa4\u4e3b\u673a\u4e0a\u7684\u65f6\u949f\u7cbe\u5ea6\u7d27\u5bc6\u76f8\u5173\uff0c\u5e76\u4e14\u4f7f\u7528\u677e\u6563\u65f6\u949f\u540c\u6b65\u7684\u6b64\u6a21\u5f0f\u4f1a\u5bfc\u81f4\u5199\u5165\u9700\u8981\u5f88\u957f\u65f6\u95f4\u624d\u80fd\u5b8c\u6210\u751a\u81f3\u8d85\u65f6\u3002\u8bf7\u53c2\u9605 \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 \u3002 COMMIT_WAIT \u4e00\u81f4\u6027\u6a21\u5f0f\u53ef\u4ee5\u5982\u4e0b\u9009\u62e9\uff1a Java Client \u8c03\u7528 KuduSession#setExternalConsistencyMode(ExternalConsistencyMode.COMMIT_WAIT) C++ Client \u8c03\u7528 KuduSession :: SetExternalConsistencyMode(COMMIT_WAIT) \u6ce8\u610f COMMIT_WAIT \u4e00\u81f4\u6027\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u5b9e\u9a8c\u529f\u80fd\u3002\u5b83\u53ef\u80fd\u4f1a\u8fd4\u56de\u4e0d\u6b63\u786e\u7684\u7ed3\u679c\uff0c\u5c55\u793a\u6027\u80fd\u95ee\u9898\u6216\u5bf9\u96c6\u7fa4\u7a33\u5b9a\u6027\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\u3002\u4e0d\u9f13\u52b1\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u3002 Read Operations (Scans) ( \u9605\u8bfb\u64cd\u4f5c(\u626b\u63cf) ) \u626b\u63cf\u662f\u7531\u53ef\u80fd\u8de8\u8d8a\u4e00\u4e2a\u6216\u591a\u4e2a tablets \u8de8\u8d8a\u4e00\u884c\u6216\u591a\u884c\u7684\u5ba2\u6237\u7aef\u6267\u884c\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002\u5f53\u670d\u52a1\u5668\u63a5\u6536\u5230\u626b\u63cf\u8bf7\u6c42\u65f6\uff0c\u4f1a\u6536\u5230 MVCC \u72b6\u6001\u7684\u5feb\u7167\uff0c\u7136\u540e\u6839\u636e\u7528\u6237\u9009\u62e9\u7684\u8bfb\u53d6\u6a21\u5f0f\uff0c\u4ee5\u4e24\u79cd\u65b9\u5f0f\u4e4b\u4e00\u8fdb\u884c\u3002\u8be5\u6a21\u5f0f\u53ef\u4ee5\u5982\u4e0b\u9009\u62e9\uff1a Java Client \u8c03\u7528 KuduScannerBuilder#setReadMode(...) C++ Client \u8c03\u7528 KuduScanner :: SetReadMode() \u4ee5\u4e0b\u6a21\u5f0f\u5728\u4e24\u4e2a\u5ba2\u6237\u7aef\u90fd\u53ef\u7528\uff1a READ_LATEST \u8fd9\u662f\u9ed8\u8ba4\u7684\u8bfb\u53d6\u6a21\u5f0f\u3002\u670d\u52a1\u5668\u62cd\u6444 MVCC \u72b6\u6001\u7684\u5feb\u7167\uff0c\u5e76\u7acb\u5373\u7ee7\u7eed\u9605\u8bfb\u3002\u5728\u6b64\u6a21\u5f0f\u4e0b\u8bfb\u53d6\u53ea\u4f1a\u4ea7\u751f \u201cRead Committed\u201d \u9694\u79bb\u3002 READ_AT_SNAPSHOT \u5728\u8fd9\u79cd\u8bfb\u53d6\u6a21\u5f0f\u4e0b\uff0c\u626b\u63cf\u662f\u4e00\u81f4\u7684\u548c\u53ef\u91cd\u590d\u7684\u3002\u5feb\u7167\u7684\u65f6\u95f4\u6233\u7531\u670d\u52a1\u5668\u9009\u62e9\uff0c\u6216\u7531\u7528\u6237\u901a\u8fc7 KuduScanner :: SetSnapshotMicros() \u663e\u5f0f\u8bbe\u7f6e\u3002\u5efa\u8bae\u660e\u786e\u8bbe\u7f6e\u65f6\u95f4\u6233;\u89c1 Recommendations ( \u5efa\u8bae\u4e66 ) \u3002\u670d\u52a1\u5668\u7b49\u5f85\uff0c\u76f4\u5230\u8fd9\u4e2a\u65f6\u95f4\u6233\u4e3a \u201csafe\u201d \uff08\u76f4\u5230\u6240\u6709\u5177\u6709\u8f83\u4f4e\u65f6\u95f4\u6233\u7684\u5199\u5165\u64cd\u4f5c\u90fd\u5df2\u5b8c\u6210\u5e76\u53ef\u89c1\uff09\u3002\u8fd9\u79cd\u5ef6\u8fdf\u52a0\u4e0a\u5916\u90e8\u4e00\u81f4\u6027\u65b9\u6cd5\uff0c\u6700\u7ec8\u5c06\u5141\u8bb8 Kudu \u5177\u6709\u5b8c\u5168\u4e25\u683c\u53ef\u5e8f\u5217\u5316\u7684\u8bfb\u5199\u8bed\u4e49\u3002\u8fd9\u4ecd\u7136\u662f\u4e00\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\uff0c\u4e00\u4e9b\u5f02\u5e38\u4ecd\u7136\u662f\u53ef\u80fd\u7684\uff08\u8bf7\u53c2\u9605 \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 \uff09\u3002\u53ea\u6709\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u8fdb\u884c\u626b\u63cf\u53ef\u4ee5\u662f\u5bb9\u9519\u7684\u3002 \u5728\u8bfb\u53d6\u6a21\u5f0f\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\u9700\u8981\u5e73\u8861\u6743\u8861\u5e76\u505a\u51fa\u9002\u5408\u60a8\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9009\u62e9\u3002 \u4f8b\u5982\uff0c\u9700\u8981\u626b\u63cf\u6574\u4e2a\u6570\u636e\u5e93\u7684\u62a5\u544a\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u9700\u8981\u6267\u884c\u4ed4\u7ec6\u7684\u8ba1\u8d39\u64cd\u4f5c\uff0c\u4ee5\u4fbf\u626b\u63cf\u53ef\u80fd\u9700\u8981\u5bb9\u9519\uff0c\u4f46\u53ef\u80fd\u4e0d\u9700\u8981\u4e00\u4e2a\u5fae\u5fae\u5c0f\u7684\u6700\u65b0\u89c6\u56fe \u7684\u6570\u636e\u5e93\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9 READ_AT_SNAPSHOT \uff0c\u5e76\u9009\u62e9\u626b\u63cf\u5f00\u59cb\u65f6\u8fc7\u53bb\u51e0\u79d2\u7684\u65f6\u95f4\u6233\u3002 \u53e6\u4e00\u65b9\u9762\uff0c\u4e0d\u5438\u6536\u6574\u4e2a\u6570\u636e\u96c6\u5e76\u4e14\u5df2\u7ecf\u5177\u6709\u7edf\u8ba1\u6027\u8d28\u7684\u673a\u5668\u5b66\u4e60\u5de5\u4f5c\u8d1f\u8f7d\u53ef\u80fd\u4e0d\u8981\u6c42\u626b\u63cf\u662f\u53ef\u91cd\u590d\u7684\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u9009\u62e9 READ_LATEST \u3002 Known Issues and Limitations ( \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 ) \u76ee\u524d\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0c Kudu \u5df2\u7ecf\u5b8c\u5168\u4e25\u683c\u5e8f\u5217\u5316\uff0c\u5b58\u5728\u51e0\u4e2a\u7f3a\u9677\u548c\u89d2\u843d\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u4fe1\u606f\uff0c\u63a5\u4e0b\u6765\u662f\u4e00\u4e9b\u5efa\u8bae\u3002 Reads (Scans) ( \u9605\u8bfb\uff08\u626b\u63cf\uff09 ) \u5bf9 COMMIT_WAIT \u7684\u652f\u6301\u662f\u5b9e\u9a8c\u6027\u7684\uff0c\u9700\u8981\u4ed4\u7ec6\u8c03\u6574\u65f6\u95f4\u540c\u6b65\u534f\u8bae\uff0c\u5982 NTP \uff08\u7f51\u7edc\u65f6\u95f4\u534f\u8bae\uff09\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528\u5b83\u3002 Writes ( \u5199\u5165 ) \u5728 leader change \u4e2d\uff0c READ_AT_SNAPSHOT \u626b\u63cf\u65f6\u95f4\u6233\u8d85\u51fa\u6700\u540e\u4e00\u6b21\u5199\u5165\u7684\u5feb\u7167\uff0c\u4e5f\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e0d\u53ef\u91cd\u590d\u7684\u8bfb\u53d6\uff08\u53c2\u89c1 KUDU-1188 \uff09\u3002\u8bf7\u53c2\u9605 \u6709\u5173\u89e3\u51b3\u65b9\u6cd5\u7684 \u5efa\u8bae \u3002 Impala \u626b\u63cf\u5f53\u524d\u4ee5 READ_LATEST \u7684\u5f62\u5f0f\u6267\u884c\uff0c\u5e76\u4e14\u6ca1\u6709\u4e00\u81f4\u6027\u4fdd\u8bc1\u3002 \u5728 AUTO_BACKGROUND_FLUSH \u6a21\u5f0f\u4e0b\uff0c\u6216\u8005\u4f7f\u7528 \u201c\u5f02\u6b65\u201d \u5237\u65b0\u673a\u5236\u65f6\uff0c\u5e94\u7528\u4e8e\u5355\u4e2a\u5ba2\u6237\u7aef\u4f1a\u8bdd\u7684\u5199\u5165\u53ef\u80fd\u7531\u4e8e\u5c06\u6570\u636e\u5237\u65b0\u5230\u670d\u52a1\u5668\u7684\u5e76\u53d1\u800c\u91cd\u65b0\u6392\u5e8f\u3002\u5982\u679c\u7528\u4e0d\u540c\u7684\u503c\u8fde\u7eed\u5feb\u901f\u66f4\u65b0\u5355\u4e2a\u884c\uff0c\u8fd9\u53ef\u80fd\u4f1a\u7279\u522b\u660e\u663e\u3002\u8fd9\u79cd\u73b0\u8c61\u5f71\u54cd\u6240\u6709\u7684\u5ba2\u6237\u7aef API \u5b9e\u73b0\u3002\u89e3\u51b3\u65b9\u6cd5\u5728 API \u6587\u6863\u4e2d\u4ecb\u7ecd\u4e86 FlushMode \u6216 AsyncKuduSession \u6587\u6863\u4e2d\u5404\u81ea\u7684\u5b9e\u73b0\u3002\u89c1 KUDU-1767 \u3002 Recommendations ( \u5efa\u8bae ) \u5982\u679c\u53ef\u91cd\u590d\u7684\u5feb\u7167\u8bfb\u53d6\u662f\u5fc5\u9700\u7684\uff0c\u8bf7\u4f7f\u7528 READ_AT_SNAPSHOT \uff0c\u5176\u65f6\u95f4\u6233\u7a0d\u5fae\u5728\u8fc7\u53bb\uff08\u5728 2-5 \u79d2\u4e4b\u95f4\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\uff09\u3002\u8fd9\u5c06\u7ed5\u8fc7 Reads\uff08Scans\uff09 \u4e2d\u63cf\u8ff0\u7684\u5f02\u5e38\u3002\u5373\u4f7f\u5f02\u5e38\u5df2\u88ab\u89e3\u51b3\uff0c\u56de\u6eaf\u65f6\u95f4\u6233\u603b\u662f\u4f7f\u626b\u63cf\u901f\u5ea6\u66f4\u5feb\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u592a\u53ef\u80fd\u88ab\u963b\u6b62\u3002 \u5982\u679c\u9700\u8981\u5916\u90e8\u4e00\u81f4\u6027\uff0c\u5e76\u4e14\u60a8\u51b3\u5b9a\u4f7f\u7528 COMMIT_WAIT \uff0c\u5219\u9700\u8981\u4ed4\u7ec6\u8c03\u6574\u65f6\u95f4\u540c\u6b65\u534f\u8bae\u3002\u6bcf\u4e2a\u4e8b\u52a1\u5c06\u5728\u6267\u884c\u65f6\u7b49\u5f85 2x \u6700\u5927\u65f6\u949f\u9519\u8bef\uff0c\u901a\u5e38\u4e3a 100 \u6beb\u79d2\u81f3 1 \u79d2\u8303\u56f4\u4e0e\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u4e5f\u8bb8\u66f4\u591a\u3002\u56e0\u6b64\uff0c\u4ea4\u6613\u5c06\u9700\u8981\u81f3\u5c11 200 \u6beb\u79d2\u81f3 2 \u79d2\u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u5b8c\u6210\u751a\u81f3\u53ef\u80fd\u4f1a\u8d85\u65f6\u3002 * \u672c\u5730\u670d\u52a1\u5668\u5e94\u8be5\u7528\u4f5c\u65f6\u95f4\u670d\u52a1\u5668\u3002\u6211\u4eec\u4f7f\u7528 Google Compute Engine \u6570\u636e\u4e2d\u5fc3\u63d0\u4f9b\u7684\u9ed8\u8ba4 NTP \u65f6\u95f4\u6e90\u8fdb\u884c\u5b9e\u9a8c\uff0c\u5e76\u80fd\u591f\u83b7\u5f97\u5408\u7406\u7684\u6700\u5927\u8bef\u5dee\u8303\u56f4\uff0c\u901a\u5e38\u5728 12-17 \u6beb\u79d2\u4e4b\u95f4\u53d8\u5316\u3002 * \u5e94\u5728 /etc/ntp.conf \u4e2d\u8c03\u6574\u4ee5\u4e0b\u53c2\u6570\u4ee5\u6536\u7d27\u6700\u5927\u9519\u8bef\uff1a \u670d\u52a1\u5668 my_server.org iburst minpoll 1 maxpoll 8 tinker dispersion 500 tinker allan 0 \u4fe1\u606f \u4e0a\u8ff0\u53c2\u6570\u4ee5\u4f30\u8ba1\u8bef\u5dee\u4e3a\u4ee3\u4ef7\u6700\u5c0f\u5316\u6700\u5927\u8bef\u5dee\uff0c\u540e\u8005\u53ef\u80fd\u9ad8\u4e8e \u201cnormal\u201d \u503c\u7684\u6570\u91cf\u7ea7\u3002\u8fd9\u4e9b\u53c2\u6570\u4e5f\u53ef\u80fd\u5bf9\u65f6\u95f4\u670d\u52a1\u5668\u9020\u6210\u66f4\u5927\u7684\u8d1f\u62c5\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u5f97\u670d\u52a1\u5668\u7684\u8f6e\u8be2\u9891\u7387\u66f4\u9ad8\u3002 References ( \u53c2\u8003 ) [1] David Alves, Todd Lipcon and Vijay Garg. Technical Report: HybridTime - Accessible Global Consistency with High Clock Uncertainty. April, 2014. http://users.ece.utexas.edu/~garg/pdslab/david/hybrid-time-tech-report-01.pdf [2] James C. Corbett, Jeffrey Dean, Michael Epstein, Andrew Fikes, Christopher Frost, J. J. Furman, Sanjay Ghemawat, Andrey Gubarev, Christopher Heiser, Peter Hochschild, Wilson Hsieh, Sebastian Kanthak, Eugene Kogan, Hongyi Li, Alexander Lloyd, Sergey Melnik, David Mwaura, David Nagle, Sean Quinlan, Rajesh Rao, Lindsay Rolig, Yasushi Saito, Michal Szymaniak, Christopher Taylor, Ruth Wang, and Dale Woodford. 2012. Spanner: Google\u2019s globally-distributed database. In Proceedings of the 10th USENIX conference on Operating Systems Design and Implementation (OSDI'12). USENIX Association, Berkeley, CA, USA, 251-264. [3] Alexander Thomson, Thaddeus Diamond, Shu-Chun Weng, Kun Ren, Philip Shao, and Daniel J. Abadi. 2012. Calvin: fast distributed transactions for partitioned database systems. In Proceedings of the 2012 ACM SIGMOD International Conference on Management of Data (SIGMOD '12). ACM, New York, NY, USA, 1-12. DOI=10.1145/2213836.2213838 http://doi.acm.org/10.1145/2213836.2213838 [4] Diego Ongaro and John Ousterhout. 2014. In search of an understandable consensus algorithm. In Proceedings of the 2014 USENIX conference on USENIX Annual Technical Conference (USENIX ATC'14), Garth Gibson and Nickolai Zeldovich (Eds.). USENIX Association, Berkeley, CA, USA, 305-320. [5] Kwei-Jay Lin, \"Consistency issues in real-time database systems,\" in System Sciences, 1989. Vol.II: Software Track, Proceedings of the Twenty-Second Annual Hawaii International Conference on , vol.2, no., pp.654-661 vol.2, 3-6 Jan 1989 doi: 10.1109/HICSS.1989.48069","title":"Kudu Transaction Semantics ( \u4e8b\u52a1\u8bed\u4e49 )"},{"location":"11/#kudu-transaction-semantics","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/transaction_semantics.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813638 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu Transaction Semantics ( \u4e8b\u52a1\u8bed\u4e49 )"},{"location":"11/#apache-kudu-transaction-semantics","text":"\u8fd9\u662f Kudu \u7684 \u4ea4\u6613\u548c\u4e00\u81f4\u6027\u8bed\u4e49\u7684\u7b80\u8981\u4ecb\u7ecd\u3002\u5bf9\u4e8e\u8fd9\u91cc\u63d0\u5230\u7684\u5927\u90e8\u5206\u5185\u5bb9\u7684\u6df1\u5165\u6280\u672f\u8bba\u8ff0\uff0c\u4e3a\u4ec0\u4e48\u662f\u6b63\u786e\u7684\uff0c\u8bf7\u53c2\u9605\u6280\u672f\u62a5\u544a [1] \u3002 Kudu \u7684 transactional semantics ( \u4e8b\u52a1\u8bed\u4e49 )\u548c\u4f53\u7cfb\u7ed3\u6784\u53d7\u5230 Spanner [2] \u548c Calvin [3] \u7b49\u6700\u5148\u8fdb\u7684\u7cfb\u7edf\u7684\u542f\u53d1\u3002 Kudu \u5efa\u7acb\u5728\u6570\u5341\u5e74\u7684\u6570\u636e\u5e93\u7814\u7a76\u57fa\u7840\u4e4b\u4e0a\u3002\u6838\u5fc3\u7406\u5ff5\u662f\u901a\u8fc7\u63d0\u4f9b\u7b80\u5355\uff0c\u5f3a\u5927\u7684\u8bed\u4e49\u7684\u4e8b\u52a1\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u7684\u751f\u6d3b\u66f4\u8f7b\u677e\uff0c\u800c\u4e0d\u4f1a\u727a\u7272\u6027\u80fd\u6216\u8c03\u6574\u5230\u4e0d\u540c\u9700\u6c42\u7684\u80fd\u529b\u3002 Kudu \u65e8\u5728\u6700\u7ec8\u5b8c\u5168\u83b7\u5f97 ACID \uff0c\u4f46\u662f\u591a tablet \u4e8b\u52a1\u5c1a\u672a\u5b9e\u65bd\u3002\u56e0\u6b64\uff0c\u672c\u6b21\u8ba8\u8bba\u7684\u91cd\u70b9\u662f\u5355\u7247\u5199\u5165\u64cd\u4f5c\uff0c\u53ea\u662f\u7b80\u5355\u5730\u89e6\u6478\u591a tablets \u8bfb\u53d6\u3002\u6700\u7ec8 Kudu \u5c06\u652f\u6301\u5b8c\u5168\u4e25\u683c\u7684\u53ef\u5e8f\u5217\u5316\u8bed\u4e49\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5b83\u5df2\u7ecf\u5728\u6709\u9650\u7684\u8303\u56f4\u5185\uff0c\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u89d2\u843d\u90fd\u88ab\u8986\u76d6\uff0c\u56e0\u4e3a\u8fd9\u4ecd\u7136\u662f\u4e00\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\u3002 Kudu \u76ee\u524d\u5141\u8bb8\u4ee5\u4e0b\u64cd\u4f5c\uff1a Write operations ( \u5199\u5165\u64cd\u4f5c ) \u662f\u5728\u5177\u6709\u591a\u4e2a\u526f\u672c\u7684\u5355\u4e2a tablet \u4e2d\u5728\u5b58\u50a8\u5f15\u64ce\u4e2d\u63d2\u5165\uff0c\u66f4\u65b0\u6216\u5220\u9664\u7684 sets of rows ( \u884c\u96c6 ) \u3002\u5199\u64cd\u4f5c\u6ca1\u6709\u5355\u72ec\u7684 \u201cread sets\u201d \uff0c\u5373\u5b83\u4eec\u5728\u6267\u884c\u5199\u5165\u4e4b\u524d\u4e0d\u626b\u63cf\u73b0\u6709\u6570\u636e\u3002\u6bcf\u4e2a\u5199\u5165\u4ec5\u6d89\u53ca\u5373\u5c06\u66f4\u6539\u7684\u884c\u7684\u5148\u524d\u72b6\u6001\u3002\u7528\u6237\u660e\u786e\u4e0d\u5199 \u201ccommitted\u201d \u3002\u76f8\u53cd\uff0c\u5b83\u4eec\u5c06\u5728\u7cfb\u7edf\u5b8c\u6210\u540e\u81ea\u52a8\u63d0\u4ea4\u3002 Scans ( \u626b\u63cf ) \u662f\u53ef\u4ee5\u904d\u5386\u591a\u4e2a tablets \u5e76\u8bfb\u53d6\u4fe1\u606f\u7684\u8bfb\u53d6\u64cd\u4f5c\uff0c\u5177\u6709\u4e00\u81f4\u6027\u6216\u6b63\u786e\u6027\u4fdd\u8bc1\u3002\u626b\u63cf\u53ef\u4ee5\u6267\u884c\u65f6\u95f4\u884c\u8fdb\u8bfb\u53d6\uff0c\u5373\u7528\u6237\u80fd\u591f\u8bbe\u7f6e\u8fc7\u53bb\u7684\u626b\u63cf\u65f6\u95f4\u6233\uff0c\u5e76\u8fd4\u56de\u5728\u8be5\u65f6\u95f4\u70b9\u53cd\u6620\u5b58\u50a8\u5f15\u64ce\u7684\u72b6\u6001\u7684\u7ed3\u679c\u3002 \u91cd\u8981 \u5f00\u59cb\u4e4b\u524d \u591a\u6b21\u63d0\u5230\u672f\u8bed\u65f6\u95f4\u6233\u6765\u8bf4\u660e\u529f\u80fd\uff0c\u4f46\u662f\u65f6\u95f4\u6233\u662f\u7528\u6237\u6700\u4e0d\u53ef\u89c1\u7684\u5185\u90e8\u6982\u5ff5\uff0c\u9664\u4e86\u5728 KuduScanner \u4e0a\u8bbe\u7f6e\u65f6\u95f4\u6233\u3002 \u6211\u4eec\u901a\u5e38\u6307\u7684\u662f C ++ client \u7684\u65b9\u6cd5\u548c\u7c7b\u3002\u867d\u7136 Java \u5ba2\u6237\u7aef\u5927\u591a\u5177\u6709\u7c7b\u4f3c\u7684\u65b9\u6cd5\u548c\u7c7b\uff0c\u4f46\u662f API \u7684\u786e\u5207\u540d\u79f0\u53ef\u80fd\u4e0d\u540c\u3002","title":"Apache Kudu \u7684 Transaction Semantics ( \u4e8b\u52a1\u8bed\u4e49 )"},{"location":"11/#single-tablet-write-operations-tablet","text":"Kudu \u91c7\u7528 Multiverion \u5e76\u53d1\u63a7\u5236 \uff08 MVCC \uff09 \u548c Raft \u4e00\u81f4\u6027\u7b97\u6cd5 [4] \u3002 Kudu \u7684\u6bcf\u4e2a\u5199\u5165\u64cd\u4f5c\u5fc5\u987b\u7ecf\u8fc7 tablet \u7684\u9886\u5bfc\u3002 leader \u5c06\u4e3a\u5176\u5c06\u66f4\u6539\u7684\u884c\u83b7\u53d6\u6240\u6709\u9501\u3002 leader \u5728\u63d0\u4ea4\u5199\u5165\u590d\u5236\u4e4b\u524d\u5206\u914d\u5199\u5165\u65f6\u95f4\u6233\u3002\u8fd9\u4e2a\u65f6\u95f4\u6233\u662f MVCC \u4e2d\u7684 write \u7684 \u201ctag\u201d \u3002 \u5728\u5927\u591a\u6570\u526f\u672c\u786e\u8ba4\u66f4\u6539\u540e\uff0c\u5b9e\u9645\u7684\u884c\u5c06\u88ab\u66f4\u6539\u3002 \u66f4\u6539\u5b8c\u6210\u540e\uff0c\u5b83\u4eec\u53ef\u4ee5\u4ee5\u539f\u5b50\u65b9\u5f0f\u540c\u65f6\u8fdb\u884c\u5199\u5165\u548c\u8bfb\u53d6\u3002 tablets \u7684\u6240\u6709\u526f\u672c\u90fd\u9075\u5faa\u76f8\u540c\u7684\u64cd\u4f5c\u987a\u5e8f\uff0c\u5982\u679c\u4e3a\u5199\u5165\u64cd\u4f5c\u5206\u914d\u65f6\u95f4\u6233 n \u5e76\u66f4\u6539 \u884c x \uff0c\u5219\u4fdd\u8bc1\u65f6\u95f4\u6233 m > n \u7684\u7b2c\u4e8c\u6b21\u5199\u5165\u64cd\u4f5c\u53ef\u4ee5\u770b\u5230 x \u7684\u65b0\u503c\u3002 \u9501\u5b9a\u91c7\u96c6\u548c\u65f6\u95f4\u6233\u5206\u914d\u7684\u8fd9\u79cd\u4e25\u683c\u6392\u5e8f\u901a\u8fc7\u534f\u5546\u4e00\u81f4\u7684\u65b9\u5f0f\u5f3a\u5236\u6267\u884c tablets \u7684\u6240\u6709\u526f\u672c\u3002\u56e0\u6b64\uff0c\u76f8\u5bf9\u4e8e\u540c\u4e00\u4e2a\u5e73\u677f\u7535\u8111\u4e2d\u7684\u5176\u4ed6\u5199\u5165\uff0c\u5173\u4e8e\u65f6\u949f\u5206\u914d\u7684\u65f6\u95f4\u6233\uff0c\u5199\u5165\u64cd\u4f5c\u662f\u5b8c\u5168\u6392\u5e8f\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5199\u5165\u5177\u6709\u4e25\u683c\u7684\u53ef\u5e8f\u5217\u5316\u8bed\u4e49\uff0c\u5c3d\u7ba1\u5728\u4e00\u4e2a\u516c\u8ba4\u7684\u6709\u9650\u7684\u4e0a\u4e0b\u6587\u4e2d\u3002\u6709\u5173\u8fd9\u4e9b\u8bed\u4e49\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u8bf7\u53c2\u9605\u8fd9\u7bc7 \u535a\u5ba2\u6587\u7ae0 \u3002 \u867d\u7136\u5728 ACID \u610f\u4e49\u4e0a\u7684\u9694\u79bb\u548c\u8010\u7528\u6027\uff0c\u591a\u884c\u5199\u5165\u64cd\u4f5c\u5c1a\u672a\u5b8c\u5168\u539f\u5b50\u5316\u3002\u6279\u91cf\u64cd\u4f5c\u4e2d\u5355\u6b21\u5199\u5165\u7684\u6545\u969c\u4e0d\u4f1a\u56de\u6eda\u64cd\u4f5c\uff0c\u800c\u662f\u4ea7\u751f\u6bcf\u884c\u9519\u8bef\u3002","title":"Single tablet write operations ( \u5355 tablet \u5199\u5165\u64cd\u4f5c )"},{"location":"11/#writing-to-multiple-tablets-tablets","text":"Kudu \u8fd8\u4e0d\u652f\u6301\u8de8\u591a\u4e2a tablets \u7684\u4e8b\u52a1\u3002\u4f46\u662f\uff0c\u4e00\u81f4\u7684\u5feb\u7167\u8bfb\u53d6\u662f\u53ef\u80fd\u7684\uff08\u5982\u5f53\u524d\u5b9e\u73b0\u4e2d\u7684\u8b66\u544a\uff09\uff0c\u5982\u4e0b\u6240\u8ff0\u3002 Kudu \u5ba2\u6237\u7aef\u7684\u5199\u5165\u53ef\u9009\u5730\u7f13\u51b2\u5728\u5185\u5b58\u4e2d\uff0c\u76f4\u5230\u5b83\u4eec\u88ab\u5237\u65b0\u5e76\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002\u5f53\u5ba2\u6237\u7aef\u7684\u4f1a\u8bdd\u5237\u65b0\u65f6\uff0c\u6bcf\u4e2a tablet \u7684\u884c\u88ab\u6279\u5904\u7406\u5728\u4e00\u8d77\uff0c\u5e76\u53d1\u9001\u5230\u6258\u7ba1 tablet \u7684 leader replica \u7684 tablet servers \u3002\u7531\u4e8e\u6ca1\u6709 inter-tablet \u4e8b\u52a1\uff0c\u8fd9\u4e9b\u6279\u6b21\u4e2d\u7684\u6bcf\u4e00\u4e2a\u4ee3\u8868\u5177\u6709\u81ea\u5df1\u7684\u65f6\u95f4\u6233\u7684\u5355\u72ec\u7684\u72ec\u7acb\u5199\u5165\u64cd\u4f5c\u3002\u7136\u800c\uff0c\u5ba2\u6237\u7aef API \u63d0\u4f9b\u4e86\u5bf9\u5206\u914d\u7684\u65f6\u95f4\u6233\u65bd\u52a0\u4e00\u4e9b\u7ea6\u675f\u7684\u9009\u9879\uff0c\u4ee5\u53ca\u5ba2\u6237\u7aef\u5982\u4f55\u89c2\u5bdf\u5bf9\u4e0d\u540c tablet \u7684\u5199\u5165\u3002 Kudu \u50cf Spanner \u4e00\u6837\u88ab\u8bbe\u8ba1\u4e3a\u5916\u90e8\u4e00\u81f4 [5] \uff0c\u5373\u4f7f\u5728\u8de8\u591a\u4e2a\u5e73\u677f\u7535\u8111\u751a\u81f3\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u60c5\u51b5\u4e0b\u4e5f\u80fd\u4fdd\u6301\u4e00\u81f4\u6027\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u5199\u5165\u64cd\u4f5c\u5728\u5e73\u677f\u7535\u8111 A \u4e0a\u66f4\u6539\u9879\u76ee x \uff0c\u5e76\u4e14\u4ee5\u4e0b\u5199\u5165\u64cd\u4f5c\u5728\u5e73\u677f\u7535\u8111 B \u4e0a\u66f4\u6539\u9879\u76ee y \uff0c\u5219\u53ef\u80fd\u9700\u8981\u5f3a\u5236\u6267\u884c\uff0c\u5982\u679c\u89c2\u5bdf\u5230 y \u7684\u66f4\u6539\uff0c\u5219 x \u7684\u66f4\u6539\u4e5f\u5fc5\u987b\u4e3a\u89c2\u5bdf\u5230\u7684\u3002\u6709\u5f88\u591a\u4f8b\u5b50\u53ef\u4ee5\u8bf4\u662f\u91cd\u8981\u7684\u3002\u4f8b\u5982\uff0c\u5982\u679c Kudu \u6b63\u5728\u5b58\u50a8\u7528\u4e8e\u8fdb\u4e00\u6b65\u5206\u6790\u7684\u70b9\u51fb\u6d41\uff0c\u5e76\u4e14\u4e24\u6b21\u70b9\u51fb\u76f8\u4e92\u5173\u8054\uff0c\u4f46\u5b58\u50a8\u5728\u4e0d\u540c\u7684 tablet \u4e2d\uff0c\u5219\u540e\u7eed\u70b9\u51fb\u5e94\u8be5\u88ab\u5206\u914d\u540e\u7eed\u65f6\u95f4\u6233\uff0c\u4ee5\u4fbf\u6355\u83b7\u5b83\u4eec\u4e4b\u95f4\u7684\u56e0\u679c\u5173\u7cfb\u3002 CLIENT_PROPAGATED Consistency Kudu \u7684\u9ed8\u8ba4\u5916\u90e8\u4e00\u81f4\u6027\u6a21\u5f0f\u79f0\u4e3a CLIENT_PROPAGATED \u3002\u6709\u5173\u5982\u4f55\u5de5\u4f5c\u7684\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605 [1] \u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u6b64\u6a21\u5f0f\u4f1a\u5bfc\u81f4\u5355\u4e2a\u5ba2\u6237\u7aef\u7684\u5199\u5165\u81ea\u52a8\u5728\u5916\u90e8\u4fdd\u6301\u4e00\u81f4\u3002\u5728\u4e0a\u8ff0 Clickstream \u573a\u666f\u4e2d\uff0c\u5982\u679c\u4e24\u4e2a\u70b9\u51fb\u662f\u7531\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u5b9e\u4f8b\u63d0\u4ea4\u7684\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u624b\u52a8\u5c06\u65f6\u95f4\u6233\u4ece\u4e00\u4e2a\u5ba2\u6237\u7aef\u4f20\u64ad\u5230\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u4ee5\u4fbf\u6355\u83b7\u56e0\u679c\u5173\u7cfb\u3002 \u5ba2\u6237\u7aef a \u548c b \u4e4b\u95f4\u7684\u65f6\u95f4\u6233\u53ef\u4ee5\u4f20\u64ad\u5982\u4e0b\uff1a Java Client \u8c03\u7528 AsyncKuduClient#getLastPropagatedTimestamp() \u5728\u5ba2\u6237\u7aef a \uff0c\u5c06\u65f6\u95f4\u6233\u4f20\u64ad\u5230\u5ba2\u6237\u7aef b \uff0c\u5e76\u5728\u5ba2\u6237\u7aef b \u4e0a\u8c03\u7528 AsyncKuduClient#setLastPropagatedTimestamp() \u3002 C++ Client \u5728\u5ba2\u6237\u7aef a \u4e0a\u8c03\u7528 KuduClient::GetLatestObservedTimestamp() \uff0c\u5c06\u65f6\u95f4\u6233\u4f20\u64ad\u5230\u5ba2\u6237\u7aef b \uff0c\u5e76\u5728\u5ba2\u6237\u7aef b \u4e0a\u8c03\u7528 KuduClient::SetLatestObservedTimestamp() \u3002 COMMIT_WAIT Consistency Kudu \u8fd8\u6709\u4e00\u4e2a\u5728 Google \u7684 Spanner \u4e2d\u4f7f\u7528\u7684\u5916\u90e8\u4e00\u81f4\u6027\u6a21\u578b\u7684\u5b9e\u9a8c\u5b9e\u73b0\uff0c\u79f0\u4e3a COMMIT_WAIT \u3002 COMMIT_WAIT \u901a\u8fc7\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u8ba1\u7b97\u673a\u4e0a\u7d27\u5bc6\u540c\u6b65\u65f6\u949f\u6765\u8d77\u4f5c\u7528\u3002\u7136\u540e\uff0c\u5f53\u53d1\u751f\u5199\u5165\u65f6\uff0c\u5206\u914d\u65f6\u95f4\u6233\uff0c\u5e76\u4e14\u5728\u901a\u8fc7\u8db3\u591f\u7684\u65f6\u95f4\u4e4b\u524d\u5199\u5165\u7684\u7ed3\u679c\u4e0d\u53ef\u89c1\uff0c\u4f7f\u5f97\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u8ba1\u7b97\u673a\u4e0d\u53ef\u80fd\u4e3a\u4e0b\u4e00\u6b21\u5199\u5165\u5206\u914d\u8f83\u4f4e\u7684\u65f6\u95f4\u6233\u3002 \u5f53\u4f7f\u7528\u6b64\u6a21\u5f0f\u65f6\uff0c\u5199\u5165\u7684\u5ef6\u8fdf\u4e0e\u6240\u6709\u96c6\u7fa4\u4e3b\u673a\u4e0a\u7684\u65f6\u949f\u7cbe\u5ea6\u7d27\u5bc6\u76f8\u5173\uff0c\u5e76\u4e14\u4f7f\u7528\u677e\u6563\u65f6\u949f\u540c\u6b65\u7684\u6b64\u6a21\u5f0f\u4f1a\u5bfc\u81f4\u5199\u5165\u9700\u8981\u5f88\u957f\u65f6\u95f4\u624d\u80fd\u5b8c\u6210\u751a\u81f3\u8d85\u65f6\u3002\u8bf7\u53c2\u9605 \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 \u3002 COMMIT_WAIT \u4e00\u81f4\u6027\u6a21\u5f0f\u53ef\u4ee5\u5982\u4e0b\u9009\u62e9\uff1a Java Client \u8c03\u7528 KuduSession#setExternalConsistencyMode(ExternalConsistencyMode.COMMIT_WAIT) C++ Client \u8c03\u7528 KuduSession :: SetExternalConsistencyMode(COMMIT_WAIT) \u6ce8\u610f COMMIT_WAIT \u4e00\u81f4\u6027\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u5b9e\u9a8c\u529f\u80fd\u3002\u5b83\u53ef\u80fd\u4f1a\u8fd4\u56de\u4e0d\u6b63\u786e\u7684\u7ed3\u679c\uff0c\u5c55\u793a\u6027\u80fd\u95ee\u9898\u6216\u5bf9\u96c6\u7fa4\u7a33\u5b9a\u6027\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\u3002\u4e0d\u9f13\u52b1\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u3002","title":"Writing to multiple tablets ( \u5199\u5165\u591a\u4e2a tablets )"},{"location":"11/#read-operations-scans","text":"\u626b\u63cf\u662f\u7531\u53ef\u80fd\u8de8\u8d8a\u4e00\u4e2a\u6216\u591a\u4e2a tablets \u8de8\u8d8a\u4e00\u884c\u6216\u591a\u884c\u7684\u5ba2\u6237\u7aef\u6267\u884c\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002\u5f53\u670d\u52a1\u5668\u63a5\u6536\u5230\u626b\u63cf\u8bf7\u6c42\u65f6\uff0c\u4f1a\u6536\u5230 MVCC \u72b6\u6001\u7684\u5feb\u7167\uff0c\u7136\u540e\u6839\u636e\u7528\u6237\u9009\u62e9\u7684\u8bfb\u53d6\u6a21\u5f0f\uff0c\u4ee5\u4e24\u79cd\u65b9\u5f0f\u4e4b\u4e00\u8fdb\u884c\u3002\u8be5\u6a21\u5f0f\u53ef\u4ee5\u5982\u4e0b\u9009\u62e9\uff1a Java Client \u8c03\u7528 KuduScannerBuilder#setReadMode(...) C++ Client \u8c03\u7528 KuduScanner :: SetReadMode() \u4ee5\u4e0b\u6a21\u5f0f\u5728\u4e24\u4e2a\u5ba2\u6237\u7aef\u90fd\u53ef\u7528\uff1a READ_LATEST \u8fd9\u662f\u9ed8\u8ba4\u7684\u8bfb\u53d6\u6a21\u5f0f\u3002\u670d\u52a1\u5668\u62cd\u6444 MVCC \u72b6\u6001\u7684\u5feb\u7167\uff0c\u5e76\u7acb\u5373\u7ee7\u7eed\u9605\u8bfb\u3002\u5728\u6b64\u6a21\u5f0f\u4e0b\u8bfb\u53d6\u53ea\u4f1a\u4ea7\u751f \u201cRead Committed\u201d \u9694\u79bb\u3002 READ_AT_SNAPSHOT \u5728\u8fd9\u79cd\u8bfb\u53d6\u6a21\u5f0f\u4e0b\uff0c\u626b\u63cf\u662f\u4e00\u81f4\u7684\u548c\u53ef\u91cd\u590d\u7684\u3002\u5feb\u7167\u7684\u65f6\u95f4\u6233\u7531\u670d\u52a1\u5668\u9009\u62e9\uff0c\u6216\u7531\u7528\u6237\u901a\u8fc7 KuduScanner :: SetSnapshotMicros() \u663e\u5f0f\u8bbe\u7f6e\u3002\u5efa\u8bae\u660e\u786e\u8bbe\u7f6e\u65f6\u95f4\u6233;\u89c1 Recommendations ( \u5efa\u8bae\u4e66 ) \u3002\u670d\u52a1\u5668\u7b49\u5f85\uff0c\u76f4\u5230\u8fd9\u4e2a\u65f6\u95f4\u6233\u4e3a \u201csafe\u201d \uff08\u76f4\u5230\u6240\u6709\u5177\u6709\u8f83\u4f4e\u65f6\u95f4\u6233\u7684\u5199\u5165\u64cd\u4f5c\u90fd\u5df2\u5b8c\u6210\u5e76\u53ef\u89c1\uff09\u3002\u8fd9\u79cd\u5ef6\u8fdf\u52a0\u4e0a\u5916\u90e8\u4e00\u81f4\u6027\u65b9\u6cd5\uff0c\u6700\u7ec8\u5c06\u5141\u8bb8 Kudu \u5177\u6709\u5b8c\u5168\u4e25\u683c\u53ef\u5e8f\u5217\u5316\u7684\u8bfb\u5199\u8bed\u4e49\u3002\u8fd9\u4ecd\u7136\u662f\u4e00\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\uff0c\u4e00\u4e9b\u5f02\u5e38\u4ecd\u7136\u662f\u53ef\u80fd\u7684\uff08\u8bf7\u53c2\u9605 \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 \uff09\u3002\u53ea\u6709\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u8fdb\u884c\u626b\u63cf\u53ef\u4ee5\u662f\u5bb9\u9519\u7684\u3002 \u5728\u8bfb\u53d6\u6a21\u5f0f\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\u9700\u8981\u5e73\u8861\u6743\u8861\u5e76\u505a\u51fa\u9002\u5408\u60a8\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9009\u62e9\u3002 \u4f8b\u5982\uff0c\u9700\u8981\u626b\u63cf\u6574\u4e2a\u6570\u636e\u5e93\u7684\u62a5\u544a\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u9700\u8981\u6267\u884c\u4ed4\u7ec6\u7684\u8ba1\u8d39\u64cd\u4f5c\uff0c\u4ee5\u4fbf\u626b\u63cf\u53ef\u80fd\u9700\u8981\u5bb9\u9519\uff0c\u4f46\u53ef\u80fd\u4e0d\u9700\u8981\u4e00\u4e2a\u5fae\u5fae\u5c0f\u7684\u6700\u65b0\u89c6\u56fe \u7684\u6570\u636e\u5e93\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9 READ_AT_SNAPSHOT \uff0c\u5e76\u9009\u62e9\u626b\u63cf\u5f00\u59cb\u65f6\u8fc7\u53bb\u51e0\u79d2\u7684\u65f6\u95f4\u6233\u3002 \u53e6\u4e00\u65b9\u9762\uff0c\u4e0d\u5438\u6536\u6574\u4e2a\u6570\u636e\u96c6\u5e76\u4e14\u5df2\u7ecf\u5177\u6709\u7edf\u8ba1\u6027\u8d28\u7684\u673a\u5668\u5b66\u4e60\u5de5\u4f5c\u8d1f\u8f7d\u53ef\u80fd\u4e0d\u8981\u6c42\u626b\u63cf\u662f\u53ef\u91cd\u590d\u7684\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u9009\u62e9 READ_LATEST \u3002","title":"Read Operations (Scans) ( \u9605\u8bfb\u64cd\u4f5c(\u626b\u63cf) )"},{"location":"11/#known-issues-and-limitations","text":"\u76ee\u524d\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0c Kudu \u5df2\u7ecf\u5b8c\u5168\u4e25\u683c\u5e8f\u5217\u5316\uff0c\u5b58\u5728\u51e0\u4e2a\u7f3a\u9677\u548c\u89d2\u843d\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u4fe1\u606f\uff0c\u63a5\u4e0b\u6765\u662f\u4e00\u4e9b\u5efa\u8bae\u3002","title":"Known Issues and Limitations ( \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236\u00a0)"},{"location":"11/#reads-scans","text":"\u5bf9 COMMIT_WAIT \u7684\u652f\u6301\u662f\u5b9e\u9a8c\u6027\u7684\uff0c\u9700\u8981\u4ed4\u7ec6\u8c03\u6574\u65f6\u95f4\u540c\u6b65\u534f\u8bae\uff0c\u5982 NTP \uff08\u7f51\u7edc\u65f6\u95f4\u534f\u8bae\uff09\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528\u5b83\u3002","title":"Reads (Scans) ( \u9605\u8bfb\uff08\u626b\u63cf\uff09\u00a0)"},{"location":"11/#writes","text":"\u5728 leader change \u4e2d\uff0c READ_AT_SNAPSHOT \u626b\u63cf\u65f6\u95f4\u6233\u8d85\u51fa\u6700\u540e\u4e00\u6b21\u5199\u5165\u7684\u5feb\u7167\uff0c\u4e5f\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e0d\u53ef\u91cd\u590d\u7684\u8bfb\u53d6\uff08\u53c2\u89c1 KUDU-1188 \uff09\u3002\u8bf7\u53c2\u9605 \u6709\u5173\u89e3\u51b3\u65b9\u6cd5\u7684 \u5efa\u8bae \u3002 Impala \u626b\u63cf\u5f53\u524d\u4ee5 READ_LATEST \u7684\u5f62\u5f0f\u6267\u884c\uff0c\u5e76\u4e14\u6ca1\u6709\u4e00\u81f4\u6027\u4fdd\u8bc1\u3002 \u5728 AUTO_BACKGROUND_FLUSH \u6a21\u5f0f\u4e0b\uff0c\u6216\u8005\u4f7f\u7528 \u201c\u5f02\u6b65\u201d \u5237\u65b0\u673a\u5236\u65f6\uff0c\u5e94\u7528\u4e8e\u5355\u4e2a\u5ba2\u6237\u7aef\u4f1a\u8bdd\u7684\u5199\u5165\u53ef\u80fd\u7531\u4e8e\u5c06\u6570\u636e\u5237\u65b0\u5230\u670d\u52a1\u5668\u7684\u5e76\u53d1\u800c\u91cd\u65b0\u6392\u5e8f\u3002\u5982\u679c\u7528\u4e0d\u540c\u7684\u503c\u8fde\u7eed\u5feb\u901f\u66f4\u65b0\u5355\u4e2a\u884c\uff0c\u8fd9\u53ef\u80fd\u4f1a\u7279\u522b\u660e\u663e\u3002\u8fd9\u79cd\u73b0\u8c61\u5f71\u54cd\u6240\u6709\u7684\u5ba2\u6237\u7aef API \u5b9e\u73b0\u3002\u89e3\u51b3\u65b9\u6cd5\u5728 API \u6587\u6863\u4e2d\u4ecb\u7ecd\u4e86 FlushMode \u6216 AsyncKuduSession \u6587\u6863\u4e2d\u5404\u81ea\u7684\u5b9e\u73b0\u3002\u89c1 KUDU-1767 \u3002","title":"Writes ( \u5199\u5165 )"},{"location":"11/#recommendations","text":"\u5982\u679c\u53ef\u91cd\u590d\u7684\u5feb\u7167\u8bfb\u53d6\u662f\u5fc5\u9700\u7684\uff0c\u8bf7\u4f7f\u7528 READ_AT_SNAPSHOT \uff0c\u5176\u65f6\u95f4\u6233\u7a0d\u5fae\u5728\u8fc7\u53bb\uff08\u5728 2-5 \u79d2\u4e4b\u95f4\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\uff09\u3002\u8fd9\u5c06\u7ed5\u8fc7 Reads\uff08Scans\uff09 \u4e2d\u63cf\u8ff0\u7684\u5f02\u5e38\u3002\u5373\u4f7f\u5f02\u5e38\u5df2\u88ab\u89e3\u51b3\uff0c\u56de\u6eaf\u65f6\u95f4\u6233\u603b\u662f\u4f7f\u626b\u63cf\u901f\u5ea6\u66f4\u5feb\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u592a\u53ef\u80fd\u88ab\u963b\u6b62\u3002 \u5982\u679c\u9700\u8981\u5916\u90e8\u4e00\u81f4\u6027\uff0c\u5e76\u4e14\u60a8\u51b3\u5b9a\u4f7f\u7528 COMMIT_WAIT \uff0c\u5219\u9700\u8981\u4ed4\u7ec6\u8c03\u6574\u65f6\u95f4\u540c\u6b65\u534f\u8bae\u3002\u6bcf\u4e2a\u4e8b\u52a1\u5c06\u5728\u6267\u884c\u65f6\u7b49\u5f85 2x \u6700\u5927\u65f6\u949f\u9519\u8bef\uff0c\u901a\u5e38\u4e3a 100 \u6beb\u79d2\u81f3 1 \u79d2\u8303\u56f4\u4e0e\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u4e5f\u8bb8\u66f4\u591a\u3002\u56e0\u6b64\uff0c\u4ea4\u6613\u5c06\u9700\u8981\u81f3\u5c11 200 \u6beb\u79d2\u81f3 2 \u79d2\u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u5b8c\u6210\u751a\u81f3\u53ef\u80fd\u4f1a\u8d85\u65f6\u3002 * \u672c\u5730\u670d\u52a1\u5668\u5e94\u8be5\u7528\u4f5c\u65f6\u95f4\u670d\u52a1\u5668\u3002\u6211\u4eec\u4f7f\u7528 Google Compute Engine \u6570\u636e\u4e2d\u5fc3\u63d0\u4f9b\u7684\u9ed8\u8ba4 NTP \u65f6\u95f4\u6e90\u8fdb\u884c\u5b9e\u9a8c\uff0c\u5e76\u80fd\u591f\u83b7\u5f97\u5408\u7406\u7684\u6700\u5927\u8bef\u5dee\u8303\u56f4\uff0c\u901a\u5e38\u5728 12-17 \u6beb\u79d2\u4e4b\u95f4\u53d8\u5316\u3002 * \u5e94\u5728 /etc/ntp.conf \u4e2d\u8c03\u6574\u4ee5\u4e0b\u53c2\u6570\u4ee5\u6536\u7d27\u6700\u5927\u9519\u8bef\uff1a \u670d\u52a1\u5668 my_server.org iburst minpoll 1 maxpoll 8 tinker dispersion 500 tinker allan 0 \u4fe1\u606f \u4e0a\u8ff0\u53c2\u6570\u4ee5\u4f30\u8ba1\u8bef\u5dee\u4e3a\u4ee3\u4ef7\u6700\u5c0f\u5316\u6700\u5927\u8bef\u5dee\uff0c\u540e\u8005\u53ef\u80fd\u9ad8\u4e8e \u201cnormal\u201d \u503c\u7684\u6570\u91cf\u7ea7\u3002\u8fd9\u4e9b\u53c2\u6570\u4e5f\u53ef\u80fd\u5bf9\u65f6\u95f4\u670d\u52a1\u5668\u9020\u6210\u66f4\u5927\u7684\u8d1f\u62c5\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u5f97\u670d\u52a1\u5668\u7684\u8f6e\u8be2\u9891\u7387\u66f4\u9ad8\u3002","title":"Recommendations \u00a0( \u5efa\u8bae )"},{"location":"11/#references","text":"[1] David Alves, Todd Lipcon and Vijay Garg. Technical Report: HybridTime - Accessible Global Consistency with High Clock Uncertainty. April, 2014. http://users.ece.utexas.edu/~garg/pdslab/david/hybrid-time-tech-report-01.pdf [2] James C. Corbett, Jeffrey Dean, Michael Epstein, Andrew Fikes, Christopher Frost, J. J. Furman, Sanjay Ghemawat, Andrey Gubarev, Christopher Heiser, Peter Hochschild, Wilson Hsieh, Sebastian Kanthak, Eugene Kogan, Hongyi Li, Alexander Lloyd, Sergey Melnik, David Mwaura, David Nagle, Sean Quinlan, Rajesh Rao, Lindsay Rolig, Yasushi Saito, Michal Szymaniak, Christopher Taylor, Ruth Wang, and Dale Woodford. 2012. Spanner: Google\u2019s globally-distributed database. In Proceedings of the 10th USENIX conference on Operating Systems Design and Implementation (OSDI'12). USENIX Association, Berkeley, CA, USA, 251-264. [3] Alexander Thomson, Thaddeus Diamond, Shu-Chun Weng, Kun Ren, Philip Shao, and Daniel J. Abadi. 2012. Calvin: fast distributed transactions for partitioned database systems. In Proceedings of the 2012 ACM SIGMOD International Conference on Management of Data (SIGMOD '12). ACM, New York, NY, USA, 1-12. DOI=10.1145/2213836.2213838 http://doi.acm.org/10.1145/2213836.2213838 [4] Diego Ongaro and John Ousterhout. 2014. In search of an understandable consensus algorithm. In Proceedings of the 2014 USENIX conference on USENIX Annual Technical Conference (USENIX ATC'14), Garth Gibson and Nickolai Zeldovich (Eds.). USENIX Association, Berkeley, CA, USA, 305-320. [5] Kwei-Jay Lin, \"Consistency issues in real-time database systems,\" in System Sciences, 1989. Vol.II: Software Track, Proceedings of the Twenty-Second Annual Hawaii International Conference on , vol.2, no., pp.654-661 vol.2, 3-6 Jan 1989 doi: 10.1109/HICSS.1989.48069","title":"References ( \u53c2\u8003 )"},{"location":"12/","text":"\u540e\u53f0\u7ef4\u62a4\u4efb\u52a1 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/background_tasks.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813641 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Apache Kudu \u540e\u53f0\u7ef4\u62a4\u4efb\u52a1 Kudu \u4f9d\u8d56\u4e8e\u8bb8\u591a\u91cd\u8981\u7684\u81ea\u52a8\u7ef4\u62a4\u6d3b\u52a8\u8fd0\u884c\u540e\u53f0\u4efb\u52a1\u3002\u8fd9\u4e9b\u4efb\u52a1\u5305\u62ec\u5c06\u6570\u636e\u4ece\u5185\u5b58\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u538b\u7f29\u6570\u636e\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u7b49\u3002 Maintenance manager ( \u7ef4\u62a4\u7ba1\u7406 ) maintenance manager \u5b89\u6392\u5e76\u8fd0\u884c\u540e\u53f0\u4efb\u52a1\u3002\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c maintenance manager \u6839\u636e\u5f53\u65f6\u6240\u9700\u7684\u6539\u8fdb\u6765\u786e\u5b9a\u4e0b\u4e00\u4e2a\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\uff0c\u4f8b\u5982\u51cf\u8f7b\u5185\u5b58\u538b\u529b\uff0c\u63d0\u9ad8\u8bfb\u53d6\u6027\u80fd\u6216\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u3002\u901a\u8fc7\u8bbe\u7f6e --maintenance_manager_num_thread s \u53ef\u4ee5\u63a7\u5236\u4e13\u7528\u4e8e\u8fd0\u884c\u540e\u53f0\u4efb\u52a1\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6570\u3002 Flushing data to disk ( \u5c06\u6570\u636e\u5237\u65b0\u5230\u78c1\u76d8 ) \u4ece\u5185\u5b58\u5230\u78c1\u76d8 flush \u6570\u636e\u53ef\u4ee5\u7f13\u89e3\u5185\u5b58\u538b\u529b\uff0c\u5e76\u53ef\u901a\u8fc7\u4ece MemRowSet \u4e2d\u7684\u5199\u5165\u4f18\u5316\u7684\u9762\u5411\u884c\u7684\u5185\u5b58\u4e2d\u683c\u5f0f\u5207\u6362\u5230\u78c1\u76d8\u4e0a\u8bfb\u53d6\u4f18\u5316\u7684\u4ee5\u5217\u4e3a\u5355\u4f4d\u7684\u683c\u5f0f\u6765\u63d0\u9ad8\u8bfb\u53d6\u6027\u80fd\u3002\u5237\u65b0\u6570\u636e\u7684\u540e\u53f0\u4efb\u52a1\u5305\u62ec FlushMRSOp \u548c FlushDeltaMemStoresOp \u3002 \u4e0e\u8fd9\u4e9b\u64cd\u4f5c\u76f8\u5173\u8054\u7684 metrics \u5206\u522b\u5177\u6709\u524d\u7f00 flush_mrs \u548c flush_dms \u3002 Compacting on-disk data ( \u538b\u7f29\u78c1\u76d8\u6570\u636e ) Kudu \u4e0d\u65ad\u6267\u884c\u51e0\u79cd\u7c7b\u578b\u7684\u538b\u7f29\u4efb\u52a1\uff0c\u4ee5\u4fbf\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u4fdd\u6301\u4e00\u81f4\u7684\u8bfb\u5199\u6027\u80fd\u3002\u5c06\u591a\u4e2a DiskRowSets \u7ec4\u5408\u5230\u4e00\u4e2a DiskRowSet \u4e2d\u7684\u5408\u5e76\u538b\u7f29\u7531 CompactRowSetsOp \u8fd0\u884c\u3002\u8fd8\u53ef\u4ee5\u8fd0\u884c\u4e24\u79cd\u7c7b\u578b\u7684 delta \u5b58\u50a8\u538b\u7f29\u64cd\u4f5c\uff1a MinorDeltaCompactionOp \u548c MajorDeltaCompactionOp \u3002 \u6709\u5173\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u538b\u5b9e\u64cd\u4f5c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Kudu Tablet \u8bbe\u8ba1\u6587\u6863 \u3002 Write-ahead log GC ( \u9884\u5199\u65e5\u5fd7 GC ) Kudu \u6bcf\u4e2a tablet \u7ef4\u62a4\u4e00\u4e2a\u9884\u5148\u8bb0\u5f55\u65e5\u5fd7\uff08 WAL \uff09\uff0c\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684\u5206\u6bb5\u3002\u5f53\u6d3b\u52a8\u6bb5\u8fbe\u5230\u914d\u7f6e\u5927\u5c0f\uff08\u7531 --log_segment_size_mb \u63a7\u5236\uff09\u65f6\uff0c tablet \u4f1a\u5b9a\u671f\u5c06 WAL \u6eda\u52a8\u5230\u65b0\u7684\u65e5\u5fd7\u6bb5\u3002\u4e3a\u4e86\u8282\u7701\u78c1\u76d8\u7a7a\u95f4\u5e76\u51cf\u5c11\u542f\u52a8\u65f6\u95f4\uff0c\u79f0\u4e3a LogGCOp \u7684\u540e\u53f0\u4efb\u52a1\u5c1d\u8bd5\u901a\u8fc7\u4ece\u672c\u5730\u8282\u70b9\u4e0d\u518d\u9700\u8981\u5b83\u4eec\u7684\u6301\u4e45\u6027\u800c\u5c06\u5176\u4ece\u78c1\u76d8\u4e2d\u5220\u9664\uff0c\u4ece\u800c\u5bf9\u5176\u8fdb\u884c\u5783\u573e\u6536\u96c6\uff08 GC \uff09\u65e7\u7684 WAL \u6bb5\u3002 \u4e0e\u6b64\u540e\u53f0\u4efb\u52a1\u76f8\u5173\u8054\u7684 metrics \u5177\u6709\u524d\u7f00 log_gc \u3002 Tablet history GC and the ancient history mark ( tablet \u5386\u53f2GC\u548c\u53e4\u4ee3\u5386\u53f2\u8bb0\u53f7 ) \u56e0\u4e3a Kudu \u4f7f\u7528\u591a\u91cd\u5e76\u53d1\u63a7\u5236\uff08 MVCC \uff09\u673a\u5236\u6765\u786e\u4fdd\u5feb\u7167\u626b\u63cf\u53ef\u4ee5\u4ece\u65b0\u7684\u66f4\u6539\u9694\u79bb\u5230\u4e00\u4e2a\u8868\u4e2d\uff0c\u6240\u4ee5\u5b9a\u671f\u5bf9\u65e7\u7684\u5386\u53f2\u6570\u636e\u8fdb\u884c\u5783\u573e\u56de\u6536\uff08\u5220\u9664\uff09\u4ee5\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u3002\u867d\u7136 Kudu \u4e0d\u4f1a\u5220\u9664\u5728\u6700\u65b0\u7248\u672c\u7684\u6570\u636e\u4e2d\u53ef\u89c1\u7684\u884c\u6216\u6570\u636e\uff0c\u4f46 Kudu \u4f1a\u5220\u9664\u4e0d\u518d\u53ef\u89c1\u7684\u65e7\u66f4\u6539\u7684\u8bb0\u5f55\u3002 \u5386\u53f2\u4e0a\u7684 MVCC \u6570\u636e\u53d8\u5f97\u65e0\u6cd5\u8bbf\u95ee\u5e76\u88ab\u81ea\u7531\u5220\u9664\u7684\u65f6\u95f4\u70b9\u88ab\u79f0\u4e3a\u53e4\u4ee3\u5386\u53f2\u8bb0\u5f55\uff08 AHM \uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e --tablet_history_max_age_sec \u6765\u914d\u7f6e AHM \u3002 \u6709\u4e24\u4e2a\u540e\u53f0\u4efb\u52a1\uff0c GC \u5386\u53f2 MVCC \u6570\u636e\u65e9\u4e8e AHM \uff1a\u8fd0\u884c\u5408\u5e76\u538b\u7f29\uff08\u79f0\u4e3a CompactRowSetsOp \uff08\u89c1\u4e0a\uff09\uff09\u7684\u540e\u53f0\u4efb\u52a1\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5355\u72ec\u7684\u540e\u53f0\u4efb\u52a1\uff0c\u53ef\u4ee5\u5220\u9664\u65e7\u7684\u64a4\u6d88\u589e\u91cf\u5757\uff0c\u79f0\u4e3a UndoDeltaBlockGCOp \u3002\u8fd0\u884c UndoDeltaBlockGCOp \u53ef\u51cf\u5c11\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u7684\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\uff0c\u7279\u522b\u662f\u5728\u66f4\u65b0\u6216\u5347\u7ea7\u7248\u672c\u8f83\u9ad8\u7684\u7cfb\u7edf\u4e2d\u3002 \u4e0e\u6b64\u540e\u53f0\u4efb\u52a1\u76f8\u5173\u8054\u7684 metrics \u5177\u6709\u524d\u7f00 undo_delta_block \u3002","title":"\u540e\u53f0\u7ef4\u62a4\u4efb\u52a1"},{"location":"12/#_1","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/background_tasks.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813641 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u540e\u53f0\u7ef4\u62a4\u4efb\u52a1"},{"location":"12/#apache-kudu","text":"Kudu \u4f9d\u8d56\u4e8e\u8bb8\u591a\u91cd\u8981\u7684\u81ea\u52a8\u7ef4\u62a4\u6d3b\u52a8\u8fd0\u884c\u540e\u53f0\u4efb\u52a1\u3002\u8fd9\u4e9b\u4efb\u52a1\u5305\u62ec\u5c06\u6570\u636e\u4ece\u5185\u5b58\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u538b\u7f29\u6570\u636e\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u7b49\u3002","title":"Apache Kudu \u540e\u53f0\u7ef4\u62a4\u4efb\u52a1"},{"location":"12/#maintenance-manager","text":"maintenance manager \u5b89\u6392\u5e76\u8fd0\u884c\u540e\u53f0\u4efb\u52a1\u3002\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c maintenance manager \u6839\u636e\u5f53\u65f6\u6240\u9700\u7684\u6539\u8fdb\u6765\u786e\u5b9a\u4e0b\u4e00\u4e2a\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\uff0c\u4f8b\u5982\u51cf\u8f7b\u5185\u5b58\u538b\u529b\uff0c\u63d0\u9ad8\u8bfb\u53d6\u6027\u80fd\u6216\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u3002\u901a\u8fc7\u8bbe\u7f6e --maintenance_manager_num_thread s \u53ef\u4ee5\u63a7\u5236\u4e13\u7528\u4e8e\u8fd0\u884c\u540e\u53f0\u4efb\u52a1\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6570\u3002","title":"Maintenance manager ( \u7ef4\u62a4\u7ba1\u7406 )"},{"location":"12/#flushing-data-to-disk","text":"\u4ece\u5185\u5b58\u5230\u78c1\u76d8 flush \u6570\u636e\u53ef\u4ee5\u7f13\u89e3\u5185\u5b58\u538b\u529b\uff0c\u5e76\u53ef\u901a\u8fc7\u4ece MemRowSet \u4e2d\u7684\u5199\u5165\u4f18\u5316\u7684\u9762\u5411\u884c\u7684\u5185\u5b58\u4e2d\u683c\u5f0f\u5207\u6362\u5230\u78c1\u76d8\u4e0a\u8bfb\u53d6\u4f18\u5316\u7684\u4ee5\u5217\u4e3a\u5355\u4f4d\u7684\u683c\u5f0f\u6765\u63d0\u9ad8\u8bfb\u53d6\u6027\u80fd\u3002\u5237\u65b0\u6570\u636e\u7684\u540e\u53f0\u4efb\u52a1\u5305\u62ec FlushMRSOp \u548c FlushDeltaMemStoresOp \u3002 \u4e0e\u8fd9\u4e9b\u64cd\u4f5c\u76f8\u5173\u8054\u7684 metrics \u5206\u522b\u5177\u6709\u524d\u7f00 flush_mrs \u548c flush_dms \u3002","title":"Flushing data to disk ( \u5c06\u6570\u636e\u5237\u65b0\u5230\u78c1\u76d8 )"},{"location":"12/#compacting-on-disk-data","text":"Kudu \u4e0d\u65ad\u6267\u884c\u51e0\u79cd\u7c7b\u578b\u7684\u538b\u7f29\u4efb\u52a1\uff0c\u4ee5\u4fbf\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u4fdd\u6301\u4e00\u81f4\u7684\u8bfb\u5199\u6027\u80fd\u3002\u5c06\u591a\u4e2a DiskRowSets \u7ec4\u5408\u5230\u4e00\u4e2a DiskRowSet \u4e2d\u7684\u5408\u5e76\u538b\u7f29\u7531 CompactRowSetsOp \u8fd0\u884c\u3002\u8fd8\u53ef\u4ee5\u8fd0\u884c\u4e24\u79cd\u7c7b\u578b\u7684 delta \u5b58\u50a8\u538b\u7f29\u64cd\u4f5c\uff1a MinorDeltaCompactionOp \u548c MajorDeltaCompactionOp \u3002 \u6709\u5173\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u538b\u5b9e\u64cd\u4f5c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Kudu Tablet \u8bbe\u8ba1\u6587\u6863 \u3002","title":"Compacting on-disk data ( \u538b\u7f29\u78c1\u76d8\u6570\u636e )"},{"location":"12/#write-ahead-log-gc-gc","text":"Kudu \u6bcf\u4e2a tablet \u7ef4\u62a4\u4e00\u4e2a\u9884\u5148\u8bb0\u5f55\u65e5\u5fd7\uff08 WAL \uff09\uff0c\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684\u5206\u6bb5\u3002\u5f53\u6d3b\u52a8\u6bb5\u8fbe\u5230\u914d\u7f6e\u5927\u5c0f\uff08\u7531 --log_segment_size_mb \u63a7\u5236\uff09\u65f6\uff0c tablet \u4f1a\u5b9a\u671f\u5c06 WAL \u6eda\u52a8\u5230\u65b0\u7684\u65e5\u5fd7\u6bb5\u3002\u4e3a\u4e86\u8282\u7701\u78c1\u76d8\u7a7a\u95f4\u5e76\u51cf\u5c11\u542f\u52a8\u65f6\u95f4\uff0c\u79f0\u4e3a LogGCOp \u7684\u540e\u53f0\u4efb\u52a1\u5c1d\u8bd5\u901a\u8fc7\u4ece\u672c\u5730\u8282\u70b9\u4e0d\u518d\u9700\u8981\u5b83\u4eec\u7684\u6301\u4e45\u6027\u800c\u5c06\u5176\u4ece\u78c1\u76d8\u4e2d\u5220\u9664\uff0c\u4ece\u800c\u5bf9\u5176\u8fdb\u884c\u5783\u573e\u6536\u96c6\uff08 GC \uff09\u65e7\u7684 WAL \u6bb5\u3002 \u4e0e\u6b64\u540e\u53f0\u4efb\u52a1\u76f8\u5173\u8054\u7684 metrics \u5177\u6709\u524d\u7f00 log_gc \u3002","title":"Write-ahead log GC ( \u9884\u5199\u65e5\u5fd7 GC\u00a0)"},{"location":"12/#tablet-history-gc-and-the-ancient-history-mark-tablet-gc","text":"\u56e0\u4e3a Kudu \u4f7f\u7528\u591a\u91cd\u5e76\u53d1\u63a7\u5236\uff08 MVCC \uff09\u673a\u5236\u6765\u786e\u4fdd\u5feb\u7167\u626b\u63cf\u53ef\u4ee5\u4ece\u65b0\u7684\u66f4\u6539\u9694\u79bb\u5230\u4e00\u4e2a\u8868\u4e2d\uff0c\u6240\u4ee5\u5b9a\u671f\u5bf9\u65e7\u7684\u5386\u53f2\u6570\u636e\u8fdb\u884c\u5783\u573e\u56de\u6536\uff08\u5220\u9664\uff09\u4ee5\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u3002\u867d\u7136 Kudu \u4e0d\u4f1a\u5220\u9664\u5728\u6700\u65b0\u7248\u672c\u7684\u6570\u636e\u4e2d\u53ef\u89c1\u7684\u884c\u6216\u6570\u636e\uff0c\u4f46 Kudu \u4f1a\u5220\u9664\u4e0d\u518d\u53ef\u89c1\u7684\u65e7\u66f4\u6539\u7684\u8bb0\u5f55\u3002 \u5386\u53f2\u4e0a\u7684 MVCC \u6570\u636e\u53d8\u5f97\u65e0\u6cd5\u8bbf\u95ee\u5e76\u88ab\u81ea\u7531\u5220\u9664\u7684\u65f6\u95f4\u70b9\u88ab\u79f0\u4e3a\u53e4\u4ee3\u5386\u53f2\u8bb0\u5f55\uff08 AHM \uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e --tablet_history_max_age_sec \u6765\u914d\u7f6e AHM \u3002 \u6709\u4e24\u4e2a\u540e\u53f0\u4efb\u52a1\uff0c GC \u5386\u53f2 MVCC \u6570\u636e\u65e9\u4e8e AHM \uff1a\u8fd0\u884c\u5408\u5e76\u538b\u7f29\uff08\u79f0\u4e3a CompactRowSetsOp \uff08\u89c1\u4e0a\uff09\uff09\u7684\u540e\u53f0\u4efb\u52a1\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5355\u72ec\u7684\u540e\u53f0\u4efb\u52a1\uff0c\u53ef\u4ee5\u5220\u9664\u65e7\u7684\u64a4\u6d88\u589e\u91cf\u5757\uff0c\u79f0\u4e3a UndoDeltaBlockGCOp \u3002\u8fd0\u884c UndoDeltaBlockGCOp \u53ef\u51cf\u5c11\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u7684\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\uff0c\u7279\u522b\u662f\u5728\u66f4\u65b0\u6216\u5347\u7ea7\u7248\u672c\u8f83\u9ad8\u7684\u7cfb\u7edf\u4e2d\u3002 \u4e0e\u6b64\u540e\u53f0\u4efb\u52a1\u76f8\u5173\u8054\u7684 metrics \u5177\u6709\u524d\u7f00 undo_delta_block \u3002","title":"Tablet history GC and the ancient history mark ( tablet \u5386\u53f2GC\u548c\u53e4\u4ee3\u5386\u53f2\u8bb0\u53f7\u00a0)"},{"location":"13/","text":"Kudu \u914d\u7f6e\u53c2\u8003 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/configuration_reference.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813644 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 kudu-master Flags Stable Flags ( \u7a33\u5b9a\u6807\u5fd7 ) \u6807\u8bb0\u4e3a stable ( \u7a33\u5b9a )\u800c\u4e0d\u662f advanced ( \u9ad8\u7ea7 )\u7684\u6807\u5fd7\u53ef\u4ee5\u5b89\u5168\u5730\u7528\u4e8e\u5e38\u89c1\u914d\u7f6e\u4efb\u52a1\u3002 --block_cache_capacity_mb \u5757\u9ad8\u901f\u7f13\u5b58\u5bb9\u91cf\uff08MB\uff09 | Type ( \u7c7b\u578b ) | int64 | | Default ( \u9ed8\u8ba4 ) | 512 | | Tags ( \u6807\u5fd7 ) | stable | --log_force_fsync_all \u6bcf\u6b21\u5199\u5165\u540e\uff0c Log/WAL \u662f\u5426\u5e94\u663e\u5f0f\u8c03\u7528 | Type ( \u7c7b\u578b ) | bool | | Default ( \u9ed8\u8ba4 ) | false | | Tags ( \u6807\u5fd7 ) | stable | --fs_data_dirs \u5177\u6709\u6570\u636e\u5757\u7684\u76ee\u5f55\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002 \u5982\u679c\u6ca1\u6709\u6307\u5b9a\uff0cfs_wal_dir \u5c06\u88ab\u7528\u4f5c\u552f\u4e00\u7684\u6570\u636e\u5757\u76ee\u5f55\u3002 | Type ( \u7c7b\u578b ) | string | | Default ( \u9ed8\u8ba4 ) | none | | Tags ( \u6807\u5fd7 ) | stable | \u76ee\u5f55 2 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001 \u76ee\u5f55 3 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001 \u76ee\u5f55 3 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"Kudu \u914d\u7f6e\u53c2\u8003"},{"location":"13/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/configuration_reference.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813644 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu \u914d\u7f6e\u53c2\u8003"},{"location":"13/#kudu-master-flags","text":"","title":"kudu-master Flags"},{"location":"13/#stable-flags","text":"\u6807\u8bb0\u4e3a stable ( \u7a33\u5b9a )\u800c\u4e0d\u662f advanced ( \u9ad8\u7ea7 )\u7684\u6807\u5fd7\u53ef\u4ee5\u5b89\u5168\u5730\u7528\u4e8e\u5e38\u89c1\u914d\u7f6e\u4efb\u52a1\u3002 --block_cache_capacity_mb \u5757\u9ad8\u901f\u7f13\u5b58\u5bb9\u91cf\uff08MB\uff09 | Type ( \u7c7b\u578b ) | int64 | | Default ( \u9ed8\u8ba4 ) | 512 | | Tags ( \u6807\u5fd7 ) | stable | --log_force_fsync_all \u6bcf\u6b21\u5199\u5165\u540e\uff0c Log/WAL \u662f\u5426\u5e94\u663e\u5f0f\u8c03\u7528 | Type ( \u7c7b\u578b ) | bool | | Default ( \u9ed8\u8ba4 ) | false | | Tags ( \u6807\u5fd7 ) | stable | --fs_data_dirs \u5177\u6709\u6570\u636e\u5757\u7684\u76ee\u5f55\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002 \u5982\u679c\u6ca1\u6709\u6307\u5b9a\uff0cfs_wal_dir \u5c06\u88ab\u7528\u4f5c\u552f\u4e00\u7684\u6570\u636e\u5757\u76ee\u5f55\u3002 | Type ( \u7c7b\u578b ) | string | | Default ( \u9ed8\u8ba4 ) | none | | Tags ( \u6807\u5fd7 ) | stable |","title":"Stable Flags ( \u7a33\u5b9a\u6807\u5fd7 )"},{"location":"13/#2-2","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 2 -\u00a0\u6807\u9898 2"},{"location":"13/#3-2","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 3 -\u00a0\u6807\u9898 2"},{"location":"13/#3-2_1","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 3 -\u00a0\u6807\u9898 2"},{"location":"14/","text":"Kudu \u547d\u4ee4\u884c\u5de5\u5177\u53c2\u8003 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/command_line_tools_reference.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813647 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 \u76ee\u5f55 1 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001 \u76ee\u5f55 2 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001 \u76ee\u5f55 3 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001 \u76ee\u5f55 3 - \u6807\u9898 2 \u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"Kudu \u547d\u4ee4\u884c\u5de5\u5177\u53c2\u8003"},{"location":"14/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/command_line_tools_reference.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813647 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu \u547d\u4ee4\u884c\u5de5\u5177\u53c2\u8003"},{"location":"14/#1-2","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 1 -\u00a0\u6807\u9898 2"},{"location":"14/#2-2","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 2 -\u00a0\u6807\u9898 2"},{"location":"14/#3-2","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 3 -\u00a0\u6807\u9898 2"},{"location":"14/#3-2_1","text":"\u4e22\u96f7\u697c\u67d0 \u3001\u3001\u3001","title":"\u76ee\u5f55 3 -\u00a0\u6807\u9898 2"},{"location":"15/","text":"\u5df2\u77e5\u7684\u95ee\u9898\u548c\u9650\u5236 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/known_issues.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813650 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Schema ( \u67b6\u6784 ) Primary keys ( \u4e3b\u952e ) \u521b\u5efa\u8868\u540e\uff0c\u4e3b\u952e\u53ef\u80fd\u4e0d\u4f1a\u66f4\u6539\u3002\u60a8\u5fc5\u987b\u5220\u9664\u5e76\u91cd\u65b0\u521b\u5efa\u8868\u4ee5\u9009\u62e9\u65b0\u7684\u4e3b\u952e\u3002 \u6784\u6210\u4e3b\u952e\u7684\u5217\u5fc5\u987b\u9996\u5148\u5217\u5728\u6a21\u5f0f\u4e2d\u3002 \u4e00\u884c\u7684\u4e3b\u952e\u53ef\u80fd\u4e0d\u4f1a\u4f7f\u7528 UPDATE \u529f\u80fd\u8fdb\u884c\u4fee\u6539\u3002\u8981\u4fee\u6539\u884c\u7684\u4e3b\u952e\uff0c\u5fc5\u987b\u5220\u9664\u8be5\u884c\u5e76\u4f7f\u7528\u4fee\u6539\u7684\u5bc6\u94a5\u91cd\u65b0\u63d2\u5165\u3002\u8fd9\u6837\u7684\u4fee\u6539\u662f\u975e\u539f\u5b50\u7684\u3002 \u4e0d\u80fd\u4f7f\u7528 DOUBLE \uff0c FLOAT \u6216 BOOL \u7c7b\u578b\u7684\u5217\u4f5c\u4e3a\u4e3b\u952e\u5b9a\u4e49\u7684\u4e00\u90e8\u5206\u3002\u53e6\u5916\uff0c\u4f5c\u4e3a\u4e3b\u952e\u5b9a\u4e49\u7684\u4e00\u90e8\u5206\u7684\u6240\u6709\u5217\u90fd\u5fc5\u987b\u4e3a NULL \u3002 \u4e0d\u652f\u6301\u81ea\u52a8\u751f\u6210\u7684\u4e3b\u952e\u3002 \u7ec4\u5408\u590d\u5408\u4e3b\u952e\u7684\u5355\u5143\u5728 Kudu \u5b8c\u6210\u7684\u5185\u90e8\u590d\u5408\u5bc6\u94a5\u7f16\u7801\u540e\uff0c\u603b\u5171\u9650\u5236\u572816KB\u3002 Columns ( \u5217 ) DECIMAL \uff0c CHAR \uff0c VARCHAR \uff0c DATE \u548c ARRAY \u7b49\u590d\u6742\u7c7b\u578b\u4e0d\u53d7\u652f\u6301\u3002 \u4e0d\u80fd\u901a\u8fc7\u66f4\u6539\u8868\u6765\u66f4\u6539\u73b0\u6709\u5217\u7684\u7c7b\u578b\u548c\u53ef\u7a7a\u6027\u3002 \u8868\u683c\u6700\u591a\u53ef\u4ee5\u6709 300 \u5217\u3002 Tables ( \u8868 ) \u8868\u5fc5\u987b\u6709\u5947\u6570\u4e2a\u526f\u672c\uff0c\u6700\u591a 7 \u4e2a\u3002 \u65e0\u6cd5\u66f4\u6539\u590d\u5236\u56e0\u5b50\uff08\u5728\u8868\u521b\u5efa\u65f6\u8bbe\u7f6e\uff09\u3002 Cells (individual values) ( \u5355\u5143\u683c ( \u4e2a\u4f53\u503c )) \u5728\u7f16\u7801\u6216\u538b\u7f29\u4e4b\u524d\uff0c\u5355\u5143\u683c\u4e0d\u80fd\u5927\u4e8e 64KB \u3002 Other usage limitations ( \u5176\u4ed6\u4f7f\u7528\u9650\u5236 ) Kudu \u4e3b\u8981\u7528\u4e8e\u5206\u6790\u7528\u4f8b\u3002\u5982\u679c\u5355\u884c\u5305\u542b\u591a\u4e2a\u5343\u5b57\u8282\u7684\u6570\u636e\uff0c\u5219\u53ef\u80fd\u4f1a\u9047\u5230\u95ee\u9898\u3002 \u4e0d\u652f\u6301\u8f85\u52a9\u7d22\u5f15\u3002 \u4e0d\u652f\u6301\u591a\u884c\u4e8b\u52a1\u3002 \u4e0d\u652f\u6301\u5173\u7cfb\u529f\u80fd\uff0c\u5982\u5916\u952e\u3002 \u8bf8\u5982\u5217\u548c\u8868\u540d\u79f0\u7684\u6807\u8bc6\u7b26\u88ab\u9650\u5236\u4e3a\u6709\u6548\u7684 UTF-8 \u5b57\u7b26\u4e32\u3002\u53e6\u5916\uff0c\u6267\u884c\u6700\u5927\u957f\u5ea6\u4e3a 256 \u4e2a\u5b57\u7b26\u3002 \u5220\u9664\u5217\u4e0d\u4f1a\u7acb\u5373\u56de\u6536\u7a7a\u95f4\u3002 Compaction \u5fc5\u987b\u5148\u8fd0\u884c\u3002 \u6ca1\u6709\u529e\u6cd5\u624b\u52a8\u8fd0\u884c\u538b\u7f29\uff0c\u4f46\u5220\u9664\u8868\u5c06\u7acb\u5373\u56de\u6536\u7a7a\u95f4\u3002 Partitioning Limitations ( \u5206\u533a\u9650\u5236 ) \u8868\u5fc5\u987b\u4f7f\u7528\u7b80\u5355\u6216\u590d\u5408\u4e3b\u952e\u624b\u52a8\u9884\u5206\u5272\u6210 tablets \u3002\u81ea\u52a8\u62c6\u5206\u8fd8\u4e0d\u53ef\u80fd\u3002\u521b\u5efa\u8868\u540e\uff0c\u53ef\u80fd\u4f1a\u6dfb\u52a0\u6216\u5220\u9664\u8303\u56f4\u5206\u533a\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u6a21\u5f0f\u8bbe\u8ba1 \u3002 \u73b0\u6709\u8868\u4e2d\u7684\u6570\u636e\u5f53\u524d\u65e0\u6cd5\u81ea\u52a8\u91cd\u65b0\u5206\u533a\u3002\u4f5c\u4e3a\u89e3\u51b3\u65b9\u6cd5\uff0c\u4f7f\u7528\u65b0\u7684\u5206\u533a\u521b\u5efa\u4e00\u4e2a\u65b0\u8868\uff0c\u5e76\u63d2\u5165\u65e7\u8868\u7684\u5185\u5bb9\u3002 \u4e22\u5931\u5927\u591a\u6570 replicas \u7684 tablets \uff08\u4f8b\u5982 3 \u4e2d\u5269\u4e0b\u7684 1 \u4e2a\uff09\u9700\u8981\u624b\u52a8\u5e72\u9884\u624d\u80fd\u4fee\u590d\u3002 Cluster management ( \u96c6\u7fa4\u7ba1\u7406 ) Rack awareness ( \u673a\u67b6\u610f\u8bc6 ) \u4e0d\u53d7\u652f\u6301\u3002 \u4e0d\u652f\u6301 Multi-datacenter ( \u591a\u6570\u636e\u4e2d\u5fc3 )\u3002 \u4e0d\u652f\u6301 Rolling restart ( \u6eda\u52a8\u91cd\u65b0\u542f\u52a8 )\u3002 Server management ( \u670d\u52a1\u5668\u7ba1\u7406 ) \u751f\u4ea7\u90e8\u7f72\u5e94\u4e3a tablet servers \u914d\u7f6e\u81f3\u5c11 4GB \u7684\u5185\u5b58\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\u5e94\u4e3a 10GB \u4ee5\u4e0a\u3002 \u5199\u5165\u65e5\u5fd7\uff08 WAL \uff09\u53ea\u80fd\u5b58\u50a8\u5728\u4e00\u4e2a\u78c1\u76d8\u4e0a\u3002 \u4e0d\u80fd\u5bb9\u5fcd\u78c1\u76d8\u6545\u969c\uff0c\u4e00\u65e6\u68c0\u6d4b\u5230 tablet server \u5c31\u4f1a\u5d29\u6e83\u3002 \u65e0\u6cd5\u6062\u590d\u6570\u636e\u7684\u78c1\u76d8\u6545\u969c\u9700\u8981\u683c\u5f0f\u5316\u8be5 tablet server \u7684\u6240\u6709 Kudu \u6570\u636e\uff0c\u624d\u80fd\u518d\u6b21\u542f\u52a8\u3002 \u6570\u636e\u76ee\u5f55\u65e0\u6cd5 \u6dfb\u52a0/\u5220\u9664 ;\u6240\u6709\u8fd9\u4e9b\u90fd\u5fc5\u987b\u91cd\u65b0\u683c\u5f0f\u5316\u4ee5\u66f4\u6539\u76ee\u5f55\u96c6\u3002 tablet servers \u65e0\u6cd5\u6b63\u5e38 decommissioned \u3002 tablet servers \u65e0\u6cd5\u66f4\u6539\u5730\u5740/\u7aef\u53e3\u3002 Kudu \u5bf9\u4e8e\u6700\u65b0\u7684 NTP \u5177\u6709\u4e25\u683c\u7684\u8981\u6c42\u3002 Kudu \u7684 master \u548c tablet servers \u5728\u4e0d\u540c\u6b65\u65f6\u4f1a\u5d29\u6e83\u3002 Kudu \u7248\u672c\u53ea\u80fd\u4f7f\u7528 NTP \u8fdb\u884c\u6d4b\u8bd5\u3002\u5176\u4ed6\u65f6\u95f4\u540c\u6b65\u63d0\u4f9b\u5546\uff0c\u5982 Chrony \u53ef\u80fd\u6216\u53ef\u80fd\u4e0d\u5de5\u4f5c\u3002 Scale ( \u89c4\u6a21 ) \u63a8\u8350\u7684\u6700\u5927\u6570\u91cf\u7684 tablet servers \u662f 100 \u3002 \u5efa\u8bae\u7684\u6700\u5927 masters \u6570\u662f 3 \u3002 \u63a8\u8350\u7684\u6700\u5927\u6570\u91cf\u7684\u5b58\u50a8\u6570\u636e\uff0c\u590d\u5236\u540e\u548c\u538b\u7f29\u540e\u6bcf\u4e2a tablet server \u662f 4TB \u3002 \u6bcf\u4e2a tablet server \u7684\u6700\u5927\u5e73\u5747 tablets \u63a8\u8350\u6570\u91cf\u4e3a 1000 \u6b21\uff0c post-replication \u3002 \u6bcf\u4e2a tablet server \u7684\u6bcf\u4e2a\u8868\u7684\u6700\u5927 tablet \u6570\u662f 60 \uff0c\u590d\u5236\u540e\uff0c\u521b\u5efa\u8868\u3002 Replication and Backup Limitations ( \u590d\u5236\u548c\u5907\u4efd\u9650\u5236 ) Kudu \u5f53\u524d\u4e0d\u5305\u62ec\u7528\u4e8e\u5907\u4efd\u548c\u8fd8\u539f\u7684\u4efb\u4f55\u5185\u7f6e\u529f\u80fd\u3002\u9f13\u52b1\u7528\u6237\u4f7f\u7528 Spark \u6216 Impala \u7b49\u5de5\u5177\uff0c\u6839\u636e\u9700\u8981\u5bfc\u51fa\u6216\u5bfc\u5165\u8868\u683c\u3002 Security Limitations ( \u5b89\u5168\u9650\u5236 ) \u6388\u6743\u4ec5\u5728\u5168\u7cfb\u7edf\uff0c\u7c97\u7c92\u5ea6\u7ea7\u522b\u63d0\u4f9b\u3002\u8868\u7ea7\uff0c\u5217\u7ea7\u548c\u884c\u7ea7\u6388\u6743\u529f\u80fd\u4e0d\u53ef\u7528\u3002 \u636e\u62a5\u9053\uff0c Kudu \u5df2\u7ecf\u62a5\u544a\u5728\u4f7f\u7528\u672c\u5730\u5757\u8bbe\u5907\u52a0\u5bc6\uff08\u4f8b\u5982 dmcrypt \uff09\u7684\u7cfb\u7edf\u4e0a\u6b63\u786e\u8fd0\u884c Kudu \u3002 Kudu \u670d\u52a1\u5668 Kerberos principals \u5fc5\u987b\u9075\u5faa\u6a21\u5f0f kudu/<HOST>@DEFAULT.REALM \u3002\u4e0d\u652f\u6301\u914d\u7f6e\u5907\u7528 Kerberos principal \u3002 Kudu \u4e0e Apache Flume \u7684\u96c6\u6210\u4e0d\u652f\u6301\u5199\u5165\u9700\u8981 Kerberos \u8ba4\u8bc1\u7684 Kudu \u96c6\u7fa4\u3002 \u9996\u6b21\u8054\u7cfb\u7fa4\u96c6\u65f6\uff0c Kudu \u5ba2\u6237\u7aef\u5b9e\u4f8b\u5c06\u68c0\u7d22\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u3002\u8fd9\u4e9b\u4ee4\u724c\u5728\u4e00\u5468\u540e\u5230\u671f\u3002\u4f7f\u7528\u5355\u4e2a Kudu \u5ba2\u6237\u7aef\u5b9e\u4f8b\u8d85\u8fc7\u4e00\u5468\u4ec5\u7531 C ++ \u5ba2\u6237\u7aef\u652f\u6301\uff0c\u4f46\u4e0d\u53d7 Java \u5ba2\u6237\u7aef\u7684\u652f\u6301\u3002 Other Known Issues ( \u5176\u4ed6\u5df2\u77e5\u95ee\u9898 ) \u4ee5\u4e0b\u662f Kudu \u5f53\u524d\u7248\u672c\u7684\u5df2\u77e5\u9519\u8bef\u548c\u95ee\u9898\u3002\u4ed6\u4eec\u5c06\u5728\u4ee5\u540e\u7684\u7248\u672c\u4e2d\u89e3\u51b3\u3002\u8bf7\u6ce8\u610f\uff0c\u6b64\u5217\u8868\u5e76\u4e0d\u8be6\u5c3d\uff0c\u4ec5\u7528\u4e8e\u6c9f\u901a\u6700\u91cd\u8981\u7684\u5df2\u77e5\u95ee\u9898\u3002 \u5982\u679c Kudu master \u914d\u7f6e\u4e86 -log_force_fsync_all \u9009\u9879\uff0c\u5219 tablet server \u548c\u5ba2\u6237\u7aef\u5c06\u7ecf\u5386\u9891\u7e41\u7684\u8d85\u65f6\uff0c\u5e76\u4e14\u96c6\u7fa4\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\u3002 \u5982\u679c tablet servers \u7684 tablet \u6570\u91cf\u5f88\u591a\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u542f\u52a8\u3002\u5efa\u8bae\u5c06\u6bcf\u53f0\u670d\u52a1\u5668\u7684 tablet \u6570\u91cf\u9650\u5236\u5728 100 \u4e2a\u4ee5\u4e0b\u3002\u5728\u5206\u5272\u8868\u683c\u65f6\u8003\u8651\u8fd9\u4e2a\u9650\u5236\u3002\u5982\u679c\u60a8\u6ce8\u610f\u5230\u542f\u52a8\u65f6\u95f4\u8f83\u6162\uff0c\u5219\u53ef\u4ee5\u76d1\u63a7 Web UI \u4e2d\u6bcf\u4e2a\u670d\u52a1\u5668\u7684 tablets \u6570\u91cf\u3002 \u5728 hostname \u4e2d\u5305\u542b\u5927\u5199\u5b57\u6bcd\u7684 hosts \u4e0a\uff0c Kerberos \u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u4e0d\u6b63\u786e\u3002 \u5982\u679c\u5728 krb5.conf \u4e2d\u914d\u7f6e\u4e86 rdns = false \uff0c\u5219 Kerberos \u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u4e0d\u6b63\u5e38\u3002","title":"\u5df2\u77e5\u7684\u95ee\u9898\u548c\u9650\u5236"},{"location":"15/#_1","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/known_issues.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813650 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u5df2\u77e5\u7684\u95ee\u9898\u548c\u9650\u5236"},{"location":"15/#schema","text":"","title":"Schema ( \u67b6\u6784 )"},{"location":"15/#primary-keys","text":"\u521b\u5efa\u8868\u540e\uff0c\u4e3b\u952e\u53ef\u80fd\u4e0d\u4f1a\u66f4\u6539\u3002\u60a8\u5fc5\u987b\u5220\u9664\u5e76\u91cd\u65b0\u521b\u5efa\u8868\u4ee5\u9009\u62e9\u65b0\u7684\u4e3b\u952e\u3002 \u6784\u6210\u4e3b\u952e\u7684\u5217\u5fc5\u987b\u9996\u5148\u5217\u5728\u6a21\u5f0f\u4e2d\u3002 \u4e00\u884c\u7684\u4e3b\u952e\u53ef\u80fd\u4e0d\u4f1a\u4f7f\u7528 UPDATE \u529f\u80fd\u8fdb\u884c\u4fee\u6539\u3002\u8981\u4fee\u6539\u884c\u7684\u4e3b\u952e\uff0c\u5fc5\u987b\u5220\u9664\u8be5\u884c\u5e76\u4f7f\u7528\u4fee\u6539\u7684\u5bc6\u94a5\u91cd\u65b0\u63d2\u5165\u3002\u8fd9\u6837\u7684\u4fee\u6539\u662f\u975e\u539f\u5b50\u7684\u3002 \u4e0d\u80fd\u4f7f\u7528 DOUBLE \uff0c FLOAT \u6216 BOOL \u7c7b\u578b\u7684\u5217\u4f5c\u4e3a\u4e3b\u952e\u5b9a\u4e49\u7684\u4e00\u90e8\u5206\u3002\u53e6\u5916\uff0c\u4f5c\u4e3a\u4e3b\u952e\u5b9a\u4e49\u7684\u4e00\u90e8\u5206\u7684\u6240\u6709\u5217\u90fd\u5fc5\u987b\u4e3a NULL \u3002 \u4e0d\u652f\u6301\u81ea\u52a8\u751f\u6210\u7684\u4e3b\u952e\u3002 \u7ec4\u5408\u590d\u5408\u4e3b\u952e\u7684\u5355\u5143\u5728 Kudu \u5b8c\u6210\u7684\u5185\u90e8\u590d\u5408\u5bc6\u94a5\u7f16\u7801\u540e\uff0c\u603b\u5171\u9650\u5236\u572816KB\u3002","title":"Primary keys ( \u4e3b\u952e )"},{"location":"15/#columns","text":"DECIMAL \uff0c CHAR \uff0c VARCHAR \uff0c DATE \u548c ARRAY \u7b49\u590d\u6742\u7c7b\u578b\u4e0d\u53d7\u652f\u6301\u3002 \u4e0d\u80fd\u901a\u8fc7\u66f4\u6539\u8868\u6765\u66f4\u6539\u73b0\u6709\u5217\u7684\u7c7b\u578b\u548c\u53ef\u7a7a\u6027\u3002 \u8868\u683c\u6700\u591a\u53ef\u4ee5\u6709 300 \u5217\u3002","title":"Columns ( \u5217 )"},{"location":"15/#tables","text":"\u8868\u5fc5\u987b\u6709\u5947\u6570\u4e2a\u526f\u672c\uff0c\u6700\u591a 7 \u4e2a\u3002 \u65e0\u6cd5\u66f4\u6539\u590d\u5236\u56e0\u5b50\uff08\u5728\u8868\u521b\u5efa\u65f6\u8bbe\u7f6e\uff09\u3002","title":"Tables ( \u8868 )"},{"location":"15/#cells-individual-values","text":"\u5728\u7f16\u7801\u6216\u538b\u7f29\u4e4b\u524d\uff0c\u5355\u5143\u683c\u4e0d\u80fd\u5927\u4e8e 64KB \u3002","title":"Cells (individual values) ( \u5355\u5143\u683c ( \u4e2a\u4f53\u503c ))"},{"location":"15/#other-usage-limitations","text":"Kudu \u4e3b\u8981\u7528\u4e8e\u5206\u6790\u7528\u4f8b\u3002\u5982\u679c\u5355\u884c\u5305\u542b\u591a\u4e2a\u5343\u5b57\u8282\u7684\u6570\u636e\uff0c\u5219\u53ef\u80fd\u4f1a\u9047\u5230\u95ee\u9898\u3002 \u4e0d\u652f\u6301\u8f85\u52a9\u7d22\u5f15\u3002 \u4e0d\u652f\u6301\u591a\u884c\u4e8b\u52a1\u3002 \u4e0d\u652f\u6301\u5173\u7cfb\u529f\u80fd\uff0c\u5982\u5916\u952e\u3002 \u8bf8\u5982\u5217\u548c\u8868\u540d\u79f0\u7684\u6807\u8bc6\u7b26\u88ab\u9650\u5236\u4e3a\u6709\u6548\u7684 UTF-8 \u5b57\u7b26\u4e32\u3002\u53e6\u5916\uff0c\u6267\u884c\u6700\u5927\u957f\u5ea6\u4e3a 256 \u4e2a\u5b57\u7b26\u3002 \u5220\u9664\u5217\u4e0d\u4f1a\u7acb\u5373\u56de\u6536\u7a7a\u95f4\u3002 Compaction \u5fc5\u987b\u5148\u8fd0\u884c\u3002 \u6ca1\u6709\u529e\u6cd5\u624b\u52a8\u8fd0\u884c\u538b\u7f29\uff0c\u4f46\u5220\u9664\u8868\u5c06\u7acb\u5373\u56de\u6536\u7a7a\u95f4\u3002","title":"Other usage limitations \u00a0( \u5176\u4ed6\u4f7f\u7528\u9650\u5236 )"},{"location":"15/#partitioning-limitations","text":"\u8868\u5fc5\u987b\u4f7f\u7528\u7b80\u5355\u6216\u590d\u5408\u4e3b\u952e\u624b\u52a8\u9884\u5206\u5272\u6210 tablets \u3002\u81ea\u52a8\u62c6\u5206\u8fd8\u4e0d\u53ef\u80fd\u3002\u521b\u5efa\u8868\u540e\uff0c\u53ef\u80fd\u4f1a\u6dfb\u52a0\u6216\u5220\u9664\u8303\u56f4\u5206\u533a\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u6a21\u5f0f\u8bbe\u8ba1 \u3002 \u73b0\u6709\u8868\u4e2d\u7684\u6570\u636e\u5f53\u524d\u65e0\u6cd5\u81ea\u52a8\u91cd\u65b0\u5206\u533a\u3002\u4f5c\u4e3a\u89e3\u51b3\u65b9\u6cd5\uff0c\u4f7f\u7528\u65b0\u7684\u5206\u533a\u521b\u5efa\u4e00\u4e2a\u65b0\u8868\uff0c\u5e76\u63d2\u5165\u65e7\u8868\u7684\u5185\u5bb9\u3002 \u4e22\u5931\u5927\u591a\u6570 replicas \u7684 tablets \uff08\u4f8b\u5982 3 \u4e2d\u5269\u4e0b\u7684 1 \u4e2a\uff09\u9700\u8981\u624b\u52a8\u5e72\u9884\u624d\u80fd\u4fee\u590d\u3002","title":"Partitioning Limitations ( \u5206\u533a\u9650\u5236 )"},{"location":"15/#cluster-management","text":"Rack awareness ( \u673a\u67b6\u610f\u8bc6 ) \u4e0d\u53d7\u652f\u6301\u3002 \u4e0d\u652f\u6301 Multi-datacenter ( \u591a\u6570\u636e\u4e2d\u5fc3 )\u3002 \u4e0d\u652f\u6301 Rolling restart ( \u6eda\u52a8\u91cd\u65b0\u542f\u52a8 )\u3002","title":"Cluster management ( \u96c6\u7fa4\u7ba1\u7406\u00a0)"},{"location":"15/#server-management","text":"\u751f\u4ea7\u90e8\u7f72\u5e94\u4e3a tablet servers \u914d\u7f6e\u81f3\u5c11 4GB \u7684\u5185\u5b58\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\u5e94\u4e3a 10GB \u4ee5\u4e0a\u3002 \u5199\u5165\u65e5\u5fd7\uff08 WAL \uff09\u53ea\u80fd\u5b58\u50a8\u5728\u4e00\u4e2a\u78c1\u76d8\u4e0a\u3002 \u4e0d\u80fd\u5bb9\u5fcd\u78c1\u76d8\u6545\u969c\uff0c\u4e00\u65e6\u68c0\u6d4b\u5230 tablet server \u5c31\u4f1a\u5d29\u6e83\u3002 \u65e0\u6cd5\u6062\u590d\u6570\u636e\u7684\u78c1\u76d8\u6545\u969c\u9700\u8981\u683c\u5f0f\u5316\u8be5 tablet server \u7684\u6240\u6709 Kudu \u6570\u636e\uff0c\u624d\u80fd\u518d\u6b21\u542f\u52a8\u3002 \u6570\u636e\u76ee\u5f55\u65e0\u6cd5 \u6dfb\u52a0/\u5220\u9664 ;\u6240\u6709\u8fd9\u4e9b\u90fd\u5fc5\u987b\u91cd\u65b0\u683c\u5f0f\u5316\u4ee5\u66f4\u6539\u76ee\u5f55\u96c6\u3002 tablet servers \u65e0\u6cd5\u6b63\u5e38 decommissioned \u3002 tablet servers \u65e0\u6cd5\u66f4\u6539\u5730\u5740/\u7aef\u53e3\u3002 Kudu \u5bf9\u4e8e\u6700\u65b0\u7684 NTP \u5177\u6709\u4e25\u683c\u7684\u8981\u6c42\u3002 Kudu \u7684 master \u548c tablet servers \u5728\u4e0d\u540c\u6b65\u65f6\u4f1a\u5d29\u6e83\u3002 Kudu \u7248\u672c\u53ea\u80fd\u4f7f\u7528 NTP \u8fdb\u884c\u6d4b\u8bd5\u3002\u5176\u4ed6\u65f6\u95f4\u540c\u6b65\u63d0\u4f9b\u5546\uff0c\u5982 Chrony \u53ef\u80fd\u6216\u53ef\u80fd\u4e0d\u5de5\u4f5c\u3002","title":"Server management ( \u670d\u52a1\u5668\u7ba1\u7406\u00a0)"},{"location":"15/#scale","text":"\u63a8\u8350\u7684\u6700\u5927\u6570\u91cf\u7684 tablet servers \u662f 100 \u3002 \u5efa\u8bae\u7684\u6700\u5927 masters \u6570\u662f 3 \u3002 \u63a8\u8350\u7684\u6700\u5927\u6570\u91cf\u7684\u5b58\u50a8\u6570\u636e\uff0c\u590d\u5236\u540e\u548c\u538b\u7f29\u540e\u6bcf\u4e2a tablet server \u662f 4TB \u3002 \u6bcf\u4e2a tablet server \u7684\u6700\u5927\u5e73\u5747 tablets \u63a8\u8350\u6570\u91cf\u4e3a 1000 \u6b21\uff0c post-replication \u3002 \u6bcf\u4e2a tablet server \u7684\u6bcf\u4e2a\u8868\u7684\u6700\u5927 tablet \u6570\u662f 60 \uff0c\u590d\u5236\u540e\uff0c\u521b\u5efa\u8868\u3002","title":"Scale ( \u89c4\u6a21\u00a0)"},{"location":"15/#replication-and-backup-limitations","text":"Kudu \u5f53\u524d\u4e0d\u5305\u62ec\u7528\u4e8e\u5907\u4efd\u548c\u8fd8\u539f\u7684\u4efb\u4f55\u5185\u7f6e\u529f\u80fd\u3002\u9f13\u52b1\u7528\u6237\u4f7f\u7528 Spark \u6216 Impala \u7b49\u5de5\u5177\uff0c\u6839\u636e\u9700\u8981\u5bfc\u51fa\u6216\u5bfc\u5165\u8868\u683c\u3002","title":"Replication and Backup Limitations ( \u590d\u5236\u548c\u5907\u4efd\u9650\u5236\u00a0)"},{"location":"15/#security-limitations","text":"\u6388\u6743\u4ec5\u5728\u5168\u7cfb\u7edf\uff0c\u7c97\u7c92\u5ea6\u7ea7\u522b\u63d0\u4f9b\u3002\u8868\u7ea7\uff0c\u5217\u7ea7\u548c\u884c\u7ea7\u6388\u6743\u529f\u80fd\u4e0d\u53ef\u7528\u3002 \u636e\u62a5\u9053\uff0c Kudu \u5df2\u7ecf\u62a5\u544a\u5728\u4f7f\u7528\u672c\u5730\u5757\u8bbe\u5907\u52a0\u5bc6\uff08\u4f8b\u5982 dmcrypt \uff09\u7684\u7cfb\u7edf\u4e0a\u6b63\u786e\u8fd0\u884c Kudu \u3002 Kudu \u670d\u52a1\u5668 Kerberos principals \u5fc5\u987b\u9075\u5faa\u6a21\u5f0f kudu/<HOST>@DEFAULT.REALM \u3002\u4e0d\u652f\u6301\u914d\u7f6e\u5907\u7528 Kerberos principal \u3002 Kudu \u4e0e Apache Flume \u7684\u96c6\u6210\u4e0d\u652f\u6301\u5199\u5165\u9700\u8981 Kerberos \u8ba4\u8bc1\u7684 Kudu \u96c6\u7fa4\u3002 \u9996\u6b21\u8054\u7cfb\u7fa4\u96c6\u65f6\uff0c Kudu \u5ba2\u6237\u7aef\u5b9e\u4f8b\u5c06\u68c0\u7d22\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u3002\u8fd9\u4e9b\u4ee4\u724c\u5728\u4e00\u5468\u540e\u5230\u671f\u3002\u4f7f\u7528\u5355\u4e2a Kudu \u5ba2\u6237\u7aef\u5b9e\u4f8b\u8d85\u8fc7\u4e00\u5468\u4ec5\u7531 C ++ \u5ba2\u6237\u7aef\u652f\u6301\uff0c\u4f46\u4e0d\u53d7 Java \u5ba2\u6237\u7aef\u7684\u652f\u6301\u3002","title":"Security Limitations ( \u5b89\u5168\u9650\u5236 )"},{"location":"15/#other-known-issues","text":"\u4ee5\u4e0b\u662f Kudu \u5f53\u524d\u7248\u672c\u7684\u5df2\u77e5\u9519\u8bef\u548c\u95ee\u9898\u3002\u4ed6\u4eec\u5c06\u5728\u4ee5\u540e\u7684\u7248\u672c\u4e2d\u89e3\u51b3\u3002\u8bf7\u6ce8\u610f\uff0c\u6b64\u5217\u8868\u5e76\u4e0d\u8be6\u5c3d\uff0c\u4ec5\u7528\u4e8e\u6c9f\u901a\u6700\u91cd\u8981\u7684\u5df2\u77e5\u95ee\u9898\u3002 \u5982\u679c Kudu master \u914d\u7f6e\u4e86 -log_force_fsync_all \u9009\u9879\uff0c\u5219 tablet server \u548c\u5ba2\u6237\u7aef\u5c06\u7ecf\u5386\u9891\u7e41\u7684\u8d85\u65f6\uff0c\u5e76\u4e14\u96c6\u7fa4\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\u3002 \u5982\u679c tablet servers \u7684 tablet \u6570\u91cf\u5f88\u591a\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u542f\u52a8\u3002\u5efa\u8bae\u5c06\u6bcf\u53f0\u670d\u52a1\u5668\u7684 tablet \u6570\u91cf\u9650\u5236\u5728 100 \u4e2a\u4ee5\u4e0b\u3002\u5728\u5206\u5272\u8868\u683c\u65f6\u8003\u8651\u8fd9\u4e2a\u9650\u5236\u3002\u5982\u679c\u60a8\u6ce8\u610f\u5230\u542f\u52a8\u65f6\u95f4\u8f83\u6162\uff0c\u5219\u53ef\u4ee5\u76d1\u63a7 Web UI \u4e2d\u6bcf\u4e2a\u670d\u52a1\u5668\u7684 tablets \u6570\u91cf\u3002 \u5728 hostname \u4e2d\u5305\u542b\u5927\u5199\u5b57\u6bcd\u7684 hosts \u4e0a\uff0c Kerberos \u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u4e0d\u6b63\u786e\u3002 \u5982\u679c\u5728 krb5.conf \u4e2d\u914d\u7f6e\u4e86 rdns = false \uff0c\u5219 Kerberos \u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u4e0d\u6b63\u5e38\u3002","title":"Other Known Issues ( \u5176\u4ed6\u5df2\u77e5\u95ee\u9898\u00a0)"},{"location":"16/","text":"\u8d21\u732e\u4e8e Kudu \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/contributing.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813653 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Contributing Patches Using Gerrit ( \u4f7f\u7528 Gerrit \u8d21\u732e\u8865\u4e01 ) Kudu \u56e2\u961f\u4f7f\u7528 Gerrit \u8fdb\u884c\u4ee3\u7801\u5ba1\u67e5\uff0c\u800c\u4e0d\u662f Github pull requests \u3002\u901a\u5e38\uff0c\u60a8\u4ece Github pull \uff0c\u4f46\u662f push \u5230 Gerrit \uff0c Gerrit \u7528\u4e8e\u67e5\u770b\u4ee3\u7801\u5e76\u5c06\u5176\u5408\u5e76\u5230 Github \u4e2d\u3002 \u6709\u5173\u4f7f\u7528 Gerrit \u8fdb\u884c\u4ee3\u7801\u5ba1\u67e5\u7684\u6982\u8ff0\uff0c\u8bf7\u53c2\u9605 Gerrit \u6559\u7a0b \u3002 Gerrit \u7684\u521d\u59cb\u8bbe\u7f6e \u4f7f\u7528\u60a8\u7684 Github \u7528\u6237\u540d\u767b\u5f55 Gerrit \u3002 \u524d\u5f80 Setting \u3002\u5728 Contact Information \u9875\u9762\u4e0a\u66f4\u65b0\u60a8\u7684\u59d3\u540d\u548c\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u5e76\u4e0a\u4f20 SSH \u516c\u94a5\u3002\u5982\u679c\u60a8\u4e0d\u66f4\u65b0\u60a8\u7684\u59d3\u540d\uff0c\u5b83\u5c06\u5728 Gerrit \u8bc4\u8bba\u4e2d\u663e\u793a\u4e3a \u201cAnonymous Coward\u201d \u3002 \u5982\u679c\u8fd8\u6ca1\u6709\u8fd9\u6837\u505a\uff0c\u8bf7 clone the main Kudu repository \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c main remote \u79f0\u4e3a origin \u3002\u5f53\u4f60 fetch \u6216 pull \uff0c\u4f60\u4f1a\u4ece origin \u8fd9\u6837\u505a\u3002 git clone https://github.com/apache/kudu \u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 \u6dfb\u52a0 gerrit remote \u3002\u5728\u4ee5\u4e0b\u547d\u4ee4\u4e2d\uff0c\u7528\u60a8\u7684 Github \u7528\u6237\u540d\u66ff\u6362 <username> \u3002 git remote add gerrit ssh://&lt;username&gt;@gerrit.cloudera.org:29418/kudu \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b89\u88c5 Gerrit commit-msg hook \u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff0c\u7528\u60a8\u7684 Github \u7528\u6237\u540d\u66ff\u6362 <username> \u3002 gitdir=$(git rev-parse --git-dir); scp -p -P 29418 &lt;username&gt;@gerrit.cloudera.org:hooks/commit-msg ${gitdir}/hooks/ \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u60a8\u5df2\u7ecf\u8bbe\u7f6e\u4e86 Kudu \u5b58\u50a8\u5e93\u4f7f\u7528 pull -rebase \u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4e24\u4e2a\u547d\u4ee4\uff0c\u5047\u8bbe\u60a8\u81f3\u4eca\u5df2\u7ecf\u68c0\u67e5\u8fc7\u4e3b\u673a\uff1a git config branch.autosetuprebase always git config branch.master.rebase true \u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u60a8\u5df2\u7ecf checked out branches \u800c\u4e0d\u662f master \uff0c\u8bf7\u5728\u4e0a\u9762\u7684\u7b2c\u4e8c\u4e2a\u547d\u4ee4\u4e2d\u66ff\u6362 master \u4ee5\u83b7\u53d6 other branch names \u3002 Submitting Patches ( \u63d0\u4ea4\u8865\u4e01 ) \u8981\u63d0\u4ea4\u4fee\u8865\u7a0b\u5e8f\uff0c\u9996\u5148\u63d0\u4ea4\u60a8\u7684\u66f4\u6539\uff08\u5982\u679c\u53ef\u80fd\uff0c\u4f7f\u7528\u63cf\u8ff0\u6027\u591a\u884c\u63d0\u4ea4\u6d88\u606f\uff09\uff0c\u7136\u540e\u5c06\u8bf7\u6c42 push \u5230 gerrit remote \u3002\u4f8b\u5982\uff0c\u8981\u5c06\u66f4\u6539\u63a8\u9001\u5230 master \u5206\u652f\uff1a git push gerrit HEAD:refs/for/master --no-thin \u6216\u8005\u5c06\u66f4\u6539 push \u5230 gh-pages \u5206\u652f ( \u66f4\u65b0\u7f51\u9875 )\uff1a git push gerrit HEAD:refs/for/gh-pages --no-thin \u6ce8\u610f \u5728\u51c6\u5907\u4e00\u4e2a\u4fee\u8865\u7a0b\u5e8f\u8fdb\u884c\u5ba1\u67e5\u65f6\uff0c\u6700\u597d \u9075\u5faa\u901a\u7528 git \u63d0\u4ea4\u51c6\u5219\u548c\u826f\u597d\u505a\u6cd5 \u3002 \u6ce8\u610f --no-thin \u53c2\u6570\u662f\u9632\u6b62 Gerrit \u4e2d\u7684\u9519\u8bef\u7684\u89e3\u51b3\u65b9\u6cd5\u3002\u8bf7\u53c2\u9605 \u6ce8\u610f \u8003\u8651\u4e3a\u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa Git \u522b\u540d\u3002 Gerrit \u8fd8\u5305\u62ec\u4e00\u4e2a\u540d\u4e3a git-review \u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u60a8\u53ef\u80fd\u4f1a\u53d1\u73b0\u6709\u7528\u3002 Gerrit \u4f1a\u5728\u60a8\u7684\u63d0\u4ea4\u6d88\u606f\u4e2d\u6dfb\u52a0\u66f4\u6539 ID \uff0c\u5e76\u521b\u5efa\u4e00\u4e2a Gerrit review \uff0c\u5176 URL \u5c06\u4f5c\u4e3a\u63a8\u9001\u56de\u590d\u7684\u4e00\u90e8\u5206\u53d1\u5e03\u3002\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u5411 kudu-dev \u90ae\u4ef6\u5217\u8868\u53d1\u9001\u6d88\u606f\uff0c\u89e3\u91ca\u8865\u4e01\u5e76\u8bf7\u6c42 review \u3002 \u83b7\u5f97\u53cd\u9988\u540e\uff0c\u60a8\u53ef\u4ee5\u66f4\u6539\u6216\u4fee\u6539\u60a8\u7684\u63d0\u4ea4\uff08\u4f8b\u5982\uff0c\u4f7f\u7528\u50cf git commit --amend \u8fd9\u6837\u7684\u547d\u4ee4\uff09\uff0c\u540c\u65f6\u4fdd\u7559\u66f4\u6539 ID \u3002\u5c06\u60a8\u7684\u66f4\u6539\u518d\u6b21 push \u7ed9 Gerrit \uff0c\u8fd9\u5c06\u5728 Gerrit \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4fee\u8865\u7a0b\u5e8f\uff0c\u5e76\u901a\u77e5\u6240\u6709\u5ba1\u9605\u8005\u6709\u5173\u66f4\u6539\u3002 \u5f53\u60a8\u7684\u4ee3\u7801\u7ecf\u8fc7\u5ba1\u67e5\u5e76\u51c6\u5907\u5408\u5e76\u5230 Kudu \u4ee3\u7801\u5e93\u540e\uff0c Kudu \u63d0\u4ea4\u8005\u5c06\u4f7f\u7528 Gerrit \u8fdb\u884c\u5408\u5e76\u3002\u4f60\u53ef\u4ee5\u4e22\u5f03\u4f60\u7684 local branch \u3002 Abandoning a Review ( \u653e\u5f03 review ) \u5982\u679c\u60a8\u7684\u8865\u4e01\u4e0d\u88ab\u63a5\u53d7\u6216\u60a8\u51b3\u5b9a\u4ece\u8003\u8651\u4e2d\u63d0\u53d6\u8865\u4e01\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 Gerrit UI \u653e\u5f03\u8865\u4e01\u3002\u5b83\u4ecd\u5c06\u5728 Gerrit \u7684\u5386\u53f2\u4e0a\u5c55\u793a\uff0c\u4f46\u4e0d\u4f1a\u88ab\u5217\u4e3a\u5f85\u5ba1\u67e5\u3002 Reviewing Patches In Gerrit ( \u5ba1\u67e5 Gerrit \u4e2d\u7684\u8865\u4e01 ) \u60a8\u53ef\u4ee5\u4f7f\u7528 Web UI \u67e5\u770b Gerrit \u4e2d\u7684\u7edf\u4e00\u6216\u5e76\u884c\u5dee\u5f02\u66f4\u6539\u3002\u8981\u53d1\u8868\u8bc4\u8bba\uff0c\u8bf7\u5355\u51fb\u76f8\u5173\u884c\u53f7\u6216\u7a81\u51fa\u663e\u793a\u8be5\u884c\u7684\u76f8\u5173\u90e8\u5206\uff0c\u7136\u540e\u952e\u5165 \u201cc\u201d \u4ee5\u663e\u793a\u6ce8\u91ca\u6846\u3002\u8981\u63d0\u4ea4\u60a8\u7684 review \u548c/\u6216 \u60a8\u7684 review status \uff0c\u8bf7\u8f6c\u5230\u8bc4\u8bba\u7684\u9876\u5c42\uff0c\u7136\u540e\u5355\u51fb Reply \u3002\u60a8\u53ef\u4ee5\u5728\u6b64\u5904\u6dfb\u52a0\u5176\u4ed6\u9876\u7ea7\u6ce8\u91ca\uff0c\u7136\u540e\u63d0\u4ea4\u3002 \u8981\u67e5\u770b Gerrit review \u4e2d\u7684\u4ee3\u7801\uff0c\u8bf7\u5355\u51fb\u4e0b\u8f7d\u5e76\u5c06\u76f8\u5173\u7684 Git \u547d\u4ee4\u7c98\u8d34\u5230 Git \u5ba2\u6237\u7aef\u3002\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u66f4\u65b0\u63d0\u4ea4\u5e76\u63a8\u9001 Gerrit \u5411\u5ba1\u9605\u63d0\u4ea4\u8865\u4e01\uff0c\u5373\u4f7f\u60a8\u4e0d\u662f\u539f\u59cb\u5ba1\u9605\u8005\u3002 Gerrit \u5141\u8bb8\u60a8\u5bf9 review \u8fdb\u884c\u6295\u7968\u3002\u5728\u4fee\u8865\u7a0b\u5e8f\u53ef\u4ee5\u5408\u5e76\u4e4b\u524d\uff0c\u9700\u8981\u81f3\u5c11\u63d0\u4ea4\u4e00\u4e2a\u63d0\u4ea4\u8005\uff08\u9664\u4e86\u63d0\u4ea4\u8005\uff09\u4e4b\u5916\u7684\u4e00\u4e2a +2 \u7684\u6295\u7968\u3002 Code Style ( \u4ee3\u7801\u98ce\u683c ) \u719f\u6089\u8fd9\u4e9b\u51c6\u5219\uff0c\u4ee5\u4fbf\u60a8\u7684\u8d21\u732e\u80fd\u591f\u5feb\u901f\u8f7b\u677e\u5730\u8fdb\u884c\u5ba1\u67e5\u548c\u6574\u5408\u3002 \u4e00\u822c\u6765\u8bf4\uff0c Kudu \u9075\u5faa Google C++ Style Guide \uff0c\u4f46\u6709\u4ee5\u4e0b\u4f8b\u5916\uff1a Notes on C++ 11 ( \u5173\u4e8e C++ 11 \u7684\u6ce8\u91ca ) Kudu \u4f7f\u7528 C ++ 11 \u3002\u67e5\u770b C ++ 11 \u79fb\u52a8\u8bed\u4e49\u548c rvalue \u5f15\u7528\u7684\u65b9\u4fbf\u6307\u5357\uff1a https://www.chromium.org/rvalue-references \u3002 \u6211\u4eec\u7684\u76ee\u6807\u662f\u9075\u5faa\u5927\u591a\u6570\u76f8\u540c\u7684\u6307\u5bfc\u539f\u5219\uff0c\u4f8b\u5982\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u8fc1\u79fb\u8fdc\u79bb foo.Pass() \uff0c\u6709\u5229\u4e8e std :: move(foo) \u3002 Limitations on boost Use ( boost \u4f7f\u7528\u9650\u5236 ) \u5728 kudu \u4ee3\u7801\u5e93\u4e2d\u4e0d\u5b58\u5728\u5408\u9002\u7684\u66ff\u6362\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ec5\u6765\u81ea\u6807\u5934\u5e93\u7684 boost \u7c7b\u3002\u7136\u800c\uff1a \u4e0d\u8981\u5bf9\u6807\u51c6 C ++ \u5e93\u6216 src/kudu/gutil/ \u4e2d\u5b58\u5728\u7b49\u6548\u529f\u80fd\u7684 boost \u7c7b\u5f15\u5165\u4f9d\u8d56\u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u559c\u6b22\u6765\u81ea gutil \u7684 strings :: Split() \uff0c\u800c\u4e0d\u662f boost :: split \u3002 \u559c\u6b22\u4f7f\u7528 boost \u7684\u529f\u80fd\u800c\u4e0d\u662f\u91cd\u65b0\u5b9e\u73b0\u76f8\u540c\u7684\u529f\u80fd\uff0c\u9664\u975e\u4f7f\u7528 boost \u529f\u80fd\u9700\u8981\u8fc7\u5ea6\u4f7f\u7528\u6211\u4eec\u7684\u98ce\u683c\u6307\u5357\u4e0d\u5141\u8bb8\u7684 C ++ \u529f\u80fd\u3002\u4f8b\u5982\uff0c boost :: spirit \u975e\u5e38\u57fa\u4e8e\u6a21\u677f\u5143\u7f16\u7a0b\uff0c\u4e0d\u5e94\u8be5\u4f7f\u7528\u3002 \u4e0d\u8981\u5728 Kudu C ++ \u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u516c\u7528\u5934\u6587\u4ef6\u4e2d\u4f7f\u7528 boost \uff0c\u56e0\u4e3a boost \u901a\u5e38\u4f1a\u7834\u574f\u5411\u540e\u517c\u5bb9\u6027\uff0c\u5e76\u4e14\u5728\u4e24\u4e2a\u5347\u7ea7\u7248\u672c\u4e4b\u95f4\u4f20\u9012\u6570\u636e\uff08\u4e00\u4e2a\u7531\u7528\u6237\u7531 Kudu \u5bfc\u51fa\uff09\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u95ee\u9898\u3002 \u5982\u679c\u6709\u4efb\u4f55\u63d0\u5347\u529f\u80fd\u5f15\u5165\u65b0\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u6700\u597d\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u81f3 dev@kudu.apache.org \u5f00\u59cb\u8ba8\u8bba\u3002 Line length ( \u7ebf\u957f ) Kudu \u56e2\u961f\u5141\u8bb8\u6bcf\u884c 100 \u4e2a\u5b57\u7b26\u7684\u884c\u957f\u5ea6\uff0c\u800c\u4e0d\u662f Google \u7684 80 \u6807\u51c6\u3002\u5c3d\u53ef\u80fd\u4fdd\u6301\u5728 80 \u4ee5\u4e0b\uff0c\u4f46\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u6ea2\u51fa\u5230 100 \u4e2a\u5de6\u53f3\u3002 Pointers ( \u6307\u9488 ) Smart Pointers and Singly-Owned Pointers ( \u667a\u80fd\u6307\u9488\u548c\u5355\u72ec\u6307\u9488 ) \u901a\u5e38\uff0c\u5927\u591a\u6570\u5bf9\u8c61\u5e94\u8be5\u6709\u660e\u786e\u7684 \u201csingle-owner\u201d \u8bed\u4e49\u3002\u5927\u591a\u6570\u65f6\u5019\uff0c singly-owned \u7684\u5bf9\u8c61\u53ef\u4ee5\u5305\u88c5\u5728 unique_ptr <> \u4e2d\uff0c\u786e\u4fdd\u5728\u8303\u56f4\u9000\u51fa\u65f6\u5220\u9664\uff0c\u5e76\u9632\u6b62\u610f\u5916\u590d\u5236\u3002 \u5982\u679c\u5bf9\u8c61\u662f singly owned \u7684\uff0c\u4f46\u662f\u4ece\u591a\u4e2a\u4f4d\u7f6e\u5f15\u7528\uff0c\u4f8b\u5982\u5f53\u5df2\u77e5\u6307\u5411\u5bf9\u8c61\u81f3\u5c11\u4e0e\u6307\u9488\u672c\u8eab\u4e00\u6837\u957f\u65f6\uff0c\u5c06\u6ce8\u91ca\u4e0e\u5c06\u539f\u59cb\u6307\u9488\u5b58\u50a8\u5e76\u5b58\u50a8\u7684\u6784\u9020\u51fd\u6570\u76f8\u5173\u8054\uff0c\u5982\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u3002 // 'blah' must remain valid for the lifetime of this class MyClass(const Blah* blah) : blah_(blah) { } \u6ce8\u610f Kudu \u4ee3\u7801\u5e93\u7684\u8f83\u65e7\u90e8\u5206\u4f7f\u7528 gscoped_ptr \u800c\u4e0d\u662f unique_ptr \u3002\u8fd9\u4e9b\u90fd\u662f\u5728 Kudu \u91c7\u7528 C ++ 11 \u4e4b\u524d\u8fdb\u884c\u7684\u3002\u65b0\u4ee3\u7801\u4e0d\u5e94\u8be5\u4f7f\u7528 gscoped_ptr \uff0c\u9664\u975e\u9700\u8981\u4e0e\u73b0\u6709\u4ee3\u7801\u8fdb\u884c\u63a5\u53e3\u3002\u6216\u8005\uff0c\u8003\u8651\u5728\u60a8\u9047\u5230\u8fd9\u4e9b\u95ee\u9898\u65f6\u66f4\u65b0\u7528\u6cd5\u3002 \u6ce8\u610f \u4e25\u683c\u7981\u6b62\u4f7f\u7528 std :: auto_ptr \uff0c\u56e0\u4e3a\u5b83\u7684\u96be\u5ea6\u5927\u4e14\u6613\u51fa\u9519\u7684\u8bed\u4e49\u3002\u6b64\u5916\uff0c std :: auto_ptr \u81ea C ++ 11 \u88ab\u58f0\u660e\u4e3a\u4e0d\u63a8\u8350\u4f7f\u7528\u3002 Smart Pointers for Multiply-Owned Pointers ( \u591a\u6307\u9488\u6307\u9488\u7684\u667a\u80fd\u6307\u9488 ): \u867d\u7136 single ownership \u662f\u7406\u60f3\u7684\uff0c\u4f46\u6709\u65f6\u5019\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u7279\u522b\u662f\u5f53\u591a\u4e2a\u7ebf\u7a0b\u6b63\u5728\u8fd0\u884c\u65f6\uff0c\u6307\u9488\u7684\u751f\u547d\u5468\u671f\u6ca1\u6709\u660e\u786e\u5b9a\u4e49\u3002\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 std :: shared_ptr \u6216 Kudu \u81ea\u5df1\u7684 scoped_refptr \u4ece gutil/ref_counted.hpp \u3002\u8fd9\u4e9b\u673a\u5236\u4e2d\u7684\u6bcf\u4e00\u4e2a\u4f9d\u8d56\u4e8e\u5f15\u7528\u8ba1\u6570\uff0c\u4ee5\u4fbf\u5728\u6ca1\u6709\u66f4\u591a\u6307\u9488\u4fdd\u7559\u65f6\u81ea\u52a8\u5220\u9664\u6307\u793a\u3002\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u6307\u9488\u4e4b\u95f4\u7684\u5173\u952e\u533a\u522b\u662f scoped_refptr \u8981\u6c42\u5bf9\u8c61\u6269\u5c55\u4e00\u4e2a RefCounted \u57fa\u7c7b\uff0c\u5e76\u5c06\u5176\u5f15\u7528\u8ba1\u6570\u5b58\u50a8\u5728\u5bf9\u8c61\u5b58\u50a8\u672c\u8eab\u5185\uff0c\u800c shared_ptr \u5728\u5806\u4e0a\u7ef4\u62a4\u5355\u72ec\u7684\u5f15\u7528\u8ba1\u6570\u3002 \u5229\u5f0a\u662f\uff1a shared_ptr \u53ef\u4ee5\u4e0e\u4efb\u4f55\u7c7b\u578b\u7684\u5bf9\u8c61\u4e00\u8d77\u4f7f\u7528\uff0c\u800c\u4e0d\u9700\u8981\u4ece\u7279\u6b8a\u7684\u57fa\u7c7b\u6d3e\u751f\u5bf9\u8c61 \u6807\u51c6\u5e93\u7684\u4e00\u90e8\u5206\uff0c\u5927\u591a\u6570 C ++ \u5f00\u53d1\u4eba\u5458\u719f\u6089 \u652f\u6301 weak_ptr \u7684\u7528\u4f8b\uff1a \u5f53\u5bf9\u8c61\u4ec5\u5728\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u9700\u8981\u88ab\u8bbf\u95ee\u65f6\u624d\u662f\u4e34\u65f6\u6240\u6709\u6743 \u6253\u7834 shared_ptr \u7684\u5faa\u73af\u5f15\u7528\uff0c\u5982\u679c\u7531\u4e8e\u805a\u5408\u5b58\u5728\u4efb\u4f55\u5b58\u5728 \u60a8\u53ef\u4ee5\u5c06 shared_ptr \u8f6c\u6362\u4e3a weak_ptr \u5e76\u8fd4\u56de \u5982\u679c\u4f7f\u7528 std :: make_shared <>() \u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5219\u53ea\u80fd\u8fdb\u884c\u4e00\u6b21\u5206\u914d\uff08\u56e0\u4e3a C ++ 11; Standard \u4e2d\u7684\u975e\u7ed1\u5b9a\u7684\u8981\u6c42\uff09 \u5982\u679c\u4f7f\u7528 shared_ptr <T> p(new T) \u521b\u5efa\u65b0\u5bf9\u8c61\u9700\u8981\u4e24\u4e2a\u5206\u914d\uff08\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5f15\u7528\u8ba1\u6570\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5bf9\u8c61\uff09 \u5f15\u7528\u8ba1\u6570\u53ef\u80fd\u4e0d\u5728\u5806\u4e0a\u7684\u5bf9\u8c61\u9644\u8fd1\uff0c\u56e0\u6b64\u5728\u8bbf\u95ee\u65f6\u53ef\u80fd\u4f1a\u53d1\u751f\u989d\u5916\u7684\u9ad8\u901f\u7f13\u5b58\u672a\u547d\u4e2d shared_ptr \u5b9e\u4f8b\u672c\u8eab\u9700\u8981 16 \u4e2a\u5b57\u8282\uff08\u6307\u5411 ref \u8ba1\u6570\u7684\u6307\u9488\u548c\u6307\u5411\u5bf9\u8c61\u7684\u6307\u9488\uff09 scoped_refptr \u53ea\u9700\u8981\u4e00\u4e2a\u5206\u914d\uff0c\u5e76\u4e14 ref \u8ba1\u6570\u4e0e\u5bf9\u8c61\u5728\u540c\u4e00\u4e2a\u9ad8\u901f\u7f13\u5b58\u884c\u4e0a \u6307\u9488\u53ea\u9700\u8981 8 \u4e2a\u5b57\u8282\uff08\u56e0\u4e3a\u5f15\u7528\u8ba1\u6570\u5728\u5bf9\u8c61\u5185\uff09 \u5f53\u9700\u8981\u66f4\u591a\u63a7\u5236\u65f6\uff0c\u60a8\u53ef\u4ee5\u624b\u52a8\u589e\u52a0\u6216\u51cf\u5c11\u53c2\u8003\u8ba1\u6570 \u60a8\u53ef\u4ee5\u5c06\u539f\u59cb\u6307\u9488\u8f6c\u6362\u56de scoped_refptr \uff0c\u800c\u4e0d\u5fc5\u62c5\u5fc3\u53cc\u91cd\u91ca\u653e \u7531\u4e8e\u6211\u4eec\u63a7\u5236\u5b9e\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u529f\u80fd\uff0c\u4f8b\u5982\u8c03\u8bd5\u6784\u5efa\uff0c\u6355\u83b7\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5806\u6808\u8ddf\u8e2a\u4ee5\u5e2e\u52a9\u8c03\u8bd5\u6cc4\u6f0f\u3002 \u5f15\u7528\u5bf9\u8c61\u5fc5\u987b\u4ece RefCounted \u7ee7\u627f \u4e0d\u652f\u6301 weak_ptr \u7684\u7528\u4f8b \u7531\u4e8e scoped_refptr \u901a\u5e38\u8d8a\u6765\u8d8a\u5c0f\uff0c\u6240\u4ee5\u5c1d\u8bd5\u5728\u65b0\u4ee3\u7801\u4e2d\u4f7f\u7528\u800c\u4e0d\u662f shared_ptr \u3002\u73b0\u6709\u4ee3\u7801\u5728\u8bb8\u591a\u5730\u65b9\u4f7f\u7528 shared_ptr \u3002\u5f53\u4e0e\u8be5\u4ee3\u7801\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528 shared_ptr \u3002 Function Binding and Callbacks ( \u51fd\u6570\u7ed1\u5b9a\u548c\u56de\u8c03 ) \u73b0\u6709\u4ee3\u7801\u4f7f\u7528 boost :: bind \u548c boost :: function \u6765\u8fdb\u884c\u51fd\u6570\u7ed1\u5b9a\u548c\u56de\u8c03\u3002 \u5bf9\u4e8e\u65b0\u4ee3\u7801\uff0c\u8bf7\u4f7f\u7528 gutil \u4e2d\u7684\u56de\u8c03\u548c\u7ed1\u5b9a\u7c7b\u3002 \u867d\u7136\u529f\u80fd\u8f83\u5c11\uff08\u7ed1\u5b9a\u4e0d\u652f\u6301\u53c2\u6570\u5360\u4f4d\u7b26\uff0c\u5305\u88c5\u51fd\u6570\u6307\u9488\u6216\u51fd\u6570\u5bf9\u8c61\uff09\uff0c\u4f46\u5b83\u4eec\u901a\u8fc7\u53c2\u6570\u751f\u547d\u5468\u671f\u7ba1\u7406\u7684\u65b9\u5f0f\u63d0\u4f9b\u66f4\u591a\u9009\u9879\u3002 \u4f8b\u5982\uff0c\u5f53 Callback \u8d85\u51fa\u8303\u56f4\u65f6\uff0c\u7ed1\u5b9a\u53c2\u6570\u7684\u7c7b\u6269\u5c55 RefCounted \u5c06\u5728\u7ed1\u5b9a\u671f\u95f4\u9012\u589e\uff0c\u5e76\u51cf\u5c11\u3002 \u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 gutil/callback.h \u4e2d\u7684\u5927\u6587\u4ef6\u6ce8\u91ca\uff0c util/callback_bind-test.cc \u4f5c\u4e3a\u793a\u4f8b\u3002 CMake Style Guide ( CMake \u6837\u5f0f\u6307\u5357 ) CMake \u5141\u8bb8\u4ee5\u8f83\u4f4e\uff0c\u4e0a\u9650\u6216\u6df7\u5408\u5927\u5c0f\u5199\u7684\u547d\u4ee4\u3002 \u8981\u4fdd\u6301 CMake \u6587\u4ef6\u4e00\u81f4\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u51c6\u5219\uff1a \u5c0f\u5199\u7684 built-in commands add_subdirectory(some/path) \u5927\u5199\u7684 built-in arguments message(STATUS \"message goes here\") \u5927\u5199\u7684 custom commands or macros ADD_KUDU_TEST(some-test) GFlags Kudu \u4f7f\u7528 gflags \u8fdb\u884c\u547d\u4ee4\u884c\u548c\u57fa\u4e8e\u6587\u4ef6\u7684\u914d\u7f6e\u3002\u4f7f\u7528\u8fd9\u4e9b\u51c6\u5219\u6dfb\u52a0\u65b0\u7684 gflag \u3002\u6240\u6709\u65b0 gflags \u5fc5\u987b\u7b26\u5408\u8fd9\u4e9b\u51c6\u5219\u3002\u73b0\u6709\u7684\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u4ea7\u54c1\u5c06\u53ca\u65f6\u7b26\u5408\u89c4\u5b9a\u3002 Name ( \u540d\u79f0 ) gflag \u7684\u540d\u5b57\u4f20\u8fbe\u4e86\u5f88\u591a\u4fe1\u606f\uff0c\u6240\u4ee5\u9009\u62e9\u4e00\u4e2a\u597d\u540d\u5b57\u3002\u8be5\u540d\u79f0\u5c06\u4f20\u64ad\u5230\u5176\u4ed6\u7cfb\u7edf\uff0c\u5982 \u914d\u7f6e\u53c2\u8003 \u3002 \u591a\u5b57\u540d\u79f0\u7684\u4e0d\u540c\u90e8\u5206\u5e94\u4ee5\u4e0b\u5212\u7ebf\u5206\u9694\u3002\u4f8b\u5982\uff0c fs_data_dirs \u3002 \u8be5\u540d\u79f0\u5e94\u4ee5\u5176\u5f71\u54cd\u7684\u4e0a\u4e0b\u6587\u4e3a\u524d\u7f00\u3002\u4f8b\u5982\uff0c webserver_num_worker_threads \u548c cfile_default_block_size \u3002\u4e0a\u4e0b\u6587\u53ef\u80fd\u5f88\u96be\u5b9a\u4e49\uff0c\u6240\u4ee5\u8bf7\u8bb0\u4f4f\uff0c\u8fd9\u4e2a\u524d\u7f00\u5c06\u7528\u4e8e\u5c06\u7c7b\u4f3c\u7684 gflags \u7ec4\u5408\u5728\u4e00\u8d77\u3002\u5982\u679c gflag \u5f71\u54cd\u6574\u4e2a\u8fc7\u7a0b\uff0c\u90a3\u4e48\u5b83\u4e0d\u5e94\u8be5\u662f\u524d\u7f00\u3002 \u5982\u679c gflag \u662f\u4e00\u4e2a\u6570\u91cf\uff0c\u8be5\u540d\u79f0\u5e94\u8be5\u540e\u7f00\u5355\u4f4d\u3002\u4f8b\u5982\uff0c tablet_copy_idle_timeout_ms \u3002 \u5982\u6709\u53ef\u80fd\uff0c\u8bf7\u4f7f\u7528\u77ed\u540d\u79f0\u3002\u8fd9\u5c06\u4e3a\u624b\u52a8\u8f93\u5165\u547d\u4ee4\u884c\u9009\u9879\u7684\u4eba\u8282\u7701\u65f6\u95f4\u3002 \u8fd9\u4e2a\u540d\u79f0\u662f Kudu \u517c\u5bb9\u6027\u5408\u540c\u7684\u4e00\u90e8\u5206\uff0c\u4e0d\u5e94\u8be5\u6ca1\u6709\u5f88\u597d\u7684\u7406\u7531\u6765\u6539\u53d8\u3002 Default value ( \u9ed8\u8ba4\u503c ) \u9009\u62e9\u9ed8\u8ba4\u503c\u901a\u5e38\u5f88\u7b80\u5355\uff0c\u4f46\u50cf\u540d\u79f0\u4e00\u6837\uff0c\u5b83\u4f20\u64ad\u5230\u5176\u4ed6\u7cfb\u7edf\u4e2d\u3002 \u9ed8\u8ba4\u503c\u662f Kudu \u7684 compatibility contract ( \u517c\u5bb9\u6027\u5408\u540c ) \u7684\u4e00\u90e8\u5206\uff0c\u5982\u679c\u6ca1\u6709\u5f88\u597d\u7684\u7406\u7531\uff0c\u4e0d\u5e94\u8be5\u6539\u53d8\u3002 Description ( \u63cf\u8ff0 ) gflag \u7684\u63cf\u8ff0\u5e94\u8be5\u8865\u5145\u540d\u79f0\u5e76\u63d0\u4f9b\u5176\u4ed6\u4e0a\u4e0b\u6587\u548c\u4fe1\u606f\u3002\u4e0e\u540d\u79f0\u4e00\u6837\uff0c\u8bf4\u660e\u4f20\u64ad\u5230\u5176\u4ed6\u7cfb\u7edf\u3002 \u63cf\u8ff0\u53ef\u4ee5\u5305\u62ec\u591a\u4e2a\u53e5\u5b50\u3002\u6bcf\u4e2a\u90fd\u5e94\u8be5\u4ee5\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u5f00\u5934\uff0c\u4ee5\u4e00\u4e2a\u53e5\u70b9\u7ed3\u5c3e\uff0c\u5e76\u5728\u4e4b\u524d\u7684\u4e00\u4e2a\u7a7a\u683c\u5f00\u59cb\u3002 \u63cf\u8ff0\u4e0d\u5e94\u5305\u542b gflag \u7684\u7c7b\u578b\u6216\u9ed8\u8ba4\u503c;\u5b83\u4eec\u662f\u5e26\u5916\u63d0\u4f9b\u7684\u3002 \u63cf\u8ff0\u5e94\u8be5\u5728\u7b2c\u4e09\u4eba\u79f0\u3002\u4e0d\u8981\u4f7f\u7528\u50cf\u4f60\u8fd9\u6837\u7684\u8bdd\u3002 gflag \u63cf\u8ff0\u53ef\u4ee5\u81ea\u7531\u66f4\u6539; Kudu \u7684\u53d1\u884c\u9884\u8ba1\u4e0d\u4f1a\u4fdd\u6301\u4e0d\u53d8\u3002 Tags ( \u6807\u5fd7 ) Kudu \u7684 gflag \u6807\u8bb0\u673a\u5236\u4e3a\u6bcf\u4e2a gflag \u6dfb\u52a0\u4e86\u673a\u5668\u53ef\u8bfb\u4e0a\u4e0b\u6587\uff0c\u7528\u4e8e\u6d88\u8017\u7cfb\u7edf\uff0c\u5982\u6587\u6863\u6216\u7ba1\u7406\u5de5\u5177\u3002\u8bf7\u53c2\u9605 flag_tags.h \u4e2d\u7684\u5927\u5757\u6ce8\u91ca\uff0c\u4ee5\u83b7\u53d6\u51c6\u5219\u3002 Miscellaneous ( \u6742 ) \u907f\u514d\u4e3a\u540c\u4e00\u4e2a\u903b\u8f91\u53c2\u6570\u521b\u5efa\u591a\u4e2a gflags \u3002\u4f8b\u5982\uff0c\u8bb8\u591a Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\u9700\u8981\u914d\u7f6e\u4e00\u4e2a WAL \u76ee\u5f55\u3002\u800c\u4e0d\u662f\u521b\u5efa foo_wal_dir \u548c bar_wal_dir gflags \uff0c\u6700\u597d\u4f7f\u7528\u4e00\u4e2a\u5355\u4e00\u7684 kudu_wal_dir gflag \u6765\u666e\u904d\u4f7f\u7528\u3002 Testing ( \u6d4b\u8bd5 ) All new code should have tests. ( \u6240\u6709\u65b0\u7684\u4ee3\u7801\u90fd\u5e94\u8be5\u6709\u6d4b\u8bd5\u3002 ) \u5728\u73b0\u6709\u6587\u4ef6\u4e2d\u6dfb\u52a0\u65b0\u7684\u6d4b\u8bd5\uff0c\u6216\u6839\u636e\u9700\u8981\u521b\u5efa\u65b0\u7684\u6d4b\u8bd5\u6587\u4ef6\u3002 All bug fixes should have tests. ( \u6240\u6709\u9519\u8bef\u4fee\u590d\u90fd\u5e94\u8be5\u6709\u6d4b\u8bd5\u3002 ) \u5982\u679c\u7531\u73b0\u6709\u6d4b\u8bd5\u7528\u4f8b\u89e6\u53d1\uff0c\u5219\u53ef\u4ee5\u4fee\u590d\u9519\u8bef\u800c\u4e0d\u6dfb\u52a0\u65b0\u6d4b\u8bd5\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5728 20 \u5206\u949f\u5de6\u53f3\u4e4b\u540e\u8fd0\u884c\u591a\u7ebf\u7a0b\u7cfb\u7edf\u6d4b\u8bd5\u65f6\u51fa\u73b0\u4e86\u4e00\u4e2a race \uff0c\u90a3\u4e48\u503c\u5f97\u5c1d\u8bd5\u66f4\u6709\u9488\u5bf9\u6027\u7684\u6d4b\u8bd5\u7528\u4f8b\u6765\u89e6\u53d1\u8be5\u9519\u8bef\u3002\u4f46\u662f\u5982\u679c\u8fd9\u5f88\u96be\u505a\uff0c\u73b0\u6709\u7684\u7cfb\u7edf\u6d4b\u8bd5\u5c31\u591f\u4e86\u3002 Tests should run quickly (< 1s). ( \u6d4b\u8bd5\u5e94\u8be5\u5f88\u5feb\u8fd0\u884c\uff08<1s\uff09\u3002 ) \u5982\u679c\u8981\u7f16\u5199\u65f6\u95f4\u5bc6\u96c6\u7684\u6d4b\u8bd5\uff0c\u8bf7\u4f7f\u8fd0\u884c\u65f6\u4f9d\u8d56\u4e8e\u901a\u8fc7 KUDU_ALLOW_SLOW_TESTS \u73af\u5883\u53d8\u91cf\u542f\u7528\u7684 KuduTest#AllowSlowTests \uff0c\u5e76\u7531 Jenkins \u6d4b\u8bd5\u6267\u884c\u4f7f\u7528\u3002 Tests which run a number of iterations of some task should use a gflags command-line argument for the number of iterations. ( \u8fd0\u884c\u4e00\u4e9b\u4efb\u52a1\u7684\u8fed\u4ee3\u7684\u6d4b\u8bd5\u5e94\u8be5\u4f7f\u7528 gflags \u547d\u4ee4\u884c\u53c2\u6570\u6765\u6267\u884c\u8fed\u4ee3\u6b21\u6570\u3002 ) \u8fd9\u5bf9\u4e8e\u7f16\u5199\u5feb\u901f\u538b\u529b\u6d4b\u8bd5\u6216\u6027\u80fd\u6d4b\u8bd5\u975e\u5e38\u65b9\u4fbf\u3002 Commits which may affect performance should include before/after perf-stat(1) output. ( \u53ef\u80fd\u5f71\u54cd\u6027\u80fd\u7684\u63d0\u4ea4\u5e94\u5305\u62ec\u5728 perf-stat(1) \u8f93\u51fa \u4e4b\u524d/\u4e4b\u540e\u3002 ) \u8fd9\u5c06\u663e\u793a\u6027\u80fd\u63d0\u5347\u6216 non-regression ( \u4e0d\u56de\u5f52 )\u3002 Performance-sensitive ( \u6027\u80fd\u654f\u611f ) \u4ee3\u7801\u5e94\u5305\u62ec\u4e00\u4e9b\u53ef\u7528\u4f5c\u76ee\u6807\u57fa\u51c6\u6d4b\u8bd5\u7528\u4f8b\u3002","title":"\u8d21\u732e\u4e8e Kudu"},{"location":"16/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/contributing.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813653 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u8d21\u732e\u4e8e Kudu"},{"location":"16/#contributing-patches-using-gerrit-gerrit","text":"Kudu \u56e2\u961f\u4f7f\u7528 Gerrit \u8fdb\u884c\u4ee3\u7801\u5ba1\u67e5\uff0c\u800c\u4e0d\u662f Github pull requests \u3002\u901a\u5e38\uff0c\u60a8\u4ece Github pull \uff0c\u4f46\u662f push \u5230 Gerrit \uff0c Gerrit \u7528\u4e8e\u67e5\u770b\u4ee3\u7801\u5e76\u5c06\u5176\u5408\u5e76\u5230 Github \u4e2d\u3002 \u6709\u5173\u4f7f\u7528 Gerrit \u8fdb\u884c\u4ee3\u7801\u5ba1\u67e5\u7684\u6982\u8ff0\uff0c\u8bf7\u53c2\u9605 Gerrit \u6559\u7a0b \u3002","title":"Contributing Patches Using Gerrit ( \u4f7f\u7528 Gerrit \u8d21\u732e\u8865\u4e01 )"},{"location":"16/#gerrit","text":"\u4f7f\u7528\u60a8\u7684 Github \u7528\u6237\u540d\u767b\u5f55 Gerrit \u3002 \u524d\u5f80 Setting \u3002\u5728 Contact Information \u9875\u9762\u4e0a\u66f4\u65b0\u60a8\u7684\u59d3\u540d\u548c\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u5e76\u4e0a\u4f20 SSH \u516c\u94a5\u3002\u5982\u679c\u60a8\u4e0d\u66f4\u65b0\u60a8\u7684\u59d3\u540d\uff0c\u5b83\u5c06\u5728 Gerrit \u8bc4\u8bba\u4e2d\u663e\u793a\u4e3a \u201cAnonymous Coward\u201d \u3002 \u5982\u679c\u8fd8\u6ca1\u6709\u8fd9\u6837\u505a\uff0c\u8bf7 clone the main Kudu repository \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c main remote \u79f0\u4e3a origin \u3002\u5f53\u4f60 fetch \u6216 pull \uff0c\u4f60\u4f1a\u4ece origin \u8fd9\u6837\u505a\u3002 git clone https://github.com/apache/kudu \u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 \u6dfb\u52a0 gerrit remote \u3002\u5728\u4ee5\u4e0b\u547d\u4ee4\u4e2d\uff0c\u7528\u60a8\u7684 Github \u7528\u6237\u540d\u66ff\u6362 <username> \u3002 git remote add gerrit ssh://&lt;username&gt;@gerrit.cloudera.org:29418/kudu \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b89\u88c5 Gerrit commit-msg hook \u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff0c\u7528\u60a8\u7684 Github \u7528\u6237\u540d\u66ff\u6362 <username> \u3002 gitdir=$(git rev-parse --git-dir); scp -p -P 29418 &lt;username&gt;@gerrit.cloudera.org:hooks/commit-msg ${gitdir}/hooks/ \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u60a8\u5df2\u7ecf\u8bbe\u7f6e\u4e86 Kudu \u5b58\u50a8\u5e93\u4f7f\u7528 pull -rebase \u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4e24\u4e2a\u547d\u4ee4\uff0c\u5047\u8bbe\u60a8\u81f3\u4eca\u5df2\u7ecf\u68c0\u67e5\u8fc7\u4e3b\u673a\uff1a git config branch.autosetuprebase always git config branch.master.rebase true \u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u60a8\u5df2\u7ecf checked out branches \u800c\u4e0d\u662f master \uff0c\u8bf7\u5728\u4e0a\u9762\u7684\u7b2c\u4e8c\u4e2a\u547d\u4ee4\u4e2d\u66ff\u6362 master \u4ee5\u83b7\u53d6 other branch names \u3002","title":"Gerrit \u7684\u521d\u59cb\u8bbe\u7f6e"},{"location":"16/#submitting-patches","text":"\u8981\u63d0\u4ea4\u4fee\u8865\u7a0b\u5e8f\uff0c\u9996\u5148\u63d0\u4ea4\u60a8\u7684\u66f4\u6539\uff08\u5982\u679c\u53ef\u80fd\uff0c\u4f7f\u7528\u63cf\u8ff0\u6027\u591a\u884c\u63d0\u4ea4\u6d88\u606f\uff09\uff0c\u7136\u540e\u5c06\u8bf7\u6c42 push \u5230 gerrit remote \u3002\u4f8b\u5982\uff0c\u8981\u5c06\u66f4\u6539\u63a8\u9001\u5230 master \u5206\u652f\uff1a git push gerrit HEAD:refs/for/master --no-thin \u6216\u8005\u5c06\u66f4\u6539 push \u5230 gh-pages \u5206\u652f ( \u66f4\u65b0\u7f51\u9875 )\uff1a git push gerrit HEAD:refs/for/gh-pages --no-thin \u6ce8\u610f \u5728\u51c6\u5907\u4e00\u4e2a\u4fee\u8865\u7a0b\u5e8f\u8fdb\u884c\u5ba1\u67e5\u65f6\uff0c\u6700\u597d \u9075\u5faa\u901a\u7528 git \u63d0\u4ea4\u51c6\u5219\u548c\u826f\u597d\u505a\u6cd5 \u3002 \u6ce8\u610f --no-thin \u53c2\u6570\u662f\u9632\u6b62 Gerrit \u4e2d\u7684\u9519\u8bef\u7684\u89e3\u51b3\u65b9\u6cd5\u3002\u8bf7\u53c2\u9605 \u6ce8\u610f \u8003\u8651\u4e3a\u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa Git \u522b\u540d\u3002 Gerrit \u8fd8\u5305\u62ec\u4e00\u4e2a\u540d\u4e3a git-review \u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u60a8\u53ef\u80fd\u4f1a\u53d1\u73b0\u6709\u7528\u3002 Gerrit \u4f1a\u5728\u60a8\u7684\u63d0\u4ea4\u6d88\u606f\u4e2d\u6dfb\u52a0\u66f4\u6539 ID \uff0c\u5e76\u521b\u5efa\u4e00\u4e2a Gerrit review \uff0c\u5176 URL \u5c06\u4f5c\u4e3a\u63a8\u9001\u56de\u590d\u7684\u4e00\u90e8\u5206\u53d1\u5e03\u3002\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u5411 kudu-dev \u90ae\u4ef6\u5217\u8868\u53d1\u9001\u6d88\u606f\uff0c\u89e3\u91ca\u8865\u4e01\u5e76\u8bf7\u6c42 review \u3002 \u83b7\u5f97\u53cd\u9988\u540e\uff0c\u60a8\u53ef\u4ee5\u66f4\u6539\u6216\u4fee\u6539\u60a8\u7684\u63d0\u4ea4\uff08\u4f8b\u5982\uff0c\u4f7f\u7528\u50cf git commit --amend \u8fd9\u6837\u7684\u547d\u4ee4\uff09\uff0c\u540c\u65f6\u4fdd\u7559\u66f4\u6539 ID \u3002\u5c06\u60a8\u7684\u66f4\u6539\u518d\u6b21 push \u7ed9 Gerrit \uff0c\u8fd9\u5c06\u5728 Gerrit \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4fee\u8865\u7a0b\u5e8f\uff0c\u5e76\u901a\u77e5\u6240\u6709\u5ba1\u9605\u8005\u6709\u5173\u66f4\u6539\u3002 \u5f53\u60a8\u7684\u4ee3\u7801\u7ecf\u8fc7\u5ba1\u67e5\u5e76\u51c6\u5907\u5408\u5e76\u5230 Kudu \u4ee3\u7801\u5e93\u540e\uff0c Kudu \u63d0\u4ea4\u8005\u5c06\u4f7f\u7528 Gerrit \u8fdb\u884c\u5408\u5e76\u3002\u4f60\u53ef\u4ee5\u4e22\u5f03\u4f60\u7684 local branch \u3002","title":"Submitting Patches ( \u63d0\u4ea4\u8865\u4e01 )"},{"location":"16/#abandoning-a-review-review","text":"\u5982\u679c\u60a8\u7684\u8865\u4e01\u4e0d\u88ab\u63a5\u53d7\u6216\u60a8\u51b3\u5b9a\u4ece\u8003\u8651\u4e2d\u63d0\u53d6\u8865\u4e01\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 Gerrit UI \u653e\u5f03\u8865\u4e01\u3002\u5b83\u4ecd\u5c06\u5728 Gerrit \u7684\u5386\u53f2\u4e0a\u5c55\u793a\uff0c\u4f46\u4e0d\u4f1a\u88ab\u5217\u4e3a\u5f85\u5ba1\u67e5\u3002","title":"Abandoning a Review ( \u653e\u5f03 review )"},{"location":"16/#reviewing-patches-in-gerrit-gerrit","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528 Web UI \u67e5\u770b Gerrit \u4e2d\u7684\u7edf\u4e00\u6216\u5e76\u884c\u5dee\u5f02\u66f4\u6539\u3002\u8981\u53d1\u8868\u8bc4\u8bba\uff0c\u8bf7\u5355\u51fb\u76f8\u5173\u884c\u53f7\u6216\u7a81\u51fa\u663e\u793a\u8be5\u884c\u7684\u76f8\u5173\u90e8\u5206\uff0c\u7136\u540e\u952e\u5165 \u201cc\u201d \u4ee5\u663e\u793a\u6ce8\u91ca\u6846\u3002\u8981\u63d0\u4ea4\u60a8\u7684 review \u548c/\u6216 \u60a8\u7684 review status \uff0c\u8bf7\u8f6c\u5230\u8bc4\u8bba\u7684\u9876\u5c42\uff0c\u7136\u540e\u5355\u51fb Reply \u3002\u60a8\u53ef\u4ee5\u5728\u6b64\u5904\u6dfb\u52a0\u5176\u4ed6\u9876\u7ea7\u6ce8\u91ca\uff0c\u7136\u540e\u63d0\u4ea4\u3002 \u8981\u67e5\u770b Gerrit review \u4e2d\u7684\u4ee3\u7801\uff0c\u8bf7\u5355\u51fb\u4e0b\u8f7d\u5e76\u5c06\u76f8\u5173\u7684 Git \u547d\u4ee4\u7c98\u8d34\u5230 Git \u5ba2\u6237\u7aef\u3002\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u66f4\u65b0\u63d0\u4ea4\u5e76\u63a8\u9001 Gerrit \u5411\u5ba1\u9605\u63d0\u4ea4\u8865\u4e01\uff0c\u5373\u4f7f\u60a8\u4e0d\u662f\u539f\u59cb\u5ba1\u9605\u8005\u3002 Gerrit \u5141\u8bb8\u60a8\u5bf9 review \u8fdb\u884c\u6295\u7968\u3002\u5728\u4fee\u8865\u7a0b\u5e8f\u53ef\u4ee5\u5408\u5e76\u4e4b\u524d\uff0c\u9700\u8981\u81f3\u5c11\u63d0\u4ea4\u4e00\u4e2a\u63d0\u4ea4\u8005\uff08\u9664\u4e86\u63d0\u4ea4\u8005\uff09\u4e4b\u5916\u7684\u4e00\u4e2a +2 \u7684\u6295\u7968\u3002","title":"Reviewing Patches In Gerrit ( \u5ba1\u67e5 Gerrit \u4e2d\u7684\u8865\u4e01 )"},{"location":"16/#code-style","text":"\u719f\u6089\u8fd9\u4e9b\u51c6\u5219\uff0c\u4ee5\u4fbf\u60a8\u7684\u8d21\u732e\u80fd\u591f\u5feb\u901f\u8f7b\u677e\u5730\u8fdb\u884c\u5ba1\u67e5\u548c\u6574\u5408\u3002 \u4e00\u822c\u6765\u8bf4\uff0c Kudu \u9075\u5faa Google C++ Style Guide \uff0c\u4f46\u6709\u4ee5\u4e0b\u4f8b\u5916\uff1a","title":"Code Style ( \u4ee3\u7801\u98ce\u683c )"},{"location":"16/#notes-on-c-11-c-11","text":"Kudu \u4f7f\u7528 C ++ 11 \u3002\u67e5\u770b C ++ 11 \u79fb\u52a8\u8bed\u4e49\u548c rvalue \u5f15\u7528\u7684\u65b9\u4fbf\u6307\u5357\uff1a https://www.chromium.org/rvalue-references \u3002 \u6211\u4eec\u7684\u76ee\u6807\u662f\u9075\u5faa\u5927\u591a\u6570\u76f8\u540c\u7684\u6307\u5bfc\u539f\u5219\uff0c\u4f8b\u5982\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u8fc1\u79fb\u8fdc\u79bb foo.Pass() \uff0c\u6709\u5229\u4e8e std :: move(foo) \u3002","title":"Notes on C++ 11 ( \u5173\u4e8e C++ 11 \u7684\u6ce8\u91ca )"},{"location":"16/#limitations-on-boost-use-boost","text":"\u5728 kudu \u4ee3\u7801\u5e93\u4e2d\u4e0d\u5b58\u5728\u5408\u9002\u7684\u66ff\u6362\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ec5\u6765\u81ea\u6807\u5934\u5e93\u7684 boost \u7c7b\u3002\u7136\u800c\uff1a \u4e0d\u8981\u5bf9\u6807\u51c6 C ++ \u5e93\u6216 src/kudu/gutil/ \u4e2d\u5b58\u5728\u7b49\u6548\u529f\u80fd\u7684 boost \u7c7b\u5f15\u5165\u4f9d\u8d56\u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u559c\u6b22\u6765\u81ea gutil \u7684 strings :: Split() \uff0c\u800c\u4e0d\u662f boost :: split \u3002 \u559c\u6b22\u4f7f\u7528 boost \u7684\u529f\u80fd\u800c\u4e0d\u662f\u91cd\u65b0\u5b9e\u73b0\u76f8\u540c\u7684\u529f\u80fd\uff0c\u9664\u975e\u4f7f\u7528 boost \u529f\u80fd\u9700\u8981\u8fc7\u5ea6\u4f7f\u7528\u6211\u4eec\u7684\u98ce\u683c\u6307\u5357\u4e0d\u5141\u8bb8\u7684 C ++ \u529f\u80fd\u3002\u4f8b\u5982\uff0c boost :: spirit \u975e\u5e38\u57fa\u4e8e\u6a21\u677f\u5143\u7f16\u7a0b\uff0c\u4e0d\u5e94\u8be5\u4f7f\u7528\u3002 \u4e0d\u8981\u5728 Kudu C ++ \u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u516c\u7528\u5934\u6587\u4ef6\u4e2d\u4f7f\u7528 boost \uff0c\u56e0\u4e3a boost \u901a\u5e38\u4f1a\u7834\u574f\u5411\u540e\u517c\u5bb9\u6027\uff0c\u5e76\u4e14\u5728\u4e24\u4e2a\u5347\u7ea7\u7248\u672c\u4e4b\u95f4\u4f20\u9012\u6570\u636e\uff08\u4e00\u4e2a\u7531\u7528\u6237\u7531 Kudu \u5bfc\u51fa\uff09\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u95ee\u9898\u3002 \u5982\u679c\u6709\u4efb\u4f55\u63d0\u5347\u529f\u80fd\u5f15\u5165\u65b0\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u6700\u597d\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u81f3 dev@kudu.apache.org \u5f00\u59cb\u8ba8\u8bba\u3002","title":"Limitations on boost Use ( boost \u4f7f\u7528\u9650\u5236 )"},{"location":"16/#line-length","text":"Kudu \u56e2\u961f\u5141\u8bb8\u6bcf\u884c 100 \u4e2a\u5b57\u7b26\u7684\u884c\u957f\u5ea6\uff0c\u800c\u4e0d\u662f Google \u7684 80 \u6807\u51c6\u3002\u5c3d\u53ef\u80fd\u4fdd\u6301\u5728 80 \u4ee5\u4e0b\uff0c\u4f46\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u6ea2\u51fa\u5230 100 \u4e2a\u5de6\u53f3\u3002","title":"Line length ( \u7ebf\u957f )"},{"location":"16/#pointers","text":"Smart Pointers and Singly-Owned Pointers ( \u667a\u80fd\u6307\u9488\u548c\u5355\u72ec\u6307\u9488 ) \u901a\u5e38\uff0c\u5927\u591a\u6570\u5bf9\u8c61\u5e94\u8be5\u6709\u660e\u786e\u7684 \u201csingle-owner\u201d \u8bed\u4e49\u3002\u5927\u591a\u6570\u65f6\u5019\uff0c singly-owned \u7684\u5bf9\u8c61\u53ef\u4ee5\u5305\u88c5\u5728 unique_ptr <> \u4e2d\uff0c\u786e\u4fdd\u5728\u8303\u56f4\u9000\u51fa\u65f6\u5220\u9664\uff0c\u5e76\u9632\u6b62\u610f\u5916\u590d\u5236\u3002 \u5982\u679c\u5bf9\u8c61\u662f singly owned \u7684\uff0c\u4f46\u662f\u4ece\u591a\u4e2a\u4f4d\u7f6e\u5f15\u7528\uff0c\u4f8b\u5982\u5f53\u5df2\u77e5\u6307\u5411\u5bf9\u8c61\u81f3\u5c11\u4e0e\u6307\u9488\u672c\u8eab\u4e00\u6837\u957f\u65f6\uff0c\u5c06\u6ce8\u91ca\u4e0e\u5c06\u539f\u59cb\u6307\u9488\u5b58\u50a8\u5e76\u5b58\u50a8\u7684\u6784\u9020\u51fd\u6570\u76f8\u5173\u8054\uff0c\u5982\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u3002 // 'blah' must remain valid for the lifetime of this class MyClass(const Blah* blah) : blah_(blah) { } \u6ce8\u610f Kudu \u4ee3\u7801\u5e93\u7684\u8f83\u65e7\u90e8\u5206\u4f7f\u7528 gscoped_ptr \u800c\u4e0d\u662f unique_ptr \u3002\u8fd9\u4e9b\u90fd\u662f\u5728 Kudu \u91c7\u7528 C ++ 11 \u4e4b\u524d\u8fdb\u884c\u7684\u3002\u65b0\u4ee3\u7801\u4e0d\u5e94\u8be5\u4f7f\u7528 gscoped_ptr \uff0c\u9664\u975e\u9700\u8981\u4e0e\u73b0\u6709\u4ee3\u7801\u8fdb\u884c\u63a5\u53e3\u3002\u6216\u8005\uff0c\u8003\u8651\u5728\u60a8\u9047\u5230\u8fd9\u4e9b\u95ee\u9898\u65f6\u66f4\u65b0\u7528\u6cd5\u3002 \u6ce8\u610f \u4e25\u683c\u7981\u6b62\u4f7f\u7528 std :: auto_ptr \uff0c\u56e0\u4e3a\u5b83\u7684\u96be\u5ea6\u5927\u4e14\u6613\u51fa\u9519\u7684\u8bed\u4e49\u3002\u6b64\u5916\uff0c std :: auto_ptr \u81ea C ++ 11 \u88ab\u58f0\u660e\u4e3a\u4e0d\u63a8\u8350\u4f7f\u7528\u3002 Smart Pointers for Multiply-Owned Pointers ( \u591a\u6307\u9488\u6307\u9488\u7684\u667a\u80fd\u6307\u9488 ): \u867d\u7136 single ownership \u662f\u7406\u60f3\u7684\uff0c\u4f46\u6709\u65f6\u5019\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u7279\u522b\u662f\u5f53\u591a\u4e2a\u7ebf\u7a0b\u6b63\u5728\u8fd0\u884c\u65f6\uff0c\u6307\u9488\u7684\u751f\u547d\u5468\u671f\u6ca1\u6709\u660e\u786e\u5b9a\u4e49\u3002\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 std :: shared_ptr \u6216 Kudu \u81ea\u5df1\u7684 scoped_refptr \u4ece gutil/ref_counted.hpp \u3002\u8fd9\u4e9b\u673a\u5236\u4e2d\u7684\u6bcf\u4e00\u4e2a\u4f9d\u8d56\u4e8e\u5f15\u7528\u8ba1\u6570\uff0c\u4ee5\u4fbf\u5728\u6ca1\u6709\u66f4\u591a\u6307\u9488\u4fdd\u7559\u65f6\u81ea\u52a8\u5220\u9664\u6307\u793a\u3002\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u6307\u9488\u4e4b\u95f4\u7684\u5173\u952e\u533a\u522b\u662f scoped_refptr \u8981\u6c42\u5bf9\u8c61\u6269\u5c55\u4e00\u4e2a RefCounted \u57fa\u7c7b\uff0c\u5e76\u5c06\u5176\u5f15\u7528\u8ba1\u6570\u5b58\u50a8\u5728\u5bf9\u8c61\u5b58\u50a8\u672c\u8eab\u5185\uff0c\u800c shared_ptr \u5728\u5806\u4e0a\u7ef4\u62a4\u5355\u72ec\u7684\u5f15\u7528\u8ba1\u6570\u3002 \u5229\u5f0a\u662f\uff1a shared_ptr \u53ef\u4ee5\u4e0e\u4efb\u4f55\u7c7b\u578b\u7684\u5bf9\u8c61\u4e00\u8d77\u4f7f\u7528\uff0c\u800c\u4e0d\u9700\u8981\u4ece\u7279\u6b8a\u7684\u57fa\u7c7b\u6d3e\u751f\u5bf9\u8c61 \u6807\u51c6\u5e93\u7684\u4e00\u90e8\u5206\uff0c\u5927\u591a\u6570 C ++ \u5f00\u53d1\u4eba\u5458\u719f\u6089 \u652f\u6301 weak_ptr \u7684\u7528\u4f8b\uff1a \u5f53\u5bf9\u8c61\u4ec5\u5728\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u9700\u8981\u88ab\u8bbf\u95ee\u65f6\u624d\u662f\u4e34\u65f6\u6240\u6709\u6743 \u6253\u7834 shared_ptr \u7684\u5faa\u73af\u5f15\u7528\uff0c\u5982\u679c\u7531\u4e8e\u805a\u5408\u5b58\u5728\u4efb\u4f55\u5b58\u5728 \u60a8\u53ef\u4ee5\u5c06 shared_ptr \u8f6c\u6362\u4e3a weak_ptr \u5e76\u8fd4\u56de \u5982\u679c\u4f7f\u7528 std :: make_shared <>() \u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5219\u53ea\u80fd\u8fdb\u884c\u4e00\u6b21\u5206\u914d\uff08\u56e0\u4e3a C ++ 11; Standard \u4e2d\u7684\u975e\u7ed1\u5b9a\u7684\u8981\u6c42\uff09 \u5982\u679c\u4f7f\u7528 shared_ptr <T> p(new T) \u521b\u5efa\u65b0\u5bf9\u8c61\u9700\u8981\u4e24\u4e2a\u5206\u914d\uff08\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5f15\u7528\u8ba1\u6570\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5bf9\u8c61\uff09 \u5f15\u7528\u8ba1\u6570\u53ef\u80fd\u4e0d\u5728\u5806\u4e0a\u7684\u5bf9\u8c61\u9644\u8fd1\uff0c\u56e0\u6b64\u5728\u8bbf\u95ee\u65f6\u53ef\u80fd\u4f1a\u53d1\u751f\u989d\u5916\u7684\u9ad8\u901f\u7f13\u5b58\u672a\u547d\u4e2d shared_ptr \u5b9e\u4f8b\u672c\u8eab\u9700\u8981 16 \u4e2a\u5b57\u8282\uff08\u6307\u5411 ref \u8ba1\u6570\u7684\u6307\u9488\u548c\u6307\u5411\u5bf9\u8c61\u7684\u6307\u9488\uff09 scoped_refptr \u53ea\u9700\u8981\u4e00\u4e2a\u5206\u914d\uff0c\u5e76\u4e14 ref \u8ba1\u6570\u4e0e\u5bf9\u8c61\u5728\u540c\u4e00\u4e2a\u9ad8\u901f\u7f13\u5b58\u884c\u4e0a \u6307\u9488\u53ea\u9700\u8981 8 \u4e2a\u5b57\u8282\uff08\u56e0\u4e3a\u5f15\u7528\u8ba1\u6570\u5728\u5bf9\u8c61\u5185\uff09 \u5f53\u9700\u8981\u66f4\u591a\u63a7\u5236\u65f6\uff0c\u60a8\u53ef\u4ee5\u624b\u52a8\u589e\u52a0\u6216\u51cf\u5c11\u53c2\u8003\u8ba1\u6570 \u60a8\u53ef\u4ee5\u5c06\u539f\u59cb\u6307\u9488\u8f6c\u6362\u56de scoped_refptr \uff0c\u800c\u4e0d\u5fc5\u62c5\u5fc3\u53cc\u91cd\u91ca\u653e \u7531\u4e8e\u6211\u4eec\u63a7\u5236\u5b9e\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u529f\u80fd\uff0c\u4f8b\u5982\u8c03\u8bd5\u6784\u5efa\uff0c\u6355\u83b7\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5806\u6808\u8ddf\u8e2a\u4ee5\u5e2e\u52a9\u8c03\u8bd5\u6cc4\u6f0f\u3002 \u5f15\u7528\u5bf9\u8c61\u5fc5\u987b\u4ece RefCounted \u7ee7\u627f \u4e0d\u652f\u6301 weak_ptr \u7684\u7528\u4f8b \u7531\u4e8e scoped_refptr \u901a\u5e38\u8d8a\u6765\u8d8a\u5c0f\uff0c\u6240\u4ee5\u5c1d\u8bd5\u5728\u65b0\u4ee3\u7801\u4e2d\u4f7f\u7528\u800c\u4e0d\u662f shared_ptr \u3002\u73b0\u6709\u4ee3\u7801\u5728\u8bb8\u591a\u5730\u65b9\u4f7f\u7528 shared_ptr \u3002\u5f53\u4e0e\u8be5\u4ee3\u7801\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528 shared_ptr \u3002","title":"Pointers ( \u6307\u9488 )"},{"location":"16/#function-binding-and-callbacks","text":"\u73b0\u6709\u4ee3\u7801\u4f7f\u7528 boost :: bind \u548c boost :: function \u6765\u8fdb\u884c\u51fd\u6570\u7ed1\u5b9a\u548c\u56de\u8c03\u3002 \u5bf9\u4e8e\u65b0\u4ee3\u7801\uff0c\u8bf7\u4f7f\u7528 gutil \u4e2d\u7684\u56de\u8c03\u548c\u7ed1\u5b9a\u7c7b\u3002 \u867d\u7136\u529f\u80fd\u8f83\u5c11\uff08\u7ed1\u5b9a\u4e0d\u652f\u6301\u53c2\u6570\u5360\u4f4d\u7b26\uff0c\u5305\u88c5\u51fd\u6570\u6307\u9488\u6216\u51fd\u6570\u5bf9\u8c61\uff09\uff0c\u4f46\u5b83\u4eec\u901a\u8fc7\u53c2\u6570\u751f\u547d\u5468\u671f\u7ba1\u7406\u7684\u65b9\u5f0f\u63d0\u4f9b\u66f4\u591a\u9009\u9879\u3002 \u4f8b\u5982\uff0c\u5f53 Callback \u8d85\u51fa\u8303\u56f4\u65f6\uff0c\u7ed1\u5b9a\u53c2\u6570\u7684\u7c7b\u6269\u5c55 RefCounted \u5c06\u5728\u7ed1\u5b9a\u671f\u95f4\u9012\u589e\uff0c\u5e76\u51cf\u5c11\u3002 \u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 gutil/callback.h \u4e2d\u7684\u5927\u6587\u4ef6\u6ce8\u91ca\uff0c util/callback_bind-test.cc \u4f5c\u4e3a\u793a\u4f8b\u3002","title":"Function Binding and Callbacks ( \u51fd\u6570\u7ed1\u5b9a\u548c\u56de\u8c03\u00a0)"},{"location":"16/#cmake-style-guide-cmake","text":"CMake \u5141\u8bb8\u4ee5\u8f83\u4f4e\uff0c\u4e0a\u9650\u6216\u6df7\u5408\u5927\u5c0f\u5199\u7684\u547d\u4ee4\u3002 \u8981\u4fdd\u6301 CMake \u6587\u4ef6\u4e00\u81f4\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u51c6\u5219\uff1a \u5c0f\u5199\u7684 built-in commands add_subdirectory(some/path) \u5927\u5199\u7684 built-in arguments message(STATUS \"message goes here\") \u5927\u5199\u7684 custom commands or macros ADD_KUDU_TEST(some-test)","title":"CMake Style Guide ( CMake \u6837\u5f0f\u6307\u5357\u00a0)"},{"location":"16/#gflags","text":"Kudu \u4f7f\u7528 gflags \u8fdb\u884c\u547d\u4ee4\u884c\u548c\u57fa\u4e8e\u6587\u4ef6\u7684\u914d\u7f6e\u3002\u4f7f\u7528\u8fd9\u4e9b\u51c6\u5219\u6dfb\u52a0\u65b0\u7684 gflag \u3002\u6240\u6709\u65b0 gflags \u5fc5\u987b\u7b26\u5408\u8fd9\u4e9b\u51c6\u5219\u3002\u73b0\u6709\u7684\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u4ea7\u54c1\u5c06\u53ca\u65f6\u7b26\u5408\u89c4\u5b9a\u3002","title":"GFlags"},{"location":"16/#name","text":"gflag \u7684\u540d\u5b57\u4f20\u8fbe\u4e86\u5f88\u591a\u4fe1\u606f\uff0c\u6240\u4ee5\u9009\u62e9\u4e00\u4e2a\u597d\u540d\u5b57\u3002\u8be5\u540d\u79f0\u5c06\u4f20\u64ad\u5230\u5176\u4ed6\u7cfb\u7edf\uff0c\u5982 \u914d\u7f6e\u53c2\u8003 \u3002 \u591a\u5b57\u540d\u79f0\u7684\u4e0d\u540c\u90e8\u5206\u5e94\u4ee5\u4e0b\u5212\u7ebf\u5206\u9694\u3002\u4f8b\u5982\uff0c fs_data_dirs \u3002 \u8be5\u540d\u79f0\u5e94\u4ee5\u5176\u5f71\u54cd\u7684\u4e0a\u4e0b\u6587\u4e3a\u524d\u7f00\u3002\u4f8b\u5982\uff0c webserver_num_worker_threads \u548c cfile_default_block_size \u3002\u4e0a\u4e0b\u6587\u53ef\u80fd\u5f88\u96be\u5b9a\u4e49\uff0c\u6240\u4ee5\u8bf7\u8bb0\u4f4f\uff0c\u8fd9\u4e2a\u524d\u7f00\u5c06\u7528\u4e8e\u5c06\u7c7b\u4f3c\u7684 gflags \u7ec4\u5408\u5728\u4e00\u8d77\u3002\u5982\u679c gflag \u5f71\u54cd\u6574\u4e2a\u8fc7\u7a0b\uff0c\u90a3\u4e48\u5b83\u4e0d\u5e94\u8be5\u662f\u524d\u7f00\u3002 \u5982\u679c gflag \u662f\u4e00\u4e2a\u6570\u91cf\uff0c\u8be5\u540d\u79f0\u5e94\u8be5\u540e\u7f00\u5355\u4f4d\u3002\u4f8b\u5982\uff0c tablet_copy_idle_timeout_ms \u3002 \u5982\u6709\u53ef\u80fd\uff0c\u8bf7\u4f7f\u7528\u77ed\u540d\u79f0\u3002\u8fd9\u5c06\u4e3a\u624b\u52a8\u8f93\u5165\u547d\u4ee4\u884c\u9009\u9879\u7684\u4eba\u8282\u7701\u65f6\u95f4\u3002 \u8fd9\u4e2a\u540d\u79f0\u662f Kudu \u517c\u5bb9\u6027\u5408\u540c\u7684\u4e00\u90e8\u5206\uff0c\u4e0d\u5e94\u8be5\u6ca1\u6709\u5f88\u597d\u7684\u7406\u7531\u6765\u6539\u53d8\u3002","title":"Name ( \u540d\u79f0 )"},{"location":"16/#default-value","text":"\u9009\u62e9\u9ed8\u8ba4\u503c\u901a\u5e38\u5f88\u7b80\u5355\uff0c\u4f46\u50cf\u540d\u79f0\u4e00\u6837\uff0c\u5b83\u4f20\u64ad\u5230\u5176\u4ed6\u7cfb\u7edf\u4e2d\u3002 \u9ed8\u8ba4\u503c\u662f Kudu \u7684 compatibility contract ( \u517c\u5bb9\u6027\u5408\u540c ) \u7684\u4e00\u90e8\u5206\uff0c\u5982\u679c\u6ca1\u6709\u5f88\u597d\u7684\u7406\u7531\uff0c\u4e0d\u5e94\u8be5\u6539\u53d8\u3002","title":"Default value ( \u9ed8\u8ba4\u503c )"},{"location":"16/#description","text":"gflag \u7684\u63cf\u8ff0\u5e94\u8be5\u8865\u5145\u540d\u79f0\u5e76\u63d0\u4f9b\u5176\u4ed6\u4e0a\u4e0b\u6587\u548c\u4fe1\u606f\u3002\u4e0e\u540d\u79f0\u4e00\u6837\uff0c\u8bf4\u660e\u4f20\u64ad\u5230\u5176\u4ed6\u7cfb\u7edf\u3002 \u63cf\u8ff0\u53ef\u4ee5\u5305\u62ec\u591a\u4e2a\u53e5\u5b50\u3002\u6bcf\u4e2a\u90fd\u5e94\u8be5\u4ee5\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u5f00\u5934\uff0c\u4ee5\u4e00\u4e2a\u53e5\u70b9\u7ed3\u5c3e\uff0c\u5e76\u5728\u4e4b\u524d\u7684\u4e00\u4e2a\u7a7a\u683c\u5f00\u59cb\u3002 \u63cf\u8ff0\u4e0d\u5e94\u5305\u542b gflag \u7684\u7c7b\u578b\u6216\u9ed8\u8ba4\u503c;\u5b83\u4eec\u662f\u5e26\u5916\u63d0\u4f9b\u7684\u3002 \u63cf\u8ff0\u5e94\u8be5\u5728\u7b2c\u4e09\u4eba\u79f0\u3002\u4e0d\u8981\u4f7f\u7528\u50cf\u4f60\u8fd9\u6837\u7684\u8bdd\u3002 gflag \u63cf\u8ff0\u53ef\u4ee5\u81ea\u7531\u66f4\u6539; Kudu \u7684\u53d1\u884c\u9884\u8ba1\u4e0d\u4f1a\u4fdd\u6301\u4e0d\u53d8\u3002","title":"Description ( \u63cf\u8ff0 )"},{"location":"16/#tags","text":"Kudu \u7684 gflag \u6807\u8bb0\u673a\u5236\u4e3a\u6bcf\u4e2a gflag \u6dfb\u52a0\u4e86\u673a\u5668\u53ef\u8bfb\u4e0a\u4e0b\u6587\uff0c\u7528\u4e8e\u6d88\u8017\u7cfb\u7edf\uff0c\u5982\u6587\u6863\u6216\u7ba1\u7406\u5de5\u5177\u3002\u8bf7\u53c2\u9605 flag_tags.h \u4e2d\u7684\u5927\u5757\u6ce8\u91ca\uff0c\u4ee5\u83b7\u53d6\u51c6\u5219\u3002","title":"Tags ( \u6807\u5fd7 )"},{"location":"16/#miscellaneous","text":"\u907f\u514d\u4e3a\u540c\u4e00\u4e2a\u903b\u8f91\u53c2\u6570\u521b\u5efa\u591a\u4e2a gflags \u3002\u4f8b\u5982\uff0c\u8bb8\u591a Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\u9700\u8981\u914d\u7f6e\u4e00\u4e2a WAL \u76ee\u5f55\u3002\u800c\u4e0d\u662f\u521b\u5efa foo_wal_dir \u548c bar_wal_dir gflags \uff0c\u6700\u597d\u4f7f\u7528\u4e00\u4e2a\u5355\u4e00\u7684 kudu_wal_dir gflag \u6765\u666e\u904d\u4f7f\u7528\u3002","title":"Miscellaneous ( \u6742\u00a0)"},{"location":"16/#testing","text":"","title":"Testing ( \u6d4b\u8bd5 )"},{"location":"16/#all-new-code-should-have-tests","text":"\u5728\u73b0\u6709\u6587\u4ef6\u4e2d\u6dfb\u52a0\u65b0\u7684\u6d4b\u8bd5\uff0c\u6216\u6839\u636e\u9700\u8981\u521b\u5efa\u65b0\u7684\u6d4b\u8bd5\u6587\u4ef6\u3002","title":"All new code should have tests. ( \u6240\u6709\u65b0\u7684\u4ee3\u7801\u90fd\u5e94\u8be5\u6709\u6d4b\u8bd5\u3002\u00a0)"},{"location":"16/#all-bug-fixes-should-have-tests","text":"\u5982\u679c\u7531\u73b0\u6709\u6d4b\u8bd5\u7528\u4f8b\u89e6\u53d1\uff0c\u5219\u53ef\u4ee5\u4fee\u590d\u9519\u8bef\u800c\u4e0d\u6dfb\u52a0\u65b0\u6d4b\u8bd5\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5728 20 \u5206\u949f\u5de6\u53f3\u4e4b\u540e\u8fd0\u884c\u591a\u7ebf\u7a0b\u7cfb\u7edf\u6d4b\u8bd5\u65f6\u51fa\u73b0\u4e86\u4e00\u4e2a race \uff0c\u90a3\u4e48\u503c\u5f97\u5c1d\u8bd5\u66f4\u6709\u9488\u5bf9\u6027\u7684\u6d4b\u8bd5\u7528\u4f8b\u6765\u89e6\u53d1\u8be5\u9519\u8bef\u3002\u4f46\u662f\u5982\u679c\u8fd9\u5f88\u96be\u505a\uff0c\u73b0\u6709\u7684\u7cfb\u7edf\u6d4b\u8bd5\u5c31\u591f\u4e86\u3002","title":"All bug fixes should have tests. ( \u6240\u6709\u9519\u8bef\u4fee\u590d\u90fd\u5e94\u8be5\u6709\u6d4b\u8bd5\u3002\u00a0)"},{"location":"16/#tests-should-run-quickly-1s-1s","text":"\u5982\u679c\u8981\u7f16\u5199\u65f6\u95f4\u5bc6\u96c6\u7684\u6d4b\u8bd5\uff0c\u8bf7\u4f7f\u8fd0\u884c\u65f6\u4f9d\u8d56\u4e8e\u901a\u8fc7 KUDU_ALLOW_SLOW_TESTS \u73af\u5883\u53d8\u91cf\u542f\u7528\u7684 KuduTest#AllowSlowTests \uff0c\u5e76\u7531 Jenkins \u6d4b\u8bd5\u6267\u884c\u4f7f\u7528\u3002","title":"Tests should run quickly (&lt; 1s). ( \u6d4b\u8bd5\u5e94\u8be5\u5f88\u5feb\u8fd0\u884c\uff08&lt;1s\uff09\u3002\u00a0)"},{"location":"16/#tests-which-run-a-number-of-iterations-of-some-task-should-use-a-gflags-command-line-argument-for-the-number-of-iterations-gflags","text":"\u8fd9\u5bf9\u4e8e\u7f16\u5199\u5feb\u901f\u538b\u529b\u6d4b\u8bd5\u6216\u6027\u80fd\u6d4b\u8bd5\u975e\u5e38\u65b9\u4fbf\u3002","title":"Tests which run a number of iterations of some task should use a\u00a0gflags\u00a0command-line argument for the number of iterations. ( \u8fd0\u884c\u4e00\u4e9b\u4efb\u52a1\u7684\u8fed\u4ee3\u7684\u6d4b\u8bd5\u5e94\u8be5\u4f7f\u7528 gflags \u547d\u4ee4\u884c\u53c2\u6570\u6765\u6267\u884c\u8fed\u4ee3\u6b21\u6570\u3002\u00a0)"},{"location":"16/#commits-which-may-affect-performance-should-include-beforeafter-perf-stat1-output-perf-stat1","text":"\u8fd9\u5c06\u663e\u793a\u6027\u80fd\u63d0\u5347\u6216 non-regression ( \u4e0d\u56de\u5f52 )\u3002 Performance-sensitive ( \u6027\u80fd\u654f\u611f ) \u4ee3\u7801\u5e94\u5305\u62ec\u4e00\u4e9b\u53ef\u7528\u4f5c\u76ee\u6807\u57fa\u51c6\u6d4b\u8bd5\u7528\u4f8b\u3002","title":"Commits which may affect performance should include before/after\u00a0perf-stat(1)\u00a0output. ( \u53ef\u80fd\u5f71\u54cd\u6027\u80fd\u7684\u63d0\u4ea4\u5e94\u5305\u62ec\u5728 perf-stat(1) \u8f93\u51fa \u4e4b\u524d/\u4e4b\u540e\u3002\u00a0)"},{"location":"17/","text":"Export Control Notice ( \u51fa\u53e3\u7ba1\u5236\u901a\u77e5 ) \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/export_control.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813657 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Export Control Notice ( \u51fa\u53e3\u7ba1\u5236\u901a\u77e5 ) \u8be5\u5206\u53d1\u5305\u62ec\u52a0\u5bc6\u8f6f\u4ef6\u3002\u60a8\u76ee\u524d\u5c45\u4f4f\u7684\u56fd\u5bb6\u53ef\u80fd\u5bf9\u8fdb\u53e3\uff0c\u62e5\u6709\uff0c\u4f7f\u7528\uff0c\u548c/\u6216\u518d\u51fa\u53e3\u52a0\u5bc6\u8f6f\u4ef6\u7684\u5176\u4ed6\u56fd\u5bb6\u6709\u9650\u5236\u3002\u5728\u4f7f\u7528\u4efb\u4f55\u52a0\u5bc6\u8f6f\u4ef6\u4e4b\u524d\uff0c\u8bf7\u68c0\u67e5\u60a8\u6240\u5728\u56fd\u5bb6\u6709\u5173\u8fdb\u53e3\uff0c\u62e5\u6709\u6216\u4f7f\u7528\u548c\u518d\u51fa\u53e3\u52a0\u5bc6\u8f6f\u4ef6\u7684\u6cd5\u5f8b\uff0c\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u4ee5\u67e5\u770b\u662f\u5426\u5141\u8bb8\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u7f8e\u56fd\u5546\u52a1\u90e8\uff0c\u5de5\u4e1a\u548c\u5b89\u5168\u5c40\uff08 BIS \uff09\u5df2\u5c06\u8be5\u8f6f\u4ef6\u5206\u7c7b\u4e3a\u51fa\u53e3\u5546\u54c1\u7ba1\u7406\u7f16\u53f7\uff08 ECCN \uff09 5D002.C.1 \uff0c\u5176\u4e2d\u5305\u62ec\u4f7f\u7528\u6216\u6267\u884c\u4e0d\u5bf9\u79f0\u7b97\u6cd5\u7684\u52a0\u5bc6\u529f\u80fd\u7684\u4fe1\u606f\u5b89\u5168\u8f6f\u4ef6\u3002\u8be5 Apache Software Foundation \u53d1\u884c\u7248\u7684\u5f62\u5f0f\u548c\u65b9\u5f0f\u4f7f\u5176\u7b26\u5408\u8bb8\u53ef\u8bc1\u5f02\u5e38ENC\u6280\u672f\u8f6f\u4ef6\u65e0\u9650\u5236\uff08 TSU \uff09\u51fa\u53e3\uff08\u53c2\u89c1 BIS \u51fa\u53e3\u7ba1\u7406\u89c4\u5b9a\uff0c\u7b2c 740.13 \u8282\uff09\uff0c\u7528\u4e8e\u5bf9\u8c61\u4ee3\u7801\u548c\u6e90\u4ee3\u7801\u3002 \u4ee5\u4e0b\u63d0\u4f9b\u4e86\u6709\u5173\u52a0\u5bc6\u8f6f\u4ef6\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff1a \u8be5\u8f6f\u4ef6\u4f7f\u7528 OpenSSL \u542f\u7528 TLS \u52a0\u5bc6\u7684\u8fde\u63a5\uff0c\u751f\u6210\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u5bc6\u94a5\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b\u5bc6\u94a5\u751f\u6210\u548c\u9a8c\u8bc1\u7b7e\u540d\u3002 \u8be5\u8f6f\u4ef6\u4f7f\u7528 Java SE \u5b89\u5168\u5e93\uff0c\u5305\u62ec Java \u5b89\u5168\u5957\u63a5\u5b57\u6269\u5c55\uff08 JSSE \uff09\uff0c Java \u901a\u7528\u5b89\u5168\u670d\u52a1\uff08 JGSS \uff09\u548c Java \u8ba4\u8bc1\u548c\u6388\u6743 API \uff08 JAAS \uff09\uff0c\u4ee5\u63d0\u4f9b\u5b89\u5168\u8ba4\u8bc1\u548c TLS \u4fdd\u62a4\u7684\u4f20\u8f93\u3002","title":"Export Control Notice ( \u51fa\u53e3\u7ba1\u5236\u901a\u77e5 )"},{"location":"17/#export-control-notice","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/export_control.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813657 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Export Control Notice ( \u51fa\u53e3\u7ba1\u5236\u901a\u77e5 )"},{"location":"17/#export-control-notice_1","text":"\u8be5\u5206\u53d1\u5305\u62ec\u52a0\u5bc6\u8f6f\u4ef6\u3002\u60a8\u76ee\u524d\u5c45\u4f4f\u7684\u56fd\u5bb6\u53ef\u80fd\u5bf9\u8fdb\u53e3\uff0c\u62e5\u6709\uff0c\u4f7f\u7528\uff0c\u548c/\u6216\u518d\u51fa\u53e3\u52a0\u5bc6\u8f6f\u4ef6\u7684\u5176\u4ed6\u56fd\u5bb6\u6709\u9650\u5236\u3002\u5728\u4f7f\u7528\u4efb\u4f55\u52a0\u5bc6\u8f6f\u4ef6\u4e4b\u524d\uff0c\u8bf7\u68c0\u67e5\u60a8\u6240\u5728\u56fd\u5bb6\u6709\u5173\u8fdb\u53e3\uff0c\u62e5\u6709\u6216\u4f7f\u7528\u548c\u518d\u51fa\u53e3\u52a0\u5bc6\u8f6f\u4ef6\u7684\u6cd5\u5f8b\uff0c\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u4ee5\u67e5\u770b\u662f\u5426\u5141\u8bb8\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u7f8e\u56fd\u5546\u52a1\u90e8\uff0c\u5de5\u4e1a\u548c\u5b89\u5168\u5c40\uff08 BIS \uff09\u5df2\u5c06\u8be5\u8f6f\u4ef6\u5206\u7c7b\u4e3a\u51fa\u53e3\u5546\u54c1\u7ba1\u7406\u7f16\u53f7\uff08 ECCN \uff09 5D002.C.1 \uff0c\u5176\u4e2d\u5305\u62ec\u4f7f\u7528\u6216\u6267\u884c\u4e0d\u5bf9\u79f0\u7b97\u6cd5\u7684\u52a0\u5bc6\u529f\u80fd\u7684\u4fe1\u606f\u5b89\u5168\u8f6f\u4ef6\u3002\u8be5 Apache Software Foundation \u53d1\u884c\u7248\u7684\u5f62\u5f0f\u548c\u65b9\u5f0f\u4f7f\u5176\u7b26\u5408\u8bb8\u53ef\u8bc1\u5f02\u5e38ENC\u6280\u672f\u8f6f\u4ef6\u65e0\u9650\u5236\uff08 TSU \uff09\u51fa\u53e3\uff08\u53c2\u89c1 BIS \u51fa\u53e3\u7ba1\u7406\u89c4\u5b9a\uff0c\u7b2c 740.13 \u8282\uff09\uff0c\u7528\u4e8e\u5bf9\u8c61\u4ee3\u7801\u548c\u6e90\u4ee3\u7801\u3002 \u4ee5\u4e0b\u63d0\u4f9b\u4e86\u6709\u5173\u52a0\u5bc6\u8f6f\u4ef6\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff1a \u8be5\u8f6f\u4ef6\u4f7f\u7528 OpenSSL \u542f\u7528 TLS \u52a0\u5bc6\u7684\u8fde\u63a5\uff0c\u751f\u6210\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u5bc6\u94a5\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b\u5bc6\u94a5\u751f\u6210\u548c\u9a8c\u8bc1\u7b7e\u540d\u3002 \u8be5\u8f6f\u4ef6\u4f7f\u7528 Java SE \u5b89\u5168\u5e93\uff0c\u5305\u62ec Java \u5b89\u5168\u5957\u63a5\u5b57\u6269\u5c55\uff08 JSSE \uff09\uff0c Java \u901a\u7528\u5b89\u5168\u670d\u52a1\uff08 JGSS \uff09\u548c Java \u8ba4\u8bc1\u548c\u6388\u6743 API \uff08 JAAS \uff09\uff0c\u4ee5\u63d0\u4f9b\u5b89\u5168\u8ba4\u8bc1\u548c TLS \u4fdd\u62a4\u7684\u4f20\u8f93\u3002","title":"Export Control Notice ( \u51fa\u53e3\u7ba1\u5236\u901a\u77e5 )"},{"location":"2/","text":"Kudu \u5165\u95e8\u6307\u5357 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/quickstart.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813610 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Apache Kudu \u5feb\u901f\u5f00\u59cb \u6309\u7167\u8fd9\u4e9b\u8bf4\u660e\u8bbe\u7f6e\u548c\u8fd0\u884c Kudu VM \uff0c\u5e76\u5728\u51e0\u5206\u949f\u4e4b\u5185\u4ece Kudu \uff0c Kudu_Impala \u548c CDH \u5f00\u59cb\u3002 \u83b7\u5f97 Kudu \u5feb\u901f\u5f00\u59cb VM \u5148\u51b3\u6761\u4ef6 \u5b89\u88c5 Oracle Virtualbox \u3002 VM \u5df2\u7ecf\u901a\u8fc7\u6d4b\u8bd5\uff0c\u53ef\u4ee5\u5728 Ubuntu 14.04 \u4e0a\u4f7f\u7528 VirtualBox 4.3 \u7248\u672c\uff0c\u5e76\u5728 OSX 10.9 \u4e0a\u4f7f\u7528 VirtualBox 5 \u7684\u7248\u672c\u3002 VirtualBox \u4e5f\u5305\u542b\u5728\u5927\u591a\u6570\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668\u4e2d\uff1a apt-get \uff0c brew \u7b49\u3002 \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528 which VBoxManage \u547d\u4ee4\u786e\u4fdd VBoxManage \u5728\u60a8\u7684 PATH \u4e2d\u3002 \u5b89\u88c5 \u8981\u4e0b\u8f7d\u5e76\u542f\u52a8 VM \uff0c\u8bf7\u5728\u7ec8\u7aef\u7a97\u53e3\u4e2d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002 $ curl -s https://raw.githubusercontent.com/cloudera/kudu-examples/master/demo-vm-setup/bootstrap.sh | bash \u6b64\u547d\u4ee4\u4e0b\u8f7d\u4e00\u4e2a shell \u811a\u672c\uff0c\u8fd9\u4e2a\u811a\u672c\u514b\u9686\u4e86 kudu-example Git \u4ed3\u5e93\uff0c\u7136\u540e\u5c06\u5927\u7ea6 1.2 GB \u5927\u5c0f\u7684 VM \u6620\u50cf\u4e0b\u8f7d\u5230\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u4e2d\u3002\u60a8\u53ef\u4ee5\u5728\u6b64\u811a\u672c\u4e0b\u8f7d\u4e0b\u6765\u4e4b\u540e\u68c0\u67e5\u8fd9\u4e2a\u811a\u672c\u901a\u8fc7\u5220\u9664\u4e0a\u9762\u811a\u672c\u7684 | bash \u90e8\u5206\u3002\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7 SSH \u8fde\u63a5\u5230 guest \u865a\u62df\u673a\u6765\u9a8c\u8bc1\u4e00\u5207\u662f\u5426\u6b63\u5e38\uff1a $ ssh demo@quickstart.cloudera \u4e0a\u9762\u7684 username \u548c password \u90fd\u662f\u6f14\u793a\u3002\u6b64\u5916\uff0c\u6f14\u793a\u7528\u6237\u5177\u6709\u65e0\u5bc6\u7801\u7684 sudo \u6743\u9650\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5b89\u88c5\u5176\u4ed6\u8f6f\u4ef6\u548c\u7ba1\u7406 guest OS \u3002\u60a8\u8fd8\u53ef\u4ee5\u8bbf\u95ee kudu-examples \u4f5c\u4e3a /home/demo/kudu-examples/ \u4e2d\u7684\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u6216\u8005\u5728 host \u4e0a\u7684 VirtualBox \u5171\u4eab\u6587\u4ef6\u5939\u4f4d\u7f6e\u3002\u8fd9\u662f\u4f7f\u811a\u672c\u6216\u6570\u636e\u5bf9 guest \u53ef\u89c1\u7684\u4e00\u79cd\u5feb\u6377\u65b9\u5f0f\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5feb\u901f\u9a8c\u8bc1 Kudu \u548c Impala \u662f\u5426\u6b63\u5728\u8fd0\u884c\uff1a $ ps aux | grep kudu $ ps aux | grep impalad \u5982\u679c\u8fde\u63a5\u5230 VM \u6216\u5176\u4e2d\u4e00\u4e2a\u8fdb\u7a0b\u6ca1\u6709\u8fd0\u884c\u65f6\u51fa\u73b0\u95ee\u9898\uff0c\u8bf7\u52a1\u5fc5\u53c2\u9605 \u201c \u7591\u96be\u89e3\u7b54 \u201d \u90e8\u5206\u3002 \u52a0\u8f7d\u6570\u636e \u8981\u4f7f\u7528 Kudu \u548c Impala \u8fdb\u884c\u4e00\u4e9b\u5178\u578b\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u5c06\u4f7f\u7528 San Francisco MTA GPS dataset \u3002\u8be5\u6570\u636e\u96c6\u5305\u542b\u4ece SF MTA \u8f66\u961f\u7684\u603b\u7ebf\u4e0a\u5b89\u88c5\u7684\u4f20\u611f\u5668\u5468\u671f\u6027\u4f20\u8f93\u7684\u539f\u59cb\u4f4d\u7f6e\u6570\u636e\u3002 \u4e0b\u8f7d\u793a\u4f8b\u6570\u636e\u5e76\u5c06\u5176\u52a0\u8f7d\u5230 HDFS \u4e2d \u9996\u5148\u6211\u4eec\u5c06\u4e0b\u8f7d\u793a\u4f8b\u6570\u636e\u96c6\uff0c\u51c6\u5907\u5e76\u5c06\u5176\u4e0a\u4f20\u5230 HDFS \u96c6\u7fa4\u4e2d\u3002 SF MTA \u7684\u7ad9\u70b9\u901a\u5e38\u6709\u70b9\u6162\uff0c\u6240\u4ee5\u6211\u4eec\u4ece\u6570\u636e\u96c6\u4e2d\u955c\u50cf\u4e86\u4e00\u4e2a CSV \u6587\u4ef6\u6837\u672c\uff0c\u7f51\u5740\u4e3a http://kudu-sample-data.s3.amazonaws.com/sfmtaAVLRawData01012013.csv.gz \u539f\u59cb\u6570\u636e\u96c6\u4f7f\u7528 DOS \u7c7b\u578b\u7684\u884c\u7ed3\u5c3e\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u5728\u4e0a\u4f20\u8fc7\u7a0b\u4e2d\u4f7f\u7528 tr \u5c06\u5176\u8f6c\u6362\u4e3a UNIX \u98ce\u683c\u3002 $ wget http://kudu-sample-data.s3.amazonaws.com/sfmtaAVLRawData01012013.csv.gz $ hdfs dfs -mkdir /sfmta $ zcat sfmtaAVLRawData01012013.csv.gz | tr -d '\\r' | hadoop fs -put - /sfmta/data.csv \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5916\u90e8 Impala \u8868\u4ee5\u8bbf\u95ee\u7eaf\u6587\u672c\u6570\u636e\u3002\u8981\u5728\u865a\u62df\u673a\u4e2d\u8fde\u63a5\u5230 Impala \uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a ssh demo@quickstart.cloudera -t impala-shell \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a CREATE EXTERNAL TABLE sfmta_raw ( revision int, report_time string, vehicle_tag int, longitude float, latitude float, speed float, heading float ) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LOCATION '/sfmta/' TBLPROPERTIES ('skip.header.line.count'='1'); \u9a8c\u8bc1\u6570\u636e\u662f\u5426\u5b9e\u9645\u52a0\u8f7d\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a ``` SELECT count(*) FROM sfmta_raw; +----------+ | count(*) | +----------+ | 859086 | +----------+ ``` \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a Kudu \u8868\u5e76\u52a0\u8f7d\u6570\u636e\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u5c06\u5b57\u7b26\u4e32 report_time \u5b57\u6bb5\u8f6c\u6362\u4e3a unix \u98ce\u683c\u7684\u65f6\u95f4\u6233\uff0c\u4ee5\u4fbf\u66f4\u6709\u6548\u7684\u5b58\u50a8\u3002 ``` CREATE TABLE sfmta PRIMARY KEY (report_time, vehicle_tag) PARTITION BY HASH(report_time) PARTITIONS 8 STORED AS KUDU AS SELECT UNIX_TIMESTAMP(report_time, 'MM/dd/yyyy HH:mm:ss') AS report_time, vehicle_tag, longitude, latitude, speed, heading FROM sfmta_raw; +------------------------+ | summary | +------------------------+ | Inserted 859086 row(s) | +------------------------+ Fetched 1 row(s) in 5.75s ``` \u521b\u5efa\u7684\u8868\u4f7f\u7528\u590d\u5408\u4e3b\u952e\u3002\u6709\u5173 Impala \u7684\u6269\u5c55 SQL \u8bed\u6cd5\u7684\u66f4\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u8bf7\u53c2\u9605 Kudu Impala \u96c6\u6210 \u3002 \u8bfb\u53d6\u548c\u4fee\u6539\u6570\u636e \u73b0\u5728\u6570\u636e\u5b58\u50a8\u5728 Kudu \u4e2d\uff0c\u60a8\u53ef\u4ee5\u5bf9\u5176\u6267\u884c\u67e5\u8be2\u3002\u4ee5\u4e0b\u67e5\u8be2\u67e5\u627e\u5305\u542b\u6700\u9ad8\u8bb0\u5f55\u8f66\u901f\u7684\u6570\u636e\u70b9\u3002 SELECT * FROM sfmta ORDER BY speed DESC LIMIT 1; +-------------+-------------+--------------------+-------------------+-------------------+---------+ | report_time | vehicle_tag | longitude | latitude | speed | heading | +-------------+-------------+--------------------+-------------------+-------------------+---------+ | 1357022342 | 5411 | -122.3968811035156 | 37.76665878295898 | 68.33300018310547 | 82 | +-------------+-------------+--------------------+-------------------+-------------------+---------+ \u901a\u8fc7\u5feb\u901f\u7684 Google \u641c\u7d22\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd9\u8f86\u516c\u5171\u6c7d\u8f66\u5728 68MPH \u7684 16 \u8857\u4e0a\u4e1c\u884c\u3002\u4e4d\u4e00\u770b\uff0c\u8fd9\u4f3c\u4e4e\u4e0d\u592a\u53ef\u80fd\u662f\u771f\u5b9e\u7684\u3002\u4e5f\u8bb8\u6211\u4eec\u505a\u4e00\u4e9b\u7814\u7a76\uff0c\u53d1\u73b0\u8fd9\u8f86\u516c\u5171\u6c7d\u8f66\u7684\u4f20\u611f\u5668\u8bbe\u5907\u88ab\u6253\u7834\u4e86\uff0c\u6211\u4eec\u51b3\u5b9a\u5220\u9664\u6570\u636e\u3002\u4f7f\u7528 Kudu \u548c \u6807\u51c6 SQL \u8fd9\u662f\u975e\u5e38\u5bb9\u6613\u7ea0\u6b63\u7684\uff1a DELETE FROM sfmta WHERE vehicle_tag = '5411'; -- Modified 1169 row(s), 0 row error(s) in 0.25s \u4e0b\u4e00\u6b65 \u4ee5\u4e0a\u793a\u4f8b\u663e\u793a\u4e86\u5982\u4f55\u4f7f\u7528 Impala \u548c Kudu \u52a0\u8f7d\uff0c\u67e5\u8be2\u548c\u53d8\u66f4\u9759\u6001\u6570\u636e\u96c6\u3002\u7136\u800c\uff0c Kudu \u7684\u771f\u6b63\u5b9e\u529b\u662f\u4ee5\u6d41\u5a92\u4f53\u65b9\u5f0f\u5438\u6536\u548c\u7a81\u53d8\u6570\u636e\u7684\u80fd\u529b\u3002 \u4f5c\u4e3a\u5b66\u4e60 Kudu \u7f16\u7a0b API \u7684\u7ec3\u4e60\uff0c\u8bf7\u5c1d\u8bd5\u5b9e\u73b0\u4e00\u4e2a\u4f7f\u7528 SFMTA XML \u6570\u636e Feed \u7684\u7a0b\u5e8f\uff0c\u5c06\u8be5\u76f8\u540c\u7684\u6570\u636e\u96c6\u5b9e\u65f6\u6444\u53d6\u5230 Kudu \u8868\u4e2d\u3002 \u6545\u969c\u6392\u9664 \u901a\u8fc7 SSH \u8bbf\u95ee VM \u7684\u95ee\u9898 \u786e\u4fdd\u4e3b\u673a\u5df2\u5b89\u88c5 SSH \u5ba2\u6237\u7aef\u3002 \u786e\u4fdd VM \u6b63\u5728\u8fd0\u884c\uff0c\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5e76\u68c0\u67e5\u540d\u4e3a kudu-demo \u7684\u865a\u62df\u673a\uff1a $ VBoxManage list runningvms \u9a8c\u8bc1 VM \u7684 IP \u5730\u5740\u662f\u5426\u5305\u542b\u5728\u4e3b\u673a\u7684 /etc/hosts \u6587\u4ef6\u4e2d\u3002\u60a8\u5e94\u8be5\u770b\u5230\u4e00\u884c\u5305\u542b\u4e00\u4e2a IP \u5730\u5740\uff0c\u540e\u8ddf\u4e3b\u673a\u540d quickstart.cloudera \u3002\u8981\u68c0\u67e5\u6b63\u5728\u8fd0\u884c\u7684 VM \u7684 IP \u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u4e0b\u9762\u7684 VBoxManage \u547d\u4ee4\u3002 $ VBoxManage guestproperty get kudu-demo /VirtualBox/GuestInfo/Net/0/V4/IP Value: 192.168.56.100 \u5982\u679c\u60a8\u4ee5\u524d\u4f7f\u7528\u8fc7 Cloudera QuickStart VM \uff0c\u5219 .ssh/known_hosts \u6587\u4ef6\u53ef\u80fd\u5305\u542b\u5bf9\u5148\u524d VM \u7684 SSH \u51ed\u636e\u7684\u5f15\u7528\u3002\u4ece\u6b64\u6587\u4ef6\u5220\u9664\u5bf9 quickstart.cloudera \u7684\u4efb\u4f55\u5f15\u7528\u3002 \u5728 VirtualBox \u4e2d\u8fd0\u884c\u65f6\u7f3a\u5c11 SSE4.2 \u652f\u6301 \u8fd0\u884c Kudu \u76ee\u524d\u9700\u8981\u4e00\u4e2a\u652f\u6301 SSE4.2 ( Nehalem \u6216\u8005\u66f4\u9ad8\u7248\u672c\u7684 Intel ) \u7684 CPU \u3002\u8981\u901a\u8fc7 SSE4.2 \u652f\u6301\u8fdb\u5165 guest \u865a\u62df\u673a\uff0c\u8bf7\u53c2\u9605 VirtualBox \u6587\u6863 \u3002 \u4e0b\u4e00\u6b65 \u5b89\u88c5 Kudu \u914d\u7f6e Kudu","title":"Kudu \u5165\u95e8\u6307\u5357"},{"location":"2/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/quickstart.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813610 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu \u5165\u95e8\u6307\u5357"},{"location":"2/#apache-kudu","text":"\u6309\u7167\u8fd9\u4e9b\u8bf4\u660e\u8bbe\u7f6e\u548c\u8fd0\u884c Kudu VM \uff0c\u5e76\u5728\u51e0\u5206\u949f\u4e4b\u5185\u4ece Kudu \uff0c Kudu_Impala \u548c CDH \u5f00\u59cb\u3002","title":"Apache Kudu \u5feb\u901f\u5f00\u59cb"},{"location":"2/#kudu-vm","text":"","title":"\u83b7\u5f97 Kudu \u5feb\u901f\u5f00\u59cb VM"},{"location":"2/#_1","text":"\u5b89\u88c5 Oracle Virtualbox \u3002 VM \u5df2\u7ecf\u901a\u8fc7\u6d4b\u8bd5\uff0c\u53ef\u4ee5\u5728 Ubuntu 14.04 \u4e0a\u4f7f\u7528 VirtualBox 4.3 \u7248\u672c\uff0c\u5e76\u5728 OSX 10.9 \u4e0a\u4f7f\u7528 VirtualBox 5 \u7684\u7248\u672c\u3002 VirtualBox \u4e5f\u5305\u542b\u5728\u5927\u591a\u6570\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668\u4e2d\uff1a apt-get \uff0c brew \u7b49\u3002 \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528 which VBoxManage \u547d\u4ee4\u786e\u4fdd VBoxManage \u5728\u60a8\u7684 PATH \u4e2d\u3002","title":"\u5148\u51b3\u6761\u4ef6"},{"location":"2/#_2","text":"\u8981\u4e0b\u8f7d\u5e76\u542f\u52a8 VM \uff0c\u8bf7\u5728\u7ec8\u7aef\u7a97\u53e3\u4e2d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002 $ curl -s https://raw.githubusercontent.com/cloudera/kudu-examples/master/demo-vm-setup/bootstrap.sh | bash \u6b64\u547d\u4ee4\u4e0b\u8f7d\u4e00\u4e2a shell \u811a\u672c\uff0c\u8fd9\u4e2a\u811a\u672c\u514b\u9686\u4e86 kudu-example Git \u4ed3\u5e93\uff0c\u7136\u540e\u5c06\u5927\u7ea6 1.2 GB \u5927\u5c0f\u7684 VM \u6620\u50cf\u4e0b\u8f7d\u5230\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u4e2d\u3002\u60a8\u53ef\u4ee5\u5728\u6b64\u811a\u672c\u4e0b\u8f7d\u4e0b\u6765\u4e4b\u540e\u68c0\u67e5\u8fd9\u4e2a\u811a\u672c\u901a\u8fc7\u5220\u9664\u4e0a\u9762\u811a\u672c\u7684 | bash \u90e8\u5206\u3002\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7 SSH \u8fde\u63a5\u5230 guest \u865a\u62df\u673a\u6765\u9a8c\u8bc1\u4e00\u5207\u662f\u5426\u6b63\u5e38\uff1a $ ssh demo@quickstart.cloudera \u4e0a\u9762\u7684 username \u548c password \u90fd\u662f\u6f14\u793a\u3002\u6b64\u5916\uff0c\u6f14\u793a\u7528\u6237\u5177\u6709\u65e0\u5bc6\u7801\u7684 sudo \u6743\u9650\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5b89\u88c5\u5176\u4ed6\u8f6f\u4ef6\u548c\u7ba1\u7406 guest OS \u3002\u60a8\u8fd8\u53ef\u4ee5\u8bbf\u95ee kudu-examples \u4f5c\u4e3a /home/demo/kudu-examples/ \u4e2d\u7684\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u6216\u8005\u5728 host \u4e0a\u7684 VirtualBox \u5171\u4eab\u6587\u4ef6\u5939\u4f4d\u7f6e\u3002\u8fd9\u662f\u4f7f\u811a\u672c\u6216\u6570\u636e\u5bf9 guest \u53ef\u89c1\u7684\u4e00\u79cd\u5feb\u6377\u65b9\u5f0f\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5feb\u901f\u9a8c\u8bc1 Kudu \u548c Impala \u662f\u5426\u6b63\u5728\u8fd0\u884c\uff1a $ ps aux | grep kudu $ ps aux | grep impalad \u5982\u679c\u8fde\u63a5\u5230 VM \u6216\u5176\u4e2d\u4e00\u4e2a\u8fdb\u7a0b\u6ca1\u6709\u8fd0\u884c\u65f6\u51fa\u73b0\u95ee\u9898\uff0c\u8bf7\u52a1\u5fc5\u53c2\u9605 \u201c \u7591\u96be\u89e3\u7b54 \u201d \u90e8\u5206\u3002","title":"\u5b89\u88c5"},{"location":"2/#_3","text":"\u8981\u4f7f\u7528 Kudu \u548c Impala \u8fdb\u884c\u4e00\u4e9b\u5178\u578b\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u5c06\u4f7f\u7528 San Francisco MTA GPS dataset \u3002\u8be5\u6570\u636e\u96c6\u5305\u542b\u4ece SF MTA \u8f66\u961f\u7684\u603b\u7ebf\u4e0a\u5b89\u88c5\u7684\u4f20\u611f\u5668\u5468\u671f\u6027\u4f20\u8f93\u7684\u539f\u59cb\u4f4d\u7f6e\u6570\u636e\u3002 \u4e0b\u8f7d\u793a\u4f8b\u6570\u636e\u5e76\u5c06\u5176\u52a0\u8f7d\u5230 HDFS \u4e2d \u9996\u5148\u6211\u4eec\u5c06\u4e0b\u8f7d\u793a\u4f8b\u6570\u636e\u96c6\uff0c\u51c6\u5907\u5e76\u5c06\u5176\u4e0a\u4f20\u5230 HDFS \u96c6\u7fa4\u4e2d\u3002 SF MTA \u7684\u7ad9\u70b9\u901a\u5e38\u6709\u70b9\u6162\uff0c\u6240\u4ee5\u6211\u4eec\u4ece\u6570\u636e\u96c6\u4e2d\u955c\u50cf\u4e86\u4e00\u4e2a CSV \u6587\u4ef6\u6837\u672c\uff0c\u7f51\u5740\u4e3a http://kudu-sample-data.s3.amazonaws.com/sfmtaAVLRawData01012013.csv.gz \u539f\u59cb\u6570\u636e\u96c6\u4f7f\u7528 DOS \u7c7b\u578b\u7684\u884c\u7ed3\u5c3e\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u5728\u4e0a\u4f20\u8fc7\u7a0b\u4e2d\u4f7f\u7528 tr \u5c06\u5176\u8f6c\u6362\u4e3a UNIX \u98ce\u683c\u3002 $ wget http://kudu-sample-data.s3.amazonaws.com/sfmtaAVLRawData01012013.csv.gz $ hdfs dfs -mkdir /sfmta $ zcat sfmtaAVLRawData01012013.csv.gz | tr -d '\\r' | hadoop fs -put - /sfmta/data.csv \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5916\u90e8 Impala \u8868\u4ee5\u8bbf\u95ee\u7eaf\u6587\u672c\u6570\u636e\u3002\u8981\u5728\u865a\u62df\u673a\u4e2d\u8fde\u63a5\u5230 Impala \uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a ssh demo@quickstart.cloudera -t impala-shell \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a CREATE EXTERNAL TABLE sfmta_raw ( revision int, report_time string, vehicle_tag int, longitude float, latitude float, speed float, heading float ) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LOCATION '/sfmta/' TBLPROPERTIES ('skip.header.line.count'='1'); \u9a8c\u8bc1\u6570\u636e\u662f\u5426\u5b9e\u9645\u52a0\u8f7d\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a ``` SELECT count(*) FROM sfmta_raw; +----------+ | count(*) | +----------+ | 859086 | +----------+ ``` \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a Kudu \u8868\u5e76\u52a0\u8f7d\u6570\u636e\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u5c06\u5b57\u7b26\u4e32 report_time \u5b57\u6bb5\u8f6c\u6362\u4e3a unix \u98ce\u683c\u7684\u65f6\u95f4\u6233\uff0c\u4ee5\u4fbf\u66f4\u6709\u6548\u7684\u5b58\u50a8\u3002 ``` CREATE TABLE sfmta PRIMARY KEY (report_time, vehicle_tag) PARTITION BY HASH(report_time) PARTITIONS 8 STORED AS KUDU AS SELECT UNIX_TIMESTAMP(report_time, 'MM/dd/yyyy HH:mm:ss') AS report_time, vehicle_tag, longitude, latitude, speed, heading FROM sfmta_raw; +------------------------+ | summary | +------------------------+ | Inserted 859086 row(s) | +------------------------+ Fetched 1 row(s) in 5.75s ``` \u521b\u5efa\u7684\u8868\u4f7f\u7528\u590d\u5408\u4e3b\u952e\u3002\u6709\u5173 Impala \u7684\u6269\u5c55 SQL \u8bed\u6cd5\u7684\u66f4\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u8bf7\u53c2\u9605 Kudu Impala \u96c6\u6210 \u3002","title":"\u52a0\u8f7d\u6570\u636e"},{"location":"2/#_4","text":"\u73b0\u5728\u6570\u636e\u5b58\u50a8\u5728 Kudu \u4e2d\uff0c\u60a8\u53ef\u4ee5\u5bf9\u5176\u6267\u884c\u67e5\u8be2\u3002\u4ee5\u4e0b\u67e5\u8be2\u67e5\u627e\u5305\u542b\u6700\u9ad8\u8bb0\u5f55\u8f66\u901f\u7684\u6570\u636e\u70b9\u3002 SELECT * FROM sfmta ORDER BY speed DESC LIMIT 1; +-------------+-------------+--------------------+-------------------+-------------------+---------+ | report_time | vehicle_tag | longitude | latitude | speed | heading | +-------------+-------------+--------------------+-------------------+-------------------+---------+ | 1357022342 | 5411 | -122.3968811035156 | 37.76665878295898 | 68.33300018310547 | 82 | +-------------+-------------+--------------------+-------------------+-------------------+---------+ \u901a\u8fc7\u5feb\u901f\u7684 Google \u641c\u7d22\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd9\u8f86\u516c\u5171\u6c7d\u8f66\u5728 68MPH \u7684 16 \u8857\u4e0a\u4e1c\u884c\u3002\u4e4d\u4e00\u770b\uff0c\u8fd9\u4f3c\u4e4e\u4e0d\u592a\u53ef\u80fd\u662f\u771f\u5b9e\u7684\u3002\u4e5f\u8bb8\u6211\u4eec\u505a\u4e00\u4e9b\u7814\u7a76\uff0c\u53d1\u73b0\u8fd9\u8f86\u516c\u5171\u6c7d\u8f66\u7684\u4f20\u611f\u5668\u8bbe\u5907\u88ab\u6253\u7834\u4e86\uff0c\u6211\u4eec\u51b3\u5b9a\u5220\u9664\u6570\u636e\u3002\u4f7f\u7528 Kudu \u548c \u6807\u51c6 SQL \u8fd9\u662f\u975e\u5e38\u5bb9\u6613\u7ea0\u6b63\u7684\uff1a DELETE FROM sfmta WHERE vehicle_tag = '5411'; -- Modified 1169 row(s), 0 row error(s) in 0.25s","title":"\u8bfb\u53d6\u548c\u4fee\u6539\u6570\u636e"},{"location":"2/#_5","text":"\u4ee5\u4e0a\u793a\u4f8b\u663e\u793a\u4e86\u5982\u4f55\u4f7f\u7528 Impala \u548c Kudu \u52a0\u8f7d\uff0c\u67e5\u8be2\u548c\u53d8\u66f4\u9759\u6001\u6570\u636e\u96c6\u3002\u7136\u800c\uff0c Kudu \u7684\u771f\u6b63\u5b9e\u529b\u662f\u4ee5\u6d41\u5a92\u4f53\u65b9\u5f0f\u5438\u6536\u548c\u7a81\u53d8\u6570\u636e\u7684\u80fd\u529b\u3002 \u4f5c\u4e3a\u5b66\u4e60 Kudu \u7f16\u7a0b API \u7684\u7ec3\u4e60\uff0c\u8bf7\u5c1d\u8bd5\u5b9e\u73b0\u4e00\u4e2a\u4f7f\u7528 SFMTA XML \u6570\u636e Feed \u7684\u7a0b\u5e8f\uff0c\u5c06\u8be5\u76f8\u540c\u7684\u6570\u636e\u96c6\u5b9e\u65f6\u6444\u53d6\u5230 Kudu \u8868\u4e2d\u3002","title":"\u4e0b\u4e00\u6b65"},{"location":"2/#_6","text":"","title":"\u6545\u969c\u6392\u9664"},{"location":"2/#ssh-vm","text":"\u786e\u4fdd\u4e3b\u673a\u5df2\u5b89\u88c5 SSH \u5ba2\u6237\u7aef\u3002 \u786e\u4fdd VM \u6b63\u5728\u8fd0\u884c\uff0c\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5e76\u68c0\u67e5\u540d\u4e3a kudu-demo \u7684\u865a\u62df\u673a\uff1a $ VBoxManage list runningvms \u9a8c\u8bc1 VM \u7684 IP \u5730\u5740\u662f\u5426\u5305\u542b\u5728\u4e3b\u673a\u7684 /etc/hosts \u6587\u4ef6\u4e2d\u3002\u60a8\u5e94\u8be5\u770b\u5230\u4e00\u884c\u5305\u542b\u4e00\u4e2a IP \u5730\u5740\uff0c\u540e\u8ddf\u4e3b\u673a\u540d quickstart.cloudera \u3002\u8981\u68c0\u67e5\u6b63\u5728\u8fd0\u884c\u7684 VM \u7684 IP \u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u4e0b\u9762\u7684 VBoxManage \u547d\u4ee4\u3002 $ VBoxManage guestproperty get kudu-demo /VirtualBox/GuestInfo/Net/0/V4/IP Value: 192.168.56.100 \u5982\u679c\u60a8\u4ee5\u524d\u4f7f\u7528\u8fc7 Cloudera QuickStart VM \uff0c\u5219 .ssh/known_hosts \u6587\u4ef6\u53ef\u80fd\u5305\u542b\u5bf9\u5148\u524d VM \u7684 SSH \u51ed\u636e\u7684\u5f15\u7528\u3002\u4ece\u6b64\u6587\u4ef6\u5220\u9664\u5bf9 quickstart.cloudera \u7684\u4efb\u4f55\u5f15\u7528\u3002","title":"\u901a\u8fc7 SSH \u8bbf\u95ee VM \u7684\u95ee\u9898"},{"location":"2/#virtualbox-sse42","text":"\u8fd0\u884c Kudu \u76ee\u524d\u9700\u8981\u4e00\u4e2a\u652f\u6301 SSE4.2 ( Nehalem \u6216\u8005\u66f4\u9ad8\u7248\u672c\u7684 Intel ) \u7684 CPU \u3002\u8981\u901a\u8fc7 SSE4.2 \u652f\u6301\u8fdb\u5165 guest \u865a\u62df\u673a\uff0c\u8bf7\u53c2\u9605 VirtualBox \u6587\u6863 \u3002","title":"\u5728 VirtualBox \u4e2d\u8fd0\u884c\u65f6\u7f3a\u5c11 SSE4.2 \u652f\u6301"},{"location":"2/#_7","text":"\u5b89\u88c5 Kudu \u914d\u7f6e Kudu","title":"\u4e0b\u4e00\u6b65"},{"location":"3/","text":"\u5b89\u88c5\u6307\u5357 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/installation.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813613 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 \u5b89\u88c5 Apache Kudu \u60a8\u53ef\u4ee5\u4f7f\u7528\u8f6f\u4ef6\u5305\u5728\u96c6\u7fa4\u4e0a\u90e8\u7f72 Kudu \uff0c\u4e5f\u53ef\u4ee5\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u3002\u8981\u8fd0\u884c Kudu \u800c\u4e0d\u5b89\u88c5\u4efb\u4f55\u4e1c\u897f\uff0c\u8bf7\u4f7f\u7528 Kudu QuickStart VM \u3002 \u6ce8\u610f Kudu \u76ee\u524d\u66f4\u5bb9\u6613\u4f7f\u7528 Cloudera Manager 5.4.7 \u6216\u66f4\u9ad8\u7248\u672c\u8fdb\u884c\u5b89\u88c5\u548c\u7ba1\u7406\u3002\u5982\u679c\u60a8\u4f7f\u7528 Cloudera Manager \uff0c\u8bf7\u53c2\u9605 Cloudera \u7684 Kudu \u6587\u6863 \u3002 \u5347\u7ea7 Kudu \u8981\u4ece\u4ee5\u524d\u7684\u7248\u672c\u5347\u7ea7 Kudu \uff0c\u8bf7\u53c2\u9605\u4ece\u4ee5\u524d\u7248\u672c\u7684 Kudu \u5347\u7ea7 \u3002 \u5148\u51b3\u6761\u4ef6\u548c\u8981\u6c42 \u786c\u4ef6 \u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4e3b\u673a\u8fd0\u884c Kudu masters \u3002\u5efa\u8bae\u4f7f\u7528\u4e00\u4e2a\u4e3b\u7ad9 ( master ) ( \u65e0\u5bb9\u9519 )\uff0c\u4e09\u4e2a masters ( \u53ef\u4ee5\u5bb9\u5fcd\u4e00\u4e2a\u6545\u969c ) \u6216 \u4e94\u4e2a masters ( \u53ef\u4ee5\u5bb9\u5fcd\u4e24\u4e2a\u6545\u969c )\u3002 \u8fd0\u884c Kudu tablet servers \u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u673a\u3002\u4f7f\u7528\u526f\u672c\u65f6\uff0c\u81f3\u5c11\u9700\u8981\u4e09\u4e2a tablet servers \u3002 \u64cd\u4f5c\u7cfb\u7edf\u8981\u6c42 Linux RHEL 6 \uff0c RHEL 7 \uff0c CentOS 6 \uff0c CentOS 7 \uff0c Ubuntu 14.04 (Trusty) \uff0c Ubuntu 16.04 (Xenial) \uff0c Debian 8 (Jessie ) \uff0c \u6216 SLES 12 \u3002 \u652f\u6301 hole punching ( \u6253\u5b54\u7684 ) \u5185\u6838\u548c\u6587\u4ef6\u7cfb\u7edf\u3002\u6253\u5b54\u662f\u4f7f\u7528 FALLOC_FL_PUNCH_HOLE \u9009\u9879\u8bbe\u7f6e\u7684 fallocate(2) \u7cfb\u7edf\u8c03\u7528\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u6545\u969c\u6392\u9664 hole punching \u3002 ntp \u3002 xfs \u6216\u8005 ext4 \u683c\u5f0f\u5316\u7684\u9a71\u52a8\u5668\u3002 macOS OS X 10.10 Yosemite \uff0c OS X 10.11 El Capitan \uff0c \u6216 macOS Sierra \u3002 \u672a\u63d0\u4f9b\u9884\u5efa\u7684 macOS \u5305\u3002 Windows Microsoft Windows \u4e0d\u53d7\u652f\u6301\u3002 Storage ( \u5b58\u50a8 ) \u5982\u679c\u56fa\u6001\u5b58\u50a8\u53ef\u7528\uff0c\u5728\u8fd9\u79cd\u9ad8\u6027\u80fd\u4ecb\u8d28\u4e0a\u5b58\u50a8 Kudu WAL \u53ef\u4ee5\u663e\u8457\u6539\u5584 Kudu \u914d\u7f6e\u4e3a\u5176\u6700\u9ad8\u8010\u4e45\u6027\u6c34\u5e73\u65f6\u7684\u5ef6\u8fdf\u3002 Management ( \u7ba1\u7406 ) \u5982\u679c\u60a8\u4f7f\u7528 Cloudera Manager \u548c CDH \uff0c\u5219\u9700\u8981 C loudera Manager 5.4.3 \u6216\u66f4\u9ad8\u7248\u672c\u3002 Cloudera Manager 5.4.7 \u53ca\u66f4\u65b0\u7248\u672c\u63d0\u4f9b\u66f4\u597d\u7684\u76d1\u63a7\u548c\u7ba1\u7406\u9009\u9879\u3002 \u4f7f\u7528\u5305\u5b89\u88c5 \u60a8\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u7684\u8f6f\u4ef6\u5305\u6765\u5b89\u88c5 Kudu \u3002 \u88681. Kudu \u5305\u4f4d\u7f6e OS ( \u64cd\u4f5c\u7cfb\u7edf ) Repository ( \u5b58\u50a8\u5e93 ) Individual Packages ( \u5355\u4e2a\u5305 ) RHEL \u6216 CentOS RHEL 6 or CentOS 6 , RHEL 7 or CentOS 7 RHEL 6 or CentOS 6 , RHEL 7 or CentOS 7 SLES SLES 12 SLES 12 Ubuntu Trusty , Xenial Trusty , Xenial Debian Jessie Jessie \u5b89\u88c5\u5728 RHEL \u6216 CentOS \u4e3b\u673a\u4e0a \u4e0b\u8f7d\u5e76\u914d\u7f6e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684 Kudu \u5b58\u50a8\u5e93\uff0c\u6216\u4f7f\u7528 Kudu Package Locations \u7684\u76f8\u5e94\u94fe\u63a5\u624b\u52a8\u4e0b\u8f7d\u5404\u4e2a RPM \u3002 \u5982\u679c\u4f7f\u7528 Yum \u5b58\u50a8\u5e93\uff0c\u8bf7\u5728\u5c06 cloudera-kudu.repo \u6587\u4ef6\u4fdd\u5b58\u5230 /etc/yum.repos.d/ \u4e4b\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u5b89\u88c5 Kudu \u8f6f\u4ef6\u5305\u3002 sudo yum install kudu # Base Kudu files sudo yum install kudu-master # Kudu master init.d service script and default configuration sudo yum install kudu-tserver # Kudu tablet server init.d service script and default configuration sudo yum install kudu-client0 # Kudu C++ client shared library sudo yum install kudu-client-devel # Kudu C++ client SDK \u8981\u624b\u52a8\u5b89\u88c5 Kudu RPM \uff0c\u9996\u5148\u4e0b\u8f7d\u5b83\u4eec\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4 sudo rpm -ivh <RPM\u5b89\u88c5> \u6765\u5b89\u88c5\u3002 \u6ce8\u610f\uff1a kudu-master \u548c kudu-tserver \u8f6f\u4ef6\u5305\u4ec5\u5728\u5206\u522b\u6709 master \u6216 tserver \u7684\u4e3b\u673a\u4e0a\u9700\u8981 ( \u5982\u679c\u4f7f\u7528 Cloudera Manager \u5219\u5b8c\u5168\u4e0d\u5fc5\u8981 )\u3002\u6bcf\u4e2a\u63d0\u4f9b\u914d\u7f6e\u6587\u4ef6\u548c\u4e00\u4e2a init.d \u811a\u672c\u6765\u7ba1\u7406\u76f8\u5e94\u7684 Kudu \u8fdb\u7a0b\u3002\u4e00\u65e6\u5b89\u88c5\uff0c Kudu \u8fdb\u7a0b\u5c06\u5728\u4e3b\u673a\u542f\u52a8\u5e76\u5173\u95ed\u65f6\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\u3002 \u5b89\u88c5\u5728 SLES \u4e3b\u673a\u4e0a \u4e0b\u8f7d\u5e76\u914d\u7f6e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684 Kudu \u5b58\u50a8\u5e93\uff0c\u6216\u4f7f\u7528 Kudu Package Locations \u7684\u76f8\u5e94\u94fe\u63a5\u624b\u52a8\u4e0b\u8f7d\u5404\u4e2a RPM \u3002 \u5982\u679c\u4f7f\u7528 Zypper \u5b58\u50a8\u5e93\uff0c\u8bf7\u5728\u5c06 cloudera-kudu.repo \u6587\u4ef6\u4fdd\u5b58\u5230 /etc/zypper/repos.d \u4e4b\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u5b89\u88c5 Kudu \u8f6f\u4ef6\u5305\u3002 sudo zypper install kudu # Base Kudu files sudo zypper install kudu-master # Kudu master init.d service script and default configuration sudo zypper install kudu-tserver # Kudu tablet server init.d service script and default configuration sudo zypper install kudu-client0 # Kudu C++ client shared library sudo zypper install kudu-client-devel # Kudu C++ client SDK \u8981\u624b\u52a8\u5b89\u88c5 Kudu RPM \uff0c\u9996\u5148\u4e0b\u8f7d\u5b83\u4eec\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4 sudo rpm -ivh <RPM\u5b89\u88c5> \u6765\u5b89\u88c5\u3002 \u6ce8\u610f\uff1a kudu-master \u548c kudu-tserver \u8f6f\u4ef6\u5305\u4ec5\u5728\u5206\u522b\u6709 master \u6216 tserver \u7684\u4e3b\u673a\u4e0a\u9700\u8981 ( \u5982\u679c\u4f7f\u7528 Cloudera Manager \u5219\u5b8c\u5168\u4e0d\u5fc5\u8981 )\u3002\u6bcf\u4e2a\u63d0\u4f9b\u914d\u7f6e\u6587\u4ef6\u548c\u4e00\u4e2a init.d \u811a\u672c\u6765\u7ba1\u7406\u76f8\u5e94\u7684 Kudu \u8fdb\u7a0b\u3002\u4e00\u65e6\u5b89\u88c5\uff0c Kudu \u8fdb\u7a0b\u5c06\u5728\u4e3b\u673a\u542f\u52a8\u5e76\u5173\u95ed\u65f6\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\u3002 \u5b89\u88c5\u5728 Ubuntu \u6216 Debian \u4e3b\u673a\u4e0a \u5982\u679c\u4f7f\u7528 ubuntu \u6216 debian \u5b58\u50a8\u5e93\uff0c\u8bf7\u5728\u5c06 cloudera.list \u6587\u4ef6\u4fdd\u5b58\u5230 /etc/apt/sources.list.d/ \u4e4b\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u5b89\u88c5 Kudu \u8f6f\u4ef6\u5305\u3002 sudo apt-get install kudu # Base Kudu files sudo apt-get install kudu-master # Service scripts for managing kudu-master sudo apt-get install kudu-tserver # Service scripts for managing kudu-tserver sudo apt-get install libkuduclient0 # Kudu C++ client shared library sudo apt-get install libkuduclient-dev # Kudu C++ client SDK \u8981\u624b\u52a8\u5b89\u88c5 Kudu RPM \uff0c\u9996\u5148\u4e0b\u8f7d\u5b83\u4eec\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4 sudo rpm -ivh <RPM\u5b89\u88c5> \u6765\u5b89\u88c5\u3002 \u6ce8\u610f\uff1a kudu-master \u548c kudu-tserver \u8f6f\u4ef6\u5305\u4ec5\u5728\u5206\u522b\u6709 master \u6216 tserver \u7684\u4e3b\u673a\u4e0a\u9700\u8981 ( \u5982\u679c\u4f7f\u7528 Cloudera Manager \u5219\u5b8c\u5168\u4e0d\u5fc5\u8981 ) \u3002\u6bcf\u4e2a\u63d0\u4f9b\u914d\u7f6e\u6587\u4ef6\u548c\u4e00\u4e2a init.d \u811a\u672c\u6765\u7ba1\u7406\u76f8\u5e94\u7684 Kudu \u8fdb\u7a0b\u3002\u4e00\u65e6\u5b89\u88c5\uff0c Kudu \u8fdb\u7a0b\u5c06\u5728\u4e3b\u673a\u542f\u52a8\u5e76\u5173\u95ed\u65f6\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\u3002 \u9a8c\u8bc1\u5b89\u88c5 \u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u6b63\u5728\u8fd0\u884c\uff1a * \u5728\u670d\u52a1\u5668\u4e0a\u68c0\u67e5 ps \u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u4ee5\u9a8c\u8bc1 kudu-master \u6216 kudu-tserver \u8fdb\u7a0b\u4e4b\u4e00\u6216\u4e24\u8005\u6b63\u5728\u8fd0\u884c\u3002 * \u6253\u5f00 Master \u6216\u8005 Tablet Server web UI \uff0c\u65b9\u6cd5\u662f\u6253\u5f00 http://< host_name >:8051/ for master \u6216\u8005 http://< host_name >:8050/ for tablet servers \u3002 \u5982\u679c Kudu \u6ca1\u6709\u8fd0\u884c\uff0c\u8bf7\u67e5\u770b '/var/log/kudu' \u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u4ee5 '.FATAL' \u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u90a3\u610f\u5473\u7740 Kudu \u65e0\u6cd5\u542f\u52a8\u3002 \u5982\u679c error \u662f \" Error during hole punch test\" \uff0c\u53ef\u80fd\u662f \u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684\u95ee\u9898 \u3002 \u5982\u679c error \u662f \" Couldn\u2019t get the current time \" \uff0c\u8fd9\u662f ntp \u7684\u95ee\u9898 \u3002 \u5982\u679c\u8fd9\u662f\u5176\u4ed6\u4f3c\u4e4e\u4e0d\u660e\u663e\u7684\u4e1c\u897f\uff0c\u6216\u8005\u5982\u679c\u60a8\u6ca1\u6709\u8fd0\u6c14\u5c1d\u8bd5\u4e0a\u8ff0\u89e3\u51b3\u65b9\u6848\uff0c\u60a8\u53ef\u4ee5\u5728 \u7528\u6237\u90ae\u4ef6\u5217\u8868 \u4e2d\u5bfb\u6c42\u5e2e\u52a9\u3002 \u5fc5\u9700\u914d\u7f6e \u5728\u542f\u52a8 Kudu \u670d\u52a1\u4e4b\u524d\uff0c\u9700\u8981\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u6267\u884c\u5176\u4ed6\u914d\u7f6e\u6b65\u9aa4\u3002 \u8fd9\u4e9b\u5305\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u5907\u7528\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a kudu-conf \u6761\u76ee\uff0c\u5e76\u4e14\u5b83\u4eec\u8fd0\u9001\u5185\u7f6e\u7684 conf.dist \u66ff\u4ee3\u3002\u8981\u8c03\u6574\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5\u7f16\u8f91 /etc/kudu/conf/ \u4e2d\u7684\u6587\u4ef6\uff0c\u6216\u8005\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9009\u9879\uff0c\u786e\u4fdd\u5b83\u662f /etc/kudu/conf/ \u6307\u5411\u7684\u94fe\u63a5\uff0c\u5728\u90a3\u91cc\u521b\u5efa\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u7684\u67d0\u4e9b\u90e8\u5206\u4e5f\u914d\u7f6e\u5728 /etc/default/kudu-master \u548c /etc/default/kudu-tserver \u6587\u4ef6\u4e2d\u3002\u5982\u679c\u521b\u5efa\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\uff0c\u60a8\u5e94\u8be5\u5305\u62ec\u6216\u8005\u590d\u5236\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002 \u67e5\u770b\u914d\u7f6e\uff0c\u5305\u62ec\u9ed8\u8ba4\u7684 WAL \u548c\u6570\u636e\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5e76\u6839\u636e\u60a8\u7684\u8981\u6c42\u8fdb\u884c\u8c03\u6574\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8 Kudu \u670d\u52a1\uff1a $ sudo service kudu-master start $ sudo service kudu-tserver start \u8981\u505c\u6b62 Kudu \u670d\u52a1\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a $ sudo service kudu-master stop $ sudo service kudu-tserver stop \u5c06 Kudu \u670d\u52a1\u914d\u7f6e\u4e3a\u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u81ea\u52a8\u542f\u52a8\uff0c\u5c06\u5176\u6dfb\u52a0\u5230\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\uff1a ``` $ sudo chkconfig kudu-master on # RHEL / CentOS / SLES $ sudo chkconfig kudu-tserver on # RHEL / CentOS / SLES $ sudo update-rc.d kudu-master defaults # Debian / Ubuntu $ sudo update-rc.d kudu-tserver defaults # Debian / Ubuntu ``` \u6709\u5173 Kudu \u670d\u52a1\u7684\u5176\u4ed6\u914d\u7f6e\uff0c\u8bf7\u53c2\u9605 \u914d\u7f6e Kudu \u3002 \u4ece\u6e90\u4ee3\u7801\u6784\u5efa \u5982\u679c\u4f7f\u7528\u5305\u88f9\u6216\u8005\u8f6f\u4ef6\u5305\u5b89\u88c5 Kudu \u4e0d\u80fd\u63d0\u4f9b\u6240\u9700\u7684\u7075\u6d3b\u6027\uff0c\u5219\u53ef\u4ee5\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u3002\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4ece\u6e90\u4ee3\u7801\u6784\u5efa\u3002 \u6ce8\u610f \u5df2\u77e5\u7684\u6784\u5efa\u95ee\u9898 \u4e0d\u53ef\u80fd\u5728 MicroSoft Windows \u4e0a\u6784\u5efa Kudu \u3002 \u9700\u8981\u4e00\u4e2a C+ 11 \u7f16\u8bd1\u5668 ( GCC 4.8 ) \u3002 RHEL \u6216\u8005 CentOS \u9700\u8981 RHEL \u6216\u8005 CentOS 6.6 \u6216\u66f4\u9ad8\u7248\u672c\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u3002\u8981\u5efa\u7acb\u5728 7.0 \u4ee5\u4e0a\u7684\u7248\u672c\u4e0a\uff0c\u5fc5\u987b\u5b89\u88c5 Red Hat Developer Toolset ( \u624d\u80fd\u8bbf\u95ee\u652f\u6301 C++ 11 \u7684\u7f16\u8bd1\u5668 )\u3002 \u5b89\u88c5\u5fc5\u5907\u5e93( \u5982\u679c\u6ca1\u6709\u5b89\u88c5 )\u3002 $ sudo yum install autoconf automake cyrus-sasl-devel cyrus-sasl-gssapi \\ cyrus-sasl-plain gcc gcc-c++ gdb git krb5-server krb5-workstation libtool \\ make openssl-devel patch pkgconfig redhat-lsb-core rsync unzip vim-common which \u5982\u679c\u5efa\u7acb\u5728 7.0 \u4ee5\u4e0a\u7684 RHEL \u6216 CentOS \u4e0a\uff0c\u8bf7\u5b89\u88c5 Red Hat Developer Toolset $ DTLS_RPM=rhscl-devtoolset-3-epel-6-x86_64-1-2.noarch.rpm $ DTLS_RPM_URL=https://www.softwarecollections.org/repos/rhscl/devtoolset-3/epel-6-x86_64/noarch/${DTLS_RPM} $ wget ${DTLS_RPM_URL} -O ${DTLS_RPM} $ sudo yum install -y scl-utils ${DTLS_RPM} $ sudo yum install -y devtoolset-3-toolchain \u53ef\u9009\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u6784\u5efa\u6587\u6863\uff0c\u8bf7\u5b89\u88c5\u5176\u4ed6\u5305\uff0c\u5305\u62ec ruby \u3002 $ sudo yum install doxygen gem graphviz ruby-devel zlib-devel \u6ce8\u610f \u5982\u679c\u5efa\u7acb\u5728 7.0 \u4ee5\u4e0a\u7684 RHEL \u6216\u8005 CentOS \u4e0a\uff0c\u5219\u53ef\u80fd\u9700\u8981\u4f7f\u7528 rubygems \u66ff\u6362 gem \u5305 \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002\u4e0d\u4f7f\u7528 devtoolset \u4f1a\u5bfc\u81f4\u4e3b\u673a\u7f16\u8bd1\u5668\u4f3c\u4e4e\u9700\u8981 libatomic \uff0c\u4f46\u627e\u4e0d\u5230\u5b83\u3002 $ build-support/enable_devtoolset.sh thirdparty/build-if-necessary.sh \u4f7f\u7528\u4e0a\u4e00\u6b65\u4e2d\u5b89\u88c5\u7684\u5b9e\u7528\u7a0b\u5e8f\u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 Kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002\u8bf7\u6ce8\u610f\uff0c devtoolset \u4ecd\u7136\u5fc5\u987b\u6307\u5b9a\uff0c\u5426\u5219\u60a8\u4f1a\u5f97\u5230 cc1plus \uff1a\u9519\u8bef\uff1a unrecognized command line option \"-std=c++11\" \u3002 mkdir -p build/release cd build/release ../../build-support/enable_devtoolset.sh \\ ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 \u53ef\u9009\uff1a\u5b89\u88c5 Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e93\u548c\u6807\u9898\u3002\u5982\u679c\u4e0d\u901a\u8fc7 DESTDIR \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u5b89\u88c5\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u4e3a /usr/local/ \u3002 sudo make DESTDIR=/opt/kudu install \u53ef\u9009\uff1a\u6784\u5efa\u6587\u6863\u3002\u6ce8\u610f\uff1a\u6b64\u547d\u4ee4\u6784\u5efa\u4e0d\u9002\u5408\u4e0a\u4f20\u5230 Kudu \u7f51\u7ad9\u7684\u672c\u5730\u6587\u6863\u3002 $ make docs \u793a\u4f8b 1 . RHEL / CentOS \u6784\u5efa\u811a\u672c \u6b64\u811a\u672c\u6982\u8ff0\u4e86\u5728\u65b0\u5b89\u88c5\u7684 RHEL \u6216 CentOS \u4e3b\u673a\u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u53ef\u7528\u4f5c\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u8df3\u8fc7\u4e0a\u9762\u6807\u8bb0\u4e3a\u53ef\u9009\u6b65\u9aa4\u7684\u6b65\u9aa4\u3002 #!/bin/bash sudo yum -y install autoconf automake cyrus-sasl-devel cyrus-sasl-gssapi \\ cyrus-sasl-plain gcc gcc-c++ gdb git krb5-server krb5-workstation libtool \\ make openssl-devel patch pkgconfig redhat-lsb-core rsync unzip vim-common which DTLS_RPM=rhscl-devtoolset-3-epel-6-x86_64-1-2.noarch.rpm DTLS_RPM_URL=https://www.softwarecollections.org/repos/rhscl/devtoolset-3/epel-6-x86_64/noarch/${DTLS_RPM} wget ${DTLS_RPM_URL} -O ${DTLS_RPM} sudo yum install -y scl-utils ${DTLS_RPM} sudo yum install -y devtoolset-3-toolchain git clone https://github.com/apache/kudu cd kudu build-support/enable_devtoolset.sh thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../build-support/enable_devtoolset.sh \\ ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 Ubuntu \u6216\u8005 Debian \u5b89\u88c5\u5fc5\u5907\u5e93 ( \u5982\u679c\u5b83\u4eec\u6ca1\u6709\u5b89\u88c5 ) $ sudo apt-get install autoconf automake curl g++ gcc gdb git \\ krb5-admin-server krb5-kdc krb5-user libkrb5-dev libsasl2-dev libsasl2-modules \\ libsasl2-modules-gssapi-mit libssl-dev libtool lsb-release make ntp openssl \\ patch pkg-config python rsync unzip vim-common \u53ef\u9009\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u6784\u5efa\u6587\u6863\uff0c\u8bf7\u5b89\u88c5\u5176\u4ed6\u5305\uff0c\u5305\u62ec ruby \u3002 $ sudo apt-get install doxygen gem graphviz ruby-dev xsltproc zlib1g-dev \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002 $ thirdparty/build-if-necessary.sh \u4f7f\u7528\u4e0a\u4e00\u6b65\u4e2d\u5b89\u88c5\u7684\u5b9e\u7528\u7a0b\u5e8f\u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002 mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake -DCMAKE_BUILD_TYPE=release ../.. make -j4 \u53ef\u9009\uff1a\u5b89\u88c5 Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e93\u548c\u6807\u9898\u3002\u5982\u679c\u4e0d\u901a\u8fc7 DESTDIR \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u5b89\u88c5\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u4e3a /usr/local/ \u3002 sudo make DESTDIR=/opt/kudu install \u53ef\u9009\uff1a\u6784\u5efa\u6587\u6863\u3002\u6ce8\u610f\uff1a\u6b64\u547d\u4ee4\u6784\u5efa\u4e0d\u9002\u5408\u4e0a\u4f20\u5230 Kudu \u7f51\u7ad9\u7684\u672c\u5730\u6587\u6863\u3002 $ make docs \u793a\u4f8b 2 . Ubuntu \u6216\u8005 Debian \u6784\u5efa\u811a\u672c \u8be5\u811a\u672c\u6982\u8ff0\u4e86\u5728 Ubuntu \u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u8df3\u8fc7\u4e0a\u9762\u6807\u8bb0\u4e3a\u53ef\u9009\u6b65\u9aa4\u7684\u6b65\u9aa4\u3002 #!/bin/bash sudo apt-get -y install autoconf automake curl g++ gcc gdb git \\ krb5-admin-server krb5-kdc krb5-user libkrb5-dev libsasl2-dev libsasl2-modules \\ libsasl2-modules-gssapi-mit libssl-dev libtool lsb-release make ntp openssl \\ patch pkg-config python rsync unzip vim-common git clone https://github.com/apache/kudu cd kudu thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 SUSE Linux Enterprise Server \u5b89\u88c5\u5fc5\u5907\u5e93\uff08\u5982\u679c\u6ca1\u6709\u5b89\u88c5\uff09\u3002 $ sudo zypper install autoconf automake curl cyrus-sasl-devel \\ cyrus-sasl-gssapi gcc gcc-c++ gdb git krb5-devel libtool lsb-release make ntp \\ openssl-devel patch pkg-config python rsync unzip vim \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002 $ thirdparty/build-if-necessary.sh \u4f7f\u7528\u4e0a\u4e00\u6b65\u4e2d\u5b89\u88c5\u7684\u5b9e\u7528\u7a0b\u5e8f\u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002 mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 \u53ef\u9009\uff1a\u5b89\u88c5 Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e93\u548c\u6807\u9898\u3002\u5982\u679c\u4e0d\u901a\u8fc7 DESTDIR \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u5b89\u88c5\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u4e3a /usr/local/ \u3002 sudo make DESTDIR=/opt/kudu install \u793a\u4f8b 3 .SLES \u6784\u5efa\u811a\u672c \u6b64\u811a\u672c\u6982\u8ff0\u4e86\u5728 SLES \u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u5e76\u53ef\u7528\u4f5c\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u8df3\u8fc7\u4e0a\u9762\u6807\u8bb0\u4e3a\u53ef\u9009\u6b65\u9aa4\u7684\u6b65\u9aa4\u3002 #!/bin/bash sudo zypper install -y autoconf automake curl cyrus-sasl-devel \\ cyrus-sasl-gssapi gcc gcc-c++ gdb git krb5-devel libtool lsb-release make ntp \\ openssl-devel patch pkg-config python rsync unzip vim git clone https://github.com/apache/kudu cd kudu thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 macOS Xcode \u5305\u662f\u7f16\u8bd1 Kudu \u6240\u5fc5\u9700\u7684\u3002\u4e0b\u9762\u7684\u4e00\u4e9b\u8bf4\u660e\u4f7f\u7528 Homebrew \u6765\u5b89\u88c5\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f46\u624b\u52a8\u4f9d\u8d56\u5b89\u88c5\u662f\u53ef\u80fd\u7684\u3002 \u6ce8\u610f macOS \u5df2\u77e5\u95ee\u9898 Kudu \u5bf9 macOS \u7684\u652f\u6301\u662f\u5b9e\u9a8c\u6027\u7684\uff0c\u53ea\u80fd\u7528\u4e8e\u5f00\u53d1\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 macOS \u9650\u5236\u548c\u5df2\u77e5\u95ee\u9898 \u3002 \u5b89\u88c5\u5fc5\u5907\u5e93\uff08\u5982\u679c\u6ca1\u6709\u5b89\u88c5\uff09\u3002 $ brew tap homebrew/dupes $ brew install autoconf automake cmake git krb5 libtool openssl pkg-config pstree \u53ef\u9009\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u6784\u5efa\u6587\u6863\uff0c\u8bf7\u5b89\u88c5\u5176\u4ed6\u5305\uff0c\u5305\u62ec ruby \u3002 $ brew install doxygen graphviz ruby $ brew install gnu-sed --with-default-names #The macOS default sed handles the -i parameter differently \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002 $ thirdparty/build-if-necessary.sh \u5982\u679c\u4e0d\u540c\u7248\u672c\u7684\u4f9d\u8d56\u5173\u7cfb\u5728\u8c03\u7528 thirdParty / build-if-necessary.sh \u65f6\u5b89\u88c5\u5e76\u4f7f\u7528\uff0c\u5219\u53ef\u80fd\u4f1a\u9047\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684\u8f93\u51fa\uff1a ./configure: line 16299: error near unexpected token `newline' ./configure: line 16299: ` PKG_CHECK_MODULES(' \u7b2c\u4e09\u65b9\u6784\u5efa\u53ef\u80fd\u88ab\u7f13\u5b58\uff0c\u5e76\u53ef\u80fd\u53cd\u6620\u4e0d\u6b63\u786e\u7248\u672c\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\u786e\u4fdd\u60a8\u5177\u6709\u6b65\u9aa41\u4e2d\u5217\u51fa\u7684\u6b63\u786e\u4f9d\u8d56\u9879\uff0c\u6e05\u7406\u5de5\u4f5c\u533a\uff0c\u7136\u540e\u5c1d\u8bd5\u91cd\u65b0\u6784\u5efa\u3002 $ git clean -fdx $ thirdparty/build-if-necessary.sh \u81ea\u5236\u5b89\u88c5\u548c\u7cfb\u7edf\u5347\u7ea7\u7684\u4e00\u4e9b\u7ec4\u5408\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u540c\u79cd\u7c7b\u7684\u9519\u8bef\uff1a libtool: Version mismatch error.\u2002\u2002This is libtool 2.4.6, but the libtool: definition of this LT_INIT comes from libtool 2.4.2. libtool: You should recreate aclocal.m4 with macros from libtool 2.4.6 libtool: and run autoconf again. \u5982 \u672c\u7ebf\u7a0b \u6240\u8ff0\uff0c\u53ef\u80fd\u7684\u4fee\u590d\u662f\u5378\u8f7d\u5e76\u91cd\u65b0\u5b89\u88c5 libtool \uff1a $ brew uninstall libtool && brew install libtool 5. \u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002 mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl \\ ../.. make -j4 \u793a\u4f8b 4. macOS \u6784\u5efa\u811a\u672c \u6b64\u811a\u672c\u6982\u8ff0\u4e86\u5728 MacOS \u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u53ef\u7528\u4f5c\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u5047\u5b9a\u5b89\u88c5\u4e86 Xcode \u548c Homebrew \u3002 #!/bin/bash brew tap homebrew/dupes brew install autoconf automake cmake git krb5 libtool openssl pkg-config pstree git clone https://github.com/apache/kudu cd kudu thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl \\ ../.. make -j4 \u5b89\u88c5 C++ \u5ba2\u6237\u7aef\u5e93 \u5982\u679c\u60a8\u9700\u8981\u8bbf\u95ee Kudu \u5ba2\u6237\u7aef\u5e93\u8fdb\u884c\u5f00\u53d1\uff0c\u8bf7\u4e3a\u60a8\u7684\u5e73\u53f0\u5b89\u88c5 kudu-client \u548c kudu-client-devel \u8f6f\u4ef6\u5305\u3002\u8bf7\u53c2\u9605 \u4f7f\u7528\u8f6f\u4ef6\u5305\u5b89\u88c5 \u3002 \u6ce8\u610f \u4ec5\u9488\u5bf9\u5ba2\u6237\u7aef\u5e93\u548c\u5934\uff08 kudu_client.so \u548c client.h \uff09\u6784\u5efa\u3002\u5176\u4ed6\u56fe\u4e66\u9986\u548c\u6807\u9898\u662f Kudu \u7684\u5185\u90e8\uff0c\u6ca1\u6709\u7a33\u5b9a\u7684\u4fdd\u8bc1\u3002 \u6784\u5efa Java \u5ba2\u6237\u7aef \u8981\u6c42 JDK 7 Apache Maven 3.x \u8981\u6784\u5efa Java \u5ba2\u6237\u7aef\uff0c\u8bf7\u514b\u9686 Kudu Git \u5b58\u50a8\u5e93\uff0c\u66f4\u6539\u4e3a java \u76ee\u5f55\uff0c\u5e76\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\uff1a $ mvn install -DskipTests \u6709\u5173\u6784\u5efa Java API \u4ee5\u53ca Eclipse \u96c6\u6210\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 java/README.md \u3002 \u67e5\u770b API \u6587\u6863 C++ API \u6587\u6863 \u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b C ++ \u5ba2\u6237\u7aef API \u6587\u6863 \u3002\u6216\u8005\uff0c\u5728 \u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\uff0c\u60a8\u8fd8\u53ef\u4ee5\u53e6\u5916\u6784\u5efa doxygen \u76ee\u6807\uff08\u4f8b\u5982\uff0c\u5982\u679c\u4f7f\u7528 make \uff0c\u5219\u8fd0\u884c make doxygen \uff09\uff0c\u5e76\u901a\u8fc7\u5728\u60a8\u6700\u559c\u6b22\u7684 Web \u4e2d\u6253\u5f00 docs/doxygen/client_api/html/index.html \u6587\u4ef6\u6765\u4f7f\u7528\u672c\u5730\u751f\u6210\u7684 API \u6587\u6863\u6d4f\u89c8\u5668\u3002 \u6ce8\u610f \u4e3a\u4e86\u6784\u5efa doxygen \u76ee\u6807\uff0c\u6709\u5fc5\u8981\u5728\u60a8\u7684\u6784\u5efa\u673a\u5668\u4e0a\u5b89\u88c5\u5e26\u6709 Dot\uff08graphviz\uff09 \u652f\u6301\u7684 doxygen \u3002\u5982\u679c\u60a8\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\u5b89\u88c5\u4e86 doxygen \uff0c\u5219\u9700\u8981\u518d\u6b21\u8fd0\u884c cmake \u4ee5\u83b7\u53d6 doxygen \u4f4d\u7f6e\u5e76\u751f\u6210\u9002\u5f53\u7684\u76ee\u6807\u3002 Java API \u6587\u6863 \u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b Java API \u6587\u6863 \u3002\u6216\u8005\uff0c\u5728 \u6784\u5efa Java \u5ba2\u6237\u7aef \u4e4b\u540e\uff0c Java API \u6587\u6863\u53ef\u4ee5\u5728 java/kudu-client/target/apidocs/index.html \u4e2d\u627e\u5230\u3002 \u4ece\u4ee5\u524d\u7248\u672c\u7684 Kudu \u5347\u7ea7 \u5347\u7ea7\u4e4b\u524d\uff0c\u60a8\u5e94\u8be5\u9605\u8bfb\u8981\u5b89\u88c5\u7684 Kudu \u7248\u672c\u7684\u53d1\u884c\u8bf4\u660e\u3002 \u5bc6\u5207\u5173\u6ce8\u4e0d\u517c\u5bb9\u6027\uff0c\u5347\u7ea7\u548c\u964d\u7ea7\u5728\u90a3\u91cc\u8bb0\u5f55\u7684\u7b14\u8bb0\u3002 \u6ce8\u610f \u76ee\u524d\u4e0d\u652f\u6301\u6eda\u52a8\u5347\u7ea7\u3002 \u5347\u7ea7\u8f6f\u4ef6\u4e4b\u524d\uff0c\u8bf7\u5173\u95ed\u6240\u6709\u7684 Kudu \u670d\u52a1\u3002 \u5347\u7ea7\u7a0b\u5e8f \u505c\u6b62 Kudu master \u548c tablet server \u670d\u52a1\uff1a $ sudo service kudu-master stop $ sudo service kudu-tserver stop \u5347\u7ea7\u8f6f\u4ef6\u5305\uff1a \u5728 RHEL \u6216\u8005 CentOS \u4e3b\u673a\u4e0a\uff1a sudo yum clean all sudo yum upgrade kudu \u5728 SLES \u4e3b\u673a\u4e0a\uff1a sudo zypper clean --all sudo zypper update kudu \u5728 Ubuntu \u6216\u8005 Debian \u4e3b\u673a\u4e0a\uff1a sudo apt-get update sudo apt-get install kudu \u542f\u52a8 Kudu master \u548c tablet server \u670d\u52a1\uff1a $ sudo service kudu-master start $ sudo service kudu-tserver start \u4e0b\u4e00\u6b65 \u914d\u7f6e Kudu \u7ba1\u7406 Kudu","title":"\u5b89\u88c5\u6307\u5357"},{"location":"3/#_1","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/installation.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813613 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u5b89\u88c5\u6307\u5357"},{"location":"3/#apache-kudu","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528\u8f6f\u4ef6\u5305\u5728\u96c6\u7fa4\u4e0a\u90e8\u7f72 Kudu \uff0c\u4e5f\u53ef\u4ee5\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u3002\u8981\u8fd0\u884c Kudu \u800c\u4e0d\u5b89\u88c5\u4efb\u4f55\u4e1c\u897f\uff0c\u8bf7\u4f7f\u7528 Kudu QuickStart VM \u3002 \u6ce8\u610f Kudu \u76ee\u524d\u66f4\u5bb9\u6613\u4f7f\u7528 Cloudera Manager 5.4.7 \u6216\u66f4\u9ad8\u7248\u672c\u8fdb\u884c\u5b89\u88c5\u548c\u7ba1\u7406\u3002\u5982\u679c\u60a8\u4f7f\u7528 Cloudera Manager \uff0c\u8bf7\u53c2\u9605 Cloudera \u7684 Kudu \u6587\u6863 \u3002","title":"\u5b89\u88c5 Apache Kudu"},{"location":"3/#kudu","text":"\u8981\u4ece\u4ee5\u524d\u7684\u7248\u672c\u5347\u7ea7 Kudu \uff0c\u8bf7\u53c2\u9605\u4ece\u4ee5\u524d\u7248\u672c\u7684 Kudu \u5347\u7ea7 \u3002","title":"\u5347\u7ea7 Kudu"},{"location":"3/#_2","text":"","title":"\u5148\u51b3\u6761\u4ef6\u548c\u8981\u6c42"},{"location":"3/#_3","text":"\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4e3b\u673a\u8fd0\u884c Kudu masters \u3002\u5efa\u8bae\u4f7f\u7528\u4e00\u4e2a\u4e3b\u7ad9 ( master ) ( \u65e0\u5bb9\u9519 )\uff0c\u4e09\u4e2a masters ( \u53ef\u4ee5\u5bb9\u5fcd\u4e00\u4e2a\u6545\u969c ) \u6216 \u4e94\u4e2a masters ( \u53ef\u4ee5\u5bb9\u5fcd\u4e24\u4e2a\u6545\u969c )\u3002 \u8fd0\u884c Kudu tablet servers \u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u673a\u3002\u4f7f\u7528\u526f\u672c\u65f6\uff0c\u81f3\u5c11\u9700\u8981\u4e09\u4e2a tablet servers \u3002","title":"\u786c\u4ef6"},{"location":"3/#_4","text":"","title":"\u64cd\u4f5c\u7cfb\u7edf\u8981\u6c42"},{"location":"3/#linux","text":"RHEL 6 \uff0c RHEL 7 \uff0c CentOS 6 \uff0c CentOS 7 \uff0c Ubuntu 14.04 (Trusty) \uff0c Ubuntu 16.04 (Xenial) \uff0c Debian 8 (Jessie ) \uff0c \u6216 SLES 12 \u3002 \u652f\u6301 hole punching ( \u6253\u5b54\u7684 ) \u5185\u6838\u548c\u6587\u4ef6\u7cfb\u7edf\u3002\u6253\u5b54\u662f\u4f7f\u7528 FALLOC_FL_PUNCH_HOLE \u9009\u9879\u8bbe\u7f6e\u7684 fallocate(2) \u7cfb\u7edf\u8c03\u7528\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u6545\u969c\u6392\u9664 hole punching \u3002 ntp \u3002 xfs \u6216\u8005 ext4 \u683c\u5f0f\u5316\u7684\u9a71\u52a8\u5668\u3002","title":"Linux"},{"location":"3/#macos","text":"OS X 10.10 Yosemite \uff0c OS X 10.11 El Capitan \uff0c \u6216 macOS Sierra \u3002 \u672a\u63d0\u4f9b\u9884\u5efa\u7684 macOS \u5305\u3002","title":"macOS"},{"location":"3/#windows","text":"Microsoft Windows \u4e0d\u53d7\u652f\u6301\u3002","title":"Windows"},{"location":"3/#storage","text":"\u5982\u679c\u56fa\u6001\u5b58\u50a8\u53ef\u7528\uff0c\u5728\u8fd9\u79cd\u9ad8\u6027\u80fd\u4ecb\u8d28\u4e0a\u5b58\u50a8 Kudu WAL \u53ef\u4ee5\u663e\u8457\u6539\u5584 Kudu \u914d\u7f6e\u4e3a\u5176\u6700\u9ad8\u8010\u4e45\u6027\u6c34\u5e73\u65f6\u7684\u5ef6\u8fdf\u3002","title":"Storage ( \u5b58\u50a8 )"},{"location":"3/#management","text":"\u5982\u679c\u60a8\u4f7f\u7528 Cloudera Manager \u548c CDH \uff0c\u5219\u9700\u8981 C loudera Manager 5.4.3 \u6216\u66f4\u9ad8\u7248\u672c\u3002 Cloudera Manager 5.4.7 \u53ca\u66f4\u65b0\u7248\u672c\u63d0\u4f9b\u66f4\u597d\u7684\u76d1\u63a7\u548c\u7ba1\u7406\u9009\u9879\u3002","title":"Management ( \u7ba1\u7406 )"},{"location":"3/#_5","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u7684\u8f6f\u4ef6\u5305\u6765\u5b89\u88c5 Kudu \u3002 \u88681. Kudu \u5305\u4f4d\u7f6e OS ( \u64cd\u4f5c\u7cfb\u7edf ) Repository ( \u5b58\u50a8\u5e93 ) Individual Packages ( \u5355\u4e2a\u5305 ) RHEL \u6216 CentOS RHEL 6 or CentOS 6 , RHEL 7 or CentOS 7 RHEL 6 or CentOS 6 , RHEL 7 or CentOS 7 SLES SLES 12 SLES 12 Ubuntu Trusty , Xenial Trusty , Xenial Debian Jessie Jessie","title":"\u4f7f\u7528\u5305\u5b89\u88c5"},{"location":"3/#rhel-centos","text":"\u4e0b\u8f7d\u5e76\u914d\u7f6e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684 Kudu \u5b58\u50a8\u5e93\uff0c\u6216\u4f7f\u7528 Kudu Package Locations \u7684\u76f8\u5e94\u94fe\u63a5\u624b\u52a8\u4e0b\u8f7d\u5404\u4e2a RPM \u3002 \u5982\u679c\u4f7f\u7528 Yum \u5b58\u50a8\u5e93\uff0c\u8bf7\u5728\u5c06 cloudera-kudu.repo \u6587\u4ef6\u4fdd\u5b58\u5230 /etc/yum.repos.d/ \u4e4b\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u5b89\u88c5 Kudu \u8f6f\u4ef6\u5305\u3002 sudo yum install kudu # Base Kudu files sudo yum install kudu-master # Kudu master init.d service script and default configuration sudo yum install kudu-tserver # Kudu tablet server init.d service script and default configuration sudo yum install kudu-client0 # Kudu C++ client shared library sudo yum install kudu-client-devel # Kudu C++ client SDK \u8981\u624b\u52a8\u5b89\u88c5 Kudu RPM \uff0c\u9996\u5148\u4e0b\u8f7d\u5b83\u4eec\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4 sudo rpm -ivh <RPM\u5b89\u88c5> \u6765\u5b89\u88c5\u3002 \u6ce8\u610f\uff1a kudu-master \u548c kudu-tserver \u8f6f\u4ef6\u5305\u4ec5\u5728\u5206\u522b\u6709 master \u6216 tserver \u7684\u4e3b\u673a\u4e0a\u9700\u8981 ( \u5982\u679c\u4f7f\u7528 Cloudera Manager \u5219\u5b8c\u5168\u4e0d\u5fc5\u8981 )\u3002\u6bcf\u4e2a\u63d0\u4f9b\u914d\u7f6e\u6587\u4ef6\u548c\u4e00\u4e2a init.d \u811a\u672c\u6765\u7ba1\u7406\u76f8\u5e94\u7684 Kudu \u8fdb\u7a0b\u3002\u4e00\u65e6\u5b89\u88c5\uff0c Kudu \u8fdb\u7a0b\u5c06\u5728\u4e3b\u673a\u542f\u52a8\u5e76\u5173\u95ed\u65f6\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\u3002","title":"\u5b89\u88c5\u5728 RHEL \u6216 CentOS \u4e3b\u673a\u4e0a"},{"location":"3/#sles","text":"\u4e0b\u8f7d\u5e76\u914d\u7f6e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684 Kudu \u5b58\u50a8\u5e93\uff0c\u6216\u4f7f\u7528 Kudu Package Locations \u7684\u76f8\u5e94\u94fe\u63a5\u624b\u52a8\u4e0b\u8f7d\u5404\u4e2a RPM \u3002 \u5982\u679c\u4f7f\u7528 Zypper \u5b58\u50a8\u5e93\uff0c\u8bf7\u5728\u5c06 cloudera-kudu.repo \u6587\u4ef6\u4fdd\u5b58\u5230 /etc/zypper/repos.d \u4e4b\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u5b89\u88c5 Kudu \u8f6f\u4ef6\u5305\u3002 sudo zypper install kudu # Base Kudu files sudo zypper install kudu-master # Kudu master init.d service script and default configuration sudo zypper install kudu-tserver # Kudu tablet server init.d service script and default configuration sudo zypper install kudu-client0 # Kudu C++ client shared library sudo zypper install kudu-client-devel # Kudu C++ client SDK \u8981\u624b\u52a8\u5b89\u88c5 Kudu RPM \uff0c\u9996\u5148\u4e0b\u8f7d\u5b83\u4eec\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4 sudo rpm -ivh <RPM\u5b89\u88c5> \u6765\u5b89\u88c5\u3002 \u6ce8\u610f\uff1a kudu-master \u548c kudu-tserver \u8f6f\u4ef6\u5305\u4ec5\u5728\u5206\u522b\u6709 master \u6216 tserver \u7684\u4e3b\u673a\u4e0a\u9700\u8981 ( \u5982\u679c\u4f7f\u7528 Cloudera Manager \u5219\u5b8c\u5168\u4e0d\u5fc5\u8981 )\u3002\u6bcf\u4e2a\u63d0\u4f9b\u914d\u7f6e\u6587\u4ef6\u548c\u4e00\u4e2a init.d \u811a\u672c\u6765\u7ba1\u7406\u76f8\u5e94\u7684 Kudu \u8fdb\u7a0b\u3002\u4e00\u65e6\u5b89\u88c5\uff0c Kudu \u8fdb\u7a0b\u5c06\u5728\u4e3b\u673a\u542f\u52a8\u5e76\u5173\u95ed\u65f6\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\u3002","title":"\u5b89\u88c5\u5728 SLES \u4e3b\u673a\u4e0a"},{"location":"3/#ubuntu-debian","text":"\u5982\u679c\u4f7f\u7528 ubuntu \u6216 debian \u5b58\u50a8\u5e93\uff0c\u8bf7\u5728\u5c06 cloudera.list \u6587\u4ef6\u4fdd\u5b58\u5230 /etc/apt/sources.list.d/ \u4e4b\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u5b89\u88c5 Kudu \u8f6f\u4ef6\u5305\u3002 sudo apt-get install kudu # Base Kudu files sudo apt-get install kudu-master # Service scripts for managing kudu-master sudo apt-get install kudu-tserver # Service scripts for managing kudu-tserver sudo apt-get install libkuduclient0 # Kudu C++ client shared library sudo apt-get install libkuduclient-dev # Kudu C++ client SDK \u8981\u624b\u52a8\u5b89\u88c5 Kudu RPM \uff0c\u9996\u5148\u4e0b\u8f7d\u5b83\u4eec\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4 sudo rpm -ivh <RPM\u5b89\u88c5> \u6765\u5b89\u88c5\u3002 \u6ce8\u610f\uff1a kudu-master \u548c kudu-tserver \u8f6f\u4ef6\u5305\u4ec5\u5728\u5206\u522b\u6709 master \u6216 tserver \u7684\u4e3b\u673a\u4e0a\u9700\u8981 ( \u5982\u679c\u4f7f\u7528 Cloudera Manager \u5219\u5b8c\u5168\u4e0d\u5fc5\u8981 ) \u3002\u6bcf\u4e2a\u63d0\u4f9b\u914d\u7f6e\u6587\u4ef6\u548c\u4e00\u4e2a init.d \u811a\u672c\u6765\u7ba1\u7406\u76f8\u5e94\u7684 Kudu \u8fdb\u7a0b\u3002\u4e00\u65e6\u5b89\u88c5\uff0c Kudu \u8fdb\u7a0b\u5c06\u5728\u4e3b\u673a\u542f\u52a8\u5e76\u5173\u95ed\u65f6\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\u3002","title":"\u5b89\u88c5\u5728 Ubuntu \u6216 Debian \u4e3b\u673a\u4e0a"},{"location":"3/#_6","text":"\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u6b63\u5728\u8fd0\u884c\uff1a * \u5728\u670d\u52a1\u5668\u4e0a\u68c0\u67e5 ps \u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u4ee5\u9a8c\u8bc1 kudu-master \u6216 kudu-tserver \u8fdb\u7a0b\u4e4b\u4e00\u6216\u4e24\u8005\u6b63\u5728\u8fd0\u884c\u3002 * \u6253\u5f00 Master \u6216\u8005 Tablet Server web UI \uff0c\u65b9\u6cd5\u662f\u6253\u5f00 http://< host_name >:8051/ for master \u6216\u8005 http://< host_name >:8050/ for tablet servers \u3002 \u5982\u679c Kudu \u6ca1\u6709\u8fd0\u884c\uff0c\u8bf7\u67e5\u770b '/var/log/kudu' \u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u4ee5 '.FATAL' \u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u90a3\u610f\u5473\u7740 Kudu \u65e0\u6cd5\u542f\u52a8\u3002 \u5982\u679c error \u662f \" Error during hole punch test\" \uff0c\u53ef\u80fd\u662f \u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684\u95ee\u9898 \u3002 \u5982\u679c error \u662f \" Couldn\u2019t get the current time \" \uff0c\u8fd9\u662f ntp \u7684\u95ee\u9898 \u3002 \u5982\u679c\u8fd9\u662f\u5176\u4ed6\u4f3c\u4e4e\u4e0d\u660e\u663e\u7684\u4e1c\u897f\uff0c\u6216\u8005\u5982\u679c\u60a8\u6ca1\u6709\u8fd0\u6c14\u5c1d\u8bd5\u4e0a\u8ff0\u89e3\u51b3\u65b9\u6848\uff0c\u60a8\u53ef\u4ee5\u5728 \u7528\u6237\u90ae\u4ef6\u5217\u8868 \u4e2d\u5bfb\u6c42\u5e2e\u52a9\u3002","title":"\u9a8c\u8bc1\u5b89\u88c5"},{"location":"3/#_7","text":"\u5728\u542f\u52a8 Kudu \u670d\u52a1\u4e4b\u524d\uff0c\u9700\u8981\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u6267\u884c\u5176\u4ed6\u914d\u7f6e\u6b65\u9aa4\u3002 \u8fd9\u4e9b\u5305\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u5907\u7528\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a kudu-conf \u6761\u76ee\uff0c\u5e76\u4e14\u5b83\u4eec\u8fd0\u9001\u5185\u7f6e\u7684 conf.dist \u66ff\u4ee3\u3002\u8981\u8c03\u6574\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5\u7f16\u8f91 /etc/kudu/conf/ \u4e2d\u7684\u6587\u4ef6\uff0c\u6216\u8005\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9009\u9879\uff0c\u786e\u4fdd\u5b83\u662f /etc/kudu/conf/ \u6307\u5411\u7684\u94fe\u63a5\uff0c\u5728\u90a3\u91cc\u521b\u5efa\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u7684\u67d0\u4e9b\u90e8\u5206\u4e5f\u914d\u7f6e\u5728 /etc/default/kudu-master \u548c /etc/default/kudu-tserver \u6587\u4ef6\u4e2d\u3002\u5982\u679c\u521b\u5efa\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\uff0c\u60a8\u5e94\u8be5\u5305\u62ec\u6216\u8005\u590d\u5236\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002 \u67e5\u770b\u914d\u7f6e\uff0c\u5305\u62ec\u9ed8\u8ba4\u7684 WAL \u548c\u6570\u636e\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5e76\u6839\u636e\u60a8\u7684\u8981\u6c42\u8fdb\u884c\u8c03\u6574\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8 Kudu \u670d\u52a1\uff1a $ sudo service kudu-master start $ sudo service kudu-tserver start \u8981\u505c\u6b62 Kudu \u670d\u52a1\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a $ sudo service kudu-master stop $ sudo service kudu-tserver stop \u5c06 Kudu \u670d\u52a1\u914d\u7f6e\u4e3a\u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u81ea\u52a8\u542f\u52a8\uff0c\u5c06\u5176\u6dfb\u52a0\u5230\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\uff1a ``` $ sudo chkconfig kudu-master on # RHEL / CentOS / SLES $ sudo chkconfig kudu-tserver on # RHEL / CentOS / SLES $ sudo update-rc.d kudu-master defaults # Debian / Ubuntu $ sudo update-rc.d kudu-tserver defaults # Debian / Ubuntu ``` \u6709\u5173 Kudu \u670d\u52a1\u7684\u5176\u4ed6\u914d\u7f6e\uff0c\u8bf7\u53c2\u9605 \u914d\u7f6e Kudu \u3002","title":"\u5fc5\u9700\u914d\u7f6e"},{"location":"3/#_8","text":"\u5982\u679c\u4f7f\u7528\u5305\u88f9\u6216\u8005\u8f6f\u4ef6\u5305\u5b89\u88c5 Kudu \u4e0d\u80fd\u63d0\u4f9b\u6240\u9700\u7684\u7075\u6d3b\u6027\uff0c\u5219\u53ef\u4ee5\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u3002\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4ece\u6e90\u4ee3\u7801\u6784\u5efa\u3002 \u6ce8\u610f \u5df2\u77e5\u7684\u6784\u5efa\u95ee\u9898 \u4e0d\u53ef\u80fd\u5728 MicroSoft Windows \u4e0a\u6784\u5efa Kudu \u3002 \u9700\u8981\u4e00\u4e2a C+ 11 \u7f16\u8bd1\u5668 ( GCC 4.8 ) \u3002","title":"\u4ece\u6e90\u4ee3\u7801\u6784\u5efa"},{"location":"3/#rhel-centos_1","text":"\u9700\u8981 RHEL \u6216\u8005 CentOS 6.6 \u6216\u66f4\u9ad8\u7248\u672c\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u3002\u8981\u5efa\u7acb\u5728 7.0 \u4ee5\u4e0a\u7684\u7248\u672c\u4e0a\uff0c\u5fc5\u987b\u5b89\u88c5 Red Hat Developer Toolset ( \u624d\u80fd\u8bbf\u95ee\u652f\u6301 C++ 11 \u7684\u7f16\u8bd1\u5668 )\u3002 \u5b89\u88c5\u5fc5\u5907\u5e93( \u5982\u679c\u6ca1\u6709\u5b89\u88c5 )\u3002 $ sudo yum install autoconf automake cyrus-sasl-devel cyrus-sasl-gssapi \\ cyrus-sasl-plain gcc gcc-c++ gdb git krb5-server krb5-workstation libtool \\ make openssl-devel patch pkgconfig redhat-lsb-core rsync unzip vim-common which \u5982\u679c\u5efa\u7acb\u5728 7.0 \u4ee5\u4e0a\u7684 RHEL \u6216 CentOS \u4e0a\uff0c\u8bf7\u5b89\u88c5 Red Hat Developer Toolset $ DTLS_RPM=rhscl-devtoolset-3-epel-6-x86_64-1-2.noarch.rpm $ DTLS_RPM_URL=https://www.softwarecollections.org/repos/rhscl/devtoolset-3/epel-6-x86_64/noarch/${DTLS_RPM} $ wget ${DTLS_RPM_URL} -O ${DTLS_RPM} $ sudo yum install -y scl-utils ${DTLS_RPM} $ sudo yum install -y devtoolset-3-toolchain \u53ef\u9009\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u6784\u5efa\u6587\u6863\uff0c\u8bf7\u5b89\u88c5\u5176\u4ed6\u5305\uff0c\u5305\u62ec ruby \u3002 $ sudo yum install doxygen gem graphviz ruby-devel zlib-devel \u6ce8\u610f \u5982\u679c\u5efa\u7acb\u5728 7.0 \u4ee5\u4e0a\u7684 RHEL \u6216\u8005 CentOS \u4e0a\uff0c\u5219\u53ef\u80fd\u9700\u8981\u4f7f\u7528 rubygems \u66ff\u6362 gem \u5305 \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002\u4e0d\u4f7f\u7528 devtoolset \u4f1a\u5bfc\u81f4\u4e3b\u673a\u7f16\u8bd1\u5668\u4f3c\u4e4e\u9700\u8981 libatomic \uff0c\u4f46\u627e\u4e0d\u5230\u5b83\u3002 $ build-support/enable_devtoolset.sh thirdparty/build-if-necessary.sh \u4f7f\u7528\u4e0a\u4e00\u6b65\u4e2d\u5b89\u88c5\u7684\u5b9e\u7528\u7a0b\u5e8f\u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 Kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002\u8bf7\u6ce8\u610f\uff0c devtoolset \u4ecd\u7136\u5fc5\u987b\u6307\u5b9a\uff0c\u5426\u5219\u60a8\u4f1a\u5f97\u5230 cc1plus \uff1a\u9519\u8bef\uff1a unrecognized command line option \"-std=c++11\" \u3002 mkdir -p build/release cd build/release ../../build-support/enable_devtoolset.sh \\ ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 \u53ef\u9009\uff1a\u5b89\u88c5 Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e93\u548c\u6807\u9898\u3002\u5982\u679c\u4e0d\u901a\u8fc7 DESTDIR \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u5b89\u88c5\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u4e3a /usr/local/ \u3002 sudo make DESTDIR=/opt/kudu install \u53ef\u9009\uff1a\u6784\u5efa\u6587\u6863\u3002\u6ce8\u610f\uff1a\u6b64\u547d\u4ee4\u6784\u5efa\u4e0d\u9002\u5408\u4e0a\u4f20\u5230 Kudu \u7f51\u7ad9\u7684\u672c\u5730\u6587\u6863\u3002 $ make docs \u793a\u4f8b 1 . RHEL / CentOS \u6784\u5efa\u811a\u672c \u6b64\u811a\u672c\u6982\u8ff0\u4e86\u5728\u65b0\u5b89\u88c5\u7684 RHEL \u6216 CentOS \u4e3b\u673a\u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u53ef\u7528\u4f5c\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u8df3\u8fc7\u4e0a\u9762\u6807\u8bb0\u4e3a\u53ef\u9009\u6b65\u9aa4\u7684\u6b65\u9aa4\u3002 #!/bin/bash sudo yum -y install autoconf automake cyrus-sasl-devel cyrus-sasl-gssapi \\ cyrus-sasl-plain gcc gcc-c++ gdb git krb5-server krb5-workstation libtool \\ make openssl-devel patch pkgconfig redhat-lsb-core rsync unzip vim-common which DTLS_RPM=rhscl-devtoolset-3-epel-6-x86_64-1-2.noarch.rpm DTLS_RPM_URL=https://www.softwarecollections.org/repos/rhscl/devtoolset-3/epel-6-x86_64/noarch/${DTLS_RPM} wget ${DTLS_RPM_URL} -O ${DTLS_RPM} sudo yum install -y scl-utils ${DTLS_RPM} sudo yum install -y devtoolset-3-toolchain git clone https://github.com/apache/kudu cd kudu build-support/enable_devtoolset.sh thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../build-support/enable_devtoolset.sh \\ ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4","title":"RHEL \u6216\u8005 CentOS"},{"location":"3/#ubuntu-debian_1","text":"\u5b89\u88c5\u5fc5\u5907\u5e93 ( \u5982\u679c\u5b83\u4eec\u6ca1\u6709\u5b89\u88c5 ) $ sudo apt-get install autoconf automake curl g++ gcc gdb git \\ krb5-admin-server krb5-kdc krb5-user libkrb5-dev libsasl2-dev libsasl2-modules \\ libsasl2-modules-gssapi-mit libssl-dev libtool lsb-release make ntp openssl \\ patch pkg-config python rsync unzip vim-common \u53ef\u9009\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u6784\u5efa\u6587\u6863\uff0c\u8bf7\u5b89\u88c5\u5176\u4ed6\u5305\uff0c\u5305\u62ec ruby \u3002 $ sudo apt-get install doxygen gem graphviz ruby-dev xsltproc zlib1g-dev \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002 $ thirdparty/build-if-necessary.sh \u4f7f\u7528\u4e0a\u4e00\u6b65\u4e2d\u5b89\u88c5\u7684\u5b9e\u7528\u7a0b\u5e8f\u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002 mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake -DCMAKE_BUILD_TYPE=release ../.. make -j4 \u53ef\u9009\uff1a\u5b89\u88c5 Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e93\u548c\u6807\u9898\u3002\u5982\u679c\u4e0d\u901a\u8fc7 DESTDIR \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u5b89\u88c5\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u4e3a /usr/local/ \u3002 sudo make DESTDIR=/opt/kudu install \u53ef\u9009\uff1a\u6784\u5efa\u6587\u6863\u3002\u6ce8\u610f\uff1a\u6b64\u547d\u4ee4\u6784\u5efa\u4e0d\u9002\u5408\u4e0a\u4f20\u5230 Kudu \u7f51\u7ad9\u7684\u672c\u5730\u6587\u6863\u3002 $ make docs \u793a\u4f8b 2 . Ubuntu \u6216\u8005 Debian \u6784\u5efa\u811a\u672c \u8be5\u811a\u672c\u6982\u8ff0\u4e86\u5728 Ubuntu \u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u8df3\u8fc7\u4e0a\u9762\u6807\u8bb0\u4e3a\u53ef\u9009\u6b65\u9aa4\u7684\u6b65\u9aa4\u3002 #!/bin/bash sudo apt-get -y install autoconf automake curl g++ gcc gdb git \\ krb5-admin-server krb5-kdc krb5-user libkrb5-dev libsasl2-dev libsasl2-modules \\ libsasl2-modules-gssapi-mit libssl-dev libtool lsb-release make ntp openssl \\ patch pkg-config python rsync unzip vim-common git clone https://github.com/apache/kudu cd kudu thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4","title":"Ubuntu \u6216\u8005 Debian"},{"location":"3/#suse-linux-enterprise-server","text":"\u5b89\u88c5\u5fc5\u5907\u5e93\uff08\u5982\u679c\u6ca1\u6709\u5b89\u88c5\uff09\u3002 $ sudo zypper install autoconf automake curl cyrus-sasl-devel \\ cyrus-sasl-gssapi gcc gcc-c++ gdb git krb5-devel libtool lsb-release make ntp \\ openssl-devel patch pkg-config python rsync unzip vim \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002 $ thirdparty/build-if-necessary.sh \u4f7f\u7528\u4e0a\u4e00\u6b65\u4e2d\u5b89\u88c5\u7684\u5b9e\u7528\u7a0b\u5e8f\u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002 mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4 \u53ef\u9009\uff1a\u5b89\u88c5 Kudu \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e93\u548c\u6807\u9898\u3002\u5982\u679c\u4e0d\u901a\u8fc7 DESTDIR \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u5b89\u88c5\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u4e3a /usr/local/ \u3002 sudo make DESTDIR=/opt/kudu install \u793a\u4f8b 3 .SLES \u6784\u5efa\u811a\u672c \u6b64\u811a\u672c\u6982\u8ff0\u4e86\u5728 SLES \u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u5e76\u53ef\u7528\u4f5c\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u8df3\u8fc7\u4e0a\u9762\u6807\u8bb0\u4e3a\u53ef\u9009\u6b65\u9aa4\u7684\u6b65\u9aa4\u3002 #!/bin/bash sudo zypper install -y autoconf automake curl cyrus-sasl-devel \\ cyrus-sasl-gssapi gcc gcc-c++ gdb git krb5-devel libtool lsb-release make ntp \\ openssl-devel patch pkg-config python rsync unzip vim git clone https://github.com/apache/kudu cd kudu thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ ../.. make -j4","title":"SUSE Linux Enterprise Server"},{"location":"3/#macos_1","text":"Xcode \u5305\u662f\u7f16\u8bd1 Kudu \u6240\u5fc5\u9700\u7684\u3002\u4e0b\u9762\u7684\u4e00\u4e9b\u8bf4\u660e\u4f7f\u7528 Homebrew \u6765\u5b89\u88c5\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f46\u624b\u52a8\u4f9d\u8d56\u5b89\u88c5\u662f\u53ef\u80fd\u7684\u3002 \u6ce8\u610f macOS \u5df2\u77e5\u95ee\u9898 Kudu \u5bf9 macOS \u7684\u652f\u6301\u662f\u5b9e\u9a8c\u6027\u7684\uff0c\u53ea\u80fd\u7528\u4e8e\u5f00\u53d1\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 macOS \u9650\u5236\u548c\u5df2\u77e5\u95ee\u9898 \u3002 \u5b89\u88c5\u5fc5\u5907\u5e93\uff08\u5982\u679c\u6ca1\u6709\u5b89\u88c5\uff09\u3002 $ brew tap homebrew/dupes $ brew install autoconf automake cmake git krb5 libtool openssl pkg-config pstree \u53ef\u9009\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u6784\u5efa\u6587\u6863\uff0c\u8bf7\u5b89\u88c5\u5176\u4ed6\u5305\uff0c\u5305\u62ec ruby \u3002 $ brew install doxygen graphviz ruby $ brew install gnu-sed --with-default-names #The macOS default sed handles the -i parameter differently \u514b\u9686 Git \u5b58\u50a8\u5e93\u5e76\u5207\u6362\u5230\u65b0\u7684 kudu \u76ee\u5f55\u3002 $ git clone https://github.com/apache/kudu $ cd kudu \u4f7f\u7528 build-if-necessary.sh \u811a\u672c\u6784\u5efa\u4efb\u4f55\u7f3a\u5c11\u7684\u7b2c\u4e09\u65b9\u8981\u6c42\u3002 $ thirdparty/build-if-necessary.sh \u5982\u679c\u4e0d\u540c\u7248\u672c\u7684\u4f9d\u8d56\u5173\u7cfb\u5728\u8c03\u7528 thirdParty / build-if-necessary.sh \u65f6\u5b89\u88c5\u5e76\u4f7f\u7528\uff0c\u5219\u53ef\u80fd\u4f1a\u9047\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684\u8f93\u51fa\uff1a ./configure: line 16299: error near unexpected token `newline' ./configure: line 16299: ` PKG_CHECK_MODULES(' \u7b2c\u4e09\u65b9\u6784\u5efa\u53ef\u80fd\u88ab\u7f13\u5b58\uff0c\u5e76\u53ef\u80fd\u53cd\u6620\u4e0d\u6b63\u786e\u7248\u672c\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\u786e\u4fdd\u60a8\u5177\u6709\u6b65\u9aa41\u4e2d\u5217\u51fa\u7684\u6b63\u786e\u4f9d\u8d56\u9879\uff0c\u6e05\u7406\u5de5\u4f5c\u533a\uff0c\u7136\u540e\u5c1d\u8bd5\u91cd\u65b0\u6784\u5efa\u3002 $ git clean -fdx $ thirdparty/build-if-necessary.sh \u81ea\u5236\u5b89\u88c5\u548c\u7cfb\u7edf\u5347\u7ea7\u7684\u4e00\u4e9b\u7ec4\u5408\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u540c\u79cd\u7c7b\u7684\u9519\u8bef\uff1a libtool: Version mismatch error.\u2002\u2002This is libtool 2.4.6, but the libtool: definition of this LT_INIT comes from libtool 2.4.2. libtool: You should recreate aclocal.m4 with macros from libtool 2.4.6 libtool: and run autoconf again. \u5982 \u672c\u7ebf\u7a0b \u6240\u8ff0\uff0c\u53ef\u80fd\u7684\u4fee\u590d\u662f\u5378\u8f7d\u5e76\u91cd\u65b0\u5b89\u88c5 libtool \uff1a $ brew uninstall libtool && brew install libtool 5. \u6784\u5efa Kudu \u3002\u4e3a\u4e2d\u95f4\u8f93\u51fa\u9009\u62e9\u4e00\u4e2a\u6784\u5efa\u76ee\u5f55\uff0c\u9664\u4e86 kudu \u76ee\u5f55\u672c\u8eab\u4e4b\u5916\uff0c\u5b83\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002 mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl \\ ../.. make -j4 \u793a\u4f8b 4. macOS \u6784\u5efa\u811a\u672c \u6b64\u811a\u672c\u6982\u8ff0\u4e86\u5728 MacOS \u4e0a\u6784\u5efa Kudu \u7684\u8fc7\u7a0b\uff0c\u53ef\u7528\u4f5c\u81ea\u52a8\u90e8\u7f72\u573a\u666f\u7684\u57fa\u7840\u3002\u5b83\u5047\u5b9a\u5b89\u88c5\u4e86 Xcode \u548c Homebrew \u3002 #!/bin/bash brew tap homebrew/dupes brew install autoconf automake cmake git krb5 libtool openssl pkg-config pstree git clone https://github.com/apache/kudu cd kudu thirdparty/build-if-necessary.sh mkdir -p build/release cd build/release ../../thirdparty/installed/common/bin/cmake \\ -DCMAKE_BUILD_TYPE=release \\ -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl \\ ../.. make -j4","title":"macOS"},{"location":"3/#c","text":"\u5982\u679c\u60a8\u9700\u8981\u8bbf\u95ee Kudu \u5ba2\u6237\u7aef\u5e93\u8fdb\u884c\u5f00\u53d1\uff0c\u8bf7\u4e3a\u60a8\u7684\u5e73\u53f0\u5b89\u88c5 kudu-client \u548c kudu-client-devel \u8f6f\u4ef6\u5305\u3002\u8bf7\u53c2\u9605 \u4f7f\u7528\u8f6f\u4ef6\u5305\u5b89\u88c5 \u3002 \u6ce8\u610f \u4ec5\u9488\u5bf9\u5ba2\u6237\u7aef\u5e93\u548c\u5934\uff08 kudu_client.so \u548c client.h \uff09\u6784\u5efa\u3002\u5176\u4ed6\u56fe\u4e66\u9986\u548c\u6807\u9898\u662f Kudu \u7684\u5185\u90e8\uff0c\u6ca1\u6709\u7a33\u5b9a\u7684\u4fdd\u8bc1\u3002","title":"\u5b89\u88c5 C++ \u5ba2\u6237\u7aef\u5e93"},{"location":"3/#java","text":"","title":"\u6784\u5efa Java \u5ba2\u6237\u7aef"},{"location":"3/#_9","text":"JDK 7 Apache Maven 3.x \u8981\u6784\u5efa Java \u5ba2\u6237\u7aef\uff0c\u8bf7\u514b\u9686 Kudu Git \u5b58\u50a8\u5e93\uff0c\u66f4\u6539\u4e3a java \u76ee\u5f55\uff0c\u5e76\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\uff1a $ mvn install -DskipTests \u6709\u5173\u6784\u5efa Java API \u4ee5\u53ca Eclipse \u96c6\u6210\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 java/README.md \u3002","title":"\u8981\u6c42"},{"location":"3/#api","text":"","title":"\u67e5\u770b API \u6587\u6863"},{"location":"3/#c-api","text":"\u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b C ++ \u5ba2\u6237\u7aef API \u6587\u6863 \u3002\u6216\u8005\uff0c\u5728 \u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\uff0c\u60a8\u8fd8\u53ef\u4ee5\u53e6\u5916\u6784\u5efa doxygen \u76ee\u6807\uff08\u4f8b\u5982\uff0c\u5982\u679c\u4f7f\u7528 make \uff0c\u5219\u8fd0\u884c make doxygen \uff09\uff0c\u5e76\u901a\u8fc7\u5728\u60a8\u6700\u559c\u6b22\u7684 Web \u4e2d\u6253\u5f00 docs/doxygen/client_api/html/index.html \u6587\u4ef6\u6765\u4f7f\u7528\u672c\u5730\u751f\u6210\u7684 API \u6587\u6863\u6d4f\u89c8\u5668\u3002 \u6ce8\u610f \u4e3a\u4e86\u6784\u5efa doxygen \u76ee\u6807\uff0c\u6709\u5fc5\u8981\u5728\u60a8\u7684\u6784\u5efa\u673a\u5668\u4e0a\u5b89\u88c5\u5e26\u6709 Dot\uff08graphviz\uff09 \u652f\u6301\u7684 doxygen \u3002\u5982\u679c\u60a8\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\u5b89\u88c5\u4e86 doxygen \uff0c\u5219\u9700\u8981\u518d\u6b21\u8fd0\u884c cmake \u4ee5\u83b7\u53d6 doxygen \u4f4d\u7f6e\u5e76\u751f\u6210\u9002\u5f53\u7684\u76ee\u6807\u3002","title":"C++ API \u6587\u6863"},{"location":"3/#java-api","text":"\u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b Java API \u6587\u6863 \u3002\u6216\u8005\uff0c\u5728 \u6784\u5efa Java \u5ba2\u6237\u7aef \u4e4b\u540e\uff0c Java API \u6587\u6863\u53ef\u4ee5\u5728 java/kudu-client/target/apidocs/index.html \u4e2d\u627e\u5230\u3002","title":"Java API \u6587\u6863"},{"location":"3/#kudu_1","text":"\u5347\u7ea7\u4e4b\u524d\uff0c\u60a8\u5e94\u8be5\u9605\u8bfb\u8981\u5b89\u88c5\u7684 Kudu \u7248\u672c\u7684\u53d1\u884c\u8bf4\u660e\u3002 \u5bc6\u5207\u5173\u6ce8\u4e0d\u517c\u5bb9\u6027\uff0c\u5347\u7ea7\u548c\u964d\u7ea7\u5728\u90a3\u91cc\u8bb0\u5f55\u7684\u7b14\u8bb0\u3002 \u6ce8\u610f \u76ee\u524d\u4e0d\u652f\u6301\u6eda\u52a8\u5347\u7ea7\u3002 \u5347\u7ea7\u8f6f\u4ef6\u4e4b\u524d\uff0c\u8bf7\u5173\u95ed\u6240\u6709\u7684 Kudu \u670d\u52a1\u3002","title":"\u4ece\u4ee5\u524d\u7248\u672c\u7684 Kudu \u5347\u7ea7"},{"location":"3/#_10","text":"\u505c\u6b62 Kudu master \u548c tablet server \u670d\u52a1\uff1a $ sudo service kudu-master stop $ sudo service kudu-tserver stop \u5347\u7ea7\u8f6f\u4ef6\u5305\uff1a \u5728 RHEL \u6216\u8005 CentOS \u4e3b\u673a\u4e0a\uff1a sudo yum clean all sudo yum upgrade kudu \u5728 SLES \u4e3b\u673a\u4e0a\uff1a sudo zypper clean --all sudo zypper update kudu \u5728 Ubuntu \u6216\u8005 Debian \u4e3b\u673a\u4e0a\uff1a sudo apt-get update sudo apt-get install kudu \u542f\u52a8 Kudu master \u548c tablet server \u670d\u52a1\uff1a $ sudo service kudu-master start $ sudo service kudu-tserver start","title":"\u5347\u7ea7\u7a0b\u5e8f"},{"location":"3/#_11","text":"\u914d\u7f6e Kudu \u7ba1\u7406 Kudu","title":"\u4e0b\u4e00\u6b65"},{"location":"4/","text":"\u914d\u7f6e Kudu \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/configuration.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813616 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 \u914d\u7f6e Apache Kudu \u6ce8\u610f Kudu \u4e0e Cloudera Manager \u76f8\u6bd4\uff0c\u5728\u72ec\u7acb\u5b89\u88c5\u4e2d\u66f4\u5bb9\u6613\u914d\u7f6e\u3002\u6709\u5173\u4f7f\u7528 Kudu \u4e0e Cloudera Manager \u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Cloudera \u7684 Kudu \u6587\u6863 \u3002 \u914d\u7f6e Kudu \u914d\u7f6e\u57fa\u7840 \u8981\u914d\u7f6e\u6bcf\u4e2a Kudu \u8fdb\u7a0b\u7684\u884c\u4e3a\uff0c\u60a8\u53ef\u4ee5\u5728\u542f\u52a8\u65f6\u4f20\u9012\u547d\u4ee4\u884c\u6807\u5fd7\uff0c\u6216\u8005\u901a\u8fc7\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a --flagfile = <file> \u9009\u9879\u4f20\u9012\u5b83\u4eec\u4ece\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\u8fd9\u4e9b\u9009\u9879\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b --flagfile \u9009\u9879\u4ee5\u5305\u542b\u5176\u4ed6\u6587\u4ef6\u3002\u901a\u8fc7\u9605\u8bfb \u5176\u6587\u6863 \u4e86\u89e3\u6709\u5173 gflags \u7684\u66f4\u591a\u4fe1\u606f\u3002 \u60a8\u53ef\u4ee5\u5c06 masters \u548c tablet servers \u7684\u9009\u9879\u653e\u7f6e\u5728\u76f8\u540c\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5c06\u5ffd\u7565\u4e0d\u9002\u7528\u7684\u9009\u9879\u3002 Flags \u53ef\u4ee5\u4ee5\u4e00\u4e2a\u6216\u4e24\u4e2a\u5b57\u7b26\u4e3a\u524d\u7f00\u3002\u672c\u6587\u6863\u6807\u51c6\u5316\u5728\u4e24\u4e2a\uff1a --example_flag \u3002 \u53d1\u73b0\u914d\u7f6e\u9009\u9879 \u53ea\u6709\u6700\u5e38\u89c1\u7684\u914d\u7f6e\u9009\u9879\u5728\u6b64\u8bb0\u5f55\u3002\u6709\u5173\u914d\u7f6e\u9009\u9879\u7684\u66f4\u8be6\u5c3d\u7684\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u914d\u7f6e\u53c2\u8003 \u3002 \u8981\u67e5\u770b\u7ed9\u5b9a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6240\u6709 configuration flags ( \u914d\u7f6e\u6807\u5fd7 )\uff0c\u8bf7\u4f7f\u7528 --help \u9009\u9879\u8fd0\u884c\u5b83\u3002\u914d\u7f6e\u672a\u8bb0\u5f55\u7684\u6807\u5fd7\u65f6\u8981\u5c0f\u5fc3\uff0c\u56e0\u4e3a\u5e76\u975e\u6240\u6709\u53ef\u80fd\u7684\u914d\u7f6e\u90fd\u5df2\u7ecf\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u5e76\u4e14\u65e0\u6cd5\u4fdd\u8bc1\u5728\u672a\u6765\u7248\u672c\u4e2d\u4fdd\u7559\u672a\u8bb0\u5f55\u7684\u9009\u9879\u3002 \u914d\u7f6e Kudu Master \u8981\u67e5\u770b kudu-master \u53ef\u6267\u884c\u6587\u4ef6\u7684\u6240\u6709\u53ef\u7528\u914d\u7f6e\u9009\u9879\uff0c\u8bf7\u4f7f\u7528 --help \u9009\u9879\u8fd0\u884c\u5b83\uff1a $ kudu-master --help \u88681 . \u652f\u6301 Kudu Masters \u7684\u914d\u7f6e\u6807\u5fd7 Flag( \u6807\u8bb0 ) Valid Options ( \u6709\u6548\u9009\u9879 ) Default( \u9ed8\u8ba4 ) Description ( \u8bf4\u660e ) --master_addresses string localhost Master \u5171\u4eab\u914d\u7f6e\u7684\u6240\u6709 RPC \u5730\u5740\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u5982\u679c\u672a\u6307\u5b9a\uff0c\u5047\u5b9a\u4e3a standalone Master --fs_data_dirs string Master \u5c06\u653e\u7f6e\u5176\u6570\u636e\u5757\u7684\u76ee\u5f55\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002 --fs_wal_dir string Master \u5c06\u5176\u9884\u5199\u65e5\u5fd7\u7684\u76ee\u5f55\u3002\u53ef\u80fd\u4e0e --fs_data_dirs \u4e2d\u5217\u51fa\u7684\u76ee\u5f55\u4e4b\u4e00\u76f8\u540c\uff0c\u4f46\u4e0d\u80fd\u4e0e\u6570\u636e\u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u76f8\u540c\u3002 --log_dir string /tmp \u5b58\u50a8\u4e3b\u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55\u3002 \u6709\u5173 masters \u6807\u5fd7\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1 \" Kudu Master \u914d\u7f6e\u53c2\u8003\" \u3002 \u914d\u7f6e Tablet Servers \u8981\u67e5\u770b kudu tserver \u53ef\u6267\u884c\u6587\u4ef6\u7684\u6240\u6709\u53ef\u7528\u914d\u7f6e\u9009\u9879\uff0c\u8bf7\u4f7f\u7528 --help \u9009\u9879\u8fd0\u884c\u5b83\uff1a $ kudu-tserver --help \u88682 . \u652f\u6301 Kudu Tablet Servers \u7684\u914d\u7f6e\u6807\u5fd7 Flag( \u6807\u8bb0 ) Valid Options ( \u6709\u6548\u9009\u9879 ) Default( \u9ed8\u8ba4 ) Description ( \u8bf4\u660e ) --fs_data_dirs string Tablet Server \u5c06\u653e\u7f6e\u5176\u6570\u636e\u5757\u7684\u76ee\u5f55\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002 --fs_wal_dir string Tablet Server \u5c06\u653e\u7f6e\u9884\u5199\u65e5\u5fd7\u7684\u76ee\u5f55\u3002 \u53ef\u80fd\u4e0e --fs_data_dirs \u4e2d\u5217\u51fa\u7684\u76ee\u5f55\u4e4b\u4e00\u76f8\u540c\uff0c\u4f46\u4e0d\u80fd\u4e0e\u6570\u636e\u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u76f8\u540c\u3002 --log_dir string /tmp \u5b58\u50a8 Tablet Server \u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55 --tserver_master_addrs string 127.0.0.1:7051 tablet server \u5e94\u8fde\u63a5\u7684\u4e3b\u673a\u7684\u9017\u53f7\u5206\u9694\u5730\u5740\u3002 masters \u4e0d\u8bfb\u8fd9\u4e2a\u6807\u5fd7\u3002 --block_cache_capacity_mb integer 512 \u5206\u914d\u7ed9 Kudu Tablet Server \u5757\u7f13\u5b58\u7684\u6700\u5927\u5185\u5b58\u91cf\u3002 --memory_limit_hard_bytes integer 4294967296 Tablet Server \u53ef\u4ee5\u5728\u5f00\u59cb\u62d2\u7edd\u6240\u6709\u4f20\u5165\u5199\u5165\u4e4b\u524d\u6d88\u8017\u7684\u6700\u5927\u5185\u5b58\u91cf\u3002 \u6709\u5173 tablet servers \u7684\u6807\u5fd7\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \" Kudu Tablet Server \u914d\u7f6e\u53c2\u8003\" \u3002 \u4e0b\u4e00\u6b65 Kudu \u5165\u95e8\u6307\u5357 \u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f","title":"\u914d\u7f6e Kudu"},{"location":"4/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/configuration.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813616 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u914d\u7f6e Kudu"},{"location":"4/#apache-kudu","text":"\u6ce8\u610f Kudu \u4e0e Cloudera Manager \u76f8\u6bd4\uff0c\u5728\u72ec\u7acb\u5b89\u88c5\u4e2d\u66f4\u5bb9\u6613\u914d\u7f6e\u3002\u6709\u5173\u4f7f\u7528 Kudu \u4e0e Cloudera Manager \u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Cloudera \u7684 Kudu \u6587\u6863 \u3002","title":"\u914d\u7f6e Apache Kudu"},{"location":"4/#kudu_1","text":"","title":"\u914d\u7f6e Kudu"},{"location":"4/#_1","text":"\u8981\u914d\u7f6e\u6bcf\u4e2a Kudu \u8fdb\u7a0b\u7684\u884c\u4e3a\uff0c\u60a8\u53ef\u4ee5\u5728\u542f\u52a8\u65f6\u4f20\u9012\u547d\u4ee4\u884c\u6807\u5fd7\uff0c\u6216\u8005\u901a\u8fc7\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a --flagfile = <file> \u9009\u9879\u4f20\u9012\u5b83\u4eec\u4ece\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\u8fd9\u4e9b\u9009\u9879\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b --flagfile \u9009\u9879\u4ee5\u5305\u542b\u5176\u4ed6\u6587\u4ef6\u3002\u901a\u8fc7\u9605\u8bfb \u5176\u6587\u6863 \u4e86\u89e3\u6709\u5173 gflags \u7684\u66f4\u591a\u4fe1\u606f\u3002 \u60a8\u53ef\u4ee5\u5c06 masters \u548c tablet servers \u7684\u9009\u9879\u653e\u7f6e\u5728\u76f8\u540c\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5c06\u5ffd\u7565\u4e0d\u9002\u7528\u7684\u9009\u9879\u3002 Flags \u53ef\u4ee5\u4ee5\u4e00\u4e2a\u6216\u4e24\u4e2a\u5b57\u7b26\u4e3a\u524d\u7f00\u3002\u672c\u6587\u6863\u6807\u51c6\u5316\u5728\u4e24\u4e2a\uff1a --example_flag \u3002","title":"\u914d\u7f6e\u57fa\u7840"},{"location":"4/#_2","text":"\u53ea\u6709\u6700\u5e38\u89c1\u7684\u914d\u7f6e\u9009\u9879\u5728\u6b64\u8bb0\u5f55\u3002\u6709\u5173\u914d\u7f6e\u9009\u9879\u7684\u66f4\u8be6\u5c3d\u7684\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u914d\u7f6e\u53c2\u8003 \u3002 \u8981\u67e5\u770b\u7ed9\u5b9a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6240\u6709 configuration flags ( \u914d\u7f6e\u6807\u5fd7 )\uff0c\u8bf7\u4f7f\u7528 --help \u9009\u9879\u8fd0\u884c\u5b83\u3002\u914d\u7f6e\u672a\u8bb0\u5f55\u7684\u6807\u5fd7\u65f6\u8981\u5c0f\u5fc3\uff0c\u56e0\u4e3a\u5e76\u975e\u6240\u6709\u53ef\u80fd\u7684\u914d\u7f6e\u90fd\u5df2\u7ecf\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u5e76\u4e14\u65e0\u6cd5\u4fdd\u8bc1\u5728\u672a\u6765\u7248\u672c\u4e2d\u4fdd\u7559\u672a\u8bb0\u5f55\u7684\u9009\u9879\u3002","title":"\u53d1\u73b0\u914d\u7f6e\u9009\u9879"},{"location":"4/#kudu-master","text":"\u8981\u67e5\u770b kudu-master \u53ef\u6267\u884c\u6587\u4ef6\u7684\u6240\u6709\u53ef\u7528\u914d\u7f6e\u9009\u9879\uff0c\u8bf7\u4f7f\u7528 --help \u9009\u9879\u8fd0\u884c\u5b83\uff1a $ kudu-master --help \u88681 . \u652f\u6301 Kudu Masters \u7684\u914d\u7f6e\u6807\u5fd7 Flag( \u6807\u8bb0 ) Valid Options ( \u6709\u6548\u9009\u9879 ) Default( \u9ed8\u8ba4 ) Description ( \u8bf4\u660e ) --master_addresses string localhost Master \u5171\u4eab\u914d\u7f6e\u7684\u6240\u6709 RPC \u5730\u5740\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u5982\u679c\u672a\u6307\u5b9a\uff0c\u5047\u5b9a\u4e3a standalone Master --fs_data_dirs string Master \u5c06\u653e\u7f6e\u5176\u6570\u636e\u5757\u7684\u76ee\u5f55\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002 --fs_wal_dir string Master \u5c06\u5176\u9884\u5199\u65e5\u5fd7\u7684\u76ee\u5f55\u3002\u53ef\u80fd\u4e0e --fs_data_dirs \u4e2d\u5217\u51fa\u7684\u76ee\u5f55\u4e4b\u4e00\u76f8\u540c\uff0c\u4f46\u4e0d\u80fd\u4e0e\u6570\u636e\u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u76f8\u540c\u3002 --log_dir string /tmp \u5b58\u50a8\u4e3b\u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55\u3002 \u6709\u5173 masters \u6807\u5fd7\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1 \" Kudu Master \u914d\u7f6e\u53c2\u8003\" \u3002","title":"\u914d\u7f6e Kudu Master"},{"location":"4/#tablet-servers","text":"\u8981\u67e5\u770b kudu tserver \u53ef\u6267\u884c\u6587\u4ef6\u7684\u6240\u6709\u53ef\u7528\u914d\u7f6e\u9009\u9879\uff0c\u8bf7\u4f7f\u7528 --help \u9009\u9879\u8fd0\u884c\u5b83\uff1a $ kudu-tserver --help \u88682 . \u652f\u6301 Kudu Tablet Servers \u7684\u914d\u7f6e\u6807\u5fd7 Flag( \u6807\u8bb0 ) Valid Options ( \u6709\u6548\u9009\u9879 ) Default( \u9ed8\u8ba4 ) Description ( \u8bf4\u660e ) --fs_data_dirs string Tablet Server \u5c06\u653e\u7f6e\u5176\u6570\u636e\u5757\u7684\u76ee\u5f55\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002 --fs_wal_dir string Tablet Server \u5c06\u653e\u7f6e\u9884\u5199\u65e5\u5fd7\u7684\u76ee\u5f55\u3002 \u53ef\u80fd\u4e0e --fs_data_dirs \u4e2d\u5217\u51fa\u7684\u76ee\u5f55\u4e4b\u4e00\u76f8\u540c\uff0c\u4f46\u4e0d\u80fd\u4e0e\u6570\u636e\u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u76f8\u540c\u3002 --log_dir string /tmp \u5b58\u50a8 Tablet Server \u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55 --tserver_master_addrs string 127.0.0.1:7051 tablet server \u5e94\u8fde\u63a5\u7684\u4e3b\u673a\u7684\u9017\u53f7\u5206\u9694\u5730\u5740\u3002 masters \u4e0d\u8bfb\u8fd9\u4e2a\u6807\u5fd7\u3002 --block_cache_capacity_mb integer 512 \u5206\u914d\u7ed9 Kudu Tablet Server \u5757\u7f13\u5b58\u7684\u6700\u5927\u5185\u5b58\u91cf\u3002 --memory_limit_hard_bytes integer 4294967296 Tablet Server \u53ef\u4ee5\u5728\u5f00\u59cb\u62d2\u7edd\u6240\u6709\u4f20\u5165\u5199\u5165\u4e4b\u524d\u6d88\u8017\u7684\u6700\u5927\u5185\u5b58\u91cf\u3002 \u6709\u5173 tablet servers \u7684\u6807\u5fd7\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \" Kudu Tablet Server \u914d\u7f6e\u53c2\u8003\" \u3002","title":"\u914d\u7f6e\u00a0Tablet Servers"},{"location":"4/#_3","text":"Kudu \u5165\u95e8\u6307\u5357 \u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f","title":"\u4e0b\u4e00\u6b65"},{"location":"5/","text":"Kudu \u96c6\u6210 Apache Impala \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/kudu_impala_integration.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813620 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 \u4f7f\u7528Apache Kudu\u4e0eApache Impala\uff08\u5b75\u5316\uff09 Kudu \u4e0e Apache Impala \uff08\u5b75\u5316\uff09\u7d27\u5bc6\u96c6\u6210\uff0c\u5141\u8bb8\u60a8\u4f7f\u7528 Impala \u4f7f\u7528 Impala \u7684 SQL \u8bed\u6cd5\u4ece Kudu tablets \u63d2\u5165\uff0c\u67e5\u8be2\uff0c\u66f4\u65b0\u548c\u5220\u9664\u6570\u636e\uff0c\u4f5c\u4e3a\u4f7f\u7528 Kudu API \u6784\u5efa\u81ea\u5b9a\u4e49 Kudu \u5e94\u7528\u7a0b\u5e8f\u7684\u66ff\u4ee3\u65b9\u6cd5\u3002\u6b64\u5916\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 JDBC \u6216 ODBC \u5c06\u4f7f\u7528\u4efb\u4f55\u8bed\u8a00\uff0c\u6846\u67b6\u6216\u5546\u4e1a\u667a\u80fd\u5de5\u5177\u7f16\u5199\u7684\u73b0\u6709\u6216\u65b0\u5e94\u7528\u7a0b\u5e8f\u4e0e\u4f7f\u7528 Impala \u4f5c\u4e3a\u4ee3\u7406\u7684 Kudu \u6570\u636e\u8fdb\u884c\u8fde\u63a5\u3002 \u8981\u6c42 \u6b64\u6587\u6863\u7279\u5b9a\u4e8e Impala \u7684\u67d0\u4e9b\u7248\u672c\u3002\u63cf\u8ff0\u7684\u8bed\u6cd5\u5c06\u4ec5\u5728\u4ee5\u4e0b\u7248\u672c\u4e2d\u8fd0\u884c\uff1a CDH 5.10 \u9644\u5e26\u7684 Impala 2.7.0 \u7248\u672c\u3002 SELECT VERSION() \u5c06\u62a5\u544a impalad version 2.7.0-cdh5.10.0 \u3002 \u4ece\u6e90\u4ee3\u7801\u7f16\u8bd1\u7684 Apache Impala 2.8.0 \u7248\u672c\u3002 SELECT VERSION() \u5c06\u62a5\u544a impalad version 2.8.0 \u3002 \u8f83\u65e9\u7248\u672c\u7684 Impala 2.7 \uff08\u5305\u62ec\u4ee5\u524d\u63d0\u4f9b\u7684\u7279\u6b8a IMPALA_KUDU \u7248\u672c\uff09\u5177\u6709\u4e0d\u517c\u5bb9\u7684\u8bed\u6cd5\u3002\u672a\u6765\u7248\u672c\u53ef\u80fd\u4e0e\u6b64\u8bed\u6cd5\u517c\u5bb9\uff0c\u4f46\u6211\u4eec\u5efa\u8bae\u60a8\u68c0\u67e5\u8fd9\u662f\u4e0e\u60a8\u5b89\u88c5\u7684\u76f8\u5e94\u7248\u672c\u76f8\u5bf9\u5e94\u7684\u6700\u65b0\u53ef\u7528\u6587\u6863\u3002 \u672c\u6587\u6863\u4e0d\u63cf\u8ff0 Impala \u5b89\u88c5\u8fc7\u7a0b\u3002\u8bf7\u53c2\u9605 Impala \u6587\u6863\uff0c\u5e76\u786e\u4fdd\u60a8\u53ef\u4ee5\u5728\u7ee7\u7eed\u4e4b\u524d\u5bf9 HDFS \u4e0a\u7684 Impala \u8868\u8fd0\u884c\u7b80\u5355\u67e5\u8be2\u3002 \u914d\u7f6e Kudu \u5185\u4e0d\u9700\u8981\u8fdb\u884c\u914d\u7f6e\u66f4\u6539\uff0c\u4ece\u800c\u53ef\u4ee5\u8bbf\u95ee Impala \u3002 \u867d\u7136\u4e0d\u662f\u7edd\u5bf9\u5fc5\u8981\u7684\uff0c\u4f46\u5efa\u8bae\u60a8\u914d\u7f6e Impala \u4e0e Kudu Master servers \u7684\u4f4d\u7f6e\uff1a \u5728 Impala \u670d\u52a1\u914d\u7f6e\u4e2d\u8bbe\u7f6e --kudu_master_hosts = <master1> [\uff1aport] \uff0c <master2> [\uff1aport] \uff0c <master3> [\uff1aport] \u6807\u5fd7\u3002\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528 Cloudera Manager \uff0c\u8bf7\u53c2\u9605\u76f8\u5e94\u7684 Cloudera Manager \u6587\u6863\u3002 \u5982\u679c\u5728 Impala \u670d\u52a1\u4e2d\u672a\u8bbe\u7f6e\u6b64\u6807\u5fd7\uff0c\u5219\u6bcf\u6b21\u521b\u5efa\u8868\u683c\u65f6\u90fd\u5fc5\u987b\u624b\u52a8\u63d0\u4f9b\u6b64\u914d\u7f6e\uff0c\u65b9\u6cd5\u662f\u5728 TBLPROPERTIES \u5b50\u53e5\u4e2d\u6307\u5b9a kudu_master_addresses \u5c5e\u6027\u3002 \u672c\u6307\u5357\u7684\u5176\u4f59\u90e8\u5206\u5047\u8bbe\u914d\u7f6e\u5df2\u8bbe\u7f6e\u3002 \u4f7f\u7528 Impala Shell \u6ce8\u610f \u8fd9\u53ea\u662f Impala Shell \u529f\u80fd\u7684\u4e00\u5c0f\u90e8\u5206\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Impala Shell \u6587\u6863\u3002 \u4f7f\u7528 impala-shell \u547d\u4ee4\u542f\u52a8 Impala Shell \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c impala-shell \u5c1d\u8bd5\u8fde\u63a5\u5230\u7aef\u53e3 21000 \u4e0a\u7684 localhost \u4e0a\u7684 Impala \u5b88\u62a4\u7a0b\u5e8f\u3002\u8981\u8fde\u63a5\u5230\u5176\u4ed6\u4e3b\u673a\uff0c\u8bf7\u4f7f\u7528 -i <host:port> \u9009\u9879\u3002\u8981\u81ea\u52a8\u8fde\u63a5\u5230\u7279\u5b9a\u7684 Impala \u6570\u636e\u5e93\uff0c\u8bf7\u4f7f\u7528 -d <database> \u9009\u9879\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u6240\u6709 Kudu \u8868\u90fd\u4f4d\u4e8e Impala_kudu \u6570\u636e\u5e93\u4e2d\u7684 Impala \u4e2d\uff0c\u8bf7\u4f7f\u7528 -d impala_kudu \u6765\u4f7f\u7528\u6b64\u6570\u636e\u5e93\u3002 \u8981\u9000\u51fa Impala Shell \uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a quit ; \u5185\u90e8\u548c\u5916\u90e8 Impala \u8868 \u4f7f\u7528 Impala \u521b\u5efa\u65b0\u7684 Kudu \u8868\u65f6\uff0c\u53ef\u4ee5\u5c06\u8868\u521b\u5efa\u4e3a\u5185\u90e8\u8868\u6216\u5916\u90e8\u8868\u3002 Internal ( \u5185\u90e8 ) \u5185\u90e8\u8868\u7531 Impala \u7ba1\u7406\uff0c\u5f53\u60a8\u4ece Impala \u4e2d\u5220\u9664\u65f6\uff0c\u6570\u636e\u548c\u8868\u786e\u5b9e\u88ab\u5220\u9664\u3002\u5f53\u60a8\u4f7f\u7528 Impala \u521b\u5efa\u65b0\u8868\u65f6\uff0c\u901a\u5e38\u662f\u5185\u90e8\u8868\u3002 External ( \u5916\u90e8 ) \u5916\u90e8\u8868\uff08\u7531 CREATE EXTERNAL TABLE \u521b\u5efa\uff09\u4e0d\u53d7 Impala \u7ba1\u7406\uff0c\u5e76\u4e14\u5220\u9664\u6b64\u8868\u4e0d\u4f1a\u5c06\u8868\u4ece\u5176\u6e90\u4f4d\u7f6e\uff08\u6b64\u5904\u4e3a Kudu \uff09\u4e22\u5f03\u3002\u76f8\u53cd\uff0c\u5b83\u53ea\u4f1a\u53bb\u9664 Impala \u548c Kudu \u4e4b\u95f4\u7684\u6620\u5c04\u3002\u8fd9\u662f Kudu \u63d0\u4f9b\u7684\u7528\u4e8e\u5c06\u73b0\u6709\u8868\u6620\u5c04\u5230 Impala \u7684\u8bed\u6cd5\u3002 \u6709\u5173\u5185\u90e8\u548c\u5916\u90e8\u8868\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Impala\u6587\u6863 \u3002 \u67e5\u8be2 Impala \u4e2d\u73b0\u6709\u7684 Kudu \u8868 \u901a\u8fc7 Kudu API \u6216\u5176\u4ed6\u96c6\u6210\uff08\u5982 Apache Spark \uff09\u521b\u5efa\u7684\u8868\u4e0d\u4f1a\u5728 Impala \u4e2d\u81ea\u52a8\u663e\u793a\u3002\u8981\u67e5\u8be2\u5b83\u4eec\uff0c\u60a8\u5fc5\u987b\u5148\u5728 Impala \u4e2d\u521b\u5efa\u5916\u90e8\u8868\u4ee5\u5c06 Kudu \u8868\u6620\u5c04\u5230 Impala \u6570\u636e\u5e93\u4e2d\uff1a CREATE EXTERNAL TABLE my_mapping_table STORED AS KUDU TBLPROPERTIES ( 'kudu.table_name' = 'my_kudu_table' ); \u4ece Impala \u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Kudu \u8868 \u4ece Impala \u5728 Kudu \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u8868\u7c7b\u4f3c\u4e8e\u5c06\u73b0\u6709\u7684 Kudu \u8868\u6620\u5c04\u5230 Impala \u8868\uff0c\u4f46\u60a8\u9700\u8981\u81ea\u5df1\u6307\u5b9a\u6a21\u5f0f\u548c\u5206\u533a\u4fe1\u606f\u3002 \u4f7f\u7528\u4ee5\u4e0b\u793a\u4f8b\u4f5c\u4e3a\u6307\u5bfc\u3002 Impala \u9996\u5148\u521b\u5efa\u8868\uff0c\u7136\u540e\u521b\u5efa\u6620\u5c04\u3002 CREATE TABLE my_first_table ( id BIGINT, name STRING, PRIMARY KEY(id) ) PARTITION BY HASH PARTITIONS 16 STORED AS KUDU; \u5728 CREATE TABLE \u8bed\u53e5\u4e2d\uff0c\u5fc5\u987b\u9996\u5148\u5217\u51fa\u6784\u6210\u4e3b\u952e\u7684\u5217\u3002\u6b64\u5916\uff0c\u4e3b\u952e\u5217\u9690\u5f0f\u6807\u8bb0\u4e3a NOT NULL \u3002 \u521b\u5efa\u65b0\u7684 Kudu \u8868\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5206\u914d\u65b9\u6848\u3002\u8bf7\u53c2\u9605 \u5206\u533a\u8868 \u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u4e0a\u9762\u7684\u8868\u521b\u5efa\u793a\u4f8b\u901a\u8fc7\u6563\u5217 id \u5217\u5206\u6210 16 \u4e2a\u5206\u533a\u3002\u6709\u5173\u5206\u533a\u7684\u6307\u5bfc\uff0c\u8bf7\u53c2\u9605 Thumb \u7684\u5206\u533a\u89c4\u5219 \u3002 CREATE TABLE AS SELECT \u60a8\u53ef\u4ee5\u4f7f\u7528 CREATE TABLE ... AS SELECT \u8bed\u53e5\u67e5\u8be2 Impala \u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u8868\u6216\u8868\u6765\u521b\u5efa\u8868\u3002\u4ee5\u4e0b\u793a\u4f8b\u5c06\u73b0\u6709\u8868 old_table \u4e2d\u7684\u6240\u6709\u884c\u5bfc\u5165\u5230 Kudu \u8868 new_table \u4e2d\u3002 new_table \u4e2d\u7684\u5217\u7684\u540d\u79f0\u548c\u7c7b\u578b\u5c06\u6839\u636e SELECT \u8bed\u53e5\u7684\u7ed3\u679c\u96c6\u4e2d\u7684\u5217\u786e\u5b9a\u3002\u8bf7\u6ce8\u610f\uff0c\u60a8\u5fc5\u987b\u53e6\u5916\u6307\u5b9a\u4e3b\u952e\u548c\u5206\u533a\u3002 CREATE TABLE new_table PRIMARY KEY (ts, name) PARTITION BY HASH(name) PARTITIONS 8 STORED AS KUDU AS SELECT ts, name, value FROM old_table; \u6307\u5b9a Tablet Partitioning ( Tablet \u5206\u533a ) \u8868\u5206\u4e3a\u6bcf\u4e2a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a tablet servers \u63d0\u4f9b\u7684 tablets \u3002\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c tablets \u5e94\u8be5\u76f8\u5bf9\u5e73\u7b49\u5730\u62c6\u5206\u8868\u7684\u6570\u636e\u3002 Kudu \u76ee\u524d\u6ca1\u6709\u81ea\u52a8\uff08\u6216\u624b\u52a8\uff09\u62c6\u5206\u9884\u5148\u5b58\u5728\u7684 tablets \u7684\u673a\u5236\u3002\u5728\u5b9e\u73b0\u6b64\u529f\u80fd\u4e4b\u524d\uff0c\u60a8\u5fc5\u987b\u5728\u521b\u5efa\u8868\u65f6\u6307\u5b9a\u5206\u533a\u3002\u5728\u8bbe\u8ba1\u8868\u683c\u67b6\u6784\u65f6\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u4e3b\u952e\uff0c\u60a8\u53ef\u4ee5\u5c06\u8868\u62c6\u5206\u6210\u4ee5\u7c7b\u4f3c\u901f\u5ea6\u589e\u957f\u7684\u5206\u533a\u3002\u4f7f\u7528 Impala \u521b\u5efa\u8868\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 PARTITION BY \u5b50\u53e5\u6307\u5b9a\u5206\u533a\uff1a \u6ce8\u610f Impala \u5173\u952e\u5b57\uff08\u5982 group \uff09\u5728\u5173\u952e\u5b57\u610f\u4e49\u4e0a\u4e0d\u88ab\u4f7f\u7528\u65f6\uff0c\u7531\u80cc\u9762\u7684\u5b57\u7b26\u5305\u56f4\u3002 CREATE TABLE cust_behavior ( _id BIGINT PRIMARY KEY, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, sku STRING, rating INT, fulfilled_date BIGINT ) PARTITION BY RANGE (_id) ( PARTITION VALUES < 1439560049342, PARTITION 1439560049342 <= VALUES < 1439566253755, PARTITION 1439566253755 <= VALUES < 1439572458168, PARTITION 1439572458168 <= VALUES < 1439578662581, PARTITION 1439578662581 <= VALUES < 1439584866994, PARTITION 1439584866994 <= VALUES < 1439591071407, PARTITION 1439591071407 <= VALUES ) STORED AS KUDU; \u5982\u679c\u60a8\u6709\u591a\u4e2a\u4e3b\u952e\u5217\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u5143\u7ec4\u8bed\u6cd5\u6307\u5b9a\u5206\u533a\u8fb9\u754c\uff1a \uff08'va'\uff0c1\uff09\uff0c\uff08'ab'\uff0c2\uff09 \u3002\u8be5\u8868\u8fbe\u5f0f\u5fc5\u987b\u662f\u6709\u6548\u7684 JSON \u3002 Impala \u6570\u636e\u5e93\u548c Kudu \u6bcf\u4e2a Impala \u8868\u90fd\u5305\u542b\u5728\u79f0\u4e3a\u6570\u636e\u5e93\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u3002\u9ed8\u8ba4\u6570\u636e\u5e93\u79f0\u4e3a\u9ed8\u8ba4\u6570\u636e\u5e93\uff0c\u7528\u6237\u53ef\u6839\u636e\u9700\u8981\u521b\u5efa\u548c\u5220\u9664\u5176\u4ed6\u6570\u636e\u5e93\u3002 \u5f53\u4ece Impala \u4e2d\u521b\u5efa\u4e00\u4e2a\u53d7\u7ba1 Kudu \u8868\u65f6\uff0c\u76f8\u5e94\u7684 Kudu \u8868\u5c06\u88ab\u547d\u540d\u4e3a my_database :: table_name \u3002 \u4e0d\u652f\u6301 Kudu \u8868\u7684 Impala \u5173\u952e\u5b57 \u521b\u5efa Kudu \u8868\u65f6\u4e0d\u652f\u6301\u4ee5\u4e0b Impala \u5173\u952e\u5b57\uff1a - PARTITIONED - LOCATION - ROWFORMAT \u4f18\u5316\u8bc4\u4f30 SQL \u8c13\u8bcd\u7684\u6027\u80fd \u5982\u679c\u60a8\u7684\u67e5\u8be2\u7684 WHERE \u5b50\u53e5\u5305\u542b\u4e0e operators = \uff0c <= \uff0c '** \uff0c '\\' \uff0c > = \uff0c BETWEEN \u6216 IN \u7684\u6bd4\u8f83\uff0c\u5219 Kudu \u76f4\u63a5\u8bc4\u4f30\u8be5\u6761\u4ef6\uff0c\u53ea\u8fd4\u56de\u76f8\u5173\u7ed3\u679c\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u4f73\u6027\u80fd\uff0c\u56e0\u4e3a Kudu \u53ea\u5c06\u76f8\u5173\u7ed3\u679c\u8fd4\u56de\u7ed9 Impala \u3002\u5bf9\u4e8e\u8c13\u8bcd != \uff0c LIKE \u6216 Impala \u652f\u6301\u7684\u4efb\u4f55\u5176\u4ed6\u8c13\u8bcd\u7c7b\u578b\uff0c Kudu \u4e0d\u4f1a\u76f4\u63a5\u8bc4\u4f30\u8c13\u8bcd\uff0c\u800c\u662f\u5c06\u6240\u6709\u7ed3\u679c\u8fd4\u56de\u7ed9 Impala \uff0c\u5e76\u4f9d\u8d56\u4e8e Impala** \u6765\u8bc4\u4f30\u5269\u4f59\u7684\u8c13\u8bcd\u5e76\u76f8\u5e94\u5730\u8fc7\u6ee4\u7ed3\u679c\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6027\u80fd\u5dee\u5f02\uff0c\u8fd9\u53d6\u51b3\u4e8e\u8bc4\u4f30 WHERE \u5b50\u53e5\u4e4b\u524d\u548c\u4e4b\u540e\u7684\u7ed3\u679c\u96c6\u7684\u589e\u91cf\u3002 \u5206\u533a\u8868 \u6839\u636e\u4e3b\u952e\u5217\u4e0a\u7684\u5206\u533a\u6a21\u5f0f\u5c06\u8868\u683c\u5212\u5206\u4e3a tablets \u3002\u6bcf\u4e2a tablet \u7531\u81f3\u5c11\u4e00\u53f0 tablet server \u63d0\u4f9b\u3002\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u4e00\u5f20\u8868\u5e94\u8be5\u5206\u6210\u591a\u4e2a tablets \u4e2d\u5206\u5e03\u7684 tablet servers \uff0c\u4ee5\u6700\u5927\u5316\u5e76\u884c\u64cd\u4f5c\u3002\u60a8\u4f7f\u7528\u7684\u5206\u533a\u6a21\u5f0f\u7684\u8be6\u7ec6\u4fe1\u606f\u5c06\u5b8c\u5168\u53d6\u51b3\u4e8e\u60a8\u5b58\u50a8\u7684\u6570\u636e\u7c7b\u578b\u548c\u8bbf\u95ee\u65b9\u5f0f\u3002\u5173\u4e8e Kudu \u6a21\u5f0f\u8bbe\u8ba1\u7684\u5168\u9762\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 Schema Design \u3002 Kudu \u76ee\u524d\u6ca1\u6709\u5728\u521b\u5efa\u8868\u4e4b\u540e\u62c6\u5206\u6216\u5408\u5e76 tablets \u7684\u673a\u5236\u3002\u521b\u5efa\u8868\u65f6\uff0c\u5fc5\u987b\u4e3a\u8868\u63d0\u4f9b\u5206\u533a\u6a21\u5f0f\u3002\u5728\u8bbe\u8ba1\u8868\u683c\u65f6\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u4e3b\u952e\uff0c\u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u5c06\u8868\u683c\u5206\u4e3a\u4ee5\u76f8\u540c\u901f\u7387\u589e\u957f\u7684 tablets \u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528 Impala \u7684 PARTITION BY \u5173\u952e\u5b57\u5bf9\u8868\u8fdb\u884c\u5206\u533a\uff0c\u8be5\u5173\u952e\u5b57\u652f\u6301 RANGE \u6216 HASH \u5206\u53d1\u3002\u5206\u533a\u65b9\u6848\u53ef\u4ee5\u5305\u542b\u96f6\u4e2a\u6216\u591a\u4e2a HASH \u5b9a\u4e49\uff0c\u540e\u9762\u662f\u53ef\u9009\u7684 RANGE \u5b9a\u4e49\u3002 RANGE \u5b9a\u4e49\u53ef\u4ee5\u5f15\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u952e\u5217\u3002 \u57fa\u672c \u548c \u9ad8\u7ea7\u5206\u533a \u7684\u793a\u4f8b\u5982\u4e0b\u6240\u793a\u3002 \u57fa\u672c\u5206\u533a PARTITION BY RANGE ( \u6309\u8303\u56f4\u5212\u5206 ) \u60a8\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u952e\u5217\u6307\u5b9a\u8303\u56f4\u5206\u533a\u3002 Kudu \u4e2d\u7684\u8303\u56f4\u5206\u533a\u5141\u8bb8\u6839\u636e\u6240\u9009\u5206\u533a\u952e\u7684\u7279\u5b9a\u503c\u6216\u503c\u7684\u8303\u56f4\u62c6\u5206\u8868\u3002\u8fd9\u6837\u53ef\u4ee5\u5e73\u8861\u5e76\u884c\u5199\u5165\u4e0e\u626b\u63cf\u6548\u7387\u3002 \u5047\u8bbe\u60a8\u6709\u4e00\u4e2a\u5177\u6709\u5217 state \uff0c name \u548c purchase_count \u7684\u8868\u3002\u4ee5\u4e0b\u793a\u4f8b\u521b\u5efa 50 \u4e2a tablets \uff0c\u6bcf\u4e2a US state \u3002 \u6ce8\u610f \u5355\u8c03\u589e\u52a0 Values \u5982\u679c\u60a8\u5728\u5176\u503c\u5355\u8c03\u9012\u589e\u7684\u5217\u4e0a\u6309\u8303\u56f4\u8fdb\u884c\u5206\u533a\uff0c\u5219\u6700\u540e\u4e00\u4e2a tablet \u7684\u589e\u957f\u5c06\u8fdc\u5927\u4e8e\u5176\u4ed6\u5e73\u53f0\u3002\u6b64\u5916\uff0c\u63d2\u5165\u7684\u6240\u6709\u6570\u636e\u5c06\u4e00\u6b21\u5199\u5165\u5355\u4e2a tablet \uff0c\u9650\u5236\u4e86\u6570\u636e\u6444\u53d6\u7684\u53ef\u6269\u5c55\u6027\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8bf7\u8003\u8651\u901a\u8fc7 HASH \u5206\u914d\uff0c\u800c\u4e0d\u662f\u6216\u9664 RANGE \u4e4b\u5916\u3002 CREATE TABLE customers ( state STRING, name STRING, purchase_count int, PRIMARY KEY (state, name) ) PARTITION BY RANGE (state) ( PARTITION VALUE = 'al', PARTITION VALUE = 'ak', PARTITION VALUE = 'ar', -- ... etc ... PARTITION VALUE = 'wv', PARTITION VALUE = 'wy' ) STORED AS KUDU; PARTITION BY HASH ( \u54c8\u5e0c\u5206\u533a ) \u60a8\u53ef\u4ee5\u901a\u8fc7\u6563\u5217\u5206\u53d1\u5230\u7279\u5b9a\u6570\u91cf\u7684 \u201c buckets \u201d \uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u663e\u5f0f\u8303\u56f4\u8fdb\u884c\u5206\u53d1\uff0c\u6216\u4e0e\u8303\u56f4\u5206\u5e03\u7ec4\u5408\u3002\u60a8\u6307\u5b9a\u8981\u5206\u533a\u7684\u4e3b\u952e\u5217\uff0c\u4ee5\u53ca\u8981\u4f7f\u7528\u7684\u5b58\u50a8\u6876\u6570\u3002\u901a\u8fc7\u6563\u5217\u6307\u5b9a\u7684\u952e\u5217\u6765\u5206\u914d\u884c\u3002\u5047\u8bbe\u6563\u5217\u7684\u503c\u672c\u8eab\u4e0d\u4f1a\u8868\u73b0\u51fa\u663e\u7740\u7684\u504f\u5dee\uff0c\u8fd9\u5c06\u6709\u52a9\u4e8e\u5c06\u6570\u636e\u5747\u5300\u5730\u5206\u5e03\u5728\u6570\u636e\u6876\u4e4b\u95f4\u3002 \u60a8\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u5b9a\u4e49\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u4f7f\u7528\u590d\u5408\u4e3b\u952e\u7684\u5b9a\u4e49\u3002\u4f46\u662f\uff0c\u5728\u591a\u4e2a\u6563\u5217\u5b9a\u4e49\u4e2d\u4e0d\u80fd\u63d0\u53ca\u4e00\u5217\u3002\u8003\u8651\u4e24\u5217a\u548cb\uff1a \u221a * HASH(a)\uff0cHASH(b) \u221a HASH(a\uff0cb) \u00d7 HASH(a)\uff0cHASH(a\uff0cb) \u6ce8\u610f \u6ca1\u6709\u6307\u5b9a\u5217\u7684 HASH \u7684 PARTITION BY HASH \u662f\u901a\u8fc7\u6563\u5217\u6240\u6709\u4e3b\u952e\u5217\u6765\u521b\u5efa\u6240\u9700\u6570\u91cf\u7684\u6876\u7684\u5feb\u6377\u65b9\u5f0f\u3002 \u5982\u679c\u4e3b\u952e\u503c\u5747\u5300\u5206\u5e03\u5728\u5176\u57df\u4e2d\uff0c\u5e76\u4e14\u6570\u636e\u504f\u79fb\u4e0d\u660e\u663e\uff0c\u4f8b\u5982 timestamps ( \u65f6\u95f4\u6233 ) \u6216 IDs ( \u5e8f\u5217\u53f7 )\uff0c\u5219\u54c8\u5e0c\u5206\u533a\u662f\u5408\u7406\u7684\u65b9\u6cd5\u3002 \u4ee5\u4e0b\u793a\u4f8b\u901a\u8fc7\u6563\u5217 id \u548c sku \u5217\u521b\u5efa 16 \u4e2a tablets \u3002\u8fd9\u4f20\u64ad\u4e86\u6240\u6709 16 \u4e2a tablets \u7684\u5199\u4f5c\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5bf9\u4e00\u7cfb\u5217 sku \u503c\u7684\u67e5\u8be2\u53ef\u80fd\u9700\u8981\u8bfb\u53d6\u6240\u6709 16 \u4e2a tablets \uff0c\u56e0\u6b64\u8fd9\u53ef\u80fd\u4e0d\u662f\u6b64\u8868\u7684\u6700\u4f73\u6a21\u5f0f\u3002\u6709\u5173\u6269\u5c55\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605 \u9ad8\u7ea7\u5206\u533a \u3002 CREATE TABLE cust_behavior ( id BIGINT, sku STRING, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, rating INT, fulfilled_date BIGINT, PRIMARY KEY (id, sku) ) PARTITION BY HASH PARTITIONS 16 STORED AS KUDU; \u9ad8\u7ea7\u5206\u533a \u60a8\u53ef\u4ee5\u7ec4\u5408 HASH \u548c RANGE \u5206\u533a\u6765\u521b\u5efa\u66f4\u590d\u6742\u7684\u5206\u533a\u6a21\u5f0f\u3002\u60a8\u53ef\u4ee5\u6307\u5b9a\u96f6\u4e2a\u6216\u591a\u4e2a HASH \u5b9a\u4e49\uff0c\u540e\u8ddf\u96f6\u4e2a\u6216\u4e00\u4e2a RANGE \u5b9a\u4e49\u3002\u6bcf\u4e2a\u5b9a\u4e49\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u3002\u867d\u7136\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684\u5206\u53d1\u6a21\u5f0f\u90fd\u8d85\u51fa\u4e86\u672c\u6587\u6863\u7684\u8303\u56f4\uff0c\u4f46\u662f\u51e0\u4e2a\u4f8b\u5b50\u8bf4\u660e\u4e86\u4e00\u4e9b\u53ef\u80fd\u6027\u3002 PARTITION BY HASH and RANGE \u8003\u8651\u4e0a\u9762\u7684 \u7b80\u5355\u54c8\u5e0c \u793a\u4f8b\uff0c\u5982\u679c\u60a8\u7ecf\u5e38\u67e5\u8be2\u4e00\u7cfb\u5217 sku \u503c\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u54c8\u5e0c\u5206\u533a\u4e0e\u8303\u56f4\u5206\u533a\u76f8\u7ed3\u5408\u6765\u4f18\u5316\u793a\u4f8b\u3002 \u4ee5\u4e0b\u793a\u4f8b\u4ecd\u7136\u521b\u5efa\u4e8616\u4e2a tablets \uff0c\u9996\u5148\u5c06 id \u5217\u5206\u4e3a 4 \u4e2a\u5b58\u50a8\u533a\uff0c\u7136\u540e\u6839\u636e sku \u5b57\u7b26\u4e32\u7684\u503c\u5e94\u7528\u8303\u56f4\u5212\u5206\u5c06\u6bcf\u4e2a\u5b58\u50a8\u533a\u5206\u4e3a\u56db\u4e2a\u6570\u636e\u5757\u3002\u81f3\u5c11\u56db\u7247\uff08\u6700\u591a\u53ef\u8fbe 16 \u5f20\uff09\u3002\u5f53\u60a8\u67e5\u8be2\u76f8\u90bb\u8303\u56f4\u7684 sku \u503c\u65f6\uff0c\u60a8\u5f88\u6709\u53ef\u80fd\u53ea\u9700\u4ece\u56db\u5206\u4e4b\u4e00\u7684 tablets \u4e2d\u8bfb\u53d6\u5373\u53ef\u5b8c\u6210\u67e5\u8be2\u3002 \u6ce8\u610f \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 PARTITION BY HASH \u65f6\uff0c\u6574\u4e2a\u4e3b\u952e\u662f\u6563\u5217\u7684\u3002\u8981\u53ea\u5bf9\u4e3b\u952e\u8fdb\u884c\u6563\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528\u50cf PARTITION BY HASH(id, sku) \u8fd9\u6837\u7684\u8bed\u6cd5\u6765\u6307\u5b9a\u5b83\u3002 CREATE TABLE cust_behavior ( id BIGINT, sku STRING, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, rating INT, fulfilled_date BIGINT, PRIMARY KEY (id, sku) ) PARTITION BY HASH (id) PARTITIONS 4, RANGE (sku) ( PARTITION VALUES < 'g', PARTITION 'g' <= VALUES < 'o', PARTITION 'o' <= VALUES < 'u', PARTITION 'u' <= VALUES ) STORED AS KUDU; Multiple PARTITION BY HASH Definitions ( \u591a\u91cd\u5212\u5206\u7531 HASH \u5b9a\u4e49 ) \u518d\u6b21\u6269\u5c55\u4e0a\u8ff0\u793a\u4f8b\uff0c\u5047\u8bbe\u67e5\u8be2\u6a21\u5f0f\u5c06\u662f\u4e0d\u53ef\u9884\u6d4b\u7684\uff0c\u4f46\u60a8\u5e0c\u671b\u786e\u4fdd\u5199\u5165\u5206\u5e03\u5728\u5927\u91cf tablets \u4e0a\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728\u4e3b\u952e\u5217\u4e0a\u8fdb\u884c\u6563\u5217\u6765\u5b9e\u73b0\u6574\u4e2a\u4e3b\u952e\u7684\u6700\u5927\u5206\u914d\u3002 CREATE TABLE cust_behavior ( id BIGINT, sku STRING, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, rating INT, fulfilled_date BIGINT, PRIMARY KEY (id, sku) ) PARTITION BY HASH (id) PARTITIONS 4, HASH (sku) PARTITIONS 4 STORED AS KUDU; \u8be5\u793a\u4f8b\u521b\u5efa 16 \u4e2a\u5206\u533a\u3002\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 HASH(id,sku) PARTITIONS 16 .\u4f46\u662f\uff0c\u5bf9\u4e8e sku \u503c\u7684\u626b\u63cf\u51e0\u4e4e\u603b\u662f\u4f1a\u5f71\u54cd\u6240\u6709 16 \u4e2a\u5206\u533a\uff0c\u800c\u4e0d\u662f\u53ef\u80fd\u9650\u5236\u4e3a 4 \u3002 Non-Covering Range Partitions ( \u4e0d\u8986\u76d6\u5206\u533a ) Kudu 1.0 \u53ca\u66f4\u9ad8\u7248\u672c\u652f\u6301\u4f7f\u7528\u975e\u8986\u76d6\u8303\u56f4\u5206\u533a\uff0c\u5176\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\uff1a \u6ca1\u6709\u672a\u8986\u76d6\u7684\u8303\u56f4\u5206\u533a\uff0c\u5728\u9700\u8981\u8003\u8651\u4e0d\u65ad\u589e\u52a0\u7684\u4e3b\u952e\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u6216\u5176\u4ed6\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u670d\u52a1\u4e8e\u65e7\u6570\u636e\u7684 tablet \u7684\u5927\u5c0f\u76f8\u5bf9\u56fa\u5b9a\uff0c\u800c\u63a5\u6536\u65b0\u6570\u636e\u7684 tablets \u5c06\u4e0d\u53d7\u9650\u5236\u5730\u589e\u957f\u3002 \u5728\u60a8\u5e0c\u671b\u6839\u636e\u5176\u7c7b\u522b\uff08\u5982\u9500\u552e\u533a\u57df\u6216\u4ea7\u54c1\u7c7b\u578b\uff09\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u533a\u7684\u60c5\u51b5\u4e0b\uff0c\u65e0\u9700\u8986\u76d6\u8303\u56f4\u5206\u533a\uff0c\u5219\u5fc5\u987b\u63d0\u524d\u4e86\u89e3\u6240\u6709\u5206\u533a\uff0c\u6216\u8005\u5982\u679c\u9700\u8981\u6dfb\u52a0\u6216\u5220\u9664\u5206\u533a\uff0c\u8bf7\u624b\u52a8\u91cd\u65b0\u521b\u5efa\u8868\u3002 \u4f8b\u5982\u5f15\u5165\u6216\u6d88\u9664\u4ea7\u54c1\u7c7b\u578b\u3002 \u975e\u8986\u76d6\u8303\u56f4\u5206\u533a\u6709\u4e00\u4e9b\u6ce8\u610f\u4e8b\u9879\u3002\u8bf7\u52a1\u5fc5\u9605\u8bfb\u94fe\u63a5\uff1a /docs/schema_design.html [Schema Design guide] \u3002 \u6b64\u793a\u4f8b\u6bcf\u5e74\u521b\u5efa\u4e00\u4e2a tablet \uff08\u51715\u4e2a tablets \uff09\uff0c\u7528\u4e8e\u5b58\u50a8\u65e5\u5fd7\u6570\u636e\u3002\u8be5\u8868\u4ec5\u63a5\u53d7 2012 \u5e74\u81f3 2016 \u5e74 \u7684\u6570\u636e\u3002\u8fd9\u4e9b\u8303\u56f4\u4e4b\u5916\u7684\u952e\u5c06\u88ab\u62d2\u7edd\u3002 CREATE TABLE sales_by_year ( year INT, sale_id INT, amount INT, PRIMARY KEY (sale_id, year) ) PARTITION BY RANGE (year) ( PARTITION VALUE = 2012, PARTITION VALUE = 2013, PARTITION VALUE = 2014, PARTITION VALUE = 2015, PARTITION VALUE = 2016 ) STORED AS KUDU; \u5f53\u8bb0\u5f55\u5f00\u59cb\u8fdb\u5165 2017 \u5e74\u65f6\uff0c\u4ed6\u4eec\u5c06\u88ab\u62d2\u7edd\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c 2017 \u5e74\u7684\u8303\u56f4\u5e94\u8be5\u5982\u4e0b\uff1a ALTER TABLE sales_by_year ADD RANGE PARTITION VALUE = 2017; \u5728\u9700\u8981\u6570\u636e\u4fdd\u7559\u7684\u6eda\u52a8\u7a97\u53e3\u7684\u60c5\u51b5\u4e0b\uff0c\u8303\u56f4\u5206\u533a\u4e5f\u53ef\u80fd\u4f1a\u4e22\u5f03\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e0d\u518d\u4fdd\u7559 2012 \u5e74\u7684\u6570\u636e\uff0c\u5219\u53ef\u80fd\u4f1a\u6279\u91cf\u5220\u9664\u6570\u636e\uff1a ALTER TABLE sales_by_year DROP RANGE PARTITION VALUE = 2012; \u8bf7\u6ce8\u610f\uff0c\u5c31\u50cf\u5220\u9664\u8868\u4e00\u6837\uff0c\u8fd9\u4e0d\u53ef\u9006\u8f6c\u5730\u5220\u9664\u5b58\u50a8\u5728\u4e22\u5f03\u7684\u5206\u533a\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002 Partitioning Rules of Thumb ( \u62c7\u6307\u5206\u533a\u89c4\u5219 ) \u5bf9\u4e8e\u5927\u578b\u8868\u683c\uff0c\u5982\u4e8b\u5b9e\u8868\uff0c\u76ee\u6807\u662f\u5728\u96c6\u7fa4\u4e2d\u62e5\u6709\u6838\u5fc3\u6570\u91cf\u7684 tablets \u3002 \u5bf9\u4e8e\u5c0f\u578b\u8868\u683c\uff08\u5982\u7ef4\u5ea6\u8868\uff09\uff0c\u76ee\u6807\u662f\u8db3\u591f\u6570\u91cf\u7684 tablets \uff0c\u6bcf\u4e2a tablets \u7684\u5927\u5c0f\u81f3\u5c11\u4e3a 1 GB \u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u8bf7\u6ce8\u610f\uff0c\u5728\u5f53\u524d\u7684\u5b9e\u73b0\u4e2d\uff0c tablets \u7684\u6570\u91cf\u9650\u5236\u4e86\u8bfb\u53d6\u7684\u5e76\u884c\u6027\u3002\u589e\u52a0 tablets \u6570\u91cf\u8d85\u8fc7\u6838\u5fc3\u6570\u91cf\u53ef\u80fd\u4f1a\u6709\u51cf\u5c11\u7684\u56de\u62a5\u3002 \u5c06\u6570\u636e\u63d2\u5165 Kudu \u8868 Impala \u5141\u8bb8\u60a8\u4f7f\u7528\u6807\u51c6 SQL \u8bed\u53e5\u5c06\u6570\u636e\u63d2\u5165 Kudu \u3002 \u63d2\u5165\u5355\u4e2a\u503c \u6b64\u793a\u4f8b\u63d2\u5165\u5355\u4e2a\u884c\u3002 INSERT INTO my_first_table VALUES (99, \"sarah\"); \u6b64\u793a\u4f8b\u4f7f\u7528\u5355\u4e2a\u8bed\u53e5\u63d2\u5165\u4e09\u884c\u3002 INSERT INTO my_first_table VALUES (1, \"john\"), (2, \"jane\"), (3, \"jim\"); \u6279\u91cf\u63d2\u5165 \u6279\u91cf\u63d2\u5165\u65f6\uff0c\u81f3\u5c11\u6709\u4e09\u79cd\u5e38\u7528\u9009\u62e9\u3002\u6bcf\u4e2a\u53ef\u80fd\u6709\u4f18\u70b9\u548c\u7f3a\u70b9\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u60a8\u7684\u6570\u636e\u548c\u60c5\u51b5\u3002 Multiple single INSERT statements ( \u591a\u4e2a\u5355\u72ec\u7684 INSERT \u8bed\u53e5 ) \u8fd9\u79cd\u65b9\u6cd5\u5177\u6709\u6613\u4e8e\u7406\u89e3\u548c\u5b9e\u73b0\u7684\u4f18\u70b9\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u662f\u4f4e\u6548\u7684\uff0c\u56e0\u4e3a Impala \u4e0e Kudu \u7684\u63d2\u5165\u6027\u80fd\u76f8\u6bd4\u5177\u6709\u5f88\u9ad8\u7684\u67e5\u8be2\u542f\u52a8\u6210\u672c\u3002\u8fd9\u5c06\u5bfc\u81f4\u76f8\u5bf9\u8f83\u9ad8\u7684\u5ef6\u8fdf\u548c\u8f83\u5dee\u7684\u541e\u5410\u91cf\u3002 Single INSERT statement with multiple VALUES ( \u5177\u6709\u591a\u4e2a VALUES \u7684\u5355\u4e2a INSERT \u8bed\u53e5 ) \u5982\u679c\u5305\u542b\u8d85\u8fc7 1024 \u4e2a VALUES \u8bed\u53e5\uff0c\u5219\u5728\u5c06\u8bf7\u6c42\u53d1\u9001\u5230 Kudu \u4e4b\u524d\uff0c Impala \u5c06\u5176\u5206\u7ec4\u4e3a 1024 \uff08\u6216 batch_size \u7684\u503c\uff09\u3002\u901a\u8fc7\u5728 Impala \u65b9\u9762\u644a\u9500\u67e5\u8be2\u542f\u52a8\u5904\u7f5a\uff0c\u6b64\u65b9\u6cd5\u53ef\u80fd\u4f1a\u6267\u884c\u6bd4\u591a\u4e2a\u987a\u5e8f INSERT \u8bed\u53e5\u7565\u597d\u3002\u8981\u8bbe\u7f6e\u5f53\u524d Impala Shell \u4f1a\u8bdd\u7684\u6279\u91cf\u5927\u5c0f\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u8bed\u6cd5\uff1a set batch_size = 10000; \u6ce8\u610f \u589e\u52a0 Impala \u6279\u91cf\u5927\u5c0f\u4f1a\u5bfc\u81f4 Impala \u4f7f\u7528\u66f4\u591a\u7684\u5185\u5b58\u3002\u60a8\u5e94\u8be5\u9a8c\u8bc1\u5bf9\u7fa4\u96c6\u7684\u5f71\u54cd\u5e76\u8fdb\u884c\u76f8\u5e94\u8c03\u6574\u3002 Batch Insert ( \u6279\u91cf\u63d2\u5165 ) \u4ece Impala \u548c Kudu \u7684\u89d2\u5ea6\u6765\u770b\uff0c\u901a\u5e38\u8868\u73b0\u6700\u597d\u7684\u65b9\u6cd5\u901a\u5e38\u662f\u4f7f\u7528 Impala \u4e2d\u7684 SELECT FROM \u8bed\u53e5\u5bfc\u5165\u6570\u636e\u3002 \u5982\u679c\u60a8\u7684\u6570\u636e\u5c1a\u672a\u5728 Impala \u4e2d\uff0c\u5219\u4e00\u79cd\u7b56\u7565\u662f \u4ece\u6587\u672c\u6587\u4ef6 \uff08\u5982 TSV \u6216 CSV \u6587\u4ef6\uff09\u5bfc\u5165\u3002 \u521b\u5efa Kudu \u8868 \uff0c\u6ce8\u610f\u6307\u5b9a\u4e3a\u4e3b\u952e\u7684\u5217\u4e0d\u80fd\u4e3a\u7a7a\u503c\u3002 \u901a\u8fc7\u67e5\u8be2\u5305\u542b\u539f\u59cb\u6570\u636e\u7684\u8868\u5c06\u503c\u63d2\u5165\u5230 Kudu \u8868\u4e2d\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff1a INSERT INTO my_kudu_table SELECT * FROM legacy_data_import_table; Ingest using the C++ or Java API ( \u91c7\u7528C ++ \u6216 Java API ) \u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u9002\u5f53\u7684\u6444\u53d6\u8def\u5f84\u662f\u4f7f\u7528 C ++ \u6216 Java API \u76f4\u63a5\u63d2\u5165\u5230 Kudu \u8868\u4e2d\u3002\u4e0e\u5176\u4ed6 Impala \u8868\u4e0d\u540c\uff0c\u901a\u8fc7 API \u63d2\u5165\u5230 Kudu \u8868\u4e2d\u7684\u6570\u636e\u53ef\u7528\u4e8e Impala \u4e2d\u7684\u67e5\u8be2\uff0c\u800c\u4e0d\u9700\u8981\u4efb\u4f55 INVALIDATE METADATA \u8bed\u53e5\u6216\u5176\u4ed6 Impala \u5b58\u50a8\u7c7b\u578b\u6240\u9700\u7684\u5176\u4ed6\u8bed\u53e5\u3002 INSERT and Primary Key Uniqueness Violations ( \u63d2\u5165\u548c\u4e3b\u952e\u552f\u4e00\u6027\u8fdd\u89c4 ) \u5728\u5927\u591a\u6570\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u5982\u679c\u60a8\u5c1d\u8bd5\u63d2\u5165\u5df2\u63d2\u5165\u7684\u884c\uff0c\u5219\u63d2\u5165\u5c06\u5931\u8d25\uff0c\u56e0\u4e3a\u4e3b\u952e\u5c06\u88ab\u91cd\u590d\u3002\u8bf7\u53c2\u9605 INSERT \uff0c UPDATE \u548c DELETE \u64cd\u4f5c \u4e2d\u7684\u6545\u969c\u3002\u7136\u800c\uff0c Impala \u4e0d\u4f1a\u5931\u8d25\u67e5\u8be2\u3002\u76f8\u53cd\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u8b66\u544a\uff0c\u4f46\u662f\u7ee7\u7eed\u6267\u884c insert \u8bed\u53e5\u7684\u5176\u4f59\u90e8\u5206\u3002 \u5982\u679c\u63d2\u5165\u7684\u884c\u610f\u56fe\u66ff\u6362\u73b0\u6709\u884c\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 UPSERT \u800c\u4e0d\u662f INSERT \u3002 INSERT INTO my_first_table VALUES (99, \"sarah\"); UPSERT INTO my_first_table VALUES (99, \"zoe\"); -- the current value of the row is 'zoe' \u66f4\u65b0\u884c UPDATE my_first_table SET name=\"bob\" where id = 3; \u6ce8\u610f \u5f53\u76ee\u6807\u8868\u5728 Kudu \u65f6\uff0c UPDATE \u8bed\u53e5\u4ec5\u9002\u7528\u4e8e Impala \u3002 \u6279\u91cf\u66f4\u65b0 \u60a8\u53ef\u4ee5\u4f7f\u7528\u6279\u91cf\u63d2\u5165\u4e2d\u76f8\u540c\u7684\u65b9\u6cd5 \u6279\u91cf\u66f4\u65b0 \u3002 UPDATE my_first_table SET name=\"bob\" where age > 10; \u5220\u9664\u884c DELETE FROM my_first_table WHERE id < 3; \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u66f4\u590d\u6742\u7684\u8bed\u6cd5\u8fdb\u884c\u5220\u9664\u3002 FROM \u5b50\u53e5\u4e2d\u7684\u9017\u53f7\u662f Impala \u6307\u5b9a\u8fde\u63a5\u67e5\u8be2\u7684\u4e00\u79cd\u65b9\u6cd5\u3002\u6709\u5173 Impala \u8fde\u63a5\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 DELETE c FROM my_second_table c, stock_symbols s WHERE c.name = s.symbol; \u6ce8\u610f \u5f53\u76ee\u6807\u8868\u5728 Kudu \u65f6\uff0c DELETE \u8bed\u53e5\u4ec5\u9002\u7528\u4e8e Impala \u3002 \u6279\u91cf\u5220\u9664 \u60a8\u53ef\u4ee5\u4f7f\u7528 \u201c\u63d2\u5165\u6279\u91cf\u201d \u4e2d\u6982\u8ff0\u7684\u76f8\u540c\u65b9\u6cd5 \u6279\u91cf\u5220\u9664 \u3002 DELETE FROM my_first_table WHERE id < 3; INSERT\uff0cUPDATE \u548c DELETE \u64cd\u4f5c\u671f\u95f4\u7684\u6545\u969c INSERT \uff0c UPDATE \u548c DELETE \u8bed\u53e5\u4e0d\u80fd\u88ab\u89c6\u4e3a\u6574\u4f53\u4e8b\u52a1\u3002\u5982\u679c\u8fd9\u4e9b\u64cd\u4f5c\u4e2d\u7684\u4e00\u4e2a\u65e0\u6cd5\u90e8\u5206\u901a\u8fc7\uff0c\u5219\u53ef\u80fd\u5df2\u7ecf\u521b\u5efa\u4e86\u5bc6\u94a5\uff08\u5728 INSERT \u7684\u60c5\u51b5\u4e0b\uff09\uff0c\u6216\u8005\u8bb0\u5f55\u53ef\u80fd\u5df2\u88ab\u5176\u4ed6\u8fdb\u7a0b\u4fee\u6539\u6216\u5220\u9664\uff08\u5728 UPDATE \u6216 DELETE \u7684\u60c5\u51b5\u4e0b\uff09\u3002\u60a8\u5e94\u8be5\u8bbe\u8ba1\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u66f4\u6539\u8868\u5c5e\u6027 \u60a8\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539\u8868\u7684\u5c5e\u6027\u6765\u66f4\u6539 Impala \u4e0e\u7ed9\u5b9a Kudu \u8868\u76f8\u5173\u7684\u5143\u6570\u636e\u3002\u8fd9\u4e9b\u5c5e\u6027\u5305\u62ec\u8868\u540d\uff0c Kudu \u4e3b\u5730\u5740\u5217\u8868\uff0c\u4ee5\u53ca\u8868\u662f\u5426\u7531 Impala \uff08\u5185\u90e8\uff09\u6216\u5916\u90e8\u7ba1\u7406\u3002 Rename an Impala Mapping Table ( \u91cd\u547d\u540d Impala \u6620\u5c04\u8868 ) ALTER TABLE my_table RENAME TO my_new_table; \u6ce8\u610f \u4f7f\u7528 ALTER TABLE ... RENAME \u8bed\u53e5\u91cd\u547d\u540d\u8868\u4ec5\u91cd\u547d\u540d Impala \u6620\u5c04\u8868\uff0c\u65e0\u8bba\u8be5\u8868\u662f\u5185\u90e8\u8fd8\u662f\u5916\u90e8\u8868\u3002\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u53ef\u80fd\u8bbf\u95ee\u57fa\u7840\u7684 Kudu \u8868\u7684\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u4e2d\u65ad\u3002 Rename the underlying Kudu table for an internal table ( \u91cd\u65b0\u547d\u540d\u5185\u90e8\u8868\u7684\u57fa\u7840 Kudu \u8868 ) \u5982\u679c\u8868\u662f\u5185\u90e8\u8868\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539 kudu.table_name \u5c5e\u6027\u91cd\u547d\u540d\u5e95\u5c42\u7684 Kudu \u8868\uff1a ALTER TABLE my_internal_table SET TBLPROPERTIES('kudu.table_name' = 'new_name') Remapping an external table to a different Kudu table ( \u5c06\u5916\u90e8\u8868\u91cd\u65b0\u6620\u5c04\u5230\u4e0d\u540c\u7684 Kudu \u8868 ) \u5982\u679c\u53e6\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5728 Impala \u4e0b\u91cd\u547d\u540d\u4e86 Kudu \u8868\uff0c\u5219\u53ef\u4ee5\u91cd\u65b0\u6620\u5c04\u5916\u90e8\u8868\u4ee5\u6307\u5411\u4e0d\u540c\u7684 Kudu \u8868\u540d\u79f0\u3002 ALTER TABLE my_external_table_ SET TBLPROPERTIES('kudu.table_name' = 'some_other_kudu_table') Change the Kudu Master Address ( \u66f4\u6539 Kudu Master \u5730\u5740 ) ALTER TABLE my_table SET TBLPROPERTIES('kudu.master_addresses' = 'kudu-new-master.example.com:7051'); Change an Internally-Managed Table to External ( \u5c06\u5185\u90e8\u7ba1\u7406\u7684\u8868\u66f4\u6539\u4e3a\u5916\u90e8 ) ALTER TABLE my_table SET TBLPROPERTIES('EXTERNAL' = 'TRUE'); \u4f7f\u7528 Impala \u5220\u9664 Kudu \u8868 \u5982\u679c\u8868\u662f\u4f7f\u7528 Impala \u4e2d\u7684\u5185\u90e8\u8868\u521b\u5efa\u7684\uff0c\u5219\u4f7f\u7528 CREATE TABLE \uff0c\u6807\u51c6 DROP TABLE \u8bed\u6cd5\u4f1a\u5220\u9664\u5e95\u5c42\u7684 Kudu \u8868\u53ca\u5176\u6240\u6709\u6570\u636e\u3002\u5982\u679c\u8868\u88ab\u521b\u5efa\u4e3a\u4e00\u4e2a\u5916\u90e8\u8868\uff0c\u4f7f\u7528 CREATE EXTERNAL TABLE\uff0cImpala \u548c Kudu \u4e4b\u95f4\u7684\u6620\u5c04\u88ab\u5220\u9664\uff0c\u4f46 Kudu \u8868\u4fdd\u6301\u539f\u6837\uff0c\u5e76\u5305\u542b\u5176\u6240\u6709\u6570\u636e\u3002 DROP TABLE my_first_table; \u4e0b\u4e00\u6b65\u505a\u4ec0\u4e48\uff1f \u4e0a\u9762\u7684\u4f8b\u5b50\u53ea\u662f\u63a2\u7d22\u4e86 Impala Shell \u6240\u80fd\u505a\u7684\u4e00\u5c0f\u90e8\u5206\u3002 \u4e86\u89e3 Impala \u9879\u76ee \u9605\u8bfb Impala \u6587\u6863 \u67e5\u770b Impala SQL \u53c2\u8003 \u9605\u8bfb Impala \u5185\u90e8\u90e8\u5206\u6216\u4e86\u89e3\u5982\u4f55\u5728 Impala Wiki \u4e0a\u4e3a Impala \u505a\u51fa\u8d21\u732e\u3002 \u9605\u8bfb\u539f\u751f\u7684 Kudu API \u3002 \u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 \u5728\u4f7f\u7528 Impala \u4e2d\u7684\u5916\u90e8\u8868\u683c\u65f6\uff0c\u5fc5\u987b\u4e3a\u5177\u6709\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u540d\u79f0\u7684 Kudu \u8868\u5206\u914d\u5907\u7528\u540d\u79f0\u3002 \u5177\u6709\u5305\u542b\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u5217\u540d\u79f0\u7684 Kudu \u8868\u53ef\u80fd\u4e0d\u4f1a\u7528\u4f5c Impala \u4e2d\u7684\u5916\u90e8\u8868\u3002\u4e13\u680f\u53ef\u80fd\u5728 Kudu \u66f4\u540d\u4e3a\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 \u521b\u5efa Kudu \u8868\u65f6\uff0c CREATE TABLE \u8bed\u53e5\u5fc5\u987b\u5728\u4e3b\u952e\u987a\u5e8f\u4e2d\u5305\u542b\u5176\u4ed6\u5217\u4e4b\u95f4\u7684\u4e3b\u952e\u5217\u3002 \u5305\u542b UNIXTIME_MICROS \u7c7b\u578b\u5217\u7684\u5e93\u675c\u8868\u53ef\u80fd\u4e0d\u4f1a\u7528\u4f5c Impala \u4e2d\u7684\u5916\u90e8\u8868\u3002 Impala \u4e0d\u80fd\u4f7f\u7528 TIMESTAMP \uff0c DECIMAL \uff0c VARCHAR \u6216\u5d4c\u5957\u7c7b\u578b\u7684\u5217\u521b\u5efa Kudu \u8868\u3002 Impala \u65e0\u6cd5\u66f4\u65b0\u4e3b\u952e\u5217\u4e2d\u7684\u503c\u3002 NULL \uff0c NOT NULL \uff0c != \u548c LIKE \u8c13\u8bcd\u4e0d\u4f1a\u88ab\u63a8\u9001\u5230 Kudu \uff0c\u800c\u662f\u4f1a\u88ab Impala \u626b\u63cf\u8282\u70b9\u8bc4\u4f30\u3002\u8fd9\u53ef\u80fd\u4f1a\u964d\u4f4e\u76f8\u5bf9\u4e8e\u5176\u4ed6\u7c7b\u578b\u8c13\u8bcd\u7684\u6027\u80fd\u3002 \u901a\u8fc7 Impala \u7684\u66f4\u65b0\uff0c\u63d2\u5165\u548c\u5220\u9664\u662f\u975e\u4e8b\u52a1\u6027\u7684\u3002\u5982\u679c\u67e5\u8be2\u5931\u8d25\u7684\u4e00\u90e8\u5206\u9014\u5f84\uff0c\u5176\u90e8\u5206\u6548\u679c\u5c06\u4e0d\u4f1a\u56de\u6eda\u3002 \u5355\u4e2a\u67e5\u8be2\u7684\u6700\u5927\u5e76\u884c\u5ea6\u4ec5\u9650\u4e8e\u8868\u4e2d\u7684 tablets \u6570\u91cf\u3002\u4e3a\u4e86\u83b7\u5f97\u826f\u597d\u7684\u5206\u6790\u6027\u80fd\uff0c\u9488\u5bf9\u6bcf\u4e2a\u4e3b\u673a10\u4e2a\u6216\u66f4\u591a\u4e2a tablets \u6216\u4f7f\u7528\u5927\u578b\u8868\u3002","title":"Kudu \u96c6\u6210 Apache Impala"},{"location":"5/#kudu-apache-impala","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/kudu_impala_integration.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813620 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu \u96c6\u6210 Apache Impala"},{"location":"5/#apache-kuduapache-impala","text":"Kudu \u4e0e Apache Impala \uff08\u5b75\u5316\uff09\u7d27\u5bc6\u96c6\u6210\uff0c\u5141\u8bb8\u60a8\u4f7f\u7528 Impala \u4f7f\u7528 Impala \u7684 SQL \u8bed\u6cd5\u4ece Kudu tablets \u63d2\u5165\uff0c\u67e5\u8be2\uff0c\u66f4\u65b0\u548c\u5220\u9664\u6570\u636e\uff0c\u4f5c\u4e3a\u4f7f\u7528 Kudu API \u6784\u5efa\u81ea\u5b9a\u4e49 Kudu \u5e94\u7528\u7a0b\u5e8f\u7684\u66ff\u4ee3\u65b9\u6cd5\u3002\u6b64\u5916\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 JDBC \u6216 ODBC \u5c06\u4f7f\u7528\u4efb\u4f55\u8bed\u8a00\uff0c\u6846\u67b6\u6216\u5546\u4e1a\u667a\u80fd\u5de5\u5177\u7f16\u5199\u7684\u73b0\u6709\u6216\u65b0\u5e94\u7528\u7a0b\u5e8f\u4e0e\u4f7f\u7528 Impala \u4f5c\u4e3a\u4ee3\u7406\u7684 Kudu \u6570\u636e\u8fdb\u884c\u8fde\u63a5\u3002","title":"\u4f7f\u7528Apache Kudu\u4e0eApache Impala\uff08\u5b75\u5316\uff09"},{"location":"5/#_1","text":"\u6b64\u6587\u6863\u7279\u5b9a\u4e8e Impala \u7684\u67d0\u4e9b\u7248\u672c\u3002\u63cf\u8ff0\u7684\u8bed\u6cd5\u5c06\u4ec5\u5728\u4ee5\u4e0b\u7248\u672c\u4e2d\u8fd0\u884c\uff1a CDH 5.10 \u9644\u5e26\u7684 Impala 2.7.0 \u7248\u672c\u3002 SELECT VERSION() \u5c06\u62a5\u544a impalad version 2.7.0-cdh5.10.0 \u3002 \u4ece\u6e90\u4ee3\u7801\u7f16\u8bd1\u7684 Apache Impala 2.8.0 \u7248\u672c\u3002 SELECT VERSION() \u5c06\u62a5\u544a impalad version 2.8.0 \u3002 \u8f83\u65e9\u7248\u672c\u7684 Impala 2.7 \uff08\u5305\u62ec\u4ee5\u524d\u63d0\u4f9b\u7684\u7279\u6b8a IMPALA_KUDU \u7248\u672c\uff09\u5177\u6709\u4e0d\u517c\u5bb9\u7684\u8bed\u6cd5\u3002\u672a\u6765\u7248\u672c\u53ef\u80fd\u4e0e\u6b64\u8bed\u6cd5\u517c\u5bb9\uff0c\u4f46\u6211\u4eec\u5efa\u8bae\u60a8\u68c0\u67e5\u8fd9\u662f\u4e0e\u60a8\u5b89\u88c5\u7684\u76f8\u5e94\u7248\u672c\u76f8\u5bf9\u5e94\u7684\u6700\u65b0\u53ef\u7528\u6587\u6863\u3002 \u672c\u6587\u6863\u4e0d\u63cf\u8ff0 Impala \u5b89\u88c5\u8fc7\u7a0b\u3002\u8bf7\u53c2\u9605 Impala \u6587\u6863\uff0c\u5e76\u786e\u4fdd\u60a8\u53ef\u4ee5\u5728\u7ee7\u7eed\u4e4b\u524d\u5bf9 HDFS \u4e0a\u7684 Impala \u8868\u8fd0\u884c\u7b80\u5355\u67e5\u8be2\u3002","title":"\u8981\u6c42"},{"location":"5/#_2","text":"Kudu \u5185\u4e0d\u9700\u8981\u8fdb\u884c\u914d\u7f6e\u66f4\u6539\uff0c\u4ece\u800c\u53ef\u4ee5\u8bbf\u95ee Impala \u3002 \u867d\u7136\u4e0d\u662f\u7edd\u5bf9\u5fc5\u8981\u7684\uff0c\u4f46\u5efa\u8bae\u60a8\u914d\u7f6e Impala \u4e0e Kudu Master servers \u7684\u4f4d\u7f6e\uff1a \u5728 Impala \u670d\u52a1\u914d\u7f6e\u4e2d\u8bbe\u7f6e --kudu_master_hosts = <master1> [\uff1aport] \uff0c <master2> [\uff1aport] \uff0c <master3> [\uff1aport] \u6807\u5fd7\u3002\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528 Cloudera Manager \uff0c\u8bf7\u53c2\u9605\u76f8\u5e94\u7684 Cloudera Manager \u6587\u6863\u3002 \u5982\u679c\u5728 Impala \u670d\u52a1\u4e2d\u672a\u8bbe\u7f6e\u6b64\u6807\u5fd7\uff0c\u5219\u6bcf\u6b21\u521b\u5efa\u8868\u683c\u65f6\u90fd\u5fc5\u987b\u624b\u52a8\u63d0\u4f9b\u6b64\u914d\u7f6e\uff0c\u65b9\u6cd5\u662f\u5728 TBLPROPERTIES \u5b50\u53e5\u4e2d\u6307\u5b9a kudu_master_addresses \u5c5e\u6027\u3002 \u672c\u6307\u5357\u7684\u5176\u4f59\u90e8\u5206\u5047\u8bbe\u914d\u7f6e\u5df2\u8bbe\u7f6e\u3002","title":"\u914d\u7f6e"},{"location":"5/#impala-shell","text":"\u6ce8\u610f \u8fd9\u53ea\u662f Impala Shell \u529f\u80fd\u7684\u4e00\u5c0f\u90e8\u5206\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Impala Shell \u6587\u6863\u3002 \u4f7f\u7528 impala-shell \u547d\u4ee4\u542f\u52a8 Impala Shell \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c impala-shell \u5c1d\u8bd5\u8fde\u63a5\u5230\u7aef\u53e3 21000 \u4e0a\u7684 localhost \u4e0a\u7684 Impala \u5b88\u62a4\u7a0b\u5e8f\u3002\u8981\u8fde\u63a5\u5230\u5176\u4ed6\u4e3b\u673a\uff0c\u8bf7\u4f7f\u7528 -i <host:port> \u9009\u9879\u3002\u8981\u81ea\u52a8\u8fde\u63a5\u5230\u7279\u5b9a\u7684 Impala \u6570\u636e\u5e93\uff0c\u8bf7\u4f7f\u7528 -d <database> \u9009\u9879\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u6240\u6709 Kudu \u8868\u90fd\u4f4d\u4e8e Impala_kudu \u6570\u636e\u5e93\u4e2d\u7684 Impala \u4e2d\uff0c\u8bf7\u4f7f\u7528 -d impala_kudu \u6765\u4f7f\u7528\u6b64\u6570\u636e\u5e93\u3002 \u8981\u9000\u51fa Impala Shell \uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a quit ;","title":"\u4f7f\u7528 Impala Shell"},{"location":"5/#impala","text":"\u4f7f\u7528 Impala \u521b\u5efa\u65b0\u7684 Kudu \u8868\u65f6\uff0c\u53ef\u4ee5\u5c06\u8868\u521b\u5efa\u4e3a\u5185\u90e8\u8868\u6216\u5916\u90e8\u8868\u3002","title":"\u5185\u90e8\u548c\u5916\u90e8 Impala \u8868"},{"location":"5/#internal","text":"\u5185\u90e8\u8868\u7531 Impala \u7ba1\u7406\uff0c\u5f53\u60a8\u4ece Impala \u4e2d\u5220\u9664\u65f6\uff0c\u6570\u636e\u548c\u8868\u786e\u5b9e\u88ab\u5220\u9664\u3002\u5f53\u60a8\u4f7f\u7528 Impala \u521b\u5efa\u65b0\u8868\u65f6\uff0c\u901a\u5e38\u662f\u5185\u90e8\u8868\u3002","title":"Internal ( \u5185\u90e8 )"},{"location":"5/#external","text":"\u5916\u90e8\u8868\uff08\u7531 CREATE EXTERNAL TABLE \u521b\u5efa\uff09\u4e0d\u53d7 Impala \u7ba1\u7406\uff0c\u5e76\u4e14\u5220\u9664\u6b64\u8868\u4e0d\u4f1a\u5c06\u8868\u4ece\u5176\u6e90\u4f4d\u7f6e\uff08\u6b64\u5904\u4e3a Kudu \uff09\u4e22\u5f03\u3002\u76f8\u53cd\uff0c\u5b83\u53ea\u4f1a\u53bb\u9664 Impala \u548c Kudu \u4e4b\u95f4\u7684\u6620\u5c04\u3002\u8fd9\u662f Kudu \u63d0\u4f9b\u7684\u7528\u4e8e\u5c06\u73b0\u6709\u8868\u6620\u5c04\u5230 Impala \u7684\u8bed\u6cd5\u3002 \u6709\u5173\u5185\u90e8\u548c\u5916\u90e8\u8868\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Impala\u6587\u6863 \u3002","title":"External ( \u5916\u90e8 )"},{"location":"5/#impala-kudu","text":"\u901a\u8fc7 Kudu API \u6216\u5176\u4ed6\u96c6\u6210\uff08\u5982 Apache Spark \uff09\u521b\u5efa\u7684\u8868\u4e0d\u4f1a\u5728 Impala \u4e2d\u81ea\u52a8\u663e\u793a\u3002\u8981\u67e5\u8be2\u5b83\u4eec\uff0c\u60a8\u5fc5\u987b\u5148\u5728 Impala \u4e2d\u521b\u5efa\u5916\u90e8\u8868\u4ee5\u5c06 Kudu \u8868\u6620\u5c04\u5230 Impala \u6570\u636e\u5e93\u4e2d\uff1a CREATE EXTERNAL TABLE my_mapping_table STORED AS KUDU TBLPROPERTIES ( 'kudu.table_name' = 'my_kudu_table' );","title":"\u67e5\u8be2 Impala \u4e2d\u73b0\u6709\u7684 Kudu \u8868"},{"location":"5/#impala-kudu_1","text":"\u4ece Impala \u5728 Kudu \u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u8868\u7c7b\u4f3c\u4e8e\u5c06\u73b0\u6709\u7684 Kudu \u8868\u6620\u5c04\u5230 Impala \u8868\uff0c\u4f46\u60a8\u9700\u8981\u81ea\u5df1\u6307\u5b9a\u6a21\u5f0f\u548c\u5206\u533a\u4fe1\u606f\u3002 \u4f7f\u7528\u4ee5\u4e0b\u793a\u4f8b\u4f5c\u4e3a\u6307\u5bfc\u3002 Impala \u9996\u5148\u521b\u5efa\u8868\uff0c\u7136\u540e\u521b\u5efa\u6620\u5c04\u3002 CREATE TABLE my_first_table ( id BIGINT, name STRING, PRIMARY KEY(id) ) PARTITION BY HASH PARTITIONS 16 STORED AS KUDU; \u5728 CREATE TABLE \u8bed\u53e5\u4e2d\uff0c\u5fc5\u987b\u9996\u5148\u5217\u51fa\u6784\u6210\u4e3b\u952e\u7684\u5217\u3002\u6b64\u5916\uff0c\u4e3b\u952e\u5217\u9690\u5f0f\u6807\u8bb0\u4e3a NOT NULL \u3002 \u521b\u5efa\u65b0\u7684 Kudu \u8868\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5206\u914d\u65b9\u6848\u3002\u8bf7\u53c2\u9605 \u5206\u533a\u8868 \u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u4e0a\u9762\u7684\u8868\u521b\u5efa\u793a\u4f8b\u901a\u8fc7\u6563\u5217 id \u5217\u5206\u6210 16 \u4e2a\u5206\u533a\u3002\u6709\u5173\u5206\u533a\u7684\u6307\u5bfc\uff0c\u8bf7\u53c2\u9605 Thumb \u7684\u5206\u533a\u89c4\u5219 \u3002 CREATE TABLE AS SELECT \u60a8\u53ef\u4ee5\u4f7f\u7528 CREATE TABLE ... AS SELECT \u8bed\u53e5\u67e5\u8be2 Impala \u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u8868\u6216\u8868\u6765\u521b\u5efa\u8868\u3002\u4ee5\u4e0b\u793a\u4f8b\u5c06\u73b0\u6709\u8868 old_table \u4e2d\u7684\u6240\u6709\u884c\u5bfc\u5165\u5230 Kudu \u8868 new_table \u4e2d\u3002 new_table \u4e2d\u7684\u5217\u7684\u540d\u79f0\u548c\u7c7b\u578b\u5c06\u6839\u636e SELECT \u8bed\u53e5\u7684\u7ed3\u679c\u96c6\u4e2d\u7684\u5217\u786e\u5b9a\u3002\u8bf7\u6ce8\u610f\uff0c\u60a8\u5fc5\u987b\u53e6\u5916\u6307\u5b9a\u4e3b\u952e\u548c\u5206\u533a\u3002 CREATE TABLE new_table PRIMARY KEY (ts, name) PARTITION BY HASH(name) PARTITIONS 8 STORED AS KUDU AS SELECT ts, name, value FROM old_table;","title":"\u4ece Impala \u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Kudu \u8868"},{"location":"5/#tablet-partitioning-tablet","text":"\u8868\u5206\u4e3a\u6bcf\u4e2a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a tablet servers \u63d0\u4f9b\u7684 tablets \u3002\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c tablets \u5e94\u8be5\u76f8\u5bf9\u5e73\u7b49\u5730\u62c6\u5206\u8868\u7684\u6570\u636e\u3002 Kudu \u76ee\u524d\u6ca1\u6709\u81ea\u52a8\uff08\u6216\u624b\u52a8\uff09\u62c6\u5206\u9884\u5148\u5b58\u5728\u7684 tablets \u7684\u673a\u5236\u3002\u5728\u5b9e\u73b0\u6b64\u529f\u80fd\u4e4b\u524d\uff0c\u60a8\u5fc5\u987b\u5728\u521b\u5efa\u8868\u65f6\u6307\u5b9a\u5206\u533a\u3002\u5728\u8bbe\u8ba1\u8868\u683c\u67b6\u6784\u65f6\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u4e3b\u952e\uff0c\u60a8\u53ef\u4ee5\u5c06\u8868\u62c6\u5206\u6210\u4ee5\u7c7b\u4f3c\u901f\u5ea6\u589e\u957f\u7684\u5206\u533a\u3002\u4f7f\u7528 Impala \u521b\u5efa\u8868\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 PARTITION BY \u5b50\u53e5\u6307\u5b9a\u5206\u533a\uff1a \u6ce8\u610f Impala \u5173\u952e\u5b57\uff08\u5982 group \uff09\u5728\u5173\u952e\u5b57\u610f\u4e49\u4e0a\u4e0d\u88ab\u4f7f\u7528\u65f6\uff0c\u7531\u80cc\u9762\u7684\u5b57\u7b26\u5305\u56f4\u3002 CREATE TABLE cust_behavior ( _id BIGINT PRIMARY KEY, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, sku STRING, rating INT, fulfilled_date BIGINT ) PARTITION BY RANGE (_id) ( PARTITION VALUES < 1439560049342, PARTITION 1439560049342 <= VALUES < 1439566253755, PARTITION 1439566253755 <= VALUES < 1439572458168, PARTITION 1439572458168 <= VALUES < 1439578662581, PARTITION 1439578662581 <= VALUES < 1439584866994, PARTITION 1439584866994 <= VALUES < 1439591071407, PARTITION 1439591071407 <= VALUES ) STORED AS KUDU; \u5982\u679c\u60a8\u6709\u591a\u4e2a\u4e3b\u952e\u5217\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u5143\u7ec4\u8bed\u6cd5\u6307\u5b9a\u5206\u533a\u8fb9\u754c\uff1a \uff08'va'\uff0c1\uff09\uff0c\uff08'ab'\uff0c2\uff09 \u3002\u8be5\u8868\u8fbe\u5f0f\u5fc5\u987b\u662f\u6709\u6548\u7684 JSON \u3002","title":"\u6307\u5b9a\u00a0Tablet Partitioning ( Tablet \u5206\u533a )"},{"location":"5/#impala-kudu_2","text":"\u6bcf\u4e2a Impala \u8868\u90fd\u5305\u542b\u5728\u79f0\u4e3a\u6570\u636e\u5e93\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u3002\u9ed8\u8ba4\u6570\u636e\u5e93\u79f0\u4e3a\u9ed8\u8ba4\u6570\u636e\u5e93\uff0c\u7528\u6237\u53ef\u6839\u636e\u9700\u8981\u521b\u5efa\u548c\u5220\u9664\u5176\u4ed6\u6570\u636e\u5e93\u3002 \u5f53\u4ece Impala \u4e2d\u521b\u5efa\u4e00\u4e2a\u53d7\u7ba1 Kudu \u8868\u65f6\uff0c\u76f8\u5e94\u7684 Kudu \u8868\u5c06\u88ab\u547d\u540d\u4e3a my_database :: table_name \u3002","title":"Impala \u6570\u636e\u5e93\u548c Kudu"},{"location":"5/#kudu-impala","text":"\u521b\u5efa Kudu \u8868\u65f6\u4e0d\u652f\u6301\u4ee5\u4e0b Impala \u5173\u952e\u5b57\uff1a - PARTITIONED - LOCATION - ROWFORMAT","title":"\u4e0d\u652f\u6301 Kudu \u8868\u7684 Impala \u5173\u952e\u5b57"},{"location":"5/#sql","text":"\u5982\u679c\u60a8\u7684\u67e5\u8be2\u7684 WHERE \u5b50\u53e5\u5305\u542b\u4e0e operators = \uff0c <= \uff0c '** \uff0c '\\' \uff0c > = \uff0c BETWEEN \u6216 IN \u7684\u6bd4\u8f83\uff0c\u5219 Kudu \u76f4\u63a5\u8bc4\u4f30\u8be5\u6761\u4ef6\uff0c\u53ea\u8fd4\u56de\u76f8\u5173\u7ed3\u679c\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u4f73\u6027\u80fd\uff0c\u56e0\u4e3a Kudu \u53ea\u5c06\u76f8\u5173\u7ed3\u679c\u8fd4\u56de\u7ed9 Impala \u3002\u5bf9\u4e8e\u8c13\u8bcd != \uff0c LIKE \u6216 Impala \u652f\u6301\u7684\u4efb\u4f55\u5176\u4ed6\u8c13\u8bcd\u7c7b\u578b\uff0c Kudu \u4e0d\u4f1a\u76f4\u63a5\u8bc4\u4f30\u8c13\u8bcd\uff0c\u800c\u662f\u5c06\u6240\u6709\u7ed3\u679c\u8fd4\u56de\u7ed9 Impala \uff0c\u5e76\u4f9d\u8d56\u4e8e Impala** \u6765\u8bc4\u4f30\u5269\u4f59\u7684\u8c13\u8bcd\u5e76\u76f8\u5e94\u5730\u8fc7\u6ee4\u7ed3\u679c\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6027\u80fd\u5dee\u5f02\uff0c\u8fd9\u53d6\u51b3\u4e8e\u8bc4\u4f30 WHERE \u5b50\u53e5\u4e4b\u524d\u548c\u4e4b\u540e\u7684\u7ed3\u679c\u96c6\u7684\u589e\u91cf\u3002","title":"\u4f18\u5316\u8bc4\u4f30 SQL \u8c13\u8bcd\u7684\u6027\u80fd"},{"location":"5/#_3","text":"\u6839\u636e\u4e3b\u952e\u5217\u4e0a\u7684\u5206\u533a\u6a21\u5f0f\u5c06\u8868\u683c\u5212\u5206\u4e3a tablets \u3002\u6bcf\u4e2a tablet \u7531\u81f3\u5c11\u4e00\u53f0 tablet server \u63d0\u4f9b\u3002\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u4e00\u5f20\u8868\u5e94\u8be5\u5206\u6210\u591a\u4e2a tablets \u4e2d\u5206\u5e03\u7684 tablet servers \uff0c\u4ee5\u6700\u5927\u5316\u5e76\u884c\u64cd\u4f5c\u3002\u60a8\u4f7f\u7528\u7684\u5206\u533a\u6a21\u5f0f\u7684\u8be6\u7ec6\u4fe1\u606f\u5c06\u5b8c\u5168\u53d6\u51b3\u4e8e\u60a8\u5b58\u50a8\u7684\u6570\u636e\u7c7b\u578b\u548c\u8bbf\u95ee\u65b9\u5f0f\u3002\u5173\u4e8e Kudu \u6a21\u5f0f\u8bbe\u8ba1\u7684\u5168\u9762\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 Schema Design \u3002 Kudu \u76ee\u524d\u6ca1\u6709\u5728\u521b\u5efa\u8868\u4e4b\u540e\u62c6\u5206\u6216\u5408\u5e76 tablets \u7684\u673a\u5236\u3002\u521b\u5efa\u8868\u65f6\uff0c\u5fc5\u987b\u4e3a\u8868\u63d0\u4f9b\u5206\u533a\u6a21\u5f0f\u3002\u5728\u8bbe\u8ba1\u8868\u683c\u65f6\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u4e3b\u952e\uff0c\u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u5c06\u8868\u683c\u5206\u4e3a\u4ee5\u76f8\u540c\u901f\u7387\u589e\u957f\u7684 tablets \u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528 Impala \u7684 PARTITION BY \u5173\u952e\u5b57\u5bf9\u8868\u8fdb\u884c\u5206\u533a\uff0c\u8be5\u5173\u952e\u5b57\u652f\u6301 RANGE \u6216 HASH \u5206\u53d1\u3002\u5206\u533a\u65b9\u6848\u53ef\u4ee5\u5305\u542b\u96f6\u4e2a\u6216\u591a\u4e2a HASH \u5b9a\u4e49\uff0c\u540e\u9762\u662f\u53ef\u9009\u7684 RANGE \u5b9a\u4e49\u3002 RANGE \u5b9a\u4e49\u53ef\u4ee5\u5f15\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u952e\u5217\u3002 \u57fa\u672c \u548c \u9ad8\u7ea7\u5206\u533a \u7684\u793a\u4f8b\u5982\u4e0b\u6240\u793a\u3002","title":"\u5206\u533a\u8868"},{"location":"5/#_4","text":"PARTITION BY RANGE ( \u6309\u8303\u56f4\u5212\u5206 ) \u60a8\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u952e\u5217\u6307\u5b9a\u8303\u56f4\u5206\u533a\u3002 Kudu \u4e2d\u7684\u8303\u56f4\u5206\u533a\u5141\u8bb8\u6839\u636e\u6240\u9009\u5206\u533a\u952e\u7684\u7279\u5b9a\u503c\u6216\u503c\u7684\u8303\u56f4\u62c6\u5206\u8868\u3002\u8fd9\u6837\u53ef\u4ee5\u5e73\u8861\u5e76\u884c\u5199\u5165\u4e0e\u626b\u63cf\u6548\u7387\u3002 \u5047\u8bbe\u60a8\u6709\u4e00\u4e2a\u5177\u6709\u5217 state \uff0c name \u548c purchase_count \u7684\u8868\u3002\u4ee5\u4e0b\u793a\u4f8b\u521b\u5efa 50 \u4e2a tablets \uff0c\u6bcf\u4e2a US state \u3002 \u6ce8\u610f \u5355\u8c03\u589e\u52a0 Values \u5982\u679c\u60a8\u5728\u5176\u503c\u5355\u8c03\u9012\u589e\u7684\u5217\u4e0a\u6309\u8303\u56f4\u8fdb\u884c\u5206\u533a\uff0c\u5219\u6700\u540e\u4e00\u4e2a tablet \u7684\u589e\u957f\u5c06\u8fdc\u5927\u4e8e\u5176\u4ed6\u5e73\u53f0\u3002\u6b64\u5916\uff0c\u63d2\u5165\u7684\u6240\u6709\u6570\u636e\u5c06\u4e00\u6b21\u5199\u5165\u5355\u4e2a tablet \uff0c\u9650\u5236\u4e86\u6570\u636e\u6444\u53d6\u7684\u53ef\u6269\u5c55\u6027\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8bf7\u8003\u8651\u901a\u8fc7 HASH \u5206\u914d\uff0c\u800c\u4e0d\u662f\u6216\u9664 RANGE \u4e4b\u5916\u3002 CREATE TABLE customers ( state STRING, name STRING, purchase_count int, PRIMARY KEY (state, name) ) PARTITION BY RANGE (state) ( PARTITION VALUE = 'al', PARTITION VALUE = 'ak', PARTITION VALUE = 'ar', -- ... etc ... PARTITION VALUE = 'wv', PARTITION VALUE = 'wy' ) STORED AS KUDU; PARTITION BY HASH ( \u54c8\u5e0c\u5206\u533a ) \u60a8\u53ef\u4ee5\u901a\u8fc7\u6563\u5217\u5206\u53d1\u5230\u7279\u5b9a\u6570\u91cf\u7684 \u201c buckets \u201d \uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u663e\u5f0f\u8303\u56f4\u8fdb\u884c\u5206\u53d1\uff0c\u6216\u4e0e\u8303\u56f4\u5206\u5e03\u7ec4\u5408\u3002\u60a8\u6307\u5b9a\u8981\u5206\u533a\u7684\u4e3b\u952e\u5217\uff0c\u4ee5\u53ca\u8981\u4f7f\u7528\u7684\u5b58\u50a8\u6876\u6570\u3002\u901a\u8fc7\u6563\u5217\u6307\u5b9a\u7684\u952e\u5217\u6765\u5206\u914d\u884c\u3002\u5047\u8bbe\u6563\u5217\u7684\u503c\u672c\u8eab\u4e0d\u4f1a\u8868\u73b0\u51fa\u663e\u7740\u7684\u504f\u5dee\uff0c\u8fd9\u5c06\u6709\u52a9\u4e8e\u5c06\u6570\u636e\u5747\u5300\u5730\u5206\u5e03\u5728\u6570\u636e\u6876\u4e4b\u95f4\u3002 \u60a8\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u5b9a\u4e49\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u4f7f\u7528\u590d\u5408\u4e3b\u952e\u7684\u5b9a\u4e49\u3002\u4f46\u662f\uff0c\u5728\u591a\u4e2a\u6563\u5217\u5b9a\u4e49\u4e2d\u4e0d\u80fd\u63d0\u53ca\u4e00\u5217\u3002\u8003\u8651\u4e24\u5217a\u548cb\uff1a \u221a * HASH(a)\uff0cHASH(b) \u221a HASH(a\uff0cb) \u00d7 HASH(a)\uff0cHASH(a\uff0cb) \u6ce8\u610f \u6ca1\u6709\u6307\u5b9a\u5217\u7684 HASH \u7684 PARTITION BY HASH \u662f\u901a\u8fc7\u6563\u5217\u6240\u6709\u4e3b\u952e\u5217\u6765\u521b\u5efa\u6240\u9700\u6570\u91cf\u7684\u6876\u7684\u5feb\u6377\u65b9\u5f0f\u3002 \u5982\u679c\u4e3b\u952e\u503c\u5747\u5300\u5206\u5e03\u5728\u5176\u57df\u4e2d\uff0c\u5e76\u4e14\u6570\u636e\u504f\u79fb\u4e0d\u660e\u663e\uff0c\u4f8b\u5982 timestamps ( \u65f6\u95f4\u6233 ) \u6216 IDs ( \u5e8f\u5217\u53f7 )\uff0c\u5219\u54c8\u5e0c\u5206\u533a\u662f\u5408\u7406\u7684\u65b9\u6cd5\u3002 \u4ee5\u4e0b\u793a\u4f8b\u901a\u8fc7\u6563\u5217 id \u548c sku \u5217\u521b\u5efa 16 \u4e2a tablets \u3002\u8fd9\u4f20\u64ad\u4e86\u6240\u6709 16 \u4e2a tablets \u7684\u5199\u4f5c\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5bf9\u4e00\u7cfb\u5217 sku \u503c\u7684\u67e5\u8be2\u53ef\u80fd\u9700\u8981\u8bfb\u53d6\u6240\u6709 16 \u4e2a tablets \uff0c\u56e0\u6b64\u8fd9\u53ef\u80fd\u4e0d\u662f\u6b64\u8868\u7684\u6700\u4f73\u6a21\u5f0f\u3002\u6709\u5173\u6269\u5c55\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605 \u9ad8\u7ea7\u5206\u533a \u3002 CREATE TABLE cust_behavior ( id BIGINT, sku STRING, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, rating INT, fulfilled_date BIGINT, PRIMARY KEY (id, sku) ) PARTITION BY HASH PARTITIONS 16 STORED AS KUDU;","title":"\u57fa\u672c\u5206\u533a"},{"location":"5/#_5","text":"\u60a8\u53ef\u4ee5\u7ec4\u5408 HASH \u548c RANGE \u5206\u533a\u6765\u521b\u5efa\u66f4\u590d\u6742\u7684\u5206\u533a\u6a21\u5f0f\u3002\u60a8\u53ef\u4ee5\u6307\u5b9a\u96f6\u4e2a\u6216\u591a\u4e2a HASH \u5b9a\u4e49\uff0c\u540e\u8ddf\u96f6\u4e2a\u6216\u4e00\u4e2a RANGE \u5b9a\u4e49\u3002\u6bcf\u4e2a\u5b9a\u4e49\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u3002\u867d\u7136\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684\u5206\u53d1\u6a21\u5f0f\u90fd\u8d85\u51fa\u4e86\u672c\u6587\u6863\u7684\u8303\u56f4\uff0c\u4f46\u662f\u51e0\u4e2a\u4f8b\u5b50\u8bf4\u660e\u4e86\u4e00\u4e9b\u53ef\u80fd\u6027\u3002 PARTITION BY HASH and RANGE \u8003\u8651\u4e0a\u9762\u7684 \u7b80\u5355\u54c8\u5e0c \u793a\u4f8b\uff0c\u5982\u679c\u60a8\u7ecf\u5e38\u67e5\u8be2\u4e00\u7cfb\u5217 sku \u503c\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u54c8\u5e0c\u5206\u533a\u4e0e\u8303\u56f4\u5206\u533a\u76f8\u7ed3\u5408\u6765\u4f18\u5316\u793a\u4f8b\u3002 \u4ee5\u4e0b\u793a\u4f8b\u4ecd\u7136\u521b\u5efa\u4e8616\u4e2a tablets \uff0c\u9996\u5148\u5c06 id \u5217\u5206\u4e3a 4 \u4e2a\u5b58\u50a8\u533a\uff0c\u7136\u540e\u6839\u636e sku \u5b57\u7b26\u4e32\u7684\u503c\u5e94\u7528\u8303\u56f4\u5212\u5206\u5c06\u6bcf\u4e2a\u5b58\u50a8\u533a\u5206\u4e3a\u56db\u4e2a\u6570\u636e\u5757\u3002\u81f3\u5c11\u56db\u7247\uff08\u6700\u591a\u53ef\u8fbe 16 \u5f20\uff09\u3002\u5f53\u60a8\u67e5\u8be2\u76f8\u90bb\u8303\u56f4\u7684 sku \u503c\u65f6\uff0c\u60a8\u5f88\u6709\u53ef\u80fd\u53ea\u9700\u4ece\u56db\u5206\u4e4b\u4e00\u7684 tablets \u4e2d\u8bfb\u53d6\u5373\u53ef\u5b8c\u6210\u67e5\u8be2\u3002 \u6ce8\u610f \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 PARTITION BY HASH \u65f6\uff0c\u6574\u4e2a\u4e3b\u952e\u662f\u6563\u5217\u7684\u3002\u8981\u53ea\u5bf9\u4e3b\u952e\u8fdb\u884c\u6563\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528\u50cf PARTITION BY HASH(id, sku) \u8fd9\u6837\u7684\u8bed\u6cd5\u6765\u6307\u5b9a\u5b83\u3002 CREATE TABLE cust_behavior ( id BIGINT, sku STRING, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, rating INT, fulfilled_date BIGINT, PRIMARY KEY (id, sku) ) PARTITION BY HASH (id) PARTITIONS 4, RANGE (sku) ( PARTITION VALUES < 'g', PARTITION 'g' <= VALUES < 'o', PARTITION 'o' <= VALUES < 'u', PARTITION 'u' <= VALUES ) STORED AS KUDU; Multiple PARTITION BY HASH Definitions ( \u591a\u91cd\u5212\u5206\u7531 HASH \u5b9a\u4e49 ) \u518d\u6b21\u6269\u5c55\u4e0a\u8ff0\u793a\u4f8b\uff0c\u5047\u8bbe\u67e5\u8be2\u6a21\u5f0f\u5c06\u662f\u4e0d\u53ef\u9884\u6d4b\u7684\uff0c\u4f46\u60a8\u5e0c\u671b\u786e\u4fdd\u5199\u5165\u5206\u5e03\u5728\u5927\u91cf tablets \u4e0a\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728\u4e3b\u952e\u5217\u4e0a\u8fdb\u884c\u6563\u5217\u6765\u5b9e\u73b0\u6574\u4e2a\u4e3b\u952e\u7684\u6700\u5927\u5206\u914d\u3002 CREATE TABLE cust_behavior ( id BIGINT, sku STRING, salary STRING, edu_level INT, usergender STRING, `group` STRING, city STRING, postcode STRING, last_purchase_price FLOAT, last_purchase_date BIGINT, category STRING, rating INT, fulfilled_date BIGINT, PRIMARY KEY (id, sku) ) PARTITION BY HASH (id) PARTITIONS 4, HASH (sku) PARTITIONS 4 STORED AS KUDU; \u8be5\u793a\u4f8b\u521b\u5efa 16 \u4e2a\u5206\u533a\u3002\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 HASH(id,sku) PARTITIONS 16 .\u4f46\u662f\uff0c\u5bf9\u4e8e sku \u503c\u7684\u626b\u63cf\u51e0\u4e4e\u603b\u662f\u4f1a\u5f71\u54cd\u6240\u6709 16 \u4e2a\u5206\u533a\uff0c\u800c\u4e0d\u662f\u53ef\u80fd\u9650\u5236\u4e3a 4 \u3002 Non-Covering Range Partitions ( \u4e0d\u8986\u76d6\u5206\u533a ) Kudu 1.0 \u53ca\u66f4\u9ad8\u7248\u672c\u652f\u6301\u4f7f\u7528\u975e\u8986\u76d6\u8303\u56f4\u5206\u533a\uff0c\u5176\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\uff1a \u6ca1\u6709\u672a\u8986\u76d6\u7684\u8303\u56f4\u5206\u533a\uff0c\u5728\u9700\u8981\u8003\u8651\u4e0d\u65ad\u589e\u52a0\u7684\u4e3b\u952e\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u6216\u5176\u4ed6\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u670d\u52a1\u4e8e\u65e7\u6570\u636e\u7684 tablet \u7684\u5927\u5c0f\u76f8\u5bf9\u56fa\u5b9a\uff0c\u800c\u63a5\u6536\u65b0\u6570\u636e\u7684 tablets \u5c06\u4e0d\u53d7\u9650\u5236\u5730\u589e\u957f\u3002 \u5728\u60a8\u5e0c\u671b\u6839\u636e\u5176\u7c7b\u522b\uff08\u5982\u9500\u552e\u533a\u57df\u6216\u4ea7\u54c1\u7c7b\u578b\uff09\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u533a\u7684\u60c5\u51b5\u4e0b\uff0c\u65e0\u9700\u8986\u76d6\u8303\u56f4\u5206\u533a\uff0c\u5219\u5fc5\u987b\u63d0\u524d\u4e86\u89e3\u6240\u6709\u5206\u533a\uff0c\u6216\u8005\u5982\u679c\u9700\u8981\u6dfb\u52a0\u6216\u5220\u9664\u5206\u533a\uff0c\u8bf7\u624b\u52a8\u91cd\u65b0\u521b\u5efa\u8868\u3002 \u4f8b\u5982\u5f15\u5165\u6216\u6d88\u9664\u4ea7\u54c1\u7c7b\u578b\u3002 \u975e\u8986\u76d6\u8303\u56f4\u5206\u533a\u6709\u4e00\u4e9b\u6ce8\u610f\u4e8b\u9879\u3002\u8bf7\u52a1\u5fc5\u9605\u8bfb\u94fe\u63a5\uff1a /docs/schema_design.html [Schema Design guide] \u3002 \u6b64\u793a\u4f8b\u6bcf\u5e74\u521b\u5efa\u4e00\u4e2a tablet \uff08\u51715\u4e2a tablets \uff09\uff0c\u7528\u4e8e\u5b58\u50a8\u65e5\u5fd7\u6570\u636e\u3002\u8be5\u8868\u4ec5\u63a5\u53d7 2012 \u5e74\u81f3 2016 \u5e74 \u7684\u6570\u636e\u3002\u8fd9\u4e9b\u8303\u56f4\u4e4b\u5916\u7684\u952e\u5c06\u88ab\u62d2\u7edd\u3002 CREATE TABLE sales_by_year ( year INT, sale_id INT, amount INT, PRIMARY KEY (sale_id, year) ) PARTITION BY RANGE (year) ( PARTITION VALUE = 2012, PARTITION VALUE = 2013, PARTITION VALUE = 2014, PARTITION VALUE = 2015, PARTITION VALUE = 2016 ) STORED AS KUDU; \u5f53\u8bb0\u5f55\u5f00\u59cb\u8fdb\u5165 2017 \u5e74\u65f6\uff0c\u4ed6\u4eec\u5c06\u88ab\u62d2\u7edd\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c 2017 \u5e74\u7684\u8303\u56f4\u5e94\u8be5\u5982\u4e0b\uff1a ALTER TABLE sales_by_year ADD RANGE PARTITION VALUE = 2017; \u5728\u9700\u8981\u6570\u636e\u4fdd\u7559\u7684\u6eda\u52a8\u7a97\u53e3\u7684\u60c5\u51b5\u4e0b\uff0c\u8303\u56f4\u5206\u533a\u4e5f\u53ef\u80fd\u4f1a\u4e22\u5f03\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e0d\u518d\u4fdd\u7559 2012 \u5e74\u7684\u6570\u636e\uff0c\u5219\u53ef\u80fd\u4f1a\u6279\u91cf\u5220\u9664\u6570\u636e\uff1a ALTER TABLE sales_by_year DROP RANGE PARTITION VALUE = 2012; \u8bf7\u6ce8\u610f\uff0c\u5c31\u50cf\u5220\u9664\u8868\u4e00\u6837\uff0c\u8fd9\u4e0d\u53ef\u9006\u8f6c\u5730\u5220\u9664\u5b58\u50a8\u5728\u4e22\u5f03\u7684\u5206\u533a\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002","title":"\u9ad8\u7ea7\u5206\u533a"},{"location":"5/#partitioning-rules-of-thumb","text":"\u5bf9\u4e8e\u5927\u578b\u8868\u683c\uff0c\u5982\u4e8b\u5b9e\u8868\uff0c\u76ee\u6807\u662f\u5728\u96c6\u7fa4\u4e2d\u62e5\u6709\u6838\u5fc3\u6570\u91cf\u7684 tablets \u3002 \u5bf9\u4e8e\u5c0f\u578b\u8868\u683c\uff08\u5982\u7ef4\u5ea6\u8868\uff09\uff0c\u76ee\u6807\u662f\u8db3\u591f\u6570\u91cf\u7684 tablets \uff0c\u6bcf\u4e2a tablets \u7684\u5927\u5c0f\u81f3\u5c11\u4e3a 1 GB \u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u8bf7\u6ce8\u610f\uff0c\u5728\u5f53\u524d\u7684\u5b9e\u73b0\u4e2d\uff0c tablets \u7684\u6570\u91cf\u9650\u5236\u4e86\u8bfb\u53d6\u7684\u5e76\u884c\u6027\u3002\u589e\u52a0 tablets \u6570\u91cf\u8d85\u8fc7\u6838\u5fc3\u6570\u91cf\u53ef\u80fd\u4f1a\u6709\u51cf\u5c11\u7684\u56de\u62a5\u3002","title":"Partitioning Rules of Thumb ( \u62c7\u6307\u5206\u533a\u89c4\u5219\u00a0)"},{"location":"5/#kudu","text":"Impala \u5141\u8bb8\u60a8\u4f7f\u7528\u6807\u51c6 SQL \u8bed\u53e5\u5c06\u6570\u636e\u63d2\u5165 Kudu \u3002","title":"\u5c06\u6570\u636e\u63d2\u5165 Kudu \u8868"},{"location":"5/#_6","text":"\u6b64\u793a\u4f8b\u63d2\u5165\u5355\u4e2a\u884c\u3002 INSERT INTO my_first_table VALUES (99, \"sarah\"); \u6b64\u793a\u4f8b\u4f7f\u7528\u5355\u4e2a\u8bed\u53e5\u63d2\u5165\u4e09\u884c\u3002 INSERT INTO my_first_table VALUES (1, \"john\"), (2, \"jane\"), (3, \"jim\");","title":"\u63d2\u5165\u5355\u4e2a\u503c"},{"location":"5/#_7","text":"\u6279\u91cf\u63d2\u5165\u65f6\uff0c\u81f3\u5c11\u6709\u4e09\u79cd\u5e38\u7528\u9009\u62e9\u3002\u6bcf\u4e2a\u53ef\u80fd\u6709\u4f18\u70b9\u548c\u7f3a\u70b9\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u60a8\u7684\u6570\u636e\u548c\u60c5\u51b5\u3002 Multiple single INSERT statements ( \u591a\u4e2a\u5355\u72ec\u7684 INSERT \u8bed\u53e5 ) \u8fd9\u79cd\u65b9\u6cd5\u5177\u6709\u6613\u4e8e\u7406\u89e3\u548c\u5b9e\u73b0\u7684\u4f18\u70b9\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u662f\u4f4e\u6548\u7684\uff0c\u56e0\u4e3a Impala \u4e0e Kudu \u7684\u63d2\u5165\u6027\u80fd\u76f8\u6bd4\u5177\u6709\u5f88\u9ad8\u7684\u67e5\u8be2\u542f\u52a8\u6210\u672c\u3002\u8fd9\u5c06\u5bfc\u81f4\u76f8\u5bf9\u8f83\u9ad8\u7684\u5ef6\u8fdf\u548c\u8f83\u5dee\u7684\u541e\u5410\u91cf\u3002 Single INSERT statement with multiple VALUES ( \u5177\u6709\u591a\u4e2a VALUES \u7684\u5355\u4e2a INSERT \u8bed\u53e5 ) \u5982\u679c\u5305\u542b\u8d85\u8fc7 1024 \u4e2a VALUES \u8bed\u53e5\uff0c\u5219\u5728\u5c06\u8bf7\u6c42\u53d1\u9001\u5230 Kudu \u4e4b\u524d\uff0c Impala \u5c06\u5176\u5206\u7ec4\u4e3a 1024 \uff08\u6216 batch_size \u7684\u503c\uff09\u3002\u901a\u8fc7\u5728 Impala \u65b9\u9762\u644a\u9500\u67e5\u8be2\u542f\u52a8\u5904\u7f5a\uff0c\u6b64\u65b9\u6cd5\u53ef\u80fd\u4f1a\u6267\u884c\u6bd4\u591a\u4e2a\u987a\u5e8f INSERT \u8bed\u53e5\u7565\u597d\u3002\u8981\u8bbe\u7f6e\u5f53\u524d Impala Shell \u4f1a\u8bdd\u7684\u6279\u91cf\u5927\u5c0f\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u8bed\u6cd5\uff1a set batch_size = 10000; \u6ce8\u610f \u589e\u52a0 Impala \u6279\u91cf\u5927\u5c0f\u4f1a\u5bfc\u81f4 Impala \u4f7f\u7528\u66f4\u591a\u7684\u5185\u5b58\u3002\u60a8\u5e94\u8be5\u9a8c\u8bc1\u5bf9\u7fa4\u96c6\u7684\u5f71\u54cd\u5e76\u8fdb\u884c\u76f8\u5e94\u8c03\u6574\u3002 Batch Insert ( \u6279\u91cf\u63d2\u5165 ) \u4ece Impala \u548c Kudu \u7684\u89d2\u5ea6\u6765\u770b\uff0c\u901a\u5e38\u8868\u73b0\u6700\u597d\u7684\u65b9\u6cd5\u901a\u5e38\u662f\u4f7f\u7528 Impala \u4e2d\u7684 SELECT FROM \u8bed\u53e5\u5bfc\u5165\u6570\u636e\u3002 \u5982\u679c\u60a8\u7684\u6570\u636e\u5c1a\u672a\u5728 Impala \u4e2d\uff0c\u5219\u4e00\u79cd\u7b56\u7565\u662f \u4ece\u6587\u672c\u6587\u4ef6 \uff08\u5982 TSV \u6216 CSV \u6587\u4ef6\uff09\u5bfc\u5165\u3002 \u521b\u5efa Kudu \u8868 \uff0c\u6ce8\u610f\u6307\u5b9a\u4e3a\u4e3b\u952e\u7684\u5217\u4e0d\u80fd\u4e3a\u7a7a\u503c\u3002 \u901a\u8fc7\u67e5\u8be2\u5305\u542b\u539f\u59cb\u6570\u636e\u7684\u8868\u5c06\u503c\u63d2\u5165\u5230 Kudu \u8868\u4e2d\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff1a INSERT INTO my_kudu_table SELECT * FROM legacy_data_import_table; Ingest using the C++ or Java API ( \u91c7\u7528C ++ \u6216 Java API ) \u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u9002\u5f53\u7684\u6444\u53d6\u8def\u5f84\u662f\u4f7f\u7528 C ++ \u6216 Java API \u76f4\u63a5\u63d2\u5165\u5230 Kudu \u8868\u4e2d\u3002\u4e0e\u5176\u4ed6 Impala \u8868\u4e0d\u540c\uff0c\u901a\u8fc7 API \u63d2\u5165\u5230 Kudu \u8868\u4e2d\u7684\u6570\u636e\u53ef\u7528\u4e8e Impala \u4e2d\u7684\u67e5\u8be2\uff0c\u800c\u4e0d\u9700\u8981\u4efb\u4f55 INVALIDATE METADATA \u8bed\u53e5\u6216\u5176\u4ed6 Impala \u5b58\u50a8\u7c7b\u578b\u6240\u9700\u7684\u5176\u4ed6\u8bed\u53e5\u3002","title":"\u6279\u91cf\u63d2\u5165"},{"location":"5/#insert-and-primary-key-uniqueness-violations","text":"\u5728\u5927\u591a\u6570\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u5982\u679c\u60a8\u5c1d\u8bd5\u63d2\u5165\u5df2\u63d2\u5165\u7684\u884c\uff0c\u5219\u63d2\u5165\u5c06\u5931\u8d25\uff0c\u56e0\u4e3a\u4e3b\u952e\u5c06\u88ab\u91cd\u590d\u3002\u8bf7\u53c2\u9605 INSERT \uff0c UPDATE \u548c DELETE \u64cd\u4f5c \u4e2d\u7684\u6545\u969c\u3002\u7136\u800c\uff0c Impala \u4e0d\u4f1a\u5931\u8d25\u67e5\u8be2\u3002\u76f8\u53cd\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u8b66\u544a\uff0c\u4f46\u662f\u7ee7\u7eed\u6267\u884c insert \u8bed\u53e5\u7684\u5176\u4f59\u90e8\u5206\u3002 \u5982\u679c\u63d2\u5165\u7684\u884c\u610f\u56fe\u66ff\u6362\u73b0\u6709\u884c\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 UPSERT \u800c\u4e0d\u662f INSERT \u3002 INSERT INTO my_first_table VALUES (99, \"sarah\"); UPSERT INTO my_first_table VALUES (99, \"zoe\"); -- the current value of the row is 'zoe'","title":"INSERT\u00a0and Primary Key Uniqueness Violations\u00a0( \u63d2\u5165\u548c\u4e3b\u952e\u552f\u4e00\u6027\u8fdd\u89c4 )"},{"location":"5/#_8","text":"UPDATE my_first_table SET name=\"bob\" where id = 3; \u6ce8\u610f \u5f53\u76ee\u6807\u8868\u5728 Kudu \u65f6\uff0c UPDATE \u8bed\u53e5\u4ec5\u9002\u7528\u4e8e Impala \u3002","title":"\u66f4\u65b0\u884c"},{"location":"5/#_9","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528\u6279\u91cf\u63d2\u5165\u4e2d\u76f8\u540c\u7684\u65b9\u6cd5 \u6279\u91cf\u66f4\u65b0 \u3002 UPDATE my_first_table SET name=\"bob\" where age > 10;","title":"\u6279\u91cf\u66f4\u65b0"},{"location":"5/#_10","text":"DELETE FROM my_first_table WHERE id < 3; \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u66f4\u590d\u6742\u7684\u8bed\u6cd5\u8fdb\u884c\u5220\u9664\u3002 FROM \u5b50\u53e5\u4e2d\u7684\u9017\u53f7\u662f Impala \u6307\u5b9a\u8fde\u63a5\u67e5\u8be2\u7684\u4e00\u79cd\u65b9\u6cd5\u3002\u6709\u5173 Impala \u8fde\u63a5\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 DELETE c FROM my_second_table c, stock_symbols s WHERE c.name = s.symbol; \u6ce8\u610f \u5f53\u76ee\u6807\u8868\u5728 Kudu \u65f6\uff0c DELETE \u8bed\u53e5\u4ec5\u9002\u7528\u4e8e Impala \u3002","title":"\u5220\u9664\u884c"},{"location":"5/#_11","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528 \u201c\u63d2\u5165\u6279\u91cf\u201d \u4e2d\u6982\u8ff0\u7684\u76f8\u540c\u65b9\u6cd5 \u6279\u91cf\u5220\u9664 \u3002 DELETE FROM my_first_table WHERE id < 3;","title":"\u6279\u91cf\u5220\u9664"},{"location":"5/#insertupdate-delete","text":"INSERT \uff0c UPDATE \u548c DELETE \u8bed\u53e5\u4e0d\u80fd\u88ab\u89c6\u4e3a\u6574\u4f53\u4e8b\u52a1\u3002\u5982\u679c\u8fd9\u4e9b\u64cd\u4f5c\u4e2d\u7684\u4e00\u4e2a\u65e0\u6cd5\u90e8\u5206\u901a\u8fc7\uff0c\u5219\u53ef\u80fd\u5df2\u7ecf\u521b\u5efa\u4e86\u5bc6\u94a5\uff08\u5728 INSERT \u7684\u60c5\u51b5\u4e0b\uff09\uff0c\u6216\u8005\u8bb0\u5f55\u53ef\u80fd\u5df2\u88ab\u5176\u4ed6\u8fdb\u7a0b\u4fee\u6539\u6216\u5220\u9664\uff08\u5728 UPDATE \u6216 DELETE \u7684\u60c5\u51b5\u4e0b\uff09\u3002\u60a8\u5e94\u8be5\u8bbe\u8ba1\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u3002","title":"INSERT\uff0cUPDATE \u548c DELETE \u64cd\u4f5c\u671f\u95f4\u7684\u6545\u969c"},{"location":"5/#_12","text":"\u60a8\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539\u8868\u7684\u5c5e\u6027\u6765\u66f4\u6539 Impala \u4e0e\u7ed9\u5b9a Kudu \u8868\u76f8\u5173\u7684\u5143\u6570\u636e\u3002\u8fd9\u4e9b\u5c5e\u6027\u5305\u62ec\u8868\u540d\uff0c Kudu \u4e3b\u5730\u5740\u5217\u8868\uff0c\u4ee5\u53ca\u8868\u662f\u5426\u7531 Impala \uff08\u5185\u90e8\uff09\u6216\u5916\u90e8\u7ba1\u7406\u3002 Rename an Impala Mapping Table ( \u91cd\u547d\u540d Impala \u6620\u5c04\u8868 ) ALTER TABLE my_table RENAME TO my_new_table; \u6ce8\u610f \u4f7f\u7528 ALTER TABLE ... RENAME \u8bed\u53e5\u91cd\u547d\u540d\u8868\u4ec5\u91cd\u547d\u540d Impala \u6620\u5c04\u8868\uff0c\u65e0\u8bba\u8be5\u8868\u662f\u5185\u90e8\u8fd8\u662f\u5916\u90e8\u8868\u3002\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u53ef\u80fd\u8bbf\u95ee\u57fa\u7840\u7684 Kudu \u8868\u7684\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u4e2d\u65ad\u3002 Rename the underlying Kudu table for an internal table ( \u91cd\u65b0\u547d\u540d\u5185\u90e8\u8868\u7684\u57fa\u7840 Kudu \u8868 ) \u5982\u679c\u8868\u662f\u5185\u90e8\u8868\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539 kudu.table_name \u5c5e\u6027\u91cd\u547d\u540d\u5e95\u5c42\u7684 Kudu \u8868\uff1a ALTER TABLE my_internal_table SET TBLPROPERTIES('kudu.table_name' = 'new_name') Remapping an external table to a different Kudu table ( \u5c06\u5916\u90e8\u8868\u91cd\u65b0\u6620\u5c04\u5230\u4e0d\u540c\u7684 Kudu \u8868 ) \u5982\u679c\u53e6\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5728 Impala \u4e0b\u91cd\u547d\u540d\u4e86 Kudu \u8868\uff0c\u5219\u53ef\u4ee5\u91cd\u65b0\u6620\u5c04\u5916\u90e8\u8868\u4ee5\u6307\u5411\u4e0d\u540c\u7684 Kudu \u8868\u540d\u79f0\u3002 ALTER TABLE my_external_table_ SET TBLPROPERTIES('kudu.table_name' = 'some_other_kudu_table') Change the Kudu Master Address ( \u66f4\u6539 Kudu Master \u5730\u5740 ) ALTER TABLE my_table SET TBLPROPERTIES('kudu.master_addresses' = 'kudu-new-master.example.com:7051'); Change an Internally-Managed Table to External ( \u5c06\u5185\u90e8\u7ba1\u7406\u7684\u8868\u66f4\u6539\u4e3a\u5916\u90e8 ) ALTER TABLE my_table SET TBLPROPERTIES('EXTERNAL' = 'TRUE');","title":"\u66f4\u6539\u8868\u5c5e\u6027"},{"location":"5/#impala-kudu_3","text":"\u5982\u679c\u8868\u662f\u4f7f\u7528 Impala \u4e2d\u7684\u5185\u90e8\u8868\u521b\u5efa\u7684\uff0c\u5219\u4f7f\u7528 CREATE TABLE \uff0c\u6807\u51c6 DROP TABLE \u8bed\u6cd5\u4f1a\u5220\u9664\u5e95\u5c42\u7684 Kudu \u8868\u53ca\u5176\u6240\u6709\u6570\u636e\u3002\u5982\u679c\u8868\u88ab\u521b\u5efa\u4e3a\u4e00\u4e2a\u5916\u90e8\u8868\uff0c\u4f7f\u7528 CREATE EXTERNAL TABLE\uff0cImpala \u548c Kudu \u4e4b\u95f4\u7684\u6620\u5c04\u88ab\u5220\u9664\uff0c\u4f46 Kudu \u8868\u4fdd\u6301\u539f\u6837\uff0c\u5e76\u5305\u542b\u5176\u6240\u6709\u6570\u636e\u3002 DROP TABLE my_first_table;","title":"\u4f7f\u7528 Impala \u5220\u9664 Kudu \u8868"},{"location":"5/#_13","text":"\u4e0a\u9762\u7684\u4f8b\u5b50\u53ea\u662f\u63a2\u7d22\u4e86 Impala Shell \u6240\u80fd\u505a\u7684\u4e00\u5c0f\u90e8\u5206\u3002 \u4e86\u89e3 Impala \u9879\u76ee \u9605\u8bfb Impala \u6587\u6863 \u67e5\u770b Impala SQL \u53c2\u8003 \u9605\u8bfb Impala \u5185\u90e8\u90e8\u5206\u6216\u4e86\u89e3\u5982\u4f55\u5728 Impala Wiki \u4e0a\u4e3a Impala \u505a\u51fa\u8d21\u732e\u3002 \u9605\u8bfb\u539f\u751f\u7684 Kudu API \u3002","title":"\u4e0b\u4e00\u6b65\u505a\u4ec0\u4e48\uff1f"},{"location":"5/#_14","text":"\u5728\u4f7f\u7528 Impala \u4e2d\u7684\u5916\u90e8\u8868\u683c\u65f6\uff0c\u5fc5\u987b\u4e3a\u5177\u6709\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u540d\u79f0\u7684 Kudu \u8868\u5206\u914d\u5907\u7528\u540d\u79f0\u3002 \u5177\u6709\u5305\u542b\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u5217\u540d\u79f0\u7684 Kudu \u8868\u53ef\u80fd\u4e0d\u4f1a\u7528\u4f5c Impala \u4e2d\u7684\u5916\u90e8\u8868\u3002\u4e13\u680f\u53ef\u80fd\u5728 Kudu \u66f4\u540d\u4e3a\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 \u521b\u5efa Kudu \u8868\u65f6\uff0c CREATE TABLE \u8bed\u53e5\u5fc5\u987b\u5728\u4e3b\u952e\u987a\u5e8f\u4e2d\u5305\u542b\u5176\u4ed6\u5217\u4e4b\u95f4\u7684\u4e3b\u952e\u5217\u3002 \u5305\u542b UNIXTIME_MICROS \u7c7b\u578b\u5217\u7684\u5e93\u675c\u8868\u53ef\u80fd\u4e0d\u4f1a\u7528\u4f5c Impala \u4e2d\u7684\u5916\u90e8\u8868\u3002 Impala \u4e0d\u80fd\u4f7f\u7528 TIMESTAMP \uff0c DECIMAL \uff0c VARCHAR \u6216\u5d4c\u5957\u7c7b\u578b\u7684\u5217\u521b\u5efa Kudu \u8868\u3002 Impala \u65e0\u6cd5\u66f4\u65b0\u4e3b\u952e\u5217\u4e2d\u7684\u503c\u3002 NULL \uff0c NOT NULL \uff0c != \u548c LIKE \u8c13\u8bcd\u4e0d\u4f1a\u88ab\u63a8\u9001\u5230 Kudu \uff0c\u800c\u662f\u4f1a\u88ab Impala \u626b\u63cf\u8282\u70b9\u8bc4\u4f30\u3002\u8fd9\u53ef\u80fd\u4f1a\u964d\u4f4e\u76f8\u5bf9\u4e8e\u5176\u4ed6\u7c7b\u578b\u8c13\u8bcd\u7684\u6027\u80fd\u3002 \u901a\u8fc7 Impala \u7684\u66f4\u65b0\uff0c\u63d2\u5165\u548c\u5220\u9664\u662f\u975e\u4e8b\u52a1\u6027\u7684\u3002\u5982\u679c\u67e5\u8be2\u5931\u8d25\u7684\u4e00\u90e8\u5206\u9014\u5f84\uff0c\u5176\u90e8\u5206\u6548\u679c\u5c06\u4e0d\u4f1a\u56de\u6eda\u3002 \u5355\u4e2a\u67e5\u8be2\u7684\u6700\u5927\u5e76\u884c\u5ea6\u4ec5\u9650\u4e8e\u8868\u4e2d\u7684 tablets \u6570\u91cf\u3002\u4e3a\u4e86\u83b7\u5f97\u826f\u597d\u7684\u5206\u6790\u6027\u80fd\uff0c\u9488\u5bf9\u6bcf\u4e2a\u4e3b\u673a10\u4e2a\u6216\u66f4\u591a\u4e2a tablets \u6216\u4f7f\u7528\u5927\u578b\u8868\u3002","title":"\u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236"},{"location":"6/","text":"\u7ba1\u7406 Kudu \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/administration.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813623 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Apache Kudu Administration ( \u7ba1\u7406 Apache Kudu ) \u6ce8\u610f Kudu \u4e0e Cloudera Manager \u76f8\u6bd4\u5728\u72ec\u7acb\u5b89\u88c5\u4e2d\u66f4\u5bb9\u6613\u7ba1\u7406\u3002 \u6709\u5173\u4f7f\u7528 Kudu \u4e0e Cloudera Manager \u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Cloudera Kudu \u6587\u6863 \u3002 \u542f\u52a8\u548c\u505c\u6b62 Kudu \u8fdb\u7a0b \u91cd\u8981 \u4ec5\u5f53\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u5305\uff08\u4f8b\u5982 rpm \u6216 deb \uff09\u5b89\u88c5 Kudu \u65f6\uff0c\u8fd9\u4e9b\u8bf4\u660e\u624d\u662f\u76f8\u5173\u7684\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8 Kudu \u670d\u52a1\uff1a $ sudo service kudu-master start $ sudo service kudu-tserver start \u8981\u505c\u6b62 Kudu \u670d\u52a1\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a $ sudo service kudu-master stop $ sudo service kudu-tserver stop Kudu Web \u754c\u9762 Kudu tablet servers \u548c masters \u5728\u5185\u7f6e\u7684 Web \u754c\u9762\u4e0a\u663e\u793a\u6709\u7528\u7684\u64cd\u4f5c\u4fe1\u606f\uff0c Kudu Master Web Interface Kudu \u4e3b\u8fdb\u7a0b\u5728 8051 \u7aef\u53e3\u4e0a\u4e3a\u5176 Web \u754c\u9762\u63d0\u4f9b\u670d\u52a1\u3002\u8be5\u754c\u9762\u66b4\u9732\u4e86\u51e0\u4e2a\u9875\u9762\uff0c\u5176\u4e2d\u5305\u542b\u6709\u5173\u7fa4\u96c6\u72b6\u6001\u7684\u4fe1\u606f\uff1a tablet servers \u5217\u8868\uff0c\u5176 host names \u548c\u4e0a\u6b21\u5fc3\u8df3\u65f6\u95f4\u3002 \u8868\u683c\u5217\u8868\uff0c\u5305\u62ec\u6bcf\u4e2a\u8868\u7684 schema \u548c tablet location information \u4fe1\u606f\u3002 \u60a8\u53ef\u4ee5\u5c06\u5176\u7c98\u8d34\u5230 Impala Shell \u4e2d\u4ee5\u5c06\u73b0\u6709\u8868\u6dfb\u52a0\u5230 Impala \u7684\u5df2\u77e5\u6570\u636e\u6e90\u5217\u8868\u4e2d\u7684 SQL \u4ee3\u7801\u3002 Kudu Tablets Server Web \u754c\u9762 \u6bcf\u4e2a tablet server \u90fd\u63d0\u4f9b\u7aef\u53e3 8050 \u4e0a\u7684 Web \u754c\u9762\u3002\u8be5\u754c\u9762\u663e\u793a\u6709\u5173\u670d\u52a1\u5668\u4e0a\u6258\u7ba1\u7684\u6bcf\u4e2a tablet \u7684\u4fe1\u606f\uff0c\u5176\u5f53\u524d\u72b6\u6001\u4ee5\u53ca\u6709\u5173\u7ef4\u62a4\u540e\u53f0\u64cd\u4f5c\u7684\u8c03\u8bd5\u4fe1\u606f\u3002 \u5e38\u89c1\u7684 Web \u754c\u9762\u9875\u9762 Kudu masters \u548c tablet servers \u901a\u8fc7\u5176 Web \u754c\u9762\u66b4\u9732\u4e86\u4e00\u7ec4\u901a\u7528\u7684\u4fe1\u606f\uff1a HTTP \u8bbf\u95ee\u670d\u52a1\u5668\u65e5\u5fd7\u3002 \u4e00\u4e2a /rpcz \u7aef\u70b9\uff0c\u901a\u8fc7 JSON \u5217\u51fa\u5f53\u524d\u8fd0\u884c\u7684 RPC \u3002 \u9875\u9762\u63d0\u4f9b\u4e86\u6709\u5173\u8fdb\u7a0b\u4e0d\u540c\u7ec4\u4ef6\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u7684\u6982\u8ff0\u548c\u8be6\u7ec6\u4fe1\u606f\u3002 \u5173\u4e8e\u5f53\u524d\u914d\u7f6e\u6807\u5fd7\u7684\u4fe1\u606f\u3002 \u5173\u4e8e\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u53ca\u5176\u8d44\u6e90\u6d88\u8017\u7684\u4fe1\u606f\u3002 \u4e00\u4e2a JSON \u7aef\u70b9\u663e\u793a\u6709\u5173\u670d\u52a1\u5668\u7684\u6307\u6807\u3002 \u6709\u5173\u5b88\u62a4\u7a0b\u5e8f\u90e8\u7f72\u7248\u672c\u53f7\u7684\u4fe1\u606f\u3002 \u8fd9\u4e9b\u754c\u9762\u662f\u4ece\u6bcf\u4e2a\u5b88\u62a4\u8fdb\u7a0b\u7684 Web UI \u7684 landing page \u94fe\u63a5\u7684\u3002 Kudu Metrics ( \u6307\u6807 ) Kudu \u5b88\u62a4\u8fdb\u7a0b\u516c\u5f00\u4e86\u5927\u91cf\u7684\u6307\u6807\u3002\u4e00\u4e9b\u6307\u6807\u4e0e\u6574\u4e2a\u670d\u52a1\u5668\u8fdb\u7a0b\u76f8\u5173\u8054\uff0c\u800c\u5176\u4ed6\u6307\u6807\u4e0e\u7279\u5b9a tablet \u526f\u672c\u76f8\u5173\u8054\u3002 \u5217\u51fa\u53ef\u7528\u7684\u6307\u6807 Kudu \u670d\u52a1\u5668\u7684\u5168\u5957\u53ef\u7528\u5ea6\u91cf\u503c\u53ef\u4ee5\u901a\u8fc7\u7279\u6b8a\u7684\u547d\u4ee4\u884c\u6807\u5fd7\u8fdb\u884c\u8f6c\u50a8\uff1a $ kudu-tserver --dump_metrics_json $ kudu-master --dump_metrics_json \u8fd9\u5c06\u8f93\u51fa\u4e00\u4e2a\u5927\u7684 JSON \u6587\u6863\u3002\u6bcf\u4e2a\u6307\u6807\u90fd\u8868\u793a\u5176\u540d\u79f0\uff0c\u6807\u7b7e\uff0c\u63cf\u8ff0\uff0c\u5355\u4f4d\u548c\u7c7b\u578b\u3002\u7531\u4e8e\u8f93\u51fa\u662f JSON \u683c\u5f0f\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u8f7b\u677e\u5730\u5c06\u8fd9\u4e9b\u4fe1\u606f\u8fdb\u884c\u89e3\u6790\uff0c\u5e76\u5c06\u5176\u9988\u9001\u5230\u4ece Kudu \u670d\u52a1\u5668\u6536\u96c6\u6307\u6807\u7684\u5176\u4ed6\u5de5\u5177\u4e2d\u3002 \u901a\u8fc7HTTP\u6536\u96c6\u6307\u6807 \u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee/\u6307\u6807\u901a\u8fc7\u5176 HTTP \u63a5\u53e3\u4ece\u670d\u52a1\u5668\u8fdb\u7a0b\u6536\u96c6\u5ea6\u91cf\u3002\u6b64\u9875\u9762\u7684\u8f93\u51fa\u662f JSON \uff0c\u53ef\u4ee5\u901a\u8fc7\u76d1\u89c6\u670d\u52a1\u8f7b\u677e\u89e3\u6790\u3002\u6b64\u7aef\u70b9\u5728\u5176\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u63a5\u53d7\u51e0\u4e2a GET \u53c2\u6570\uff1a /metrics?metrics=<substring1>,<substring2>,\u2026 - \u5c06\u8fd4\u56de\u7684\u6307\u6807\u9650\u5236\u4e3a\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u63d0\u4f9b\u7684\u5b50\u5b57\u7b26\u4e32\u7684\u6307\u6807\u3002\u5b50\u4e32\u4e5f\u5339\u914d\u5b9e\u4f53\u540d\u79f0\uff0c\u56e0\u6b64\u53ef\u7528\u4e8e\u6536\u96c6\u7279\u5b9a tablet \u7684\u6307\u6807\u3002 /metrics?include_schema=1 - \u5305\u62ec JSON \u8f93\u51fa\u4e2d\u7684\u5ea6\u91cf\u67b6\u6784\u4fe1\u606f\uff0c\u5982\u5355\u4f4d\uff0c\u63cf\u8ff0\u548c\u6807\u7b7e\u3002\u901a\u5e38\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u8282\u7701\u7a7a\u95f4\u3002 /metrics?compact=1 - \u4ece\u7ed3\u679c JSON \u4e2d\u6d88\u9664\u4e0d\u5fc5\u8981\u7684\u7a7a\u683c\uff0c\u4ece\u8fdc\u7a0b\u4e3b\u673a\u83b7\u53d6\u6b64\u9875\u9762\u65f6\u53ef\u4ee5\u51cf\u5c11\u5e26\u5bbd\u3002 /metrics?include_raw_histograms=1 - \u5305\u62ec\u76f4\u65b9\u56fe\u6307\u6807\u7684\u539f\u59cb\u5b58\u50a8\u6876\u548c\u503c\uff0c\u53ef\u5b9e\u73b0\u968f\u65f6\u95f4\u548c\u8de8\u4e3b\u673a\u7684\u767e\u5206\u4f4d\u6570\u5ea6\u91cf\u7684\u51c6\u786e\u805a\u5408\u3002 \u4f8b\u5982\uff1a $ curl -s 'http://example-ts:8050/metrics?include_schema=1&metrics=connections_accepted' [ { \"type\": \"server\", \"id\": \"kudu.tabletserver\", \"attributes\": {}, \"metrics\": [ { \"name\": \"rpc_connections_accepted\", \"label\": \"RPC Connections Accepted\", \"type\": \"counter\", \"unit\": \"connections\", \"description\": \"Number of incoming TCP connections made to the RPC server\", \"value\": 92 } ] } ] $ curl -s 'http://example-ts:8050/metrics?metrics=log_append_latency' [ { \"type\": \"tablet\", \"id\": \"c0ebf9fef1b847e2a83c7bd35c2056b1\", \"attributes\": { \"table_name\": \"lineitem\", \"partition\": \"hash buckets: (55), range: [(<start>), (<end>))\", \"table_id\": \"\" }, \"metrics\": [ { \"name\": \"log_append_latency\", \"total_count\": 7498, \"min\": 4, \"mean\": 69.3649, \"percentile_75\": 29, \"percentile_95\": 38, \"percentile_99\": 45, \"percentile_99_9\": 95, \"percentile_99_99\": 167, \"max\": 367244, \"total_sum\": 520098 } ] } ] \u6ce8\u610f \u6240\u6709\u76f4\u65b9\u56fe\u548c\u8ba1\u6570\u5668\u90fd\u662f\u4ece\u670d\u52a1\u5668\u5f00\u59cb\u65f6\u95f4\u5f00\u59cb\u6d4b\u91cf\u7684\uff0c\u6536\u96c6\u540e\u4e0d\u4f1a\u91cd\u7f6e\u3002 \u6536\u96c6\u6307\u6807\u5230\u65e5\u5fd7 Kudu \u53ef\u4ee5\u914d\u7f6e\u4e3a\u4f7f\u7528 --metrics_log_interval_ms \u6807\u5fd7\u5c06\u5176\u6240\u6709\u5ea6\u91cf\u503c\u5b9a\u671f\u8f6c\u50a8\u5230\u672c\u5730\u65e5\u5fd7\u6587\u4ef6\u3002\u5c06\u6b64\u6807\u5fd7\u8bbe\u7f6e\u4e3a\u5c06\u5ea6\u91cf\u503c\u5199\u5165\u65e5\u5fd7\u6587\u4ef6\u7684\u65f6\u95f4\u95f4\u9694\u3002 \u5ea6\u91cf\u65e5\u5fd7\u5c06\u4e0e\u5176\u4ed6 Kudu \u65e5\u5fd7\u6587\u4ef6\u4e00\u6837\u5199\u5165\u4e0e\u5176\u76f8\u540c\u7684\u76ee\u5f55\uff0c\u5177\u6709\u76f8\u540c\u7684\u547d\u540d\u683c\u5f0f\u3002\u4efb\u4f55\u6307\u6807\u65e5\u5fd7\u6587\u4ef6\u8fbe\u5230 64MB \u672a\u538b\u7f29\u540e\uff0c\u65e5\u5fd7\u5c06\u88ab\u6eda\u52a8\uff0c\u4e0a\u4e00\u4e2a\u6587\u4ef6\u5c06\u88ab gzip \u538b\u7f29\u3002 \u751f\u6210\u7684\u65e5\u5fd7\u6587\u4ef6\u6709\u4e09\u4e2a\u7a7a\u683c\u5206\u9694\u7684\u5b57\u6bb5\u3002\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u662f\u5355\u8bcd\u6307\u6807\u3002\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u662f\u81ea Unix \u7eaa\u5143\u4ee5\u6765\u7684\u5fae\u79d2\u7684\u5f53\u524d\u65f6\u95f4\u6233\u3002\u7b2c\u4e09\u4e2a\u662f\u4f7f\u7528\u7d27\u51d1\u7684 JSON \u7f16\u7801\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6240\u6709\u6307\u6807\u7684\u5f53\u524d\u503c\u3002\u7f16\u7801\u4e0e\u901a\u8fc7\u4e0a\u8ff0 HTTP \u83b7\u53d6\u7684\u6307\u6807\u76f8\u540c\u3002 \u6ce8\u610f \u867d\u7136\u5ea6\u91cf\u8bb0\u5f55\u81ea\u52a8\u6eda\u52a8\u5e76\u538b\u7f29\u4ee5\u524d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f46\u5b83\u4e0d\u4f1a\u5220\u9664\u65e7\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\u7531\u4e8e\u5ea6\u91cf\u8bb0\u5f55\u53ef\u4ee5\u4f7f\u7528\u5927\u91cf\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u56e0\u6b64\u8bf7\u8003\u8651\u8bbe\u7f6e\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u6765\u76d1\u89c6\u65e5\u5fd7\u76ee\u5f55\u4e2d\u7684\u7a7a\u95f4\u5e76\u5f52\u6863\u6216\u5220\u9664\u65e7\u6bb5\u3002 \u5e38\u89c1\u7684 Kudu \u5de5\u4f5c\u6d41\u7a0b \u8fc1\u79fb\u5230\u591a\u4e2a Kudu Master \u4e3a\u4e86\u83b7\u5f97\u9ad8\u53ef\u7528\u6027\u5e76\u907f\u514d\u51fa\u73b0\u5355\u70b9\u6545\u969c\uff0c Kudu \u96c6\u7fa4\u5e94\u8be5\u7531\u591a\u4e2a\u4e3b\u4eba\u521b\u5efa\u3002\u8bb8\u591a Kudu \u96c6\u7fa4\u662f\u7531\u4e00\u4e2a\u5355\u4e00\u7684\u4e3b\u4eba\u521b\u5efa\u7684\uff0c\u65e0\u8bba\u662f\u7b80\u5355\u7684\u8fd8\u662f\u7531\u4e8e Kudu \u591a\u4e3b\u4eba\u7684\u652f\u6301\u5728\u5f53\u65f6\u4ecd\u7136\u662f\u5b9e\u9a8c\u6027\u7684\u3002\u6b64\u5de5\u4f5c\u6d41\u6f14\u793a\u5982\u4f55\u8fc1\u79fb\u5230\u591a\u4e3b\u914d\u7f6e\u3002 \u6ce8\u610f \u5c06\u5de5\u4f5c\u6d41\u6dfb\u52a0\u5230\u73b0\u6709\u7684\u591a\u4e3b\u914d\u7f6e\u4e2d\u662f\u4e0d\u5b89\u5168\u7684\u3002\u4e0d\u8981\u4e3a\u6b64\u76ee\u7684\u4f7f\u7528\u5b83\u3002 \u6ce8\u610f \u8be5\u5de5\u4f5c\u6d41\u7a0b\u81f3\u5c11\u57fa\u672c\u4e0a\u719f\u6089 Kudu \u914d\u7f6e\u7ba1\u7406\u3002\u5982\u679c\u4f7f\u7528 Cloudera Manager\uff08CM\uff09 \uff0c\u5de5\u4f5c\u6d41\u7a0b\u4e5f\u9884\u5148\u5047\u5b9a\u5b83\u662f\u719f\u6089\u7684\u3002 \u6ce8\u610f \u4ee5\u4e0b\u6240\u6709\u547d\u4ee4\u884c\u6b65\u9aa4\u90fd\u5e94\u8be5\u50cf Kudu UNIX \u7528\u6237\u4e00\u822c\u6267\u884c\u3002 \u51c6\u5907\u8fc1\u79fb \u5efa\u7acb\u7ef4\u62a4\u7a97\u53e3\uff08\u4e00\u5c0f\u65f6\u5e94\u8be5\u8db3\u591f\uff09\u3002\u5728\u6b64\u671f\u95f4\uff0c Kudu \u96c6\u7fa4\u5c06\u4e0d\u53ef\u7528\u3002 \u51b3\u5b9a\u4f7f\u7528\u591a\u5c11 masters \u3002 masters \u7684\u6570\u91cf\u5e94\u8be5\u662f\u5947\u6570\u3002\u5efa\u8bae\u4f7f\u7528\u4e09\u6216\u4e94\u4e2a\u8282\u70b9\u4e3b\u914d\u7f6e;\u4ed6\u4eec\u53ef\u4ee5\u5bb9\u5fcd\u4e00\u4e24\u4e2a\u6545\u969c\u3002 \u5bf9\u73b0\u6709 master \u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u8bc6\u522b\u548c\u8bb0\u5f55\u4e3b\u6570\u636e\u6240\u5728\u7684\u76ee\u5f55\u3002\u5982\u679c\u4f7f\u7528 Kudu \u7cfb\u7edf\u8f6f\u4ef6\u5305\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3a /var/lib/kudu/master \uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 fs_wal_dir \u548c fs_data_dirs \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u81ea\u5b9a\u4e49\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u5c06 fs_data_dirs \u8bbe\u7f6e\u4e3a\u9664 fs_wal_dir \u503c\u4e4b\u5916\u7684\u67d0\u4e9b\u76ee\u5f55\uff0c\u5219\u5e94\u5c06\u5176\u660e\u786e\u5305\u542b\u5728\u5176\u4e2d\u8fd8\u5305\u542b fs_wal_dir \u7684\u6bcf\u4e2a\u547d\u4ee4\u4e2d\u3002 \u8bc6\u522b\u548c\u8bb0\u5f55 master \u6b63\u5728\u4e3a RPC \u4f7f\u7528\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u7aef\u53e3\u503c\u4e3a 7051 \uff0c\u4f46\u53ef\u80fd\u4f7f\u7528 rpc_bind_addresses \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u4e86\u81ea\u5b9a\u4e49\u3002 \u8bc6\u522b master \u7684 UUID \u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u5b83\uff1a $ kudu fs dump uuid --fs_wal_dir=&lt;master_data_dir&gt; 2&gt;/dev/null master_data_dir \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 \u4f8b\u5b50 $ kudu fs dump uuid --fs_wal_dir=/var/lib/kudu/master 2&gt;/dev/null 4aab798a69e94fab8d77069edff28ce0 \u53ef\u9009\uff1a\u914d\u7f6e master \u7684 DNS \u522b\u540d\u3002\u522b\u540d\u53ef\u80fd\u662f DNS cname \uff08\u5982\u679c\u673a\u5668\u5df2\u7ecf\u5728 DNS \u4e2d\u6709 A \u8bb0\u5f55\uff09\uff0c A \u8bb0\u5f55\uff08\u5982\u679c\u673a\u5668\u4ec5\u7531\u5176 IP \u5730\u5740\u77e5\u9053\uff09\u6216 /etc/hosts \u4e2d\u7684\u522b\u540d\u3002\u522b\u540d\u5e94\u8be5\u662f master \u7684\u62bd\u8c61\u8868\u793a\uff08\u4f8b\u5982\uff0c master - 1 \uff09\u3002 \u6ce8\u610f \u6ca1\u6709 DNS \u522b\u540d\uff0c\u4e0d\u53ef\u80fd\u4ece\u6c38\u4e45\u6027\u4e3b\u673a\u6545\u969c\u4e2d\u6062\u590d\uff0c\u56e0\u6b64\u5f3a\u70c8\u5efa\u8bae\u3002 \u4e3a\u6bcf\u4e2a\u65b0\u7684\u4e3b\u8bbe\u5907\u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u5728\u96c6\u7fa4\u4e2d\u9009\u62e9\u4e00\u4e2a\u672a\u4f7f\u7528\u7684\u673a\u5668\u3002\u4e3b\u673a\u751f\u6210\u7684\u8d1f\u8f7d\u5f88\u5c0f\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6570\u636e\u670d\u52a1\u6216\u8d1f\u8f7d\u751f\u6210\u8fc7\u7a0b\u5171\u540c\u914d\u7f6e\uff0c\u5c3d\u7ba1\u4e0e\u5176\u4ed6 Kudu \u4e3b\u673a\u4e0d\u540c\uff0c\u914d\u7f6e\u76f8\u540c\u3002 \u786e\u4fdd Kudu \u901a\u8fc7\u7cfb\u7edf\u5305\u88c5\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u5b89\u88c5 kudu \u548c kudu-master \u5305\u88c5\uff09\u6216\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u5b89\u88c5\u5728\u673a\u5668\u4e0a\u3002 \u9009\u62e9\u5e76\u8bb0\u5f55\u4e3b\u6570\u636e\u5c06\u5b58\u5728\u7684\u76ee\u5f55\u3002 \u9009\u62e9\u5e76\u8bb0\u5f55\u4e3b\u673a\u5e94\u7528\u4e8e RPC \u7684\u7aef\u53e3\u3002 \u53ef\u9009\uff1a\u914d\u7f6e\u4e3b\u670d\u52a1\u5668\u7684 DNS \u522b\u540d\uff08\u4f8b\u5982\uff0c master-2 \uff0c master-3 \u7b49\uff09\u3002 \u6267\u884c\u8fc1\u79fb \u505c\u6b62\u6574\u4e2a\u96c6\u7fa4\u4e2d\u7684\u6240\u6709 Kudu \u8fdb\u7a0b\u3002 \u683c\u5f0f\u5316\u6bcf\u4e2a\u65b0 master \u4e0a\u7684\u6570\u636e\u76ee\u5f55\uff0c\u5e76\u8bb0\u5f55\u751f\u6210\u7684 UUID \u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e8f\u5217\uff1a $ kudu fs format --fs_wal_dir=&lt;master_data_dir&gt; $ kudu fs dump uuid --fs_wal_dir=&lt;master_data_dir&gt; 2&gt;/dev/null master_data_dir \u65b0 master \u4ee5\u524d\u5f55\u5236\u7684\u6570\u636e\u76ee\u5f55\u3002 \u793a\u4f8b $ kudu fs format --fs_wal_dir=/var/lib/kudu/master $ kudu fs dump uuid --fs_wal_dir=/var/lib/kudu/master 2&gt;/dev/null f5624e05f40649b79a757629a69d061e \u5982\u679c\u4f7f\u7528 CM \uff0c\u73b0\u5728\u6dfb\u52a0\u65b0\u7684 Kudu master roles \uff0c\u4f46\u4e0d\u8981\u542f\u52a8\u5b83\u4eec\u3002 \u5982\u679c\u4f7f\u7528 DNS \u522b\u540d\uff0c\u8bf7\u4f7f\u7528\u8be5\u4e3b\u673a\u7684\u522b\u540d\u8986\u76d6\u6bcf\u4e2a\u89d2\u8272\uff08\u5305\u62ec\u73b0\u6709\u4e3b\u89d2\u8272\uff09\u7684 \u201cMaster Address\u201d \u53c2\u6570\u7684\u7a7a\u503c\u3002 \u5982\u679c\u4f7f\u7528\u975e\u9ed8\u8ba4 RPC \u7aef\u53e3\u503c\uff0c\u8bf7\u6dfb\u52a0\u7aef\u53e3\u53f7\uff08\u4ee5\u5192\u53f7\u5206\u9694\uff09\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u91cd\u5199 master \u7684 Raft \u914d\u7f6e\uff0c\u5728\u73b0\u6709\u4e3b\u673a\u4e0a\u6267\u884c\uff1a $ kudu local_replica cmeta rewrite_raft_config --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; &lt;all_masters&gt; master_data_dir \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 all_masters \u7a7a\u683c\u5206\u9694\u7684 master \u7684\u5217\u8868\uff0c\u65b0\u7684\u548c\u73b0\u5728\u7684\u3002\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u5fc5\u987b\u662f <uuid>\uff1a<hostname>\uff1a<port> \u683c\u5f0f\u7684\u5b57\u7b26\u4e32 UUID master \u4ee5\u524d\u8bb0\u5f55\u7684 UUID hostname master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u6216 \u522b\u540d port master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7684\u7aef\u53e3\u53f7 \u793a\u4f8b $ kudu local_replica cmeta rewrite_raft_config --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 4aab798a69e94fab8d77069edff28ce0:master-1:7051 f5624e05f40649b79a757629a69d061e:master-2:7051 988d8ac6530f426cbe180be5ba52033d:master-3:7051 \u4fee\u6539\u73b0\u6709 master \u548c\u65b0 masters \u7684 master_addresses \u914d\u7f6e\u53c2\u6570\u7684\u503c\u3002\u65b0\u503c\u5fc5\u987b\u662f\u6240\u6709\u4e3b\u8282\u70b9\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u6bcf\u4e2a\u6761\u76ee\u662f <hostname>\uff1a<port> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 hostname master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u548c \u522b\u540d port master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7aef\u53e3\u53f7 \u542f\u52a8\u73b0\u6709\u7684 master \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06 master \u6570\u636e\u590d\u5236\u5230\u6bcf\u4e2a\u65b0 master \uff0c\u5728\u6bcf\u53f0\u65b0 master \u4e0a\u6267\u884c\uff1a $ kudu local_replica copy_from_remote --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; &lt;existing_master&gt; master_data_dir \u65b0 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 existing_master \u73b0\u6709 master \u7684 RPC \u5730\u5740\u5fc5\u987b\u662f <hostname>\uff1a<port> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 hostname \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u6216\u522b\u540d port \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7aef\u53e3\u53f7 \u793a\u4f8b $ kudu local_replica copy_from_remote --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 master-1:7051 \u542f\u52a8\u6240\u6709\u7684\u65b0\u7684 master \u6ce8\u610f \u5982\u679c\u4f7f\u7528 CM \uff0c\u8bf7\u8df3\u8fc7\u4e0b\u4e00\u6b65\u3002 \u4fee\u6539\u6bcf\u4e2a tablet server \u7684 tserver_master_addrs \u914d\u7f6e\u53c2\u6570\u7684\u503c\u3002\u65b0\u503c\u5fc5\u987b\u662f\u4ee5\u9017\u53f7\u5206\u9694\u7684\u4e3b\u6587\u4ef6\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6761\u76ee\u662f <hostname> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 \uff1a <port> hostname master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u548c\u522b\u540d port master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7aef\u53e3\u53f7 \u542f\u52a8\u6240\u6709\u7684 tablet servers \u606d\u559c\uff0c\u96c6\u7fa4\u5df2\u7ecf\u8fc1\u79fb\u5230\u591a\u4e2a masters \u4e86\uff01\u8981\u9a8c\u8bc1\u6240\u6709 master \u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u8bf7\u8003\u8651\u6267\u884c\u4ee5\u4e0b\u5065\u5eb7\u6027\u68c0\u67e5\uff1a \u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u6bcf\u4e2a master \u7684 Web UI \u3002\u770b\u770b /master page \u3002\u6240\u6709\u7684 master \u90fd\u5e94\u8be5\u88ab\u5217\u5728\u90a3\u91cc\uff0c\u4e00\u4e2a\u4e3b\u4eba\u5728 LEADER \u89d2\u8272\uff0c\u5176\u4ed6\u7684\u5728 FOLLOWER \u89d2\u8272\u3002\u6bcf\u4e2a master \u7684 master \u7684\u5185\u5bb9\u5e94\u8be5\u662f\u4e00\u6837\u7684\u3002 \u4f7f\u7528 kudu \u547d\u4ee4\u884c\u5de5\u5177\u5728\u96c6\u7fa4\u4e0a\u8fd0\u884c Kudu \u7cfb\u7edf\u68c0\u67e5\uff08 ksck \uff09\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u4f7f\u7528 ksck \u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5 \u3002 \u5728\u591a Master \u90e8\u7f72\u4e2d\u4ece\u6b7b\u4ea1\u7684 Kudu Master \u6062\u590d Kudu multi-master \u90e8\u7f72\u529f\u80fd\u901a\u5e38\u5728\u4e3b\u673a\u4e22\u5931\u7684\u60c5\u51b5\u4e0b\u3002\u4f46\u662f\uff0c\u91cd\u8981\u7684\u662f\u66f4\u6362\u6b7b\u4e3b;\u5426\u5219\u7b2c\u4e8c\u6b21\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u53ef\u7528\u6027\u7684\u4e22\u5931\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u53ef\u7528 master \u7684\u6570\u91cf\u3002\u6b64\u5de5\u4f5c\u6d41\u7a0b\u63cf\u8ff0\u5982\u4f55\u66f4\u6362 dead master \u3002 \u7531\u4e8e KUDU-1620 \uff0c\u65e0\u9700\u91cd\u65b0\u542f\u52a8\u73b0\u573a\u4e3b\u673a\u5373\u53ef\u6267\u884c\u6b64\u5de5\u4f5c\u6d41\u7a0b\u3002\u56e0\u6b64\uff0c\u5de5\u4f5c\u6d41\u9700\u8981\u4e00\u4e2a\u7ef4\u62a4\u7a97\u53e3\uff0c\u5c3d\u7ba1\u4e3b\u8981\u901a\u5e38\u662f\u5feb\u901f\u91cd\u542f\u3002 \u6ce8\u610f Kudu \u8fd8\u4e0d\u652f\u6301\u4e3b\u4eba\u7684 Raft \u914d\u7f6e\u66f4\u6539\u3002\u56e0\u6b64\uff0c\u5982\u679c\u90e8\u7f72\u662f\u4f7f\u7528 DNS \u522b\u540d\u521b\u5efa\u7684\uff0c\u5219\u53ea\u80fd\u66ff\u6362\u4e3b\u670d\u52a1\u5668\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 multi-master \u79fb\u52a8\u5de5\u4f5c\u6d41\u7a0b \u3002 \u6ce8\u610f \u8be5\u5de5\u4f5c\u6d41\u7a0b\u81f3\u5c11\u57fa\u672c\u4e0a\u719f\u6089 Kudu \u914d\u7f6e\u7ba1\u7406\u3002\u5982\u679c\u4f7f\u7528 Cloudera Manager \uff08CM\uff09 \uff0c\u5de5\u4f5c\u6d41\u7a0b\u4e5f\u9884\u5148\u5047\u5b9a\u5b83\u662f\u719f\u6089\u7684\u3002 \u6ce8\u610f \u4ee5\u4e0b\u6240\u6709\u547d\u4ee4\u884c\u6b65\u9aa4\u90fd\u5e94\u8be5\u50cf Kudu UNIX \u7528\u6237\u4e00\u822c\u6267\u884c\u3002 \u4e3a\u6062\u590d\u505a\u51c6\u5907 \u786e\u4fdd dead master \u673a\u5668\u6b63\u5e38\u5e76\u4e14\u771f\u6b63\u6b7b\u4ea1\u3002\u91c7\u53d6\u4e00\u5207\u5fc5\u8981\u6b65\u9aa4\uff0c\u9632\u6b62\u610f\u5916\u91cd\u542f;\u8fd9\u5bf9\u4e8e\u96c6\u7fa4\u540e\u6062\u590d\u6765\u8bf4\u53ef\u80fd\u662f\u76f8\u5f53\u5371\u9669\u7684\u3002 \u9009\u62e9\u5269\u4e0b\u7684\u4ecd\u7136\u6d3b\u7740\u7684 master \u4e4b\u4e00\u4f5c\u4e3a\u6062\u590d\u7684\u57fa\u7840\u3002\u8fd9\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u7684\u5176\u4f59\u90e8\u5206\u5c06\u628a\u8fd9\u4e2a\u4e3b\u673a\u79f0\u4e3a \u201c reference \u201d \u4e3b\u673a\u3002 \u9009\u62e9 new master \u6240\u5728\u7684\u7fa4\u96c6\u4e2d\u672a\u4f7f\u7528\u7684\u673a\u5668\u3002 master \u751f\u6210\u7684\u8d1f\u8f7d\u5f88\u5c0f\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6570\u636e\u670d\u52a1\u6216\u8d1f\u8f7d\u751f\u6210\u8fc7\u7a0b\u5171\u540c\u914d\u7f6e\uff0c\u5c3d\u7ba1\u4e0e\u5176\u4ed6 Kudu \u4e3b\u673a\u4e0d\u540c\uff0c\u914d\u7f6e\u76f8\u540c\u3002\u8fd9\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u7684\u5176\u4f59\u90e8\u5206\u5c06\u628a\u8fd9\u4e2a\u4e3b\u673a\u79f0\u4e3a \u201c replacement \u201d \u4e3b\u673a\u3002 \u4e3a replacement master \u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u786e\u4fdd Kudu \u901a\u8fc7\u7cfb\u7edf\u5305\u88c5\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u5b89\u88c5 kudu \u548c kudu-master \u5305\u88c5\uff09\u6216\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u5b89\u88c5\u5728\u673a\u5668\u4e0a\u3002 \u9009\u62e9\u5e76\u8bb0\u5f55 master \u6570\u636e\u5c06\u5b58\u5728\u7684\u76ee\u5f55\u3002 \u4e3a\u6bcf\u4e2a\u73b0\u5728\u6d3b\u7740\u7684 master \u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u8bc6\u522b\u548c\u8bb0\u5f55\u4e3b\u6570\u636e\u6240\u5728\u7684\u76ee\u5f55\u3002\u5982\u679c\u4f7f\u7528 Kudu \u7cfb\u7edf\u8f6f\u4ef6\u5305\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3a /var/lib/kudu/master \uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 fs_wal_dir \u548c fs_data_dirs \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u81ea\u5b9a\u4e49\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u5c06 fs_data_dirs \u8bbe\u7f6e\u4e3a\u9664 fs_wal_dir \u503c\u4e4b\u5916\u7684\u67d0\u4e9b\u76ee\u5f55\uff0c\u5219\u5e94\u5c06\u5176\u660e\u786e\u5305\u542b\u5728\u5176\u4e2d\u8fd8\u5305\u542b fs_wal_dir \u7684\u6bcf\u4e2a\u547d\u4ee4\u4e2d\u3002 \u8bc6\u522b\u548c\u8bb0\u5f55 master \u7684 UUID \u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u5b83\uff1a $ kudu fs dump uuid --fs_wal_dir=&lt;master_data_dir&gt; 2&gt;/dev/null master_data_dir \u6d3b\u7740 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 \u793a\u4f8b $ kudu fs dump uuid --fs_wal_dir=/var/lib/kudu/master 2&gt;/dev/null 80a82c4b8a9f4c819bab744927ad765c \u5bf9 reference master \u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u8bc6\u522b\u548c\u8bb0\u5f55\u4e3b\u6570\u636e\u6240\u5728\u7684\u76ee\u5f55\u3002\u5982\u679c\u4f7f\u7528 Kudu \u7cfb\u7edf\u8f6f\u4ef6\u5305\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3a /var/lib/kudu/master \uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 fs_wal_dir \u548c fs_data_dirs \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u81ea\u5b9a\u4e49\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u5c06 fs_data_dirs \u8bbe\u7f6e\u4e3a\u9664 fs_wal_dir \u503c\u4e4b\u5916\u7684\u67d0\u4e9b\u76ee\u5f55\uff0c\u5219\u5e94\u5c06\u5176\u660e\u786e\u5305\u542b\u5728\u5176\u4e2d\u8fd8\u5305\u542b fs_wal_dir \u7684\u6bcf\u4e2a\u547d\u4ee4\u4e2d\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8bc6\u522b\u5e76\u8bb0\u5f55\u96c6\u7fa4\u4e2d\u6bcf\u4e2a master \u7684 UUID \uff1a $ kudu local_replica cmeta print_replica_uuids --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; 2&gt;/dev/null master_data_dir reference master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 \u793a\u4f8b $ kudu local_replica cmeta print_replica_uuids --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 2&gt;/dev/null 80a82c4b8a9f4c819bab744927ad765c 2a73eeee5d47413981d9a1c637cce170 1c3f3094256347528d02ec107466aef3 \u4f7f\u7528\u4ee5\u524d\u8bb0\u5f55\u7684\u4e24\u4e2a UUID \u5217\u8868\uff08\u4e00\u4e2a\u7528\u4e8e\u6240\u6709 live master \uff0c\u4e00\u4e2a\u7528\u4e8e\u6240\u6709 master \uff09\uff0c\u786e\u5b9a\u5e76\u8bb0\u5f55\uff08\u901a\u8fc7\u6d88\u9664\u5904\u7406\uff09 dead master \u7684 UUID \u3002 \u6267\u884c\u6062\u590d \u4f7f\u7528\u4ee5\u524d\u8bb0\u5f55\u7684 dead master \u4e3b\u673a\u7684 UUID \u683c\u5f0f\u5316 replacement master \u4e0a\u7684\u6570\u636e\u76ee\u5f55\u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e8f\u5217\uff1a $ kudu fs format --fs_wal_dir=&lt;master_data_dir&gt; --uuid=&lt;uuid&gt; master_data_dir replacement master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 uuid dead master \u4ee5\u524d\u8bb0\u5f55\u7684 UUID \u4f8b\u5b50 $ kudu fs format --fs_wal_dir=/var/lib/kudu/master --uuid=80a82c4b8a9f4c819bab744927ad765c \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06 master \u6570\u636e\u590d\u5236\u5230 replacement master \uff1a $ kudu local_replica copy_from_remote --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; &lt;reference_master&gt; master_data_dir replacement master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 reference_master reference_master \u7684 RPC \u5730\u5740\u5fc5\u987b\u662f <hostname>\uff1a<port> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 hostname reference master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u6216\u522b\u540d port reference master \u4e4b\u524d\u8bb0\u5f55\u7684 RPC \u7684\u7aef\u53e3\u53f7 \u793a\u4f8b $ kudu local_replica copy_from_remote --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 master-2:7051 \u5982\u679c\u4f7f\u7528 CM \uff0c\u8bf7\u7acb\u5373\u6dfb\u52a0\u66ff\u6362\u7684 Kudu master role \uff0c\u4f46\u4e0d\u8981\u542f\u52a8\u5b83\u3002 \u4f7f\u7528 replacement master \u7684\u522b\u540d\u8986\u76d6 new role \u7684 \u201c Master Address\u201d \u53c2\u6570\u7684\u7a7a\u503c\u3002 \u5982\u679c\u4f7f\u7528\u975e\u9ed8\u8ba4 RPC \u7aef\u53e3\u503c\uff0c\u8bf7\u6dfb\u52a0\u7aef\u53e3\u53f7\uff08\u4ee5\u5192\u53f7\u5206\u9694\uff09\u3002 \u91cd\u65b0\u914d\u7f6e dead master \u7684 DNS \u522b\u540d\u4ee5\u6307\u5411 replacement master \u3002 \u542f\u52a8 replacement master \u3002 \u91cd\u65b0\u542f\u52a8\u73b0\u6709\u7684 live master \u3002\u8fd9\u5bfc\u81f4\u77ed\u6682\u7684\u53ef\u7528\u6027\u4e2d\u65ad\uff0c\u4f46\u662f\u53ea\u6709 masters \u56de\u6765\u624d\u80fd\u6301\u7eed\u3002 \u606d\u559c\uff0c dead master \u5df2\u7ecf\u88ab\u66ff\u6362\u4e86\uff01\u8981\u9a8c\u8bc1\u6240\u6709 master \u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u8bf7\u8003\u8651\u6267\u884c\u4ee5\u4e0b\u5065\u5eb7\u6027\u68c0\u67e5\uff1a \u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u6bcf\u4e2a master \u7684 Web UI \u3002\u770b\u770b /master page \u3002\u6240\u6709\u7684\u4e3b\u4eba\u90fd\u5e94\u8be5\u88ab\u5217\u5728\u90a3\u91cc\uff0c\u4e00\u4e2a master \u5728 LEADER \u89d2\u8272\uff0c\u5176\u4ed6\u7684\u5728 FOLLOWER \u89d2\u8272\u3002\u6bcf\u4e2a master \u7684 master \u7684\u5185\u5bb9\u5e94\u8be5\u662f\u4e00\u6837\u7684\u3002 \u4f7f\u7528 kudu \u547d\u4ee4\u884c\u5de5\u5177\u5728\u96c6\u7fa4\u4e0a\u8fd0\u884c Kudu \u7cfb\u7edf\u68c0\u67e5\uff08 ksck \uff09\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u4f7f\u7528 ksck \u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5 \u3002 \u4f7f\u7528 ksck \u68c0\u67e5\u96c6\u7fa4\u8fd0\u884c\u72b6\u51b5 kudu CLI \u5305\u62ec\u4e00\u4e2a\u540d\u4e3a ksck \u7684\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5\u548c\u6570\u636e\u5b8c\u6574\u6027\u3002 ksck \u4f1a\u53d1\u73b0\u95ee\u9898\uff0c\u5982\u526f\u672c\u4e0d\u8db3\u7684 tablet \uff0c\u65e0\u6cd5\u8fde\u63a5\u7684 tablet server \u6216\u6ca1\u6709 leader \u7684 tablet \u3002 \u5e94\u4ece\u547d\u4ee4\u884c\u8fd0\u884c ksck \uff0c\u5e76\u8981\u6c42\u6307\u5b9a master address \u7684\u5b8c\u6574\u5217\u8868\uff1a $ kudu cluster ksck master-01.example.com,master-02.example.com,master-03.example.com \u8981\u67e5\u770b ksck \u53ef\u7528\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u4f7f\u7528 --help \u6807\u5fd7\u3002\u5982\u679c\u96c6\u7fa4\u662f\u5065\u5eb7\u7684\uff0c ksck \u5c06\u6253\u5370\u6210\u529f\u6d88\u606f\uff0c\u5e76\u8fd4\u56de\u96f6\uff08\u6210\u529f\uff09\u9000\u51fa\u72b6\u6001\u3002 Connected to the Master Fetched info from all 1 Tablet Servers Table IntegrationTestBigLinkedList is HEALTHY (1 tablet(s) checked) The metadata for 1 table(s) is HEALTHY OK \u5982\u679c\u96c6\u7fa4\u4e0d\u5065\u5eb7\uff0c\u4f8b\u5982\uff0c\u5982\u679c tablet server \u8fdb\u7a0b\u5df2\u505c\u6b62\uff0c\u5219 ksck \u5c06\u62a5\u544a\u95ee\u9898\u5e76\u8fd4\u56de\u975e\u96f6\u9000\u51fa\u72b6\u6001\uff1a Connected to the Master WARNING: Unable to connect to Tablet Server 8a0b66a756014def82760a09946d1fce (tserver-01.example.com:7050): Network error: could not send Ping RPC to server: Client connection negotiation failed: client connection to 192.168.0.2:7050: connect: Connection refused (error 61) WARNING: Fetched info from 0 Tablet Servers, 1 weren't reachable Tablet ce3c2d27010d4253949a989b9d9bf43c of table 'IntegrationTestBigLinkedList' is unavailable: 1 replica(s) not RUNNING 8a0b66a756014def82760a09946d1fce (tserver-01.example.com:7050): TS unavailable [LEADER] Table IntegrationTestBigLinkedList has 1 unavailable tablet(s) WARNING: 1 out of 1 table(s) are not in a healthy state ================== Errors: ================== error fetching info from tablet servers: Network error: Not all Tablet Servers are reachable table consistency check error: Corruption: 1 table(s) are bad FAILED Runtime error: ksck discovered errors \u4e3a\u4e86\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u53ef\u9009\u7684 --checksum_scan \u6807\u5fd7\uff0c\u901a\u8fc7\u626b\u63cf\u6bcf\u4e2a tablet \u526f\u672c\u5e76\u6bd4\u8f83\u7ed3\u679c\uff0c\u53ef\u4ee5\u786e\u4fdd\u96c6\u7fa4\u5177\u6709\u4e00\u81f4\u7684\u6570\u636e\u3002 --tables \u6216 --tablets \u6807\u5fd7\u53ef\u7528\u4e8e\u5c06\u6821\u9a8c\u548c\u626b\u63cf\u7684\u8303\u56f4\u5206\u522b\u9650\u5236\u5728\u7279\u5b9a\u7684\u8868\u683c\u6216 tablet \u4e0a\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5bf9 IntegrationTestBigLinkedList \u8868\u4e0a\u7684\u6570\u636e\u5b8c\u6574\u6027\u8fdb\u884c\u68c0\u67e5\uff1a $ kudu cluster ksck --checksum_scan --tables IntegrationTestBigLinkedList master-01.example.com,master-02.example.com,master-03.example.com \u4ece\u78c1\u76d8\u6545\u969c\u6062\u590d Kudu tablet servers \u65e0\u6cd5\u6062\u590d\u78c1\u76d8\u6545\u969c\u3002\u5f53\u5305\u542b\u6570\u636e\u76ee\u5f55\u6216\u9884\u5199\u65e5\u5fd7\uff08 WAL \uff09\u7684\u78c1\u76d8\u6b7b\u673a\u65f6\uff0c\u5fc5\u987b\u91cd\u5efa\u6574\u4e2a tablet server \u3002\u5728 tablet server \u53d1\u751f\u6545\u969c\u540e\uff0c Kudu \u4f1a\u5728\u5176\u4ed6\u670d\u52a1\u5668\u4e0a\u81ea\u52a8\u91cd\u65b0\u590d\u5236 tablet \uff0c\u4f46\u9700\u8981\u624b\u52a8\u5e72\u9884\u624d\u80fd\u5c06\u5931\u8d25\u7684 tablet server \u8fd8\u539f\u5230\u8fd0\u884c\u72b6\u6001\u3002 \u5728\u78c1\u76d8\u6545\u969c\u540e\u6062\u590d tablet servers \u7684\u7b2c\u4e00\u6b65\u662f\u66f4\u6362\u53d1\u751f\u6545\u969c\u7684\u78c1\u76d8\uff0c\u6216\u4ece\u6570\u636e\u76ee\u5f55 and/or WAL \u914d\u7f6e\u4e2d\u5220\u9664\u51fa\u73b0\u6545\u969c\u7684\u78c1\u76d8\u3002\u63a5\u4e0b\u6765\uff0c\u5fc5\u987b\u5220\u9664\u6570\u636e\u76ee\u5f55\u548c WAL \u76ee\u5f55\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u5982\u679c tablet servers \u914d\u7f6e\u4e86 --fs_wal_dir = /data/0/kudu-tserver-wal \u548c --fs_data_dirs = /data/1/kudu-tserver/data/2/kudu-tserver \uff0c\u5219\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5220\u9664\u6570\u636e\u76ee\u5f55\u548c WAL \u76ee\u5f55\u5185\u5bb9\uff1a $ rm -rf /data/0/kudu-tserver-wal/* /data/1/kudu-tserver/* /data/2/kudu-tserver/* \u5728 WAL \u548c\u6570\u636e\u76ee\u5f55\u88ab\u6e05\u7a7a\u4e4b\u540e\uff0c\u53ef\u4ee5\u542f\u52a8 tablet servers \u8fdb\u7a0b\u3002\u5f53\u4f7f\u7528\u7cfb\u7edf\u5305\u5b89\u88c5 Kudu \u65f6\uff0c\u901a\u5e38\u4f7f\u7528\u670d\u52a1\uff1a $ sudo service kudu-tserver start \u4e00\u65e6 tablet servers \u518d\u6b21\u8fd0\u884c\uff0c\u5c31\u4f1a\u6839\u636e\u9700\u8981\u5728\u5176\u4e0a\u521b\u5efa\u65b0\u7684 tablet \u526f\u672c\u3002","title":"\u7ba1\u7406 Kudu"},{"location":"6/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/administration.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813623 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u7ba1\u7406 Kudu"},{"location":"6/#apache-kudu-administration-apache-kudu","text":"\u6ce8\u610f Kudu \u4e0e Cloudera Manager \u76f8\u6bd4\u5728\u72ec\u7acb\u5b89\u88c5\u4e2d\u66f4\u5bb9\u6613\u7ba1\u7406\u3002 \u6709\u5173\u4f7f\u7528 Kudu \u4e0e Cloudera Manager \u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Cloudera Kudu \u6587\u6863 \u3002","title":"Apache Kudu Administration ( \u7ba1\u7406 Apache Kudu )"},{"location":"6/#kudu_1","text":"\u91cd\u8981 \u4ec5\u5f53\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u5305\uff08\u4f8b\u5982 rpm \u6216 deb \uff09\u5b89\u88c5 Kudu \u65f6\uff0c\u8fd9\u4e9b\u8bf4\u660e\u624d\u662f\u76f8\u5173\u7684\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8 Kudu \u670d\u52a1\uff1a $ sudo service kudu-master start $ sudo service kudu-tserver start \u8981\u505c\u6b62 Kudu \u670d\u52a1\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a $ sudo service kudu-master stop $ sudo service kudu-tserver stop","title":"\u542f\u52a8\u548c\u505c\u6b62 Kudu \u8fdb\u7a0b"},{"location":"6/#kudu-web","text":"Kudu tablet servers \u548c masters \u5728\u5185\u7f6e\u7684 Web \u754c\u9762\u4e0a\u663e\u793a\u6709\u7528\u7684\u64cd\u4f5c\u4fe1\u606f\uff0c","title":"Kudu Web \u754c\u9762"},{"location":"6/#kudu-master-web-interface","text":"Kudu \u4e3b\u8fdb\u7a0b\u5728 8051 \u7aef\u53e3\u4e0a\u4e3a\u5176 Web \u754c\u9762\u63d0\u4f9b\u670d\u52a1\u3002\u8be5\u754c\u9762\u66b4\u9732\u4e86\u51e0\u4e2a\u9875\u9762\uff0c\u5176\u4e2d\u5305\u542b\u6709\u5173\u7fa4\u96c6\u72b6\u6001\u7684\u4fe1\u606f\uff1a tablet servers \u5217\u8868\uff0c\u5176 host names \u548c\u4e0a\u6b21\u5fc3\u8df3\u65f6\u95f4\u3002 \u8868\u683c\u5217\u8868\uff0c\u5305\u62ec\u6bcf\u4e2a\u8868\u7684 schema \u548c tablet location information \u4fe1\u606f\u3002 \u60a8\u53ef\u4ee5\u5c06\u5176\u7c98\u8d34\u5230 Impala Shell \u4e2d\u4ee5\u5c06\u73b0\u6709\u8868\u6dfb\u52a0\u5230 Impala \u7684\u5df2\u77e5\u6570\u636e\u6e90\u5217\u8868\u4e2d\u7684 SQL \u4ee3\u7801\u3002","title":"Kudu Master Web Interface"},{"location":"6/#kudu-tablets-server-web","text":"\u6bcf\u4e2a tablet server \u90fd\u63d0\u4f9b\u7aef\u53e3 8050 \u4e0a\u7684 Web \u754c\u9762\u3002\u8be5\u754c\u9762\u663e\u793a\u6709\u5173\u670d\u52a1\u5668\u4e0a\u6258\u7ba1\u7684\u6bcf\u4e2a tablet \u7684\u4fe1\u606f\uff0c\u5176\u5f53\u524d\u72b6\u6001\u4ee5\u53ca\u6709\u5173\u7ef4\u62a4\u540e\u53f0\u64cd\u4f5c\u7684\u8c03\u8bd5\u4fe1\u606f\u3002","title":"Kudu Tablets Server Web \u754c\u9762"},{"location":"6/#web","text":"Kudu masters \u548c tablet servers \u901a\u8fc7\u5176 Web \u754c\u9762\u66b4\u9732\u4e86\u4e00\u7ec4\u901a\u7528\u7684\u4fe1\u606f\uff1a HTTP \u8bbf\u95ee\u670d\u52a1\u5668\u65e5\u5fd7\u3002 \u4e00\u4e2a /rpcz \u7aef\u70b9\uff0c\u901a\u8fc7 JSON \u5217\u51fa\u5f53\u524d\u8fd0\u884c\u7684 RPC \u3002 \u9875\u9762\u63d0\u4f9b\u4e86\u6709\u5173\u8fdb\u7a0b\u4e0d\u540c\u7ec4\u4ef6\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u7684\u6982\u8ff0\u548c\u8be6\u7ec6\u4fe1\u606f\u3002 \u5173\u4e8e\u5f53\u524d\u914d\u7f6e\u6807\u5fd7\u7684\u4fe1\u606f\u3002 \u5173\u4e8e\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u53ca\u5176\u8d44\u6e90\u6d88\u8017\u7684\u4fe1\u606f\u3002 \u4e00\u4e2a JSON \u7aef\u70b9\u663e\u793a\u6709\u5173\u670d\u52a1\u5668\u7684\u6307\u6807\u3002 \u6709\u5173\u5b88\u62a4\u7a0b\u5e8f\u90e8\u7f72\u7248\u672c\u53f7\u7684\u4fe1\u606f\u3002 \u8fd9\u4e9b\u754c\u9762\u662f\u4ece\u6bcf\u4e2a\u5b88\u62a4\u8fdb\u7a0b\u7684 Web UI \u7684 landing page \u94fe\u63a5\u7684\u3002","title":"\u5e38\u89c1\u7684 Web \u754c\u9762\u9875\u9762"},{"location":"6/#kudu-metrics","text":"Kudu \u5b88\u62a4\u8fdb\u7a0b\u516c\u5f00\u4e86\u5927\u91cf\u7684\u6307\u6807\u3002\u4e00\u4e9b\u6307\u6807\u4e0e\u6574\u4e2a\u670d\u52a1\u5668\u8fdb\u7a0b\u76f8\u5173\u8054\uff0c\u800c\u5176\u4ed6\u6307\u6807\u4e0e\u7279\u5b9a tablet \u526f\u672c\u76f8\u5173\u8054\u3002","title":"Kudu Metrics ( \u6307\u6807 )"},{"location":"6/#_1","text":"Kudu \u670d\u52a1\u5668\u7684\u5168\u5957\u53ef\u7528\u5ea6\u91cf\u503c\u53ef\u4ee5\u901a\u8fc7\u7279\u6b8a\u7684\u547d\u4ee4\u884c\u6807\u5fd7\u8fdb\u884c\u8f6c\u50a8\uff1a $ kudu-tserver --dump_metrics_json $ kudu-master --dump_metrics_json \u8fd9\u5c06\u8f93\u51fa\u4e00\u4e2a\u5927\u7684 JSON \u6587\u6863\u3002\u6bcf\u4e2a\u6307\u6807\u90fd\u8868\u793a\u5176\u540d\u79f0\uff0c\u6807\u7b7e\uff0c\u63cf\u8ff0\uff0c\u5355\u4f4d\u548c\u7c7b\u578b\u3002\u7531\u4e8e\u8f93\u51fa\u662f JSON \u683c\u5f0f\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u8f7b\u677e\u5730\u5c06\u8fd9\u4e9b\u4fe1\u606f\u8fdb\u884c\u89e3\u6790\uff0c\u5e76\u5c06\u5176\u9988\u9001\u5230\u4ece Kudu \u670d\u52a1\u5668\u6536\u96c6\u6307\u6807\u7684\u5176\u4ed6\u5de5\u5177\u4e2d\u3002","title":"\u5217\u51fa\u53ef\u7528\u7684\u6307\u6807"},{"location":"6/#http","text":"\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee/\u6307\u6807\u901a\u8fc7\u5176 HTTP \u63a5\u53e3\u4ece\u670d\u52a1\u5668\u8fdb\u7a0b\u6536\u96c6\u5ea6\u91cf\u3002\u6b64\u9875\u9762\u7684\u8f93\u51fa\u662f JSON \uff0c\u53ef\u4ee5\u901a\u8fc7\u76d1\u89c6\u670d\u52a1\u8f7b\u677e\u89e3\u6790\u3002\u6b64\u7aef\u70b9\u5728\u5176\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u63a5\u53d7\u51e0\u4e2a GET \u53c2\u6570\uff1a /metrics?metrics=<substring1>,<substring2>,\u2026 - \u5c06\u8fd4\u56de\u7684\u6307\u6807\u9650\u5236\u4e3a\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u63d0\u4f9b\u7684\u5b50\u5b57\u7b26\u4e32\u7684\u6307\u6807\u3002\u5b50\u4e32\u4e5f\u5339\u914d\u5b9e\u4f53\u540d\u79f0\uff0c\u56e0\u6b64\u53ef\u7528\u4e8e\u6536\u96c6\u7279\u5b9a tablet \u7684\u6307\u6807\u3002 /metrics?include_schema=1 - \u5305\u62ec JSON \u8f93\u51fa\u4e2d\u7684\u5ea6\u91cf\u67b6\u6784\u4fe1\u606f\uff0c\u5982\u5355\u4f4d\uff0c\u63cf\u8ff0\u548c\u6807\u7b7e\u3002\u901a\u5e38\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u8282\u7701\u7a7a\u95f4\u3002 /metrics?compact=1 - \u4ece\u7ed3\u679c JSON \u4e2d\u6d88\u9664\u4e0d\u5fc5\u8981\u7684\u7a7a\u683c\uff0c\u4ece\u8fdc\u7a0b\u4e3b\u673a\u83b7\u53d6\u6b64\u9875\u9762\u65f6\u53ef\u4ee5\u51cf\u5c11\u5e26\u5bbd\u3002 /metrics?include_raw_histograms=1 - \u5305\u62ec\u76f4\u65b9\u56fe\u6307\u6807\u7684\u539f\u59cb\u5b58\u50a8\u6876\u548c\u503c\uff0c\u53ef\u5b9e\u73b0\u968f\u65f6\u95f4\u548c\u8de8\u4e3b\u673a\u7684\u767e\u5206\u4f4d\u6570\u5ea6\u91cf\u7684\u51c6\u786e\u805a\u5408\u3002 \u4f8b\u5982\uff1a $ curl -s 'http://example-ts:8050/metrics?include_schema=1&metrics=connections_accepted' [ { \"type\": \"server\", \"id\": \"kudu.tabletserver\", \"attributes\": {}, \"metrics\": [ { \"name\": \"rpc_connections_accepted\", \"label\": \"RPC Connections Accepted\", \"type\": \"counter\", \"unit\": \"connections\", \"description\": \"Number of incoming TCP connections made to the RPC server\", \"value\": 92 } ] } ] $ curl -s 'http://example-ts:8050/metrics?metrics=log_append_latency' [ { \"type\": \"tablet\", \"id\": \"c0ebf9fef1b847e2a83c7bd35c2056b1\", \"attributes\": { \"table_name\": \"lineitem\", \"partition\": \"hash buckets: (55), range: [(<start>), (<end>))\", \"table_id\": \"\" }, \"metrics\": [ { \"name\": \"log_append_latency\", \"total_count\": 7498, \"min\": 4, \"mean\": 69.3649, \"percentile_75\": 29, \"percentile_95\": 38, \"percentile_99\": 45, \"percentile_99_9\": 95, \"percentile_99_99\": 167, \"max\": 367244, \"total_sum\": 520098 } ] } ] \u6ce8\u610f \u6240\u6709\u76f4\u65b9\u56fe\u548c\u8ba1\u6570\u5668\u90fd\u662f\u4ece\u670d\u52a1\u5668\u5f00\u59cb\u65f6\u95f4\u5f00\u59cb\u6d4b\u91cf\u7684\uff0c\u6536\u96c6\u540e\u4e0d\u4f1a\u91cd\u7f6e\u3002","title":"\u901a\u8fc7HTTP\u6536\u96c6\u6307\u6807"},{"location":"6/#_2","text":"Kudu \u53ef\u4ee5\u914d\u7f6e\u4e3a\u4f7f\u7528 --metrics_log_interval_ms \u6807\u5fd7\u5c06\u5176\u6240\u6709\u5ea6\u91cf\u503c\u5b9a\u671f\u8f6c\u50a8\u5230\u672c\u5730\u65e5\u5fd7\u6587\u4ef6\u3002\u5c06\u6b64\u6807\u5fd7\u8bbe\u7f6e\u4e3a\u5c06\u5ea6\u91cf\u503c\u5199\u5165\u65e5\u5fd7\u6587\u4ef6\u7684\u65f6\u95f4\u95f4\u9694\u3002 \u5ea6\u91cf\u65e5\u5fd7\u5c06\u4e0e\u5176\u4ed6 Kudu \u65e5\u5fd7\u6587\u4ef6\u4e00\u6837\u5199\u5165\u4e0e\u5176\u76f8\u540c\u7684\u76ee\u5f55\uff0c\u5177\u6709\u76f8\u540c\u7684\u547d\u540d\u683c\u5f0f\u3002\u4efb\u4f55\u6307\u6807\u65e5\u5fd7\u6587\u4ef6\u8fbe\u5230 64MB \u672a\u538b\u7f29\u540e\uff0c\u65e5\u5fd7\u5c06\u88ab\u6eda\u52a8\uff0c\u4e0a\u4e00\u4e2a\u6587\u4ef6\u5c06\u88ab gzip \u538b\u7f29\u3002 \u751f\u6210\u7684\u65e5\u5fd7\u6587\u4ef6\u6709\u4e09\u4e2a\u7a7a\u683c\u5206\u9694\u7684\u5b57\u6bb5\u3002\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u662f\u5355\u8bcd\u6307\u6807\u3002\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u662f\u81ea Unix \u7eaa\u5143\u4ee5\u6765\u7684\u5fae\u79d2\u7684\u5f53\u524d\u65f6\u95f4\u6233\u3002\u7b2c\u4e09\u4e2a\u662f\u4f7f\u7528\u7d27\u51d1\u7684 JSON \u7f16\u7801\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6240\u6709\u6307\u6807\u7684\u5f53\u524d\u503c\u3002\u7f16\u7801\u4e0e\u901a\u8fc7\u4e0a\u8ff0 HTTP \u83b7\u53d6\u7684\u6307\u6807\u76f8\u540c\u3002 \u6ce8\u610f \u867d\u7136\u5ea6\u91cf\u8bb0\u5f55\u81ea\u52a8\u6eda\u52a8\u5e76\u538b\u7f29\u4ee5\u524d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f46\u5b83\u4e0d\u4f1a\u5220\u9664\u65e7\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\u7531\u4e8e\u5ea6\u91cf\u8bb0\u5f55\u53ef\u4ee5\u4f7f\u7528\u5927\u91cf\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u56e0\u6b64\u8bf7\u8003\u8651\u8bbe\u7f6e\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u6765\u76d1\u89c6\u65e5\u5fd7\u76ee\u5f55\u4e2d\u7684\u7a7a\u95f4\u5e76\u5f52\u6863\u6216\u5220\u9664\u65e7\u6bb5\u3002","title":"\u6536\u96c6\u6307\u6807\u5230\u65e5\u5fd7"},{"location":"6/#kudu_2","text":"","title":"\u5e38\u89c1\u7684 Kudu \u5de5\u4f5c\u6d41\u7a0b"},{"location":"6/#kudu-master","text":"\u4e3a\u4e86\u83b7\u5f97\u9ad8\u53ef\u7528\u6027\u5e76\u907f\u514d\u51fa\u73b0\u5355\u70b9\u6545\u969c\uff0c Kudu \u96c6\u7fa4\u5e94\u8be5\u7531\u591a\u4e2a\u4e3b\u4eba\u521b\u5efa\u3002\u8bb8\u591a Kudu \u96c6\u7fa4\u662f\u7531\u4e00\u4e2a\u5355\u4e00\u7684\u4e3b\u4eba\u521b\u5efa\u7684\uff0c\u65e0\u8bba\u662f\u7b80\u5355\u7684\u8fd8\u662f\u7531\u4e8e Kudu \u591a\u4e3b\u4eba\u7684\u652f\u6301\u5728\u5f53\u65f6\u4ecd\u7136\u662f\u5b9e\u9a8c\u6027\u7684\u3002\u6b64\u5de5\u4f5c\u6d41\u6f14\u793a\u5982\u4f55\u8fc1\u79fb\u5230\u591a\u4e3b\u914d\u7f6e\u3002 \u6ce8\u610f \u5c06\u5de5\u4f5c\u6d41\u6dfb\u52a0\u5230\u73b0\u6709\u7684\u591a\u4e3b\u914d\u7f6e\u4e2d\u662f\u4e0d\u5b89\u5168\u7684\u3002\u4e0d\u8981\u4e3a\u6b64\u76ee\u7684\u4f7f\u7528\u5b83\u3002 \u6ce8\u610f \u8be5\u5de5\u4f5c\u6d41\u7a0b\u81f3\u5c11\u57fa\u672c\u4e0a\u719f\u6089 Kudu \u914d\u7f6e\u7ba1\u7406\u3002\u5982\u679c\u4f7f\u7528 Cloudera Manager\uff08CM\uff09 \uff0c\u5de5\u4f5c\u6d41\u7a0b\u4e5f\u9884\u5148\u5047\u5b9a\u5b83\u662f\u719f\u6089\u7684\u3002 \u6ce8\u610f \u4ee5\u4e0b\u6240\u6709\u547d\u4ee4\u884c\u6b65\u9aa4\u90fd\u5e94\u8be5\u50cf Kudu UNIX \u7528\u6237\u4e00\u822c\u6267\u884c\u3002","title":"\u8fc1\u79fb\u5230\u591a\u4e2a Kudu Master"},{"location":"6/#_3","text":"\u5efa\u7acb\u7ef4\u62a4\u7a97\u53e3\uff08\u4e00\u5c0f\u65f6\u5e94\u8be5\u8db3\u591f\uff09\u3002\u5728\u6b64\u671f\u95f4\uff0c Kudu \u96c6\u7fa4\u5c06\u4e0d\u53ef\u7528\u3002 \u51b3\u5b9a\u4f7f\u7528\u591a\u5c11 masters \u3002 masters \u7684\u6570\u91cf\u5e94\u8be5\u662f\u5947\u6570\u3002\u5efa\u8bae\u4f7f\u7528\u4e09\u6216\u4e94\u4e2a\u8282\u70b9\u4e3b\u914d\u7f6e;\u4ed6\u4eec\u53ef\u4ee5\u5bb9\u5fcd\u4e00\u4e24\u4e2a\u6545\u969c\u3002 \u5bf9\u73b0\u6709 master \u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u8bc6\u522b\u548c\u8bb0\u5f55\u4e3b\u6570\u636e\u6240\u5728\u7684\u76ee\u5f55\u3002\u5982\u679c\u4f7f\u7528 Kudu \u7cfb\u7edf\u8f6f\u4ef6\u5305\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3a /var/lib/kudu/master \uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 fs_wal_dir \u548c fs_data_dirs \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u81ea\u5b9a\u4e49\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u5c06 fs_data_dirs \u8bbe\u7f6e\u4e3a\u9664 fs_wal_dir \u503c\u4e4b\u5916\u7684\u67d0\u4e9b\u76ee\u5f55\uff0c\u5219\u5e94\u5c06\u5176\u660e\u786e\u5305\u542b\u5728\u5176\u4e2d\u8fd8\u5305\u542b fs_wal_dir \u7684\u6bcf\u4e2a\u547d\u4ee4\u4e2d\u3002 \u8bc6\u522b\u548c\u8bb0\u5f55 master \u6b63\u5728\u4e3a RPC \u4f7f\u7528\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u7aef\u53e3\u503c\u4e3a 7051 \uff0c\u4f46\u53ef\u80fd\u4f7f\u7528 rpc_bind_addresses \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u4e86\u81ea\u5b9a\u4e49\u3002 \u8bc6\u522b master \u7684 UUID \u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u5b83\uff1a $ kudu fs dump uuid --fs_wal_dir=&lt;master_data_dir&gt; 2&gt;/dev/null master_data_dir \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 \u4f8b\u5b50 $ kudu fs dump uuid --fs_wal_dir=/var/lib/kudu/master 2&gt;/dev/null 4aab798a69e94fab8d77069edff28ce0 \u53ef\u9009\uff1a\u914d\u7f6e master \u7684 DNS \u522b\u540d\u3002\u522b\u540d\u53ef\u80fd\u662f DNS cname \uff08\u5982\u679c\u673a\u5668\u5df2\u7ecf\u5728 DNS \u4e2d\u6709 A \u8bb0\u5f55\uff09\uff0c A \u8bb0\u5f55\uff08\u5982\u679c\u673a\u5668\u4ec5\u7531\u5176 IP \u5730\u5740\u77e5\u9053\uff09\u6216 /etc/hosts \u4e2d\u7684\u522b\u540d\u3002\u522b\u540d\u5e94\u8be5\u662f master \u7684\u62bd\u8c61\u8868\u793a\uff08\u4f8b\u5982\uff0c master - 1 \uff09\u3002 \u6ce8\u610f \u6ca1\u6709 DNS \u522b\u540d\uff0c\u4e0d\u53ef\u80fd\u4ece\u6c38\u4e45\u6027\u4e3b\u673a\u6545\u969c\u4e2d\u6062\u590d\uff0c\u56e0\u6b64\u5f3a\u70c8\u5efa\u8bae\u3002 \u4e3a\u6bcf\u4e2a\u65b0\u7684\u4e3b\u8bbe\u5907\u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u5728\u96c6\u7fa4\u4e2d\u9009\u62e9\u4e00\u4e2a\u672a\u4f7f\u7528\u7684\u673a\u5668\u3002\u4e3b\u673a\u751f\u6210\u7684\u8d1f\u8f7d\u5f88\u5c0f\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6570\u636e\u670d\u52a1\u6216\u8d1f\u8f7d\u751f\u6210\u8fc7\u7a0b\u5171\u540c\u914d\u7f6e\uff0c\u5c3d\u7ba1\u4e0e\u5176\u4ed6 Kudu \u4e3b\u673a\u4e0d\u540c\uff0c\u914d\u7f6e\u76f8\u540c\u3002 \u786e\u4fdd Kudu \u901a\u8fc7\u7cfb\u7edf\u5305\u88c5\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u5b89\u88c5 kudu \u548c kudu-master \u5305\u88c5\uff09\u6216\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u5b89\u88c5\u5728\u673a\u5668\u4e0a\u3002 \u9009\u62e9\u5e76\u8bb0\u5f55\u4e3b\u6570\u636e\u5c06\u5b58\u5728\u7684\u76ee\u5f55\u3002 \u9009\u62e9\u5e76\u8bb0\u5f55\u4e3b\u673a\u5e94\u7528\u4e8e RPC \u7684\u7aef\u53e3\u3002 \u53ef\u9009\uff1a\u914d\u7f6e\u4e3b\u670d\u52a1\u5668\u7684 DNS \u522b\u540d\uff08\u4f8b\u5982\uff0c master-2 \uff0c master-3 \u7b49\uff09\u3002","title":"\u51c6\u5907\u8fc1\u79fb"},{"location":"6/#_4","text":"\u505c\u6b62\u6574\u4e2a\u96c6\u7fa4\u4e2d\u7684\u6240\u6709 Kudu \u8fdb\u7a0b\u3002 \u683c\u5f0f\u5316\u6bcf\u4e2a\u65b0 master \u4e0a\u7684\u6570\u636e\u76ee\u5f55\uff0c\u5e76\u8bb0\u5f55\u751f\u6210\u7684 UUID \u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e8f\u5217\uff1a $ kudu fs format --fs_wal_dir=&lt;master_data_dir&gt; $ kudu fs dump uuid --fs_wal_dir=&lt;master_data_dir&gt; 2&gt;/dev/null master_data_dir \u65b0 master \u4ee5\u524d\u5f55\u5236\u7684\u6570\u636e\u76ee\u5f55\u3002 \u793a\u4f8b $ kudu fs format --fs_wal_dir=/var/lib/kudu/master $ kudu fs dump uuid --fs_wal_dir=/var/lib/kudu/master 2&gt;/dev/null f5624e05f40649b79a757629a69d061e \u5982\u679c\u4f7f\u7528 CM \uff0c\u73b0\u5728\u6dfb\u52a0\u65b0\u7684 Kudu master roles \uff0c\u4f46\u4e0d\u8981\u542f\u52a8\u5b83\u4eec\u3002 \u5982\u679c\u4f7f\u7528 DNS \u522b\u540d\uff0c\u8bf7\u4f7f\u7528\u8be5\u4e3b\u673a\u7684\u522b\u540d\u8986\u76d6\u6bcf\u4e2a\u89d2\u8272\uff08\u5305\u62ec\u73b0\u6709\u4e3b\u89d2\u8272\uff09\u7684 \u201cMaster Address\u201d \u53c2\u6570\u7684\u7a7a\u503c\u3002 \u5982\u679c\u4f7f\u7528\u975e\u9ed8\u8ba4 RPC \u7aef\u53e3\u503c\uff0c\u8bf7\u6dfb\u52a0\u7aef\u53e3\u53f7\uff08\u4ee5\u5192\u53f7\u5206\u9694\uff09\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u91cd\u5199 master \u7684 Raft \u914d\u7f6e\uff0c\u5728\u73b0\u6709\u4e3b\u673a\u4e0a\u6267\u884c\uff1a $ kudu local_replica cmeta rewrite_raft_config --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; &lt;all_masters&gt; master_data_dir \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 all_masters \u7a7a\u683c\u5206\u9694\u7684 master \u7684\u5217\u8868\uff0c\u65b0\u7684\u548c\u73b0\u5728\u7684\u3002\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u5fc5\u987b\u662f <uuid>\uff1a<hostname>\uff1a<port> \u683c\u5f0f\u7684\u5b57\u7b26\u4e32 UUID master \u4ee5\u524d\u8bb0\u5f55\u7684 UUID hostname master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u6216 \u522b\u540d port master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7684\u7aef\u53e3\u53f7 \u793a\u4f8b $ kudu local_replica cmeta rewrite_raft_config --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 4aab798a69e94fab8d77069edff28ce0:master-1:7051 f5624e05f40649b79a757629a69d061e:master-2:7051 988d8ac6530f426cbe180be5ba52033d:master-3:7051 \u4fee\u6539\u73b0\u6709 master \u548c\u65b0 masters \u7684 master_addresses \u914d\u7f6e\u53c2\u6570\u7684\u503c\u3002\u65b0\u503c\u5fc5\u987b\u662f\u6240\u6709\u4e3b\u8282\u70b9\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u6bcf\u4e2a\u6761\u76ee\u662f <hostname>\uff1a<port> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 hostname master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u548c \u522b\u540d port master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7aef\u53e3\u53f7 \u542f\u52a8\u73b0\u6709\u7684 master \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06 master \u6570\u636e\u590d\u5236\u5230\u6bcf\u4e2a\u65b0 master \uff0c\u5728\u6bcf\u53f0\u65b0 master \u4e0a\u6267\u884c\uff1a $ kudu local_replica copy_from_remote --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; &lt;existing_master&gt; master_data_dir \u65b0 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 existing_master \u73b0\u6709 master \u7684 RPC \u5730\u5740\u5fc5\u987b\u662f <hostname>\uff1a<port> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 hostname \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u6216\u522b\u540d port \u73b0\u6709 master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7aef\u53e3\u53f7 \u793a\u4f8b $ kudu local_replica copy_from_remote --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 master-1:7051 \u542f\u52a8\u6240\u6709\u7684\u65b0\u7684 master \u6ce8\u610f \u5982\u679c\u4f7f\u7528 CM \uff0c\u8bf7\u8df3\u8fc7\u4e0b\u4e00\u6b65\u3002 \u4fee\u6539\u6bcf\u4e2a tablet server \u7684 tserver_master_addrs \u914d\u7f6e\u53c2\u6570\u7684\u503c\u3002\u65b0\u503c\u5fc5\u987b\u662f\u4ee5\u9017\u53f7\u5206\u9694\u7684\u4e3b\u6587\u4ef6\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6761\u76ee\u662f <hostname> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 \uff1a <port> hostname master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u548c\u522b\u540d port master \u4ee5\u524d\u8bb0\u5f55\u7684 RPC \u7aef\u53e3\u53f7 \u542f\u52a8\u6240\u6709\u7684 tablet servers \u606d\u559c\uff0c\u96c6\u7fa4\u5df2\u7ecf\u8fc1\u79fb\u5230\u591a\u4e2a masters \u4e86\uff01\u8981\u9a8c\u8bc1\u6240\u6709 master \u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u8bf7\u8003\u8651\u6267\u884c\u4ee5\u4e0b\u5065\u5eb7\u6027\u68c0\u67e5\uff1a \u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u6bcf\u4e2a master \u7684 Web UI \u3002\u770b\u770b /master page \u3002\u6240\u6709\u7684 master \u90fd\u5e94\u8be5\u88ab\u5217\u5728\u90a3\u91cc\uff0c\u4e00\u4e2a\u4e3b\u4eba\u5728 LEADER \u89d2\u8272\uff0c\u5176\u4ed6\u7684\u5728 FOLLOWER \u89d2\u8272\u3002\u6bcf\u4e2a master \u7684 master \u7684\u5185\u5bb9\u5e94\u8be5\u662f\u4e00\u6837\u7684\u3002 \u4f7f\u7528 kudu \u547d\u4ee4\u884c\u5de5\u5177\u5728\u96c6\u7fa4\u4e0a\u8fd0\u884c Kudu \u7cfb\u7edf\u68c0\u67e5\uff08 ksck \uff09\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u4f7f\u7528 ksck \u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5 \u3002","title":"\u6267\u884c\u8fc1\u79fb"},{"location":"6/#master-kudu-master","text":"Kudu multi-master \u90e8\u7f72\u529f\u80fd\u901a\u5e38\u5728\u4e3b\u673a\u4e22\u5931\u7684\u60c5\u51b5\u4e0b\u3002\u4f46\u662f\uff0c\u91cd\u8981\u7684\u662f\u66f4\u6362\u6b7b\u4e3b;\u5426\u5219\u7b2c\u4e8c\u6b21\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u53ef\u7528\u6027\u7684\u4e22\u5931\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u53ef\u7528 master \u7684\u6570\u91cf\u3002\u6b64\u5de5\u4f5c\u6d41\u7a0b\u63cf\u8ff0\u5982\u4f55\u66f4\u6362 dead master \u3002 \u7531\u4e8e KUDU-1620 \uff0c\u65e0\u9700\u91cd\u65b0\u542f\u52a8\u73b0\u573a\u4e3b\u673a\u5373\u53ef\u6267\u884c\u6b64\u5de5\u4f5c\u6d41\u7a0b\u3002\u56e0\u6b64\uff0c\u5de5\u4f5c\u6d41\u9700\u8981\u4e00\u4e2a\u7ef4\u62a4\u7a97\u53e3\uff0c\u5c3d\u7ba1\u4e3b\u8981\u901a\u5e38\u662f\u5feb\u901f\u91cd\u542f\u3002 \u6ce8\u610f Kudu \u8fd8\u4e0d\u652f\u6301\u4e3b\u4eba\u7684 Raft \u914d\u7f6e\u66f4\u6539\u3002\u56e0\u6b64\uff0c\u5982\u679c\u90e8\u7f72\u662f\u4f7f\u7528 DNS \u522b\u540d\u521b\u5efa\u7684\uff0c\u5219\u53ea\u80fd\u66ff\u6362\u4e3b\u670d\u52a1\u5668\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 multi-master \u79fb\u52a8\u5de5\u4f5c\u6d41\u7a0b \u3002 \u6ce8\u610f \u8be5\u5de5\u4f5c\u6d41\u7a0b\u81f3\u5c11\u57fa\u672c\u4e0a\u719f\u6089 Kudu \u914d\u7f6e\u7ba1\u7406\u3002\u5982\u679c\u4f7f\u7528 Cloudera Manager \uff08CM\uff09 \uff0c\u5de5\u4f5c\u6d41\u7a0b\u4e5f\u9884\u5148\u5047\u5b9a\u5b83\u662f\u719f\u6089\u7684\u3002 \u6ce8\u610f \u4ee5\u4e0b\u6240\u6709\u547d\u4ee4\u884c\u6b65\u9aa4\u90fd\u5e94\u8be5\u50cf Kudu UNIX \u7528\u6237\u4e00\u822c\u6267\u884c\u3002","title":"\u5728\u591a Master \u90e8\u7f72\u4e2d\u4ece\u6b7b\u4ea1\u7684 Kudu Master \u6062\u590d"},{"location":"6/#_5","text":"\u786e\u4fdd dead master \u673a\u5668\u6b63\u5e38\u5e76\u4e14\u771f\u6b63\u6b7b\u4ea1\u3002\u91c7\u53d6\u4e00\u5207\u5fc5\u8981\u6b65\u9aa4\uff0c\u9632\u6b62\u610f\u5916\u91cd\u542f;\u8fd9\u5bf9\u4e8e\u96c6\u7fa4\u540e\u6062\u590d\u6765\u8bf4\u53ef\u80fd\u662f\u76f8\u5f53\u5371\u9669\u7684\u3002 \u9009\u62e9\u5269\u4e0b\u7684\u4ecd\u7136\u6d3b\u7740\u7684 master \u4e4b\u4e00\u4f5c\u4e3a\u6062\u590d\u7684\u57fa\u7840\u3002\u8fd9\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u7684\u5176\u4f59\u90e8\u5206\u5c06\u628a\u8fd9\u4e2a\u4e3b\u673a\u79f0\u4e3a \u201c reference \u201d \u4e3b\u673a\u3002 \u9009\u62e9 new master \u6240\u5728\u7684\u7fa4\u96c6\u4e2d\u672a\u4f7f\u7528\u7684\u673a\u5668\u3002 master \u751f\u6210\u7684\u8d1f\u8f7d\u5f88\u5c0f\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6570\u636e\u670d\u52a1\u6216\u8d1f\u8f7d\u751f\u6210\u8fc7\u7a0b\u5171\u540c\u914d\u7f6e\uff0c\u5c3d\u7ba1\u4e0e\u5176\u4ed6 Kudu \u4e3b\u673a\u4e0d\u540c\uff0c\u914d\u7f6e\u76f8\u540c\u3002\u8fd9\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u7684\u5176\u4f59\u90e8\u5206\u5c06\u628a\u8fd9\u4e2a\u4e3b\u673a\u79f0\u4e3a \u201c replacement \u201d \u4e3b\u673a\u3002 \u4e3a replacement master \u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u786e\u4fdd Kudu \u901a\u8fc7\u7cfb\u7edf\u5305\u88c5\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u5b89\u88c5 kudu \u548c kudu-master \u5305\u88c5\uff09\u6216\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u5b89\u88c5\u5728\u673a\u5668\u4e0a\u3002 \u9009\u62e9\u5e76\u8bb0\u5f55 master \u6570\u636e\u5c06\u5b58\u5728\u7684\u76ee\u5f55\u3002 \u4e3a\u6bcf\u4e2a\u73b0\u5728\u6d3b\u7740\u7684 master \u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u8bc6\u522b\u548c\u8bb0\u5f55\u4e3b\u6570\u636e\u6240\u5728\u7684\u76ee\u5f55\u3002\u5982\u679c\u4f7f\u7528 Kudu \u7cfb\u7edf\u8f6f\u4ef6\u5305\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3a /var/lib/kudu/master \uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 fs_wal_dir \u548c fs_data_dirs \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u81ea\u5b9a\u4e49\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u5c06 fs_data_dirs \u8bbe\u7f6e\u4e3a\u9664 fs_wal_dir \u503c\u4e4b\u5916\u7684\u67d0\u4e9b\u76ee\u5f55\uff0c\u5219\u5e94\u5c06\u5176\u660e\u786e\u5305\u542b\u5728\u5176\u4e2d\u8fd8\u5305\u542b fs_wal_dir \u7684\u6bcf\u4e2a\u547d\u4ee4\u4e2d\u3002 \u8bc6\u522b\u548c\u8bb0\u5f55 master \u7684 UUID \u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u5b83\uff1a $ kudu fs dump uuid --fs_wal_dir=&lt;master_data_dir&gt; 2&gt;/dev/null master_data_dir \u6d3b\u7740 master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 \u793a\u4f8b $ kudu fs dump uuid --fs_wal_dir=/var/lib/kudu/master 2&gt;/dev/null 80a82c4b8a9f4c819bab744927ad765c \u5bf9 reference master \u6267\u884c\u4ee5\u4e0b\u51c6\u5907\u6b65\u9aa4\uff1a \u8bc6\u522b\u548c\u8bb0\u5f55\u4e3b\u6570\u636e\u6240\u5728\u7684\u76ee\u5f55\u3002\u5982\u679c\u4f7f\u7528 Kudu \u7cfb\u7edf\u8f6f\u4ef6\u5305\uff0c\u5219\u9ed8\u8ba4\u503c\u4e3a /var/lib/kudu/master \uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 fs_wal_dir \u548c fs_data_dirs \u914d\u7f6e\u53c2\u6570\u8fdb\u884c\u81ea\u5b9a\u4e49\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u5c06 fs_data_dirs \u8bbe\u7f6e\u4e3a\u9664 fs_wal_dir \u503c\u4e4b\u5916\u7684\u67d0\u4e9b\u76ee\u5f55\uff0c\u5219\u5e94\u5c06\u5176\u660e\u786e\u5305\u542b\u5728\u5176\u4e2d\u8fd8\u5305\u542b fs_wal_dir \u7684\u6bcf\u4e2a\u547d\u4ee4\u4e2d\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8bc6\u522b\u5e76\u8bb0\u5f55\u96c6\u7fa4\u4e2d\u6bcf\u4e2a master \u7684 UUID \uff1a $ kudu local_replica cmeta print_replica_uuids --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; 2&gt;/dev/null master_data_dir reference master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 \u793a\u4f8b $ kudu local_replica cmeta print_replica_uuids --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 2&gt;/dev/null 80a82c4b8a9f4c819bab744927ad765c 2a73eeee5d47413981d9a1c637cce170 1c3f3094256347528d02ec107466aef3 \u4f7f\u7528\u4ee5\u524d\u8bb0\u5f55\u7684\u4e24\u4e2a UUID \u5217\u8868\uff08\u4e00\u4e2a\u7528\u4e8e\u6240\u6709 live master \uff0c\u4e00\u4e2a\u7528\u4e8e\u6240\u6709 master \uff09\uff0c\u786e\u5b9a\u5e76\u8bb0\u5f55\uff08\u901a\u8fc7\u6d88\u9664\u5904\u7406\uff09 dead master \u7684 UUID \u3002","title":"\u4e3a\u6062\u590d\u505a\u51c6\u5907"},{"location":"6/#_6","text":"\u4f7f\u7528\u4ee5\u524d\u8bb0\u5f55\u7684 dead master \u4e3b\u673a\u7684 UUID \u683c\u5f0f\u5316 replacement master \u4e0a\u7684\u6570\u636e\u76ee\u5f55\u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e8f\u5217\uff1a $ kudu fs format --fs_wal_dir=&lt;master_data_dir&gt; --uuid=&lt;uuid&gt; master_data_dir replacement master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 uuid dead master \u4ee5\u524d\u8bb0\u5f55\u7684 UUID \u4f8b\u5b50 $ kudu fs format --fs_wal_dir=/var/lib/kudu/master --uuid=80a82c4b8a9f4c819bab744927ad765c \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06 master \u6570\u636e\u590d\u5236\u5230 replacement master \uff1a $ kudu local_replica copy_from_remote --fs_wal_dir=&lt;master_data_dir&gt; &lt;tablet_id&gt; &lt;reference_master&gt; master_data_dir replacement master \u4ee5\u524d\u8bb0\u5f55\u7684\u6570\u636e\u76ee\u5f55 tablet_id \u5fc5\u987b\u662f\u5b57\u7b26\u4e32 00000000000000000000000000000000 reference_master reference_master \u7684 RPC \u5730\u5740\u5fc5\u987b\u662f <hostname>\uff1a<port> \u5f62\u5f0f\u7684\u5b57\u7b26\u4e32 hostname reference master \u4ee5\u524d\u8bb0\u5f55\u7684 hostname \u6216\u522b\u540d port reference master \u4e4b\u524d\u8bb0\u5f55\u7684 RPC \u7684\u7aef\u53e3\u53f7 \u793a\u4f8b $ kudu local_replica copy_from_remote --fs_wal_dir=/var/lib/kudu/master 00000000000000000000000000000000 master-2:7051 \u5982\u679c\u4f7f\u7528 CM \uff0c\u8bf7\u7acb\u5373\u6dfb\u52a0\u66ff\u6362\u7684 Kudu master role \uff0c\u4f46\u4e0d\u8981\u542f\u52a8\u5b83\u3002 \u4f7f\u7528 replacement master \u7684\u522b\u540d\u8986\u76d6 new role \u7684 \u201c Master Address\u201d \u53c2\u6570\u7684\u7a7a\u503c\u3002 \u5982\u679c\u4f7f\u7528\u975e\u9ed8\u8ba4 RPC \u7aef\u53e3\u503c\uff0c\u8bf7\u6dfb\u52a0\u7aef\u53e3\u53f7\uff08\u4ee5\u5192\u53f7\u5206\u9694\uff09\u3002 \u91cd\u65b0\u914d\u7f6e dead master \u7684 DNS \u522b\u540d\u4ee5\u6307\u5411 replacement master \u3002 \u542f\u52a8 replacement master \u3002 \u91cd\u65b0\u542f\u52a8\u73b0\u6709\u7684 live master \u3002\u8fd9\u5bfc\u81f4\u77ed\u6682\u7684\u53ef\u7528\u6027\u4e2d\u65ad\uff0c\u4f46\u662f\u53ea\u6709 masters \u56de\u6765\u624d\u80fd\u6301\u7eed\u3002 \u606d\u559c\uff0c dead master \u5df2\u7ecf\u88ab\u66ff\u6362\u4e86\uff01\u8981\u9a8c\u8bc1\u6240\u6709 master \u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u8bf7\u8003\u8651\u6267\u884c\u4ee5\u4e0b\u5065\u5eb7\u6027\u68c0\u67e5\uff1a \u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u6bcf\u4e2a master \u7684 Web UI \u3002\u770b\u770b /master page \u3002\u6240\u6709\u7684\u4e3b\u4eba\u90fd\u5e94\u8be5\u88ab\u5217\u5728\u90a3\u91cc\uff0c\u4e00\u4e2a master \u5728 LEADER \u89d2\u8272\uff0c\u5176\u4ed6\u7684\u5728 FOLLOWER \u89d2\u8272\u3002\u6bcf\u4e2a master \u7684 master \u7684\u5185\u5bb9\u5e94\u8be5\u662f\u4e00\u6837\u7684\u3002 \u4f7f\u7528 kudu \u547d\u4ee4\u884c\u5de5\u5177\u5728\u96c6\u7fa4\u4e0a\u8fd0\u884c Kudu \u7cfb\u7edf\u68c0\u67e5\uff08 ksck \uff09\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u4f7f\u7528 ksck \u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5 \u3002","title":"\u6267\u884c\u6062\u590d"},{"location":"6/#ksck","text":"kudu CLI \u5305\u62ec\u4e00\u4e2a\u540d\u4e3a ksck \u7684\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5\u548c\u6570\u636e\u5b8c\u6574\u6027\u3002 ksck \u4f1a\u53d1\u73b0\u95ee\u9898\uff0c\u5982\u526f\u672c\u4e0d\u8db3\u7684 tablet \uff0c\u65e0\u6cd5\u8fde\u63a5\u7684 tablet server \u6216\u6ca1\u6709 leader \u7684 tablet \u3002 \u5e94\u4ece\u547d\u4ee4\u884c\u8fd0\u884c ksck \uff0c\u5e76\u8981\u6c42\u6307\u5b9a master address \u7684\u5b8c\u6574\u5217\u8868\uff1a $ kudu cluster ksck master-01.example.com,master-02.example.com,master-03.example.com \u8981\u67e5\u770b ksck \u53ef\u7528\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u4f7f\u7528 --help \u6807\u5fd7\u3002\u5982\u679c\u96c6\u7fa4\u662f\u5065\u5eb7\u7684\uff0c ksck \u5c06\u6253\u5370\u6210\u529f\u6d88\u606f\uff0c\u5e76\u8fd4\u56de\u96f6\uff08\u6210\u529f\uff09\u9000\u51fa\u72b6\u6001\u3002 Connected to the Master Fetched info from all 1 Tablet Servers Table IntegrationTestBigLinkedList is HEALTHY (1 tablet(s) checked) The metadata for 1 table(s) is HEALTHY OK \u5982\u679c\u96c6\u7fa4\u4e0d\u5065\u5eb7\uff0c\u4f8b\u5982\uff0c\u5982\u679c tablet server \u8fdb\u7a0b\u5df2\u505c\u6b62\uff0c\u5219 ksck \u5c06\u62a5\u544a\u95ee\u9898\u5e76\u8fd4\u56de\u975e\u96f6\u9000\u51fa\u72b6\u6001\uff1a Connected to the Master WARNING: Unable to connect to Tablet Server 8a0b66a756014def82760a09946d1fce (tserver-01.example.com:7050): Network error: could not send Ping RPC to server: Client connection negotiation failed: client connection to 192.168.0.2:7050: connect: Connection refused (error 61) WARNING: Fetched info from 0 Tablet Servers, 1 weren't reachable Tablet ce3c2d27010d4253949a989b9d9bf43c of table 'IntegrationTestBigLinkedList' is unavailable: 1 replica(s) not RUNNING 8a0b66a756014def82760a09946d1fce (tserver-01.example.com:7050): TS unavailable [LEADER] Table IntegrationTestBigLinkedList has 1 unavailable tablet(s) WARNING: 1 out of 1 table(s) are not in a healthy state ================== Errors: ================== error fetching info from tablet servers: Network error: Not all Tablet Servers are reachable table consistency check error: Corruption: 1 table(s) are bad FAILED Runtime error: ksck discovered errors \u4e3a\u4e86\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u53ef\u9009\u7684 --checksum_scan \u6807\u5fd7\uff0c\u901a\u8fc7\u626b\u63cf\u6bcf\u4e2a tablet \u526f\u672c\u5e76\u6bd4\u8f83\u7ed3\u679c\uff0c\u53ef\u4ee5\u786e\u4fdd\u96c6\u7fa4\u5177\u6709\u4e00\u81f4\u7684\u6570\u636e\u3002 --tables \u6216 --tablets \u6807\u5fd7\u53ef\u7528\u4e8e\u5c06\u6821\u9a8c\u548c\u626b\u63cf\u7684\u8303\u56f4\u5206\u522b\u9650\u5236\u5728\u7279\u5b9a\u7684\u8868\u683c\u6216 tablet \u4e0a\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5bf9 IntegrationTestBigLinkedList \u8868\u4e0a\u7684\u6570\u636e\u5b8c\u6574\u6027\u8fdb\u884c\u68c0\u67e5\uff1a $ kudu cluster ksck --checksum_scan --tables IntegrationTestBigLinkedList master-01.example.com,master-02.example.com,master-03.example.com","title":"\u4f7f\u7528 ksck \u68c0\u67e5\u96c6\u7fa4\u8fd0\u884c\u72b6\u51b5"},{"location":"6/#_7","text":"Kudu tablet servers \u65e0\u6cd5\u6062\u590d\u78c1\u76d8\u6545\u969c\u3002\u5f53\u5305\u542b\u6570\u636e\u76ee\u5f55\u6216\u9884\u5199\u65e5\u5fd7\uff08 WAL \uff09\u7684\u78c1\u76d8\u6b7b\u673a\u65f6\uff0c\u5fc5\u987b\u91cd\u5efa\u6574\u4e2a tablet server \u3002\u5728 tablet server \u53d1\u751f\u6545\u969c\u540e\uff0c Kudu \u4f1a\u5728\u5176\u4ed6\u670d\u52a1\u5668\u4e0a\u81ea\u52a8\u91cd\u65b0\u590d\u5236 tablet \uff0c\u4f46\u9700\u8981\u624b\u52a8\u5e72\u9884\u624d\u80fd\u5c06\u5931\u8d25\u7684 tablet server \u8fd8\u539f\u5230\u8fd0\u884c\u72b6\u6001\u3002 \u5728\u78c1\u76d8\u6545\u969c\u540e\u6062\u590d tablet servers \u7684\u7b2c\u4e00\u6b65\u662f\u66f4\u6362\u53d1\u751f\u6545\u969c\u7684\u78c1\u76d8\uff0c\u6216\u4ece\u6570\u636e\u76ee\u5f55 and/or WAL \u914d\u7f6e\u4e2d\u5220\u9664\u51fa\u73b0\u6545\u969c\u7684\u78c1\u76d8\u3002\u63a5\u4e0b\u6765\uff0c\u5fc5\u987b\u5220\u9664\u6570\u636e\u76ee\u5f55\u548c WAL \u76ee\u5f55\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u5982\u679c tablet servers \u914d\u7f6e\u4e86 --fs_wal_dir = /data/0/kudu-tserver-wal \u548c --fs_data_dirs = /data/1/kudu-tserver/data/2/kudu-tserver \uff0c\u5219\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5220\u9664\u6570\u636e\u76ee\u5f55\u548c WAL \u76ee\u5f55\u5185\u5bb9\uff1a $ rm -rf /data/0/kudu-tserver-wal/* /data/1/kudu-tserver/* /data/2/kudu-tserver/* \u5728 WAL \u548c\u6570\u636e\u76ee\u5f55\u88ab\u6e05\u7a7a\u4e4b\u540e\uff0c\u53ef\u4ee5\u542f\u52a8 tablet servers \u8fdb\u7a0b\u3002\u5f53\u4f7f\u7528\u7cfb\u7edf\u5305\u5b89\u88c5 Kudu \u65f6\uff0c\u901a\u5e38\u4f7f\u7528\u670d\u52a1\uff1a $ sudo service kudu-tserver start \u4e00\u65e6 tablet servers \u518d\u6b21\u8fd0\u884c\uff0c\u5c31\u4f1a\u6839\u636e\u9700\u8981\u5728\u5176\u4e0a\u521b\u5efa\u65b0\u7684 tablet \u526f\u672c\u3002","title":"\u4ece\u78c1\u76d8\u6545\u969c\u6062\u590d"},{"location":"7/","text":"Kudu \u6545\u969c\u6392\u9664 \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/troubleshooting.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813626 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 \u542f\u52a8\u9519\u8bef Errors During Hole Punching Test ( \u7a7f\u900f\u6d4b\u8bd5\u4e2d\u7684\u9519\u8bef ) Kudu \u9700\u8981 hole punching capabilities ( \u7a7f\u900f\u80fd\u529b ) \u624d\u80fd\u6709\u6548\u3002\u7a7f\u900f\u652f\u6301\u53d6\u51b3\u4e8e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7248\u672c\u548c\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u3002 RHEL \u6216 CentOS 6.4 \u6216\u66f4\u9ad8\u7248\u672c\uff0c\u4fee\u8865\u5230 2.6.32-358 \u6216\u66f4\u9ad8\u7248\u672c\u7684\u5185\u6838\u7248\u672c\u3002\u672a\u914d\u7f6e\u7684 RHEL \u6216 CentOS 6.4 \u4e0d\u5305\u62ec\u652f\u6301\u7a7f\u900f\u7684\u5185\u6838\u3002 Ubuntu 14.04 \u5305\u62ec Linux \u5185\u6838\u7684 3.13 \u7248\u672c\uff0c\u5b83\u652f\u6301\u6253\u5b54\u3002 \u8f83\u65b0\u7248\u672c\u7684 EXT4 \u6216 XFS \u6587\u4ef6\u7cfb\u7edf\u652f\u6301\u7a7f\u900f\uff0c\u4f46 EXT3 \u4e0d\u652f\u6301\u3002\u65e7\u7248\u672c\u7684 XFS \u4e0d\u652f\u6301\u7a7f\u900f\u8fd4\u56de EOPNOTSUPP \uff08\u64cd\u4f5c\u4e0d\u652f\u6301\uff09\u9519\u8bef\u3002\u4e0d\u652f\u6301\u7a7f\u900f\u7684 EXT4 \u6216 XFS \u7684\u8f83\u65e7\u7248\u672c\u4f1a\u5bfc\u81f4 Kudu \u53d1\u51fa\u4ee5\u4e0b\u9519\u8bef\u6d88\u606f\uff0c\u5e76\u4e14\u65e0\u6cd5\u542f\u52a8\uff1a \u7a7f\u900f\u8bd5\u9a8c\u65f6\u51fa\u9519\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u9700\u8981\u4e00\u4e2a\u5177\u6709\u7a7f\u900f\u652f\u6301\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982 ext4 \u6216 xfs \u3002\u5728 el6 \u4e0a\uff0c\u5185\u6838\u7248\u672c 2.6.32-358 \u6216\u66f4\u65b0\u7248\u672c\u662f\u5fc5\u9700\u7684\u3002\u4e0d\u4f7f\u7528\u7a7f\u900f\u65f6\uff08\u4ee5\u67d0\u79cd\u6548\u7387\u548c\u53ef\u6269\u5c55\u6027\u4e3a\u4ee3\u4ef7\uff09\uff0c\u91cd\u65b0\u914d\u7f6e Kudu \u4e0e --block_manager = file \u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Kudu \u6587\u6863\u7ec6\u8282\u3002\u539f\u59cb\u9519\u8bef\u6d88\u606f\u5982\u4e0b\u3002 \u6ca1\u6709\u7a7f\u900f\u652f\u6301\uff0c\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u4e0d\u5b89\u5168\u4f7f\u7528\u3002\u5b83\u4e0d\u4f1a\u5220\u9664\u5757\uff0c\u5e76\u5c06\u6d88\u8017\u66f4\u591a\u7684\u78c1\u76d8\u7a7a\u95f4\u3002 \u5373\u4f7f\u4f60\u7684\u73af\u5883\u4e2d\u65e0\u6cd5\u4f7f\u7528\u7a7f\u900f\uff0c\u4f60\u4ecd\u7136\u53ef\u4ee5\u5c1d\u8bd5 Kudu \u3002\u901a\u8fc7\u5c06 --block_manager = file \u6807\u5fd7\u6dfb\u52a0\u5230\u7528\u4e8e\u542f\u52a8\u4e3b\u670d\u52a1\u5668\u548c tablet server \u7684\u547d\u4ee4\uff0c\u542f\u7528\u6587\u4ef6\u5757\u7ba1\u7406\u5668\u800c\u4e0d\u662f\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u3002\u6587\u4ef6\u5757\u7ba1\u7406\u5668\u4e0d\u4f1a\u4e0e\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u4e00\u6837\u7f29\u653e\u3002 \u6ce8\u610f \u7531\u4e8e\u6587\u4ef6\u5757\u7ba1\u7406\u5668\u7684\u89c4\u6a21\u548c\u6027\u80fd\u4e0d\u4f73\uff0c\u53ea\u80fd\u7528\u4e8e\u5c0f\u89c4\u6a21\u7684\u8bc4\u4f30\u548c\u5f00\u53d1\u3002 NTP Clock Synchronization ( NTP \u65f6\u949f\u540c\u6b65 ) \u5bf9\u4e8e\u4e3b\u670d\u52a1\u5668\u548c\u5e73\u677f\u7535\u8111\u670d\u52a1\u5668\u5b88\u62a4\u7a0b\u5e8f\uff0c\u5fc5\u987b\u4f7f\u7528 NTP \u540c\u6b65\u670d\u52a1\u5668\u7684\u65f6\u949f\u3002\u53e6\u5916\uff0c\u6700\u5927\u65f6\u949f\u8bef\u5dee\uff08\u4e0d\u8981\u8bef\u4f30\u4e3a\u8bef\u5dee\uff09\u4f4e\u4e8e\u53ef\u914d\u7f6e\u7684\u9608\u503c\u3002\u9ed8\u8ba4\u503c\u4e3a 10 \u79d2\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u6807\u5fd7 --max_clock_sync_error_usec \u8bbe\u7f6e\u3002 \u5982\u679c\u672a\u5b89\u88c5 NTP \uff0c\u6216\u8005\u5982\u679c\u65f6\u949f\u88ab\u62a5\u544a\u4e3a\u4e0d\u540c\u6b65\uff0c\u5219 Kudu \u5c06\u4e0d\u4f1a\u542f\u52a8\uff0c\u5e76\u4f1a\u53d1\u51fa\u5982\u4e0b\u6d88\u606f\uff1a F0924 20:24:36.336809 14550 hybrid_clock.cc:191 Couldn't get the current time: Clock unsynchronized. Status: Service unavailable: Error reading clock. Clock considered unsynchronized. \u5982\u679c NTP \u5b89\u88c5\u5e76\u540c\u6b65\uff0c\u4f46\u6700\u5927\u65f6\u949f\u9519\u8bef\u592a\u9ad8\uff0c\u7528\u6237\u5c06\u770b\u5230\u5982\u4e0b\u6d88\u606f\uff1a Sep 17, 8:13:09.873 PM FATAL hybrid_clock.cc:196 Couldn't get the current time: Clock synchronized, but error: 11130000, is past the maximum allowable error: 10000000 \u6216\u8005 Sep 17, 8:32:31.135 PM FATAL tablet_server_main.cc:38 Check failed: _s.ok() Bad status: Service unavailable: Cannot initialize clock: Cannot initialize HybridClock. Clock synchronized but error was too high (11711000 us). \u91cd\u8981 \u5982\u679c\u5df2\u5b89\u88c5 NTP \uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c ntptime \u6765\u76d1\u89c6\u540c\u6b65\u72b6\u6001\u3002\u76f8\u5173\u503c\u662f\u62a5\u544a\u7684\u6700\u5927\u8bef\u5dee\u3002 \u8981\u5b89\u88c5 NTP \uff0c\u8bf7\u5bf9\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u76f8\u5e94\u7684\u547d\u4ee4\uff1a OS ( \u64cd\u4f5c\u7cfb\u7edf ) Command ( \u547d\u4ee4 ) Debian/Ubuntu sudo apt-get install ntp RHEL/CentOS sudo yum install ntp \u5982\u679c NTP \u5df2\u5b89\u88c5\u4f46\u672a\u8fd0\u884c\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\u542f\u52a8\u5b83\uff1a OS ( \u64cd\u4f5c\u7cfb\u7edf ) Command ( \u547d\u4ee4 ) Debian/Ubuntu sudo service ntp restart RHEL/CentOS sudo /etc/init.d/ntpd restart \u91cd\u8981 NTP \u9700\u8981\u7f51\u7edc\u8fde\u63a5\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u540c\u6b65\u65f6\u949f\u3002 \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u70b9\u7f51\u7edc\u8fde\u63a5\u53ef\u80fd\u4f7f NTP \u5c06\u65f6\u949f\u62a5\u544a\u4e3a\u4e0d\u540c\u6b65\u3002 \u4e00\u4e2a\u5e38\u89c1\u7684\uff0c\u867d\u7136\u4e34\u65f6\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u4f7f\u7528\u4e0a\u8ff0\u547d\u4ee4\u91cd\u65b0\u542f\u52a8 NTP \u3002 \u5982\u679c\u65f6\u949f\u88ab NTP \u62a5\u544a\u4e3a\u540c\u6b65\uff0c\u4f46\u662f\u6700\u5927\u8bef\u5dee\u592a\u9ad8\uff0c\u5219\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u4e0a\u8ff0\u6807\u5fd7\u6765\u5c06\u9608\u503c\u589e\u52a0\u5230\u66f4\u9ad8\u7684\u503c\u3002 \u4f8b\u5982\uff0c\u5c06\u53ef\u80fd\u7684\u6700\u5927\u8bef\u5dee\u589e\u52a0\u5230 20 \u79d2\uff0c\u6807\u5fd7\u5e94\u8be5\u5982\u4e0b\u8bbe\u7f6e\uff1a --max_clock_sync_error_usec = 20000000 \u62a5\u544a Kudu \u5d29\u6e83 Kudu \u5728 Kudu \u9047\u5230\u5d29\u6e83\u65f6\u4f7f\u7528 Google Breakpad \u5e93\u6765\u751f\u6210 minidump \u3002\u8fd9\u4e9b minidumps \u7684\u5927\u5c0f\u901a\u5e38\u53ea\u6709\u51e0 MB \uff0c\u5373\u4f7f\u7981\u7528\u4e86\u6838\u5fc3\u8f6c\u50a8\u751f\u6210\u4e5f\u4f1a\u751f\u6210\u8fd9\u4e9b\u3002\u5728\u8fd9\u4e2a\u65f6\u5019\uff0c\u53ea\u80fd\u5728 Kudu \u7684 Linux \u4e0a\u751f\u6210 minidumps \u3002 minidump \u6587\u4ef6\u5305\u542b\u6709\u5173\u5d29\u6e83\u7684\u8fdb\u7a0b\u7684\u91cd\u8981\u8c03\u8bd5\u4fe1\u606f\uff0c\u5305\u62ec\u52a0\u8f7d\u7684\u5171\u4eab\u5e93\u53ca\u5176\u7248\u672c\uff0c\u5d29\u6e83\u65f6\u8fd0\u884c\u7684\u7ebf\u7a0b\u5217\u8868\uff0c\u5904\u7406\u5668\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u548c\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5806\u6808\u5185\u5b58\u526f\u672c\uff0c\u4ee5\u53ca CPU \u548c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u4fe1\u606f\u3002 \u4e5f\u53ef\u4ee5\u5f3a\u5236 Kudu \u901a\u8fc7\u5411 kudu-tserver \u6216 kudu-master \u8fdb\u7a0b\u53d1\u9001 USR1 \u4fe1\u53f7\u6765\u521b\u5efa\u4e00\u4e2a minidump \uff0c\u800c\u4e0d\u4f1a\u6740\u6b7b\u8fdb\u7a0b\u3002\u4f8b\u5982\uff1a sudo pkill -USR1 kudu-tserver \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c Kudu \u5c06\u5176 minidum \u5b58\u50a8\u5728\u5176\u914d\u7f6e\u7684\u540d\u4e3a minidumps \u7684 glog \u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e --minidump_path \u6807\u5fd7\u6765\u5b9a\u5236\u8be5\u4f4d\u7f6e\u3002\u5728\u5220\u9664\u6700\u65e7\u7684\u4e4b\u524d\uff0c Kudu \u5c06\u53ea\u4fdd\u7559\u4e00\u5b9a\u6570\u91cf\u7684 minidumps \uff0c\u4ee5\u907f\u514d\u7528 minidump \u6587\u4ef6\u586b\u6ee1\u78c1\u76d8\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e --max_minidumps gflag \u6765\u63a7\u5236\u5c06\u4fdd\u7559\u7684\u6700\u5c0f\u6570\u91cf\u3002 Minidumps \u5305\u542b\u7279\u5b9a\u4e8e\u521b\u5efa\u5b83\u4eec\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u56e0\u6b64\u5728\u4e0d\u8bbf\u95ee\u5d29\u6e83\u7684\u786e\u5207\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b\u4e0d\u53ef\u7528\uff0c\u6216\u8005\u975e\u5e38\u76f8\u4f3c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u91cd\u8981 Minitump \u53ef\u4ee5\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u7ed9 Kudu \u5f00\u53d1\u4eba\u5458\u6216\u9644\u52a0\u5230 JIRA \uff0c\u4ee5\u5e2e\u52a9 Kudu \u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u5d29\u6e83\u3002\u4e3a\u4e86\u4f7f\u5176\u6709\u7528\uff0c\u5f00\u53d1\u4eba\u5458\u5c06\u9700\u8981\u77e5\u9053 Kudu \u7684\u786e\u5207\u7248\u672c\u548c\u53d1\u751f\u5d29\u6e83\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\u8bf7\u6ce8\u610f\uff0c\u867d\u7136 minidump \u4e0d\u5305\u542b\u5806\u5185\u5b58\u8f6c\u50a8\uff0c\u4f46\u5b83\u786e\u5b9e\u5305\u542b\u5806\u6808\u5185\u5b58\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u663e\u793a\u5728 minidump \u4e2d\u3002\u5982\u679c\u673a\u5bc6\u6216\u4e2a\u4eba\u4fe1\u606f\u5b58\u50a8\u5728\u7fa4\u96c6\u4e0a\uff0c\u8bf7\u4e0d\u8981\u5171\u4eab minidump \u6587\u4ef6\u3002 \u6027\u80fd\u6545\u969c\u6392\u9664 Kudu\u8ffd\u8e2a kudu-master \u548c kudu-tserver \u5b88\u62a4\u8fdb\u7a0b\u5305\u62ec\u57fa\u4e8e\u5f00\u6e90 Chromium \u8ddf\u8e2a\u6846\u67b6\u7684\u5185\u7f6e\u8ddf\u8e2a\u652f\u6301\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u8ddf\u8e2a\u6765\u5e2e\u52a9\u8bca\u65ad\u5ef6\u8fdf\u95ee\u9898\u6216 Kudu \u670d\u52a1\u5668\u4e0a\u7684\u5176\u4ed6\u95ee\u9898\u3002 \u8bbf\u95ee\u8ddf\u8e2a\u754c\u9762 \u6bcf\u4e2a Kudu \u5b88\u62a4\u8fdb\u7a0b\u4e2d\uff0c\u8ddf\u8e2a\u754c\u9762\u662f\u901a\u8fc7 Web \u6d4f\u89c8\u5668\u8bbf\u95ee\u5d4c\u5165\u5f0f Web \u670d\u52a1\u5668\u7684\u4e00\u90e8\u5206\u3002 \u8868 1. \u8ddf\u8e2a\u754c\u9762 URL Daemon ( \u5b88\u62a4\u8fdb\u7a0b ) URL Tablet Server http://tablet-server-1.example.com:8050/tracing.html Master http://master-1.example.com:8051/tracing.html \u6ce8\u610f \u5df2\u77e5\u8ddf\u8e2a\u754c\u9762\u9002\u7528\u4e8e\u6700\u65b0\u7248\u672c\u7684 Google Chrome \u3002\u5176\u4ed6\u6d4f\u89c8\u5668\u53ef\u80fd\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002 Collecting a trace ( \u6536\u96c6\u75d5\u8ff9 ) \u5bfc\u822a\u5230\u8ddf\u8e2a\u754c\u9762\u540e\uff0c\u5355\u51fb\u5c4f\u5e55\u5de6\u4e0a\u89d2\u7684\u8bb0\u5f55\u6309\u94ae\u3002\u5f53\u5f00\u59cb\u8bca\u65ad\u95ee\u9898\u65f6\uff0c\u9996\u5148\u9009\u62e9\u6240\u6709\u7c7b\u522b\u3002\u5355\u51fb\u8bb0\u5f55\u5f00\u59cb\u8bb0\u5f55\u8ddf\u8e2a\u3002 \u5728\u8ddf\u8e2a\u6536\u96c6\u671f\u95f4\uff0c\u4e8b\u4ef6\u88ab\u6536\u96c6\u5230\u5185\u5b58\u4e2d\u7684\u73af\u5f62\u7f13\u51b2\u533a\u4e2d\u3002\u8be5\u73af\u5f62\u7f13\u51b2\u5668\u7684\u5927\u5c0f\u56fa\u5b9a\uff0c\u6700\u7ec8\u53ef\u4ee5\u8fbe\u5230100\uff05\u3002\u4f46\u662f\uff0c\u5728\u5220\u9664\u65e7\u4e8b\u4ef6\u7684\u540c\u65f6\uff0c\u4ecd\u7136\u6536\u96c6\u65b0\u7684\u4e8b\u4ef6\u3002\u8bb0\u5f55\u8ddf\u8e2a\u65f6\uff0c\u89e6\u53d1\u60a8\u6709\u5174\u8da3\u63a2\u7d22\u7684\u884c\u4e3a\u6216\u5de5\u4f5c\u8d1f\u8f7d\u3002 \u6536\u96c6\u6570\u79d2\u540e\uff0c\u5355\u51fb\u505c\u6b62\u3002\u6536\u96c6\u7684\u8e2a\u8ff9\u5c06\u88ab\u4e0b\u8f7d\u5e76\u663e\u793a\u3002\u4f7f\u7528 \uff1f\u952e\u663e\u793a\u6709\u5173\u4f7f\u7528\u8ddf\u8e2a\u754c\u9762\u63a2\u7d22\u8ddf\u8e2a\u7684\u5e2e\u52a9\u6587\u672c\u3002 Saving a trace ( \u4fdd\u5b58\u75d5\u8ff9 ) \u60a8\u53ef\u4ee5\u5c06\u6536\u96c6\u7684\u75d5\u8ff9\u4fdd\u5b58\u4e3a JSON \u6587\u4ef6\uff0c\u4ee5\u4fbf\u4ee5\u540e\u5206\u6790\uff0c\u7136\u540e\u5728\u6536\u96c6\u8ddf\u8e2a\u540e\u5355\u51fb\u201c\u4fdd\u5b58\u201d\u3002\u8981\u52a0\u8f7d\u548c\u5206\u6790\u4fdd\u5b58\u7684 JSON \u6587\u4ef6\uff0c\u8bf7\u5355\u51fb\u52a0\u8f7d\u5e76\u9009\u62e9\u6587\u4ef6\u3002 RPC Timeout Traces ( RPC\u8d85\u65f6\u8ddf\u8e2a ) \u5982\u679c\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u9047\u5230 RPC \u8d85\u65f6\uff0c Kudu tablet servers WARNING \u7ea7\u522b\u65e5\u5fd7\u5e94\u5305\u542b\u5305\u542b RPC \u7ea7\u522b\u8ddf\u8e2a\u7684\u65e5\u5fd7\u6761\u76ee\u3002\u4f8b\u5982\uff1a W0922 00:56:52.313848 10858 inbound_call.cc:193] Call kudu.consensus.ConsensusService.UpdateConsensus from 192.168.1.102:43499 (request call id 3555909) took 1464ms (client timeout 1000). W0922 00:56:52.314888 10858 inbound_call.cc:197] Trace: 0922 00:56:50.849505 (+ 0us) service_pool.cc:97] Inserting onto call queue 0922 00:56:50.849527 (+ 22us) service_pool.cc:158] Handling call 0922 00:56:50.849574 (+ 47us) raft_consensus.cc:1008] Updating replica for 2 ops 0922 00:56:50.849628 (+ 54us) raft_consensus.cc:1050] Early marking committed up to term: 8 index: 880241 0922 00:56:50.849968 (+ 340us) raft_consensus.cc:1056] Triggering prepare for 2 ops 0922 00:56:50.850119 (+ 151us) log.cc:420] Serialized 1555 byte log entry 0922 00:56:50.850213 (+ 94us) raft_consensus.cc:1131] Marking committed up to term: 8 index: 880241 0922 00:56:50.850218 (+ 5us) raft_consensus.cc:1148] Updating last received op as term: 8 index: 880243 0922 00:56:50.850219 (+ 1us) raft_consensus.cc:1195] Filling consensus response to leader. 0922 00:56:50.850221 (+ 2us) raft_consensus.cc:1169] Waiting on the replicates to finish logging 0922 00:56:52.313763 (+1463542us) raft_consensus.cc:1182] finished 0922 00:56:52.313764 (+ 1us) raft_consensus.cc:1190] UpdateReplicas() finished 0922 00:56:52.313788 (+ 24us) inbound_call.cc:114] Queueing success response \u8fd9\u4e9b\u8ddf\u8e2a\u53ef\u4ee5\u6307\u793a\u8bf7\u6c42\u7684\u54ea\u4e2a\u90e8\u5206\u7f13\u6162\u3002 \u8bf7\u5c06\u5b83\u4eec\u5305\u542b\u5728\u4e0e RPC \u5ef6\u8fdf\u5f02\u5e38\u503c\u76f8\u5173\u7684\u9519\u8bef\u62a5\u544a\u4e2d\u3002 Kernel Stack Watchdog Traces ( \u5185\u6838\u5806\u6808\u770b\u95e8\u72d7\u8ddf\u8e2a ) \u6bcf\u4e2a Kudu \u670d\u52a1\u5668\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u79f0\u4e3a Stack Watchdog \u7684\u540e\u53f0\u7ebf\u7a0b\uff0c\u5b83\u76d1\u89c6\u670d\u52a1\u5668\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\uff0c\u4ee5\u9632\u5b83\u4eec\u88ab\u963b\u585e\u8d85\u8fc7\u9884\u671f\u7684\u65f6\u95f4\u6bb5\u3002 \u8fd9\u4e9b\u8ddf\u8e2a\u53ef\u4ee5\u6307\u793a\u64cd\u4f5c\u7cfb\u7edf\u95ee\u9898\u6216\u74f6\u9888\u5b58\u50a8\u3002 \u5f53\u770b\u95e8\u72d7\u7ebf\u7a0b\u8bc6\u522b\u7ebf\u7a0b\u963b\u585e\u7684\u60c5\u51b5\u65f6\uff0c\u5b83\u4f1a\u5728 WARNING \u65e5\u5fd7\u4e2d\u8bb0\u5f55\u4e00\u4e2a\u6761\u76ee\uff0c\u5982\u4e0b\u6240\u793a\uff1a W0921 23:51:54.306350 10912 kernel_stack_watchdog.cc:111] Thread 10937 stuck at /data/kudu/consensus/log.cc:505 for 537ms: Kernel stack: [<ffffffffa00b209d>] do_get_write_access+0x29d/0x520 [jbd2] [<ffffffffa00b2471>] jbd2_journal_get_write_access+0x31/0x50 [jbd2] [<ffffffffa00fe6d8>] __ext4_journal_get_write_access+0x38/0x80 [ext4] [<ffffffffa00d9b23>] ext4_reserve_inode_write+0x73/0xa0 [ext4] [<ffffffffa00d9b9c>] ext4_mark_inode_dirty+0x4c/0x1d0 [ext4] [<ffffffffa00d9e90>] ext4_dirty_inode+0x40/0x60 [ext4] [<ffffffff811ac48b>] __mark_inode_dirty+0x3b/0x160 [<ffffffff8119c742>] file_update_time+0xf2/0x170 [<ffffffff8111c1e0>] __generic_file_aio_write+0x230/0x490 [<ffffffff8111c4c8>] generic_file_aio_write+0x88/0x100 [<ffffffffa00d3fb1>] ext4_file_write+0x61/0x1e0 [ext4] [<ffffffff81180f5b>] do_sync_readv_writev+0xfb/0x140 [<ffffffff81181ee6>] do_readv_writev+0xd6/0x1f0 [<ffffffff81182046>] vfs_writev+0x46/0x60 [<ffffffff81182102>] sys_pwritev+0xa2/0xc0 [<ffffffff8100b072>] system_call_fastpath+0x16/0x1b [<ffffffffffffffff>] 0xffffffffffffffff User stack: @ 0x3a1ace10c4 (unknown) @ 0x1262103 (unknown) @ 0x12622d4 (unknown) @ 0x12603df (unknown) @ 0x8e7bfb (unknown) @ 0x8f478b (unknown) @ 0x8f55db (unknown) @ 0x12a7b6f (unknown) @ 0x3a1b007851 (unknown) @ 0x3a1ace894d (unknown) @ (nil) (unknown) \u8fd9\u4e9b\u8ddf\u8e2a\u53ef\u7528\u4e8e\u8bca\u65ad\u6839\u6e90\u4e8e\u5ef6\u8fdf\u95ee\u9898\uff08\u7531 Kudu \u4ee5\u4e0b\u7684\u7cfb\u7edf\u5f15\u8d77\uff09\uff0c\u5982\u78c1\u76d8\u63a7\u5236\u5668\u6216\u6587\u4ef6\u7cfb\u7edf\u3002 \u4f7f\u7528 Kudu \u7684\u95ee\u9898 ClassNotFoundException\uff1acom.cloudera.kudu.hive.KuduStorageHandler \u5c1d\u8bd5\u901a\u8fc7 Hive \u4f7f\u7528 Kudu \u8868\u65f6\uff0c\u7528\u6237\u5c06\u9047\u5230\u6b64\u5f02\u5e38\u3002 \u8fd9\u4e0d\u662f\u4e00\u4e2a\u4e22\u5931\u7684 jar \u7684\u60c5\u51b5\uff0c\u800c\u53ea\u662f Impala \u5c06 Hive \u4e2d\u7684 Kudu \u5143\u6570\u636e\u5b58\u50a8\u5728\u5176\u4ed6\u5de5\u5177\uff08\u5305\u62ec Hive \u672c\u8eab\u548c Spark \uff09\u4e2d\u65e0\u6cd5\u8bfb\u53d6\u7684\u683c\u5f0f\u3002 Hive \u7528\u6237\u6ca1\u6709\u89e3\u51b3\u65b9\u6cd5\u3002 Spark \u7528\u6237\u9700\u8981\u521b\u5efa\u4e34\u65f6\u8868\u3002","title":"Kudu \u6545\u969c\u6392\u9664"},{"location":"7/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/troubleshooting.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813626 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu \u6545\u969c\u6392\u9664"},{"location":"7/#_1","text":"","title":"\u542f\u52a8\u9519\u8bef"},{"location":"7/#errors-during-hole-punching-test","text":"Kudu \u9700\u8981 hole punching capabilities ( \u7a7f\u900f\u80fd\u529b ) \u624d\u80fd\u6709\u6548\u3002\u7a7f\u900f\u652f\u6301\u53d6\u51b3\u4e8e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7248\u672c\u548c\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u3002 RHEL \u6216 CentOS 6.4 \u6216\u66f4\u9ad8\u7248\u672c\uff0c\u4fee\u8865\u5230 2.6.32-358 \u6216\u66f4\u9ad8\u7248\u672c\u7684\u5185\u6838\u7248\u672c\u3002\u672a\u914d\u7f6e\u7684 RHEL \u6216 CentOS 6.4 \u4e0d\u5305\u62ec\u652f\u6301\u7a7f\u900f\u7684\u5185\u6838\u3002 Ubuntu 14.04 \u5305\u62ec Linux \u5185\u6838\u7684 3.13 \u7248\u672c\uff0c\u5b83\u652f\u6301\u6253\u5b54\u3002 \u8f83\u65b0\u7248\u672c\u7684 EXT4 \u6216 XFS \u6587\u4ef6\u7cfb\u7edf\u652f\u6301\u7a7f\u900f\uff0c\u4f46 EXT3 \u4e0d\u652f\u6301\u3002\u65e7\u7248\u672c\u7684 XFS \u4e0d\u652f\u6301\u7a7f\u900f\u8fd4\u56de EOPNOTSUPP \uff08\u64cd\u4f5c\u4e0d\u652f\u6301\uff09\u9519\u8bef\u3002\u4e0d\u652f\u6301\u7a7f\u900f\u7684 EXT4 \u6216 XFS \u7684\u8f83\u65e7\u7248\u672c\u4f1a\u5bfc\u81f4 Kudu \u53d1\u51fa\u4ee5\u4e0b\u9519\u8bef\u6d88\u606f\uff0c\u5e76\u4e14\u65e0\u6cd5\u542f\u52a8\uff1a \u7a7f\u900f\u8bd5\u9a8c\u65f6\u51fa\u9519\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u9700\u8981\u4e00\u4e2a\u5177\u6709\u7a7f\u900f\u652f\u6301\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982 ext4 \u6216 xfs \u3002\u5728 el6 \u4e0a\uff0c\u5185\u6838\u7248\u672c 2.6.32-358 \u6216\u66f4\u65b0\u7248\u672c\u662f\u5fc5\u9700\u7684\u3002\u4e0d\u4f7f\u7528\u7a7f\u900f\u65f6\uff08\u4ee5\u67d0\u79cd\u6548\u7387\u548c\u53ef\u6269\u5c55\u6027\u4e3a\u4ee3\u4ef7\uff09\uff0c\u91cd\u65b0\u914d\u7f6e Kudu \u4e0e --block_manager = file \u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Kudu \u6587\u6863\u7ec6\u8282\u3002\u539f\u59cb\u9519\u8bef\u6d88\u606f\u5982\u4e0b\u3002 \u6ca1\u6709\u7a7f\u900f\u652f\u6301\uff0c\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u4e0d\u5b89\u5168\u4f7f\u7528\u3002\u5b83\u4e0d\u4f1a\u5220\u9664\u5757\uff0c\u5e76\u5c06\u6d88\u8017\u66f4\u591a\u7684\u78c1\u76d8\u7a7a\u95f4\u3002 \u5373\u4f7f\u4f60\u7684\u73af\u5883\u4e2d\u65e0\u6cd5\u4f7f\u7528\u7a7f\u900f\uff0c\u4f60\u4ecd\u7136\u53ef\u4ee5\u5c1d\u8bd5 Kudu \u3002\u901a\u8fc7\u5c06 --block_manager = file \u6807\u5fd7\u6dfb\u52a0\u5230\u7528\u4e8e\u542f\u52a8\u4e3b\u670d\u52a1\u5668\u548c tablet server \u7684\u547d\u4ee4\uff0c\u542f\u7528\u6587\u4ef6\u5757\u7ba1\u7406\u5668\u800c\u4e0d\u662f\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u3002\u6587\u4ef6\u5757\u7ba1\u7406\u5668\u4e0d\u4f1a\u4e0e\u65e5\u5fd7\u5757\u7ba1\u7406\u5668\u4e00\u6837\u7f29\u653e\u3002 \u6ce8\u610f \u7531\u4e8e\u6587\u4ef6\u5757\u7ba1\u7406\u5668\u7684\u89c4\u6a21\u548c\u6027\u80fd\u4e0d\u4f73\uff0c\u53ea\u80fd\u7528\u4e8e\u5c0f\u89c4\u6a21\u7684\u8bc4\u4f30\u548c\u5f00\u53d1\u3002","title":"Errors During Hole Punching Test ( \u7a7f\u900f\u6d4b\u8bd5\u4e2d\u7684\u9519\u8bef )"},{"location":"7/#ntp-clock-synchronization-ntp","text":"\u5bf9\u4e8e\u4e3b\u670d\u52a1\u5668\u548c\u5e73\u677f\u7535\u8111\u670d\u52a1\u5668\u5b88\u62a4\u7a0b\u5e8f\uff0c\u5fc5\u987b\u4f7f\u7528 NTP \u540c\u6b65\u670d\u52a1\u5668\u7684\u65f6\u949f\u3002\u53e6\u5916\uff0c\u6700\u5927\u65f6\u949f\u8bef\u5dee\uff08\u4e0d\u8981\u8bef\u4f30\u4e3a\u8bef\u5dee\uff09\u4f4e\u4e8e\u53ef\u914d\u7f6e\u7684\u9608\u503c\u3002\u9ed8\u8ba4\u503c\u4e3a 10 \u79d2\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u6807\u5fd7 --max_clock_sync_error_usec \u8bbe\u7f6e\u3002 \u5982\u679c\u672a\u5b89\u88c5 NTP \uff0c\u6216\u8005\u5982\u679c\u65f6\u949f\u88ab\u62a5\u544a\u4e3a\u4e0d\u540c\u6b65\uff0c\u5219 Kudu \u5c06\u4e0d\u4f1a\u542f\u52a8\uff0c\u5e76\u4f1a\u53d1\u51fa\u5982\u4e0b\u6d88\u606f\uff1a F0924 20:24:36.336809 14550 hybrid_clock.cc:191 Couldn't get the current time: Clock unsynchronized. Status: Service unavailable: Error reading clock. Clock considered unsynchronized. \u5982\u679c NTP \u5b89\u88c5\u5e76\u540c\u6b65\uff0c\u4f46\u6700\u5927\u65f6\u949f\u9519\u8bef\u592a\u9ad8\uff0c\u7528\u6237\u5c06\u770b\u5230\u5982\u4e0b\u6d88\u606f\uff1a Sep 17, 8:13:09.873 PM FATAL hybrid_clock.cc:196 Couldn't get the current time: Clock synchronized, but error: 11130000, is past the maximum allowable error: 10000000 \u6216\u8005 Sep 17, 8:32:31.135 PM FATAL tablet_server_main.cc:38 Check failed: _s.ok() Bad status: Service unavailable: Cannot initialize clock: Cannot initialize HybridClock. Clock synchronized but error was too high (11711000 us). \u91cd\u8981 \u5982\u679c\u5df2\u5b89\u88c5 NTP \uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c ntptime \u6765\u76d1\u89c6\u540c\u6b65\u72b6\u6001\u3002\u76f8\u5173\u503c\u662f\u62a5\u544a\u7684\u6700\u5927\u8bef\u5dee\u3002 \u8981\u5b89\u88c5 NTP \uff0c\u8bf7\u5bf9\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u76f8\u5e94\u7684\u547d\u4ee4\uff1a OS ( \u64cd\u4f5c\u7cfb\u7edf ) Command ( \u547d\u4ee4 ) Debian/Ubuntu sudo apt-get install ntp RHEL/CentOS sudo yum install ntp \u5982\u679c NTP \u5df2\u5b89\u88c5\u4f46\u672a\u8fd0\u884c\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\u542f\u52a8\u5b83\uff1a OS ( \u64cd\u4f5c\u7cfb\u7edf ) Command ( \u547d\u4ee4 ) Debian/Ubuntu sudo service ntp restart RHEL/CentOS sudo /etc/init.d/ntpd restart \u91cd\u8981 NTP \u9700\u8981\u7f51\u7edc\u8fde\u63a5\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u540c\u6b65\u65f6\u949f\u3002 \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u70b9\u7f51\u7edc\u8fde\u63a5\u53ef\u80fd\u4f7f NTP \u5c06\u65f6\u949f\u62a5\u544a\u4e3a\u4e0d\u540c\u6b65\u3002 \u4e00\u4e2a\u5e38\u89c1\u7684\uff0c\u867d\u7136\u4e34\u65f6\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u4f7f\u7528\u4e0a\u8ff0\u547d\u4ee4\u91cd\u65b0\u542f\u52a8 NTP \u3002 \u5982\u679c\u65f6\u949f\u88ab NTP \u62a5\u544a\u4e3a\u540c\u6b65\uff0c\u4f46\u662f\u6700\u5927\u8bef\u5dee\u592a\u9ad8\uff0c\u5219\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u4e0a\u8ff0\u6807\u5fd7\u6765\u5c06\u9608\u503c\u589e\u52a0\u5230\u66f4\u9ad8\u7684\u503c\u3002 \u4f8b\u5982\uff0c\u5c06\u53ef\u80fd\u7684\u6700\u5927\u8bef\u5dee\u589e\u52a0\u5230 20 \u79d2\uff0c\u6807\u5fd7\u5e94\u8be5\u5982\u4e0b\u8bbe\u7f6e\uff1a --max_clock_sync_error_usec = 20000000","title":"NTP Clock Synchronization ( NTP \u65f6\u949f\u540c\u6b65\u00a0)"},{"location":"7/#kudu_1","text":"Kudu \u5728 Kudu \u9047\u5230\u5d29\u6e83\u65f6\u4f7f\u7528 Google Breakpad \u5e93\u6765\u751f\u6210 minidump \u3002\u8fd9\u4e9b minidumps \u7684\u5927\u5c0f\u901a\u5e38\u53ea\u6709\u51e0 MB \uff0c\u5373\u4f7f\u7981\u7528\u4e86\u6838\u5fc3\u8f6c\u50a8\u751f\u6210\u4e5f\u4f1a\u751f\u6210\u8fd9\u4e9b\u3002\u5728\u8fd9\u4e2a\u65f6\u5019\uff0c\u53ea\u80fd\u5728 Kudu \u7684 Linux \u4e0a\u751f\u6210 minidumps \u3002 minidump \u6587\u4ef6\u5305\u542b\u6709\u5173\u5d29\u6e83\u7684\u8fdb\u7a0b\u7684\u91cd\u8981\u8c03\u8bd5\u4fe1\u606f\uff0c\u5305\u62ec\u52a0\u8f7d\u7684\u5171\u4eab\u5e93\u53ca\u5176\u7248\u672c\uff0c\u5d29\u6e83\u65f6\u8fd0\u884c\u7684\u7ebf\u7a0b\u5217\u8868\uff0c\u5904\u7406\u5668\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u548c\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5806\u6808\u5185\u5b58\u526f\u672c\uff0c\u4ee5\u53ca CPU \u548c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u4fe1\u606f\u3002 \u4e5f\u53ef\u4ee5\u5f3a\u5236 Kudu \u901a\u8fc7\u5411 kudu-tserver \u6216 kudu-master \u8fdb\u7a0b\u53d1\u9001 USR1 \u4fe1\u53f7\u6765\u521b\u5efa\u4e00\u4e2a minidump \uff0c\u800c\u4e0d\u4f1a\u6740\u6b7b\u8fdb\u7a0b\u3002\u4f8b\u5982\uff1a sudo pkill -USR1 kudu-tserver \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c Kudu \u5c06\u5176 minidum \u5b58\u50a8\u5728\u5176\u914d\u7f6e\u7684\u540d\u4e3a minidumps \u7684 glog \u76ee\u5f55\u7684\u5b50\u76ee\u5f55\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e --minidump_path \u6807\u5fd7\u6765\u5b9a\u5236\u8be5\u4f4d\u7f6e\u3002\u5728\u5220\u9664\u6700\u65e7\u7684\u4e4b\u524d\uff0c Kudu \u5c06\u53ea\u4fdd\u7559\u4e00\u5b9a\u6570\u91cf\u7684 minidumps \uff0c\u4ee5\u907f\u514d\u7528 minidump \u6587\u4ef6\u586b\u6ee1\u78c1\u76d8\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e --max_minidumps gflag \u6765\u63a7\u5236\u5c06\u4fdd\u7559\u7684\u6700\u5c0f\u6570\u91cf\u3002 Minidumps \u5305\u542b\u7279\u5b9a\u4e8e\u521b\u5efa\u5b83\u4eec\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u56e0\u6b64\u5728\u4e0d\u8bbf\u95ee\u5d29\u6e83\u7684\u786e\u5207\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b\u4e0d\u53ef\u7528\uff0c\u6216\u8005\u975e\u5e38\u76f8\u4f3c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u91cd\u8981 Minitump \u53ef\u4ee5\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u7ed9 Kudu \u5f00\u53d1\u4eba\u5458\u6216\u9644\u52a0\u5230 JIRA \uff0c\u4ee5\u5e2e\u52a9 Kudu \u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u5d29\u6e83\u3002\u4e3a\u4e86\u4f7f\u5176\u6709\u7528\uff0c\u5f00\u53d1\u4eba\u5458\u5c06\u9700\u8981\u77e5\u9053 Kudu \u7684\u786e\u5207\u7248\u672c\u548c\u53d1\u751f\u5d29\u6e83\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\u8bf7\u6ce8\u610f\uff0c\u867d\u7136 minidump \u4e0d\u5305\u542b\u5806\u5185\u5b58\u8f6c\u50a8\uff0c\u4f46\u5b83\u786e\u5b9e\u5305\u542b\u5806\u6808\u5185\u5b58\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u663e\u793a\u5728 minidump \u4e2d\u3002\u5982\u679c\u673a\u5bc6\u6216\u4e2a\u4eba\u4fe1\u606f\u5b58\u50a8\u5728\u7fa4\u96c6\u4e0a\uff0c\u8bf7\u4e0d\u8981\u5171\u4eab minidump \u6587\u4ef6\u3002","title":"\u62a5\u544a Kudu \u5d29\u6e83"},{"location":"7/#_2","text":"","title":"\u6027\u80fd\u6545\u969c\u6392\u9664"},{"location":"7/#kudu_2","text":"kudu-master \u548c kudu-tserver \u5b88\u62a4\u8fdb\u7a0b\u5305\u62ec\u57fa\u4e8e\u5f00\u6e90 Chromium \u8ddf\u8e2a\u6846\u67b6\u7684\u5185\u7f6e\u8ddf\u8e2a\u652f\u6301\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u8ddf\u8e2a\u6765\u5e2e\u52a9\u8bca\u65ad\u5ef6\u8fdf\u95ee\u9898\u6216 Kudu \u670d\u52a1\u5668\u4e0a\u7684\u5176\u4ed6\u95ee\u9898\u3002","title":"Kudu\u8ffd\u8e2a"},{"location":"7/#_3","text":"\u6bcf\u4e2a Kudu \u5b88\u62a4\u8fdb\u7a0b\u4e2d\uff0c\u8ddf\u8e2a\u754c\u9762\u662f\u901a\u8fc7 Web \u6d4f\u89c8\u5668\u8bbf\u95ee\u5d4c\u5165\u5f0f Web \u670d\u52a1\u5668\u7684\u4e00\u90e8\u5206\u3002 \u8868 1. \u8ddf\u8e2a\u754c\u9762 URL Daemon ( \u5b88\u62a4\u8fdb\u7a0b ) URL Tablet Server http://tablet-server-1.example.com:8050/tracing.html Master http://master-1.example.com:8051/tracing.html \u6ce8\u610f \u5df2\u77e5\u8ddf\u8e2a\u754c\u9762\u9002\u7528\u4e8e\u6700\u65b0\u7248\u672c\u7684 Google Chrome \u3002\u5176\u4ed6\u6d4f\u89c8\u5668\u53ef\u80fd\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002","title":"\u8bbf\u95ee\u8ddf\u8e2a\u754c\u9762"},{"location":"7/#collecting-a-trace","text":"\u5bfc\u822a\u5230\u8ddf\u8e2a\u754c\u9762\u540e\uff0c\u5355\u51fb\u5c4f\u5e55\u5de6\u4e0a\u89d2\u7684\u8bb0\u5f55\u6309\u94ae\u3002\u5f53\u5f00\u59cb\u8bca\u65ad\u95ee\u9898\u65f6\uff0c\u9996\u5148\u9009\u62e9\u6240\u6709\u7c7b\u522b\u3002\u5355\u51fb\u8bb0\u5f55\u5f00\u59cb\u8bb0\u5f55\u8ddf\u8e2a\u3002 \u5728\u8ddf\u8e2a\u6536\u96c6\u671f\u95f4\uff0c\u4e8b\u4ef6\u88ab\u6536\u96c6\u5230\u5185\u5b58\u4e2d\u7684\u73af\u5f62\u7f13\u51b2\u533a\u4e2d\u3002\u8be5\u73af\u5f62\u7f13\u51b2\u5668\u7684\u5927\u5c0f\u56fa\u5b9a\uff0c\u6700\u7ec8\u53ef\u4ee5\u8fbe\u5230100\uff05\u3002\u4f46\u662f\uff0c\u5728\u5220\u9664\u65e7\u4e8b\u4ef6\u7684\u540c\u65f6\uff0c\u4ecd\u7136\u6536\u96c6\u65b0\u7684\u4e8b\u4ef6\u3002\u8bb0\u5f55\u8ddf\u8e2a\u65f6\uff0c\u89e6\u53d1\u60a8\u6709\u5174\u8da3\u63a2\u7d22\u7684\u884c\u4e3a\u6216\u5de5\u4f5c\u8d1f\u8f7d\u3002 \u6536\u96c6\u6570\u79d2\u540e\uff0c\u5355\u51fb\u505c\u6b62\u3002\u6536\u96c6\u7684\u8e2a\u8ff9\u5c06\u88ab\u4e0b\u8f7d\u5e76\u663e\u793a\u3002\u4f7f\u7528 \uff1f\u952e\u663e\u793a\u6709\u5173\u4f7f\u7528\u8ddf\u8e2a\u754c\u9762\u63a2\u7d22\u8ddf\u8e2a\u7684\u5e2e\u52a9\u6587\u672c\u3002","title":"Collecting a trace ( \u6536\u96c6\u75d5\u8ff9\u00a0)"},{"location":"7/#saving-a-trace","text":"\u60a8\u53ef\u4ee5\u5c06\u6536\u96c6\u7684\u75d5\u8ff9\u4fdd\u5b58\u4e3a JSON \u6587\u4ef6\uff0c\u4ee5\u4fbf\u4ee5\u540e\u5206\u6790\uff0c\u7136\u540e\u5728\u6536\u96c6\u8ddf\u8e2a\u540e\u5355\u51fb\u201c\u4fdd\u5b58\u201d\u3002\u8981\u52a0\u8f7d\u548c\u5206\u6790\u4fdd\u5b58\u7684 JSON \u6587\u4ef6\uff0c\u8bf7\u5355\u51fb\u52a0\u8f7d\u5e76\u9009\u62e9\u6587\u4ef6\u3002","title":"Saving a trace ( \u4fdd\u5b58\u75d5\u8ff9 )"},{"location":"7/#rpc-timeout-traces-rpc","text":"\u5982\u679c\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u9047\u5230 RPC \u8d85\u65f6\uff0c Kudu tablet servers WARNING \u7ea7\u522b\u65e5\u5fd7\u5e94\u5305\u542b\u5305\u542b RPC \u7ea7\u522b\u8ddf\u8e2a\u7684\u65e5\u5fd7\u6761\u76ee\u3002\u4f8b\u5982\uff1a W0922 00:56:52.313848 10858 inbound_call.cc:193] Call kudu.consensus.ConsensusService.UpdateConsensus from 192.168.1.102:43499 (request call id 3555909) took 1464ms (client timeout 1000). W0922 00:56:52.314888 10858 inbound_call.cc:197] Trace: 0922 00:56:50.849505 (+ 0us) service_pool.cc:97] Inserting onto call queue 0922 00:56:50.849527 (+ 22us) service_pool.cc:158] Handling call 0922 00:56:50.849574 (+ 47us) raft_consensus.cc:1008] Updating replica for 2 ops 0922 00:56:50.849628 (+ 54us) raft_consensus.cc:1050] Early marking committed up to term: 8 index: 880241 0922 00:56:50.849968 (+ 340us) raft_consensus.cc:1056] Triggering prepare for 2 ops 0922 00:56:50.850119 (+ 151us) log.cc:420] Serialized 1555 byte log entry 0922 00:56:50.850213 (+ 94us) raft_consensus.cc:1131] Marking committed up to term: 8 index: 880241 0922 00:56:50.850218 (+ 5us) raft_consensus.cc:1148] Updating last received op as term: 8 index: 880243 0922 00:56:50.850219 (+ 1us) raft_consensus.cc:1195] Filling consensus response to leader. 0922 00:56:50.850221 (+ 2us) raft_consensus.cc:1169] Waiting on the replicates to finish logging 0922 00:56:52.313763 (+1463542us) raft_consensus.cc:1182] finished 0922 00:56:52.313764 (+ 1us) raft_consensus.cc:1190] UpdateReplicas() finished 0922 00:56:52.313788 (+ 24us) inbound_call.cc:114] Queueing success response \u8fd9\u4e9b\u8ddf\u8e2a\u53ef\u4ee5\u6307\u793a\u8bf7\u6c42\u7684\u54ea\u4e2a\u90e8\u5206\u7f13\u6162\u3002 \u8bf7\u5c06\u5b83\u4eec\u5305\u542b\u5728\u4e0e RPC \u5ef6\u8fdf\u5f02\u5e38\u503c\u76f8\u5173\u7684\u9519\u8bef\u62a5\u544a\u4e2d\u3002","title":"RPC Timeout Traces ( RPC\u8d85\u65f6\u8ddf\u8e2a\u00a0)"},{"location":"7/#kernel-stack-watchdog-traces","text":"\u6bcf\u4e2a Kudu \u670d\u52a1\u5668\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u79f0\u4e3a Stack Watchdog \u7684\u540e\u53f0\u7ebf\u7a0b\uff0c\u5b83\u76d1\u89c6\u670d\u52a1\u5668\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\uff0c\u4ee5\u9632\u5b83\u4eec\u88ab\u963b\u585e\u8d85\u8fc7\u9884\u671f\u7684\u65f6\u95f4\u6bb5\u3002 \u8fd9\u4e9b\u8ddf\u8e2a\u53ef\u4ee5\u6307\u793a\u64cd\u4f5c\u7cfb\u7edf\u95ee\u9898\u6216\u74f6\u9888\u5b58\u50a8\u3002 \u5f53\u770b\u95e8\u72d7\u7ebf\u7a0b\u8bc6\u522b\u7ebf\u7a0b\u963b\u585e\u7684\u60c5\u51b5\u65f6\uff0c\u5b83\u4f1a\u5728 WARNING \u65e5\u5fd7\u4e2d\u8bb0\u5f55\u4e00\u4e2a\u6761\u76ee\uff0c\u5982\u4e0b\u6240\u793a\uff1a W0921 23:51:54.306350 10912 kernel_stack_watchdog.cc:111] Thread 10937 stuck at /data/kudu/consensus/log.cc:505 for 537ms: Kernel stack: [<ffffffffa00b209d>] do_get_write_access+0x29d/0x520 [jbd2] [<ffffffffa00b2471>] jbd2_journal_get_write_access+0x31/0x50 [jbd2] [<ffffffffa00fe6d8>] __ext4_journal_get_write_access+0x38/0x80 [ext4] [<ffffffffa00d9b23>] ext4_reserve_inode_write+0x73/0xa0 [ext4] [<ffffffffa00d9b9c>] ext4_mark_inode_dirty+0x4c/0x1d0 [ext4] [<ffffffffa00d9e90>] ext4_dirty_inode+0x40/0x60 [ext4] [<ffffffff811ac48b>] __mark_inode_dirty+0x3b/0x160 [<ffffffff8119c742>] file_update_time+0xf2/0x170 [<ffffffff8111c1e0>] __generic_file_aio_write+0x230/0x490 [<ffffffff8111c4c8>] generic_file_aio_write+0x88/0x100 [<ffffffffa00d3fb1>] ext4_file_write+0x61/0x1e0 [ext4] [<ffffffff81180f5b>] do_sync_readv_writev+0xfb/0x140 [<ffffffff81181ee6>] do_readv_writev+0xd6/0x1f0 [<ffffffff81182046>] vfs_writev+0x46/0x60 [<ffffffff81182102>] sys_pwritev+0xa2/0xc0 [<ffffffff8100b072>] system_call_fastpath+0x16/0x1b [<ffffffffffffffff>] 0xffffffffffffffff User stack: @ 0x3a1ace10c4 (unknown) @ 0x1262103 (unknown) @ 0x12622d4 (unknown) @ 0x12603df (unknown) @ 0x8e7bfb (unknown) @ 0x8f478b (unknown) @ 0x8f55db (unknown) @ 0x12a7b6f (unknown) @ 0x3a1b007851 (unknown) @ 0x3a1ace894d (unknown) @ (nil) (unknown) \u8fd9\u4e9b\u8ddf\u8e2a\u53ef\u7528\u4e8e\u8bca\u65ad\u6839\u6e90\u4e8e\u5ef6\u8fdf\u95ee\u9898\uff08\u7531 Kudu \u4ee5\u4e0b\u7684\u7cfb\u7edf\u5f15\u8d77\uff09\uff0c\u5982\u78c1\u76d8\u63a7\u5236\u5668\u6216\u6587\u4ef6\u7cfb\u7edf\u3002","title":"Kernel Stack Watchdog Traces ( \u5185\u6838\u5806\u6808\u770b\u95e8\u72d7\u8ddf\u8e2a )"},{"location":"7/#kudu_3","text":"","title":"\u4f7f\u7528 Kudu \u7684\u95ee\u9898"},{"location":"7/#classnotfoundexceptioncomclouderakuduhivekudustoragehandler","text":"\u5c1d\u8bd5\u901a\u8fc7 Hive \u4f7f\u7528 Kudu \u8868\u65f6\uff0c\u7528\u6237\u5c06\u9047\u5230\u6b64\u5f02\u5e38\u3002 \u8fd9\u4e0d\u662f\u4e00\u4e2a\u4e22\u5931\u7684 jar \u7684\u60c5\u51b5\uff0c\u800c\u53ea\u662f Impala \u5c06 Hive \u4e2d\u7684 Kudu \u5143\u6570\u636e\u5b58\u50a8\u5728\u5176\u4ed6\u5de5\u5177\uff08\u5305\u62ec Hive \u672c\u8eab\u548c Spark \uff09\u4e2d\u65e0\u6cd5\u8bfb\u53d6\u7684\u683c\u5f0f\u3002 Hive \u7528\u6237\u6ca1\u6709\u89e3\u51b3\u65b9\u6cd5\u3002 Spark \u7528\u6237\u9700\u8981\u521b\u5efa\u4e34\u65f6\u8868\u3002","title":"ClassNotFoundException\uff1acom.cloudera.kudu.hive.KuduStorageHandler"},{"location":"8/","text":"\u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/developing.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813629 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 \u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f Kudu \u63d0\u4f9b C ++ \uff0c Java \u548c Python \u5ba2\u6237\u7aef API \u4ee5\u53ca\u53c2\u8003\u793a\u4f8b\u6765\u8bf4\u660e\u5b83\u4eec\u7684\u7528\u9014\u3002 \u6ce8\u610f \u4e0d\u652f\u6301\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u6216\u4e13\u7528\u63a5\u53e3\uff0c\u4e0d\u5c5e\u4e8e\u516c\u5171 API \u7684\u63a5\u53e3\u6ca1\u6709\u7a33\u5b9a\u6027\u4fdd\u8bc1\u3002 \u67e5\u770b API \u6587\u6863 C++ API \u6587\u6863 \u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b C ++ \u5ba2\u6237\u7aef API \u6587\u6863\u3002\u6216\u8005\uff0c\u5728\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\uff0c\u60a8\u8fd8\u53ef\u4ee5\u53e6\u5916\u6784\u5efa doxygen \u76ee\u6807\uff08\u4f8b\u5982\uff0c\u5982\u679c\u4f7f\u7528 make \uff0c\u5219\u8fd0\u884c make doxygen \uff09\uff0c\u5e76\u901a\u8fc7\u5728\u60a8\u6700\u559c\u6b22\u7684 Web \u4e2d\u6253\u5f00 docs/doxygen/client_api/html/index.html \u6587\u4ef6\u6765\u4f7f\u7528\u672c\u5730\u751f\u6210\u7684 API \u6587\u6863\u6d4f\u89c8\u5668\u3002 \u91cd\u8981 \u4e3a\u4e86\u6784\u5efa doxygen \u76ee\u6807\uff0c\u6709\u5fc5\u8981\u5728\u60a8\u7684\u6784\u5efa\u673a\u5668\u4e0a\u5b89\u88c5\u5e26\u6709 Dot\uff08 graphviz \uff09 \u652f\u6301\u7684 doxygen \u3002\u5982\u679c\u60a8\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\u5b89\u88c5\u4e86 doxygen \uff0c\u5219\u9700\u8981\u518d\u6b21\u8fd0\u884c cmake \u4ee5\u83b7\u53d6 doxygen \u4f4d\u7f6e\u5e76\u751f\u6210\u9002\u5f53\u7684\u76ee\u6807\u3002 Java API \u6587\u6863 \u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b Java API \u6587\u6863 \u3002\u6216\u8005\uff0c\u5728\u6784\u5efa Java \u5ba2\u6237\u7aef \u4e4b\u540e\uff0c Java API \u6587\u6863\u53ef\u4ee5\u5728 java/kudu-client/target/apidocs/index.html \u4e2d\u627e\u5230\u3002 \u5de5\u4f5c\u5b9e\u4f8b kudu \u793a\u4f8b Github \u4ed3\u5e93\u4e2d\u63d0\u4f9b\u4e86\u51e0\u4e2a\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u793a\u4f8b\u5305\u62ec\u4e00\u4e2a\u81ea\u8ff0\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4f55\u7f16\u8bd1\u548c\u8fd0\u884c\u5b83\u3002\u8fd9\u4e9b\u4f8b\u5b50\u8bf4\u660e\u4e86 Kudu API \u7684\u6b63\u786e\u4f7f\u7528\uff0c\u4ee5\u53ca\u5982\u4f55\u8bbe\u7f6e\u865a\u62df\u673a\u6765\u8fd0\u884c Kudu \u3002\u4ee5\u4e0b\u5217\u8868\u5305\u62ec\u4eca\u5929\u53ef\u7528\u7684\u4e00\u4e9b\u793a\u4f8b\u3002\u68c0\u67e5\u5b58\u50a8\u5e93\u672c\u8eab\uff0c\u4ee5\u9632\u6b64\u5217\u8868\u8fc7\u671f\u3002 java/java-example \u8fde\u63a5\u5230 Kudu \u5b9e\u4f8b\u7684\u7b80\u5355 Java \u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u5411\u5176\u4e2d\u5199\u5165\u6570\u636e\uff0c\u7136\u540e\u4e22\u5f03\u8be5\u8868\u3002 java/collectl \u4fa6\u542c TCP \u5957\u63a5\u5b57\u7684\u5c0f\u578b Java \u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e Collectl \u6709\u7ebf\u534f\u8bae\u76f8\u5bf9\u5e94\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002\u5e38\u7528\u7684 collectl \u5de5\u5177\u53ef\u7528\u4e8e\u5c06\u793a\u4f8b\u6570\u636e\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002 java/insert-loadgen \u751f\u6210\u968f\u673a\u63d2\u5165\u8d1f\u8f7d\u7684 Java \u5e94\u7528\u7a0b\u5e8f\u3002 python/dstat-kudu \u4e00\u4e2a\u793a\u4f8b\u7a0b\u5e8f\uff0c\u663e\u793a\u5982\u4f55\u4f7f\u7528 Kudu Python API \u5c06\u6570\u636e\u52a0\u8f7d\u5230\u7531\u5916\u90e8\u7a0b\u5e8f\u751f\u6210\u7684\u65b0\u7684/\u73b0\u6709\u7684 Kudu \u8868\u4e2d\uff0c dstat \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u3002 python/graphite-kudu \u4f7f\u7528 graphite-web ( \u77f3\u58a8\u7f51 ) \u4e0e Kudu \u4f5c\u4e3a\u540e\u7aef\u7684\u5b9e\u9a8c\u63d2\u4ef6\u3002 demo-vm-setup \u811a\u672c\u4e0b\u8f7d\u5e76\u8fd0\u884c\u5e26\u6709 Kudu \u7684 VirtualBox \u865a\u62df\u673a\u5df2\u5b89\u88c5\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5feb\u901f\u5165\u95e8 \u3002 \u8fd9\u4e9b\u4f8b\u5b50\u5e94\u8be5\u662f\u60a8\u81ea\u5df1\u7684 Kudu \u5e94\u7528\u7a0b\u5e8f\u548c\u96c6\u6210\u7684\u6709\u7528\u8d77\u70b9\u3002 Maven Artifacts ( Maven \u5de5\u4ef6 ) \u4ee5\u4e0b Maven <dependency> \u5143\u7d20\u5bf9\u4e8e Apache Kudu \u516c\u5f00\u7248\u672c\uff08\u4ece 1.0.0 \u5f00\u59cb\uff09\u662f\u6709\u6548\u7684\uff1a <dependency> <groupId>org.apache.kudu</groupId> <artifactId>kudu-client</artifactId> <version>1.1.0</version> </dependency> Java \u5ba2\u6237\u7aef\u548c\u5404\u79cd Java \u96c6\u6210\uff08\u4f8b\u5982 Spark \uff0c Flume \uff09\u7684\u4fbf\u5229\u4e8c\u8fdb\u5236\u6587\u4ef6\u73b0\u5728\u4e5f\u53ef\u4ee5\u901a\u8fc7 ASF Maven \u5b58\u50a8\u5e93 \u548c Maven Central \u5b58\u50a8\u5e93 \u83b7\u5f97\u3002 Impala\u547d\u4ee4\u4f7f\u7528 Kudu \u7684\u4f8b\u5b50 \u8bf7\u53c2\u9605 \u4f7f\u7528 Impala \u4e0e Kudu \u8fdb\u884c\u6709\u5173\u4f7f\u7528 Kudu \u5b89\u88c5\u548c\u4f7f\u7528 Impala \u7684\u6307\u5bfc\uff0c\u5176\u4e2d\u5305\u62ec\u51e0\u4e2a impala-shell \u793a\u4f8b\u3002 Kudu \u4e0e Spark \u96c6\u6210 Kudu \u4ece 1.0.0 \u7248\u5f00\u59cb\uff0c\u901a\u8fc7 Data Source API \u4e0e Spark \u96c6\u6210\u3002\u4f7f\u7528 --packages \u9009\u9879\u5305\u62ec kudu-spark \u4f9d\u8d56\u5173\u7cfb\uff1a \u5982\u679c\u4f7f\u7528 Spark \u4e0e Scala 2.10 \uff0c\u8bf7\u4f7f\u7528 kudu-spark_2.10 \u63d2\u4ef6\uff1a spark-shell --packages org.apache.kudu:kudu-spark_2.10:1.1.0 \u5982\u679c\u5728 Scala 2.11 \u4e2d\u4f7f\u7528 Spark 2 \uff0c\u8bf7\u4f7f\u7528 kudu-spark2_2.11 \u63d2\u4ef6\uff1a spark-shell --packages org.apache.kudu:kudu-spark2_2.11:1.1.0 \u7136\u540e\u5bfc\u5165 kudu-spark \u5e76\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u6846\uff1a import org.apache.kudu.spark.kudu._ import org.apache.kudu.client._ import collection.JavaConverters._ // Read a table from Kudu val df = sqlContext.read.options(Map(\"kudu.master\" -> \"kudu.master:7051\",\"kudu.table\" -> \"kudu_table\")).kudu // Query using the Spark API... df.select(\"id\").filter(\"id\" >= 5).show() // ...or register a temporary table and use SQL df.registerTempTable(\"kudu_table\") val filteredDF = sqlContext.sql(\"select id from kudu_table where id >= 5\").show() // Use KuduContext to create, delete, or write to Kudu tables val kuduContext = new KuduContext(\"kudu.master:7051\", sqlContext.sparkContext) // Create a new Kudu table from a dataframe schema // NB: No rows from the dataframe are inserted into the table kuduContext.createTable( \"test_table\", df.schema, Seq(\"key\"), new CreateTableOptions() .setNumReplicas(1) .addHashPartitions(List(\"key\").asJava, 3)) // Insert data kuduContext.insertRows(df, \"test_table\") // Delete data kuduContext.deleteRows(filteredDF, \"test_table\") // Upsert data kuduContext.upsertRows(df, \"test_table\") // Update data val alteredDF = df.select(\"id\", $\"count\" + 1) kuduContext.updateRows(filteredRows, \"test_table\" // Data can also be inserted into the Kudu table using the data source, though the methods on KuduContext are preferred // NB: The default is to upsert rows; to perform standard inserts instead, set operation = insert in the options map // NB: Only mode Append is supported df.write.options(Map(\"kudu.master\"-> \"kudu.master:7051\", \"kudu.table\"-> \"test_table\")).mode(\"append\").kudu // Check for the existence of a Kudu table kuduContext.tableExists(\"another_table\") // Delete a Kudu table kuduContext.deleteTable(\"unwanted_table\") <> and OR predicates are not pushed to Kudu, and instead will be evaluated by the Spark task. Only LIKE predicates with a suffix wildcard are pushed to Kudu, meaning that LIKE \"FOO%\" is pushed down but LIKE \"FOO%BAR\" isn\u2019t. Spark \u96c6\u6210\u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236 \u6ce8\u518c\u4e3a\u4e34\u65f6\u8868\u65f6\uff0c\u5fc5\u987b\u4e3a\u5177\u6709\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u540d\u79f0\u7684 Kudu \u8868\u5206\u914d\u5907\u7528\u540d\u79f0\u3002 \u5177\u6709\u5305\u542b\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u5217\u540d\u79f0\u7684 Kudu \u8868\u53ef\u80fd\u4e0d\u4e0e SparkSQL \u4e00\u8d77\u4f7f\u7528\u3002 Columns \u53ef\u80fd\u5728 Kudu \u66f4\u540d\u4e3a\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 <> \u548c OR \u8c13\u8bcd\u4e0d\u88ab\u63a8\u9001\u5230 Kudu \uff0c\u800c\u662f\u5c06\u5728 Spark \u7684evaluate\u8fc7\u7a0b\u4e2d\u6267\u884c\uff0c \u53ea\u6709\u5177\u6709\u540e\u7f00\u901a\u914d\u7b26\u7684 LIKE \u8c13\u8bcd\u624d\u88ab\u63a8\u9001\u5230 Kudu \u6267\u884c\uff0c\u8fd9\u610f\u5473\u7740 LIKE\u201cFOO\uff05\u201d \u8bed\u53e5\u88ab\u4e0b\u63a8\u5230 Kudu \uff0c\u800c \u201cFOO\uff05BAR\u201d \u8fd9\u6837\u7684\u8bed\u53e5\u4e0d\u4f1a\u3002 Kudu \u4e0d\u652f\u6301 Spark SQL \u652f\u6301\u7684\u6240\u6709\u7c7b\u578b\uff0c\u4f8b\u5982 Date \uff0c Decimal \u548c\u590d\u6742\u7c7b\u578b\u3002 Kudu \u8868\u53ea\u80fd\u5728 SparkSQL \u4e2d\u6ce8\u518c\u4e3a\u4e34\u65f6\u8868\u3002 \u53ef\u80fd\u4e0d\u4f1a\u4f7f\u7528 HiveContext \u67e5\u8be2 Kudu \u8868\u3002 Kudu Python \u5ba2\u6237\u7aef Kudu Python \u5ba2\u6237\u7aef\u4e3a C ++ \u5ba2\u6237\u7aef API \u63d0\u4f9b\u4e86\u4e00\u4e2a Python \u53cb\u597d\u7684\u754c\u9762\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u90e8\u5206 Python \u5ba2\u6237\u7aef\u3002 import kudu from kudu.client import Partitioning from datetime import datetime # Connect to Kudu master server client = kudu.connect(host='kudu.master', port=7051) # Define a schema for a new table builder = kudu.schema_builder() builder.add_column('key').type(kudu.int64).nullable(False).primary_key() builder.add_column('ts_val', type_=kudu.unixtime_micros, nullable=False, compression='lz4') schema = builder.build() # Define partitioning schema partitioning = Partitioning().add_hash_partitions(column_names=['key'], num_buckets=3) # Create new table client.create_table('python-example', schema, partitioning) # Open a table table = client.table('python-example') # Create a new session so that we can apply write operations session = client.new_session() # Insert a row op = table.new_insert({'key': 1, 'ts_val': datetime.utcnow()}) session.apply(op) # Upsert a row op = table.new_upsert({'key': 2, 'ts_val': \"2016-01-01T00:00:00.000000\"}) session.apply(op) # Updating a row op = table.new_update({'key': 1, 'ts_val': (\"2017-01-01\", \"%Y-%m-%d\")}) session.apply(op) # Delete a row op = table.new_delete({'key': 2}) session.apply(op) # Flush write operations, if failures occur, capture print them. try: session.flush() except kudu.KuduBadStatus as e: print(session.get_pending_errors()) # Create a scanner and add a predicate scanner = table.scanner() scanner.add_predicate(table['ts_val'] == datetime(2017, 1, 1)) # Open Scanner and read all tuples # Note: This doesn't scale for large scans result = scanner.open().read_all_tuples() \u4e0e MapReduce \uff0c YARN \u548c\u5176\u4ed6\u6846\u67b6\u96c6\u6210 Kudu \u65e8\u5728\u4e0e Hadoop \u751f\u6001\u7cfb\u7edf\u4e2d\u7684 MapReduce \uff0c YARN \uff0c Spark \u548c\u5176\u4ed6\u6846\u67b6\u96c6\u6210\u3002 \u8bf7\u53c2\u9605 RowCounter.java \u548c ImportCsv.java \uff0c\u4e86\u89e3\u53ef\u4ee5\u5bf9\u81ea\u5df1\u7684\u96c6\u6210\u8fdb\u884c\u5efa\u6a21\u7684\u793a\u4f8b\u3002 \u8bf7\u7ee7\u7eed\u5173\u6ce8\u672a\u6765\u4f7f\u7528 YARN \u548c Spark \u7684\u66f4\u591a\u793a\u4f8b\u3002","title":"\u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f"},{"location":"8/#kudu","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/developing.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813629 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"\u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f"},{"location":"8/#kudu_1","text":"Kudu \u63d0\u4f9b C ++ \uff0c Java \u548c Python \u5ba2\u6237\u7aef API \u4ee5\u53ca\u53c2\u8003\u793a\u4f8b\u6765\u8bf4\u660e\u5b83\u4eec\u7684\u7528\u9014\u3002 \u6ce8\u610f \u4e0d\u652f\u6301\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u6216\u4e13\u7528\u63a5\u53e3\uff0c\u4e0d\u5c5e\u4e8e\u516c\u5171 API \u7684\u63a5\u53e3\u6ca1\u6709\u7a33\u5b9a\u6027\u4fdd\u8bc1\u3002","title":"\u4f7f\u7528 Kudu \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f"},{"location":"8/#api","text":"","title":"\u67e5\u770b API \u6587\u6863"},{"location":"8/#c-api","text":"\u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b C ++ \u5ba2\u6237\u7aef API \u6587\u6863\u3002\u6216\u8005\uff0c\u5728\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\uff0c\u60a8\u8fd8\u53ef\u4ee5\u53e6\u5916\u6784\u5efa doxygen \u76ee\u6807\uff08\u4f8b\u5982\uff0c\u5982\u679c\u4f7f\u7528 make \uff0c\u5219\u8fd0\u884c make doxygen \uff09\uff0c\u5e76\u901a\u8fc7\u5728\u60a8\u6700\u559c\u6b22\u7684 Web \u4e2d\u6253\u5f00 docs/doxygen/client_api/html/index.html \u6587\u4ef6\u6765\u4f7f\u7528\u672c\u5730\u751f\u6210\u7684 API \u6587\u6863\u6d4f\u89c8\u5668\u3002 \u91cd\u8981 \u4e3a\u4e86\u6784\u5efa doxygen \u76ee\u6807\uff0c\u6709\u5fc5\u8981\u5728\u60a8\u7684\u6784\u5efa\u673a\u5668\u4e0a\u5b89\u88c5\u5e26\u6709 Dot\uff08 graphviz \uff09 \u652f\u6301\u7684 doxygen \u3002\u5982\u679c\u60a8\u4ece\u6e90\u4ee3\u7801\u6784\u5efa Kudu \u540e\u5b89\u88c5\u4e86 doxygen \uff0c\u5219\u9700\u8981\u518d\u6b21\u8fd0\u884c cmake \u4ee5\u83b7\u53d6 doxygen \u4f4d\u7f6e\u5e76\u751f\u6210\u9002\u5f53\u7684\u76ee\u6807\u3002","title":"C++ API \u6587\u6863"},{"location":"8/#java-api","text":"\u60a8\u53ef\u4ee5\u5728\u7ebf\u67e5\u770b Java API \u6587\u6863 \u3002\u6216\u8005\uff0c\u5728\u6784\u5efa Java \u5ba2\u6237\u7aef \u4e4b\u540e\uff0c Java API \u6587\u6863\u53ef\u4ee5\u5728 java/kudu-client/target/apidocs/index.html \u4e2d\u627e\u5230\u3002","title":"Java API \u6587\u6863"},{"location":"8/#_1","text":"kudu \u793a\u4f8b Github \u4ed3\u5e93\u4e2d\u63d0\u4f9b\u4e86\u51e0\u4e2a\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u793a\u4f8b\u5305\u62ec\u4e00\u4e2a\u81ea\u8ff0\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4f55\u7f16\u8bd1\u548c\u8fd0\u884c\u5b83\u3002\u8fd9\u4e9b\u4f8b\u5b50\u8bf4\u660e\u4e86 Kudu API \u7684\u6b63\u786e\u4f7f\u7528\uff0c\u4ee5\u53ca\u5982\u4f55\u8bbe\u7f6e\u865a\u62df\u673a\u6765\u8fd0\u884c Kudu \u3002\u4ee5\u4e0b\u5217\u8868\u5305\u62ec\u4eca\u5929\u53ef\u7528\u7684\u4e00\u4e9b\u793a\u4f8b\u3002\u68c0\u67e5\u5b58\u50a8\u5e93\u672c\u8eab\uff0c\u4ee5\u9632\u6b64\u5217\u8868\u8fc7\u671f\u3002 java/java-example \u8fde\u63a5\u5230 Kudu \u5b9e\u4f8b\u7684\u7b80\u5355 Java \u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u5411\u5176\u4e2d\u5199\u5165\u6570\u636e\uff0c\u7136\u540e\u4e22\u5f03\u8be5\u8868\u3002 java/collectl \u4fa6\u542c TCP \u5957\u63a5\u5b57\u7684\u5c0f\u578b Java \u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e Collectl \u6709\u7ebf\u534f\u8bae\u76f8\u5bf9\u5e94\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002\u5e38\u7528\u7684 collectl \u5de5\u5177\u53ef\u7528\u4e8e\u5c06\u793a\u4f8b\u6570\u636e\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002 java/insert-loadgen \u751f\u6210\u968f\u673a\u63d2\u5165\u8d1f\u8f7d\u7684 Java \u5e94\u7528\u7a0b\u5e8f\u3002 python/dstat-kudu \u4e00\u4e2a\u793a\u4f8b\u7a0b\u5e8f\uff0c\u663e\u793a\u5982\u4f55\u4f7f\u7528 Kudu Python API \u5c06\u6570\u636e\u52a0\u8f7d\u5230\u7531\u5916\u90e8\u7a0b\u5e8f\u751f\u6210\u7684\u65b0\u7684/\u73b0\u6709\u7684 Kudu \u8868\u4e2d\uff0c dstat \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u3002 python/graphite-kudu \u4f7f\u7528 graphite-web ( \u77f3\u58a8\u7f51 ) \u4e0e Kudu \u4f5c\u4e3a\u540e\u7aef\u7684\u5b9e\u9a8c\u63d2\u4ef6\u3002 demo-vm-setup \u811a\u672c\u4e0b\u8f7d\u5e76\u8fd0\u884c\u5e26\u6709 Kudu \u7684 VirtualBox \u865a\u62df\u673a\u5df2\u5b89\u88c5\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5feb\u901f\u5165\u95e8 \u3002 \u8fd9\u4e9b\u4f8b\u5b50\u5e94\u8be5\u662f\u60a8\u81ea\u5df1\u7684 Kudu \u5e94\u7528\u7a0b\u5e8f\u548c\u96c6\u6210\u7684\u6709\u7528\u8d77\u70b9\u3002","title":"\u5de5\u4f5c\u5b9e\u4f8b"},{"location":"8/#maven-artifacts-maven","text":"\u4ee5\u4e0b Maven <dependency> \u5143\u7d20\u5bf9\u4e8e Apache Kudu \u516c\u5f00\u7248\u672c\uff08\u4ece 1.0.0 \u5f00\u59cb\uff09\u662f\u6709\u6548\u7684\uff1a <dependency> <groupId>org.apache.kudu</groupId> <artifactId>kudu-client</artifactId> <version>1.1.0</version> </dependency> Java \u5ba2\u6237\u7aef\u548c\u5404\u79cd Java \u96c6\u6210\uff08\u4f8b\u5982 Spark \uff0c Flume \uff09\u7684\u4fbf\u5229\u4e8c\u8fdb\u5236\u6587\u4ef6\u73b0\u5728\u4e5f\u53ef\u4ee5\u901a\u8fc7 ASF Maven \u5b58\u50a8\u5e93 \u548c Maven Central \u5b58\u50a8\u5e93 \u83b7\u5f97\u3002","title":"Maven Artifacts ( Maven \u5de5\u4ef6 )"},{"location":"8/#impala-kudu","text":"\u8bf7\u53c2\u9605 \u4f7f\u7528 Impala \u4e0e Kudu \u8fdb\u884c\u6709\u5173\u4f7f\u7528 Kudu \u5b89\u88c5\u548c\u4f7f\u7528 Impala \u7684\u6307\u5bfc\uff0c\u5176\u4e2d\u5305\u62ec\u51e0\u4e2a impala-shell \u793a\u4f8b\u3002","title":"Impala\u547d\u4ee4\u4f7f\u7528 Kudu \u7684\u4f8b\u5b50"},{"location":"8/#kudu-spark","text":"Kudu \u4ece 1.0.0 \u7248\u5f00\u59cb\uff0c\u901a\u8fc7 Data Source API \u4e0e Spark \u96c6\u6210\u3002\u4f7f\u7528 --packages \u9009\u9879\u5305\u62ec kudu-spark \u4f9d\u8d56\u5173\u7cfb\uff1a \u5982\u679c\u4f7f\u7528 Spark \u4e0e Scala 2.10 \uff0c\u8bf7\u4f7f\u7528 kudu-spark_2.10 \u63d2\u4ef6\uff1a spark-shell --packages org.apache.kudu:kudu-spark_2.10:1.1.0 \u5982\u679c\u5728 Scala 2.11 \u4e2d\u4f7f\u7528 Spark 2 \uff0c\u8bf7\u4f7f\u7528 kudu-spark2_2.11 \u63d2\u4ef6\uff1a spark-shell --packages org.apache.kudu:kudu-spark2_2.11:1.1.0 \u7136\u540e\u5bfc\u5165 kudu-spark \u5e76\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u6846\uff1a import org.apache.kudu.spark.kudu._ import org.apache.kudu.client._ import collection.JavaConverters._ // Read a table from Kudu val df = sqlContext.read.options(Map(\"kudu.master\" -> \"kudu.master:7051\",\"kudu.table\" -> \"kudu_table\")).kudu // Query using the Spark API... df.select(\"id\").filter(\"id\" >= 5).show() // ...or register a temporary table and use SQL df.registerTempTable(\"kudu_table\") val filteredDF = sqlContext.sql(\"select id from kudu_table where id >= 5\").show() // Use KuduContext to create, delete, or write to Kudu tables val kuduContext = new KuduContext(\"kudu.master:7051\", sqlContext.sparkContext) // Create a new Kudu table from a dataframe schema // NB: No rows from the dataframe are inserted into the table kuduContext.createTable( \"test_table\", df.schema, Seq(\"key\"), new CreateTableOptions() .setNumReplicas(1) .addHashPartitions(List(\"key\").asJava, 3)) // Insert data kuduContext.insertRows(df, \"test_table\") // Delete data kuduContext.deleteRows(filteredDF, \"test_table\") // Upsert data kuduContext.upsertRows(df, \"test_table\") // Update data val alteredDF = df.select(\"id\", $\"count\" + 1) kuduContext.updateRows(filteredRows, \"test_table\" // Data can also be inserted into the Kudu table using the data source, though the methods on KuduContext are preferred // NB: The default is to upsert rows; to perform standard inserts instead, set operation = insert in the options map // NB: Only mode Append is supported df.write.options(Map(\"kudu.master\"-> \"kudu.master:7051\", \"kudu.table\"-> \"test_table\")).mode(\"append\").kudu // Check for the existence of a Kudu table kuduContext.tableExists(\"another_table\") // Delete a Kudu table kuduContext.deleteTable(\"unwanted_table\") <> and OR predicates are not pushed to Kudu, and instead will be evaluated by the Spark task. Only LIKE predicates with a suffix wildcard are pushed to Kudu, meaning that LIKE \"FOO%\" is pushed down but LIKE \"FOO%BAR\" isn\u2019t.","title":"Kudu \u4e0e Spark \u96c6\u6210"},{"location":"8/#spark","text":"\u6ce8\u518c\u4e3a\u4e34\u65f6\u8868\u65f6\uff0c\u5fc5\u987b\u4e3a\u5177\u6709\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u540d\u79f0\u7684 Kudu \u8868\u5206\u914d\u5907\u7528\u540d\u79f0\u3002 \u5177\u6709\u5305\u542b\u5927\u5199\u5b57\u6bcd\u6216\u975e ASCII \u5b57\u7b26\u7684\u5217\u540d\u79f0\u7684 Kudu \u8868\u53ef\u80fd\u4e0d\u4e0e SparkSQL \u4e00\u8d77\u4f7f\u7528\u3002 Columns \u53ef\u80fd\u5728 Kudu \u66f4\u540d\u4e3a\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 <> \u548c OR \u8c13\u8bcd\u4e0d\u88ab\u63a8\u9001\u5230 Kudu \uff0c\u800c\u662f\u5c06\u5728 Spark \u7684evaluate\u8fc7\u7a0b\u4e2d\u6267\u884c\uff0c \u53ea\u6709\u5177\u6709\u540e\u7f00\u901a\u914d\u7b26\u7684 LIKE \u8c13\u8bcd\u624d\u88ab\u63a8\u9001\u5230 Kudu \u6267\u884c\uff0c\u8fd9\u610f\u5473\u7740 LIKE\u201cFOO\uff05\u201d \u8bed\u53e5\u88ab\u4e0b\u63a8\u5230 Kudu \uff0c\u800c \u201cFOO\uff05BAR\u201d \u8fd9\u6837\u7684\u8bed\u53e5\u4e0d\u4f1a\u3002 Kudu \u4e0d\u652f\u6301 Spark SQL \u652f\u6301\u7684\u6240\u6709\u7c7b\u578b\uff0c\u4f8b\u5982 Date \uff0c Decimal \u548c\u590d\u6742\u7c7b\u578b\u3002 Kudu \u8868\u53ea\u80fd\u5728 SparkSQL \u4e2d\u6ce8\u518c\u4e3a\u4e34\u65f6\u8868\u3002 \u53ef\u80fd\u4e0d\u4f1a\u4f7f\u7528 HiveContext \u67e5\u8be2 Kudu \u8868\u3002","title":"Spark \u96c6\u6210\u5df2\u77e5\u95ee\u9898\u548c\u9650\u5236"},{"location":"8/#kudu-python","text":"Kudu Python \u5ba2\u6237\u7aef\u4e3a C ++ \u5ba2\u6237\u7aef API \u63d0\u4f9b\u4e86\u4e00\u4e2a Python \u53cb\u597d\u7684\u754c\u9762\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u90e8\u5206 Python \u5ba2\u6237\u7aef\u3002 import kudu from kudu.client import Partitioning from datetime import datetime # Connect to Kudu master server client = kudu.connect(host='kudu.master', port=7051) # Define a schema for a new table builder = kudu.schema_builder() builder.add_column('key').type(kudu.int64).nullable(False).primary_key() builder.add_column('ts_val', type_=kudu.unixtime_micros, nullable=False, compression='lz4') schema = builder.build() # Define partitioning schema partitioning = Partitioning().add_hash_partitions(column_names=['key'], num_buckets=3) # Create new table client.create_table('python-example', schema, partitioning) # Open a table table = client.table('python-example') # Create a new session so that we can apply write operations session = client.new_session() # Insert a row op = table.new_insert({'key': 1, 'ts_val': datetime.utcnow()}) session.apply(op) # Upsert a row op = table.new_upsert({'key': 2, 'ts_val': \"2016-01-01T00:00:00.000000\"}) session.apply(op) # Updating a row op = table.new_update({'key': 1, 'ts_val': (\"2017-01-01\", \"%Y-%m-%d\")}) session.apply(op) # Delete a row op = table.new_delete({'key': 2}) session.apply(op) # Flush write operations, if failures occur, capture print them. try: session.flush() except kudu.KuduBadStatus as e: print(session.get_pending_errors()) # Create a scanner and add a predicate scanner = table.scanner() scanner.add_predicate(table['ts_val'] == datetime(2017, 1, 1)) # Open Scanner and read all tuples # Note: This doesn't scale for large scans result = scanner.open().read_all_tuples()","title":"Kudu Python \u5ba2\u6237\u7aef"},{"location":"8/#mapreduce-yarn","text":"Kudu \u65e8\u5728\u4e0e Hadoop \u751f\u6001\u7cfb\u7edf\u4e2d\u7684 MapReduce \uff0c YARN \uff0c Spark \u548c\u5176\u4ed6\u6846\u67b6\u96c6\u6210\u3002 \u8bf7\u53c2\u9605 RowCounter.java \u548c ImportCsv.java \uff0c\u4e86\u89e3\u53ef\u4ee5\u5bf9\u81ea\u5df1\u7684\u96c6\u6210\u8fdb\u884c\u5efa\u6a21\u7684\u793a\u4f8b\u3002 \u8bf7\u7ee7\u7eed\u5173\u6ce8\u672a\u6765\u4f7f\u7528 YARN \u548c Spark \u7684\u66f4\u591a\u793a\u4f8b\u3002","title":"\u4e0e MapReduce \uff0c YARN \u548c\u5176\u4ed6\u6846\u67b6\u96c6\u6210"},{"location":"9/","text":"Kudu Schema Design ( \u6a21\u5f0f\u8bbe\u8ba1 ) \u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/schema_design.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813632 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51 Apache Kudu Schema Design ( Apache Kudu \u6a21\u5f0f\u8bbe\u8ba1 ) Kudu \u8868\u5177\u6709\u4e0e\u4f20\u7edf RDBMS \u4e2d\u7684\u8868\u7c7b\u4f3c\u7684\u7ed3\u6784\u5316\u6570\u636e\u6a21\u578b\u3002\u6a21\u5f0f\u8bbe\u8ba1\u5bf9\u4e8e\u5b9e\u73b0 Kudu \u7684\u6700\u4f73\u6027\u80fd\u548c\u8fd0\u884c\u7a33\u5b9a\u6027\u81f3\u5173\u91cd\u8981\u3002\u6bcf\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c\u6ca1\u6709\u4e00\u4e2a\u6700\u5408\u9002\u6bcf\u4e2a\u8868\u7684\u5355\u4e00\u6a21\u5f0f\u8bbe\u8ba1\u3002\u672c\u6587\u6863\u6982\u8ff0\u4e86 Kudu \u7684\u6709\u6548\u6a21\u5f0f\u8bbe\u8ba1\u7406\u5ff5\uff0c\u7279\u522b\u6ce8\u610f\u4e0e\u4f20\u7edf RDBMS \u6a21\u5f0f\u6240\u91c7\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\u7684\u5730\u65b9\u3002 \u5728\u9ad8\u5c42\u6b21\u4e0a\uff0c\u521b\u5efa Kudu \u8868\u6709\u4e09\u4e2a\u95ee\u9898\uff1a \u5217\u8bbe\u8ba1 \uff0c \u4e3b\u952e\u8bbe\u8ba1 \u548c \u5206\u533a\u8bbe\u8ba1 \u3002\u5176\u4e2d\u53ea\u6709\u5206\u533a\u5bf9\u4e8e\u719f\u6089\u4f20\u7edf\u7684\u975e\u5206\u5e03\u5f0f\u5173\u7cfb\u6570\u636e\u5e93\u7684\u4eba\u6765\u8bf4\u5c06\u662f\u4e00\u4e2a\u65b0\u7684\u6982\u5ff5\u3002\u6700\u540e\u4e00\u8282\u8ba8\u8bba \u6539\u53d8\u73b0\u6709\u8868\u7684\u6a21\u5f0f \uff0c\u4ee5\u53ca\u5173\u4e8e\u6a21\u5f0f\u8bbe\u8ba1\u7684 \u5df2\u77e5\u9650\u5236 \u3002 The Perfect Schema ( \u5b8c\u7f8e\u7684\u6a21\u5f0f ) \u5b8c\u7f8e\u7684\u6a21\u5f0f\u5c06\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u6570\u636e\u5c06\u4ee5\u8fd9\u6837\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u53d1\uff0c\u5373\u8bfb\u53d6\u548c\u5199\u5165\u5728 tablet servers \u4e0a\u5747\u5300\u5206\u5e03\u3002\u8fd9\u53d7\u5230\u5206\u533a\u7684\u5f71\u54cd\u3002 Tablets \u5c06\u4ee5\u5747\u5300\uff0c\u53ef\u9884\u6d4b\u7684\u901f\u5ea6\u589e\u957f\uff0c tablets \u7684\u8d1f\u8f7d\u5c06\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u4fdd\u6301\u7a33\u5b9a\u3002\u8fd9\u6700\u53d7\u5f71\u54cd\u5206\u533a\u3002 \u626b\u63cf\u5c06\u8bfb\u53d6\u5b8c\u6210\u67e5\u8be2\u6240\u9700\u7684\u6700\u5c11\u6570\u636e\u91cf\u3002\u8fd9\u4e3b\u8981\u53d7\u5230\u4e3b\u952e\u8bbe\u8ba1\u7684\u5f71\u54cd\uff0c\u4f46\u5206\u533a\u4e5f\u901a\u8fc7\u5206\u533a\u4fee\u526a\u6765\u8d77\u4f5c\u7528\u3002 \u5b8c\u7f8e\u7684\u6a21\u5f0f\u53d6\u51b3\u4e8e\u6570\u636e\u7684\u7279\u6027\uff0c\u9700\u8981\u505a\u7684\u4e8b\u60c5\u4ee5\u53ca\u96c6\u7fa4\u7684\u62d3\u6251\u3002\u6a21\u5f0f\u8bbe\u8ba1\u662f\u60a8\u6700\u5927\u9650\u5ea6\u5730\u53d1\u6325 Kudu \u96c6\u7fa4\u6027\u80fd\u7684\u6700\u91cd\u8981\u7684\u4e00\u4ef6\u4e8b\u3002 Column Design ( \u5217\u8bbe\u8ba1 ) Kudu \u8868\u7531\u4e00\u4e2a\u5217\u6216\u591a\u4e2a\u5217\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5217\u90fd\u6709\u4e00\u4e2a\u5b9a\u4e49\u7684\u7c7b\u578b\u3002\u4e0d\u5c5e\u4e8e\u4e3b\u952e\u7684\u5217\u53ef\u80fd\u4e3a\u7a7a\u3002\u652f\u6301\u7684\u5217\u7c7b\u578b\u5305\u62ec\uff1a boolean 8-bit signed integer 16-bit signed integer 32-bit signed integer 64-bit signed integer unixtime_micros (\u4ece UNIX \u65f6\u4ee3\u8d77\uff0c64 \u4f4d\u5fae\u79d2) single-precision (32-bit) IEEE-754 floating-point number ( \u5355\u7cbe\u5ea6\uff0c32\u4f4d\uff0cIEEE-754 \u6d6e\u70b9\u6570 ) double-precision (64-bit) IEEE-754 floating-point number ( \u53cc\u7cbe\u5ea6\uff0c64\u4f4d\uff0cIEEE-754 \u6d6e\u70b9\u6570 ) UTF-8 encoded string (up to 64KB uncompressed) ( UTF-8 \u7f16\u7801\u5b57\u7b26\u4e32\uff08\u9ad8\u8fbe 64KB \u672a\u538b\u7f29\uff09 ) binary (up to 64KB uncompressed) ( \u4e8c\u8fdb\u5236\uff08\u9ad8\u8fbe 64KB \u672a\u538b\u7f29\uff09 ) Kudu \u5229\u7528\u5f3a\u7c7b\u578b\u7684\u5217\u548c\u67f1\u72b6\u78c1\u76d8\u5b58\u50a8\u683c\u5f0f\u6765\u63d0\u4f9b\u9ad8\u6548\u7684\u7f16\u7801\u548c\u5e8f\u5217\u5316\u3002\u4e3a\u4e86\u5145\u5206\u5229\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u5217\u5e94\u8be5\u88ab\u6307\u5b9a\u4e3a\u9002\u5f53\u7684\u7c7b\u578b\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u5b57\u7b26\u4e32\u6216\u4e8c\u8fdb\u5236\u5217\u6765\u6a21\u62df ' schemaless ' \u8868\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u8fdb\u884c\u7ed3\u6784\u5316\u3002\u9664\u4e86\u7f16\u7801\u4e4b\u5916\uff0cKudu \u5141\u8bb8\u6309\u7167\u6bcf\u5217\u8fdb\u884c\u538b\u7f29\u3002 Column Encoding ( \u5217\u7f16\u7801 ) \u53ef\u4ee5\u6839\u636e\u5217\u7684\u7c7b\u578b\uff0c\u4f7f\u7528\u7f16\u7801\u521b\u5efa Kudu \u8868\u4e2d\u7684\u6bcf\u4e2a\u5217\u3002 \u8868 1. Encoding type ( \u7f16\u7801\u7c7b\u578b ) Column Type ( \u5217\u7c7b\u578b ) Encoding ( \u7f16\u7801 ) Default ( \u9ed8\u8ba4 ) int8, int16, int32 plain, bitshuffle, run length bitshuffle int64, unixtime_micros plain, bitshuffle, run length bitshuffle float, double plain, bitshuffle bitshuffle bool plain, run length run length string, binary plain, prefix, dictionary dictionary plain Encoding ( \u666e\u901a\u7f16\u7801 ) \u6570\u636e\u4ee5\u5176\u81ea\u7136\u683c\u5f0f\u5b58\u50a8\u3002\u4f8b\u5982\uff0c int32 values \u4f5c\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684 32 \u4f4d little-endian integers \u5b58\u50a8\u3002 Bitshuffle Encoding \u91cd\u65b0\u6392\u5217\u4e00\u7ec4\u503c\u4ee5\u5b58\u50a8\u6bcf\u4e2a\u503c\u7684\u6700\u9ad8\u6709\u6548\u4f4d\uff0c\u5176\u6b21\u662f\u6bcf\u4e2a\u503c\u7684\u7b2c\u4e8c\u4e2a\u6700\u9ad8\u6709\u6548\u4f4d\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002\u6700\u540e\uff0c\u7ed3\u679c\u662f LZ4 \u538b\u7f29\u3002 Bitshuffle \u7f16\u7801\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u91cd\u590d\u503c\u7684\u5217\u6216\u6309\u4e3b\u952e\u6392\u5e8f\u65f6\u5c11\u91cf\u66f4\u6539\u7684\u5217\u662f\u4e0d\u9519\u7684\u9009\u62e9\u3002 bithuffle \u9879\u76ee\u5bf9\u6027\u80fd\u548c\u7528\u4f8b\u6709\u5f88\u597d\u7684\u6982\u8ff0\u3002 Run Length Encoding ( \u8fd0\u884c\u957f\u5ea6\u7f16\u7801 ) \u901a\u8fc7\u4ec5\u5b58\u50a8\u503c\u548c\u8ba1\u6570\uff0c\u5728\u5217\u4e2d\u538b\u7f29\u8fd0\u884c\uff08\u8fde\u7eed\u91cd\u590d\u503c\uff09\u3002\u5f53\u6309\u4e3b\u952e\u6392\u5e8f\u65f6\uff0c\u8fd0\u884c\u957f\u5ea6\u7f16\u7801\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u8fde\u7eed\u91cd\u590d\u503c\u7684\u5217\u662f\u6709\u6548\u7684\u3002 Dictionary Encoding ( \u5b57\u5178\u7f16\u7801 ) \u6784\u5efa\u4e86\u552f\u4e00\u503c\u7684\u5b57\u5178\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5217\u503c\u90fd\u88ab\u7f16\u7801\u4e3a\u5b57\u5178\u4e2d\u7684\u76f8\u5e94\u7d22\u5f15\u3002\u5b57\u5178\u7f16\u7801\u5bf9\u4e8e\u57fa\u6570\u8f83\u4f4e\u7684\u5217\u662f\u6709\u6548\u7684\u3002\u5982\u679c\u7ed9\u5b9a\u884c\u96c6\u7684\u5217\u503c\u7531\u4e8e\u552f\u4e00\u503c\u7684\u6570\u91cf\u592a\u9ad8\u800c\u65e0\u6cd5\u538b\u7f29\uff0c\u5219 Kudu \u5c06\u900f\u660e\u5730\u56de\u9000\u5230\u8be5\u884c\u96c6\u7684\u7eaf\u7f16\u7801\u3002\u8fd9\u5728 flush \u8fc7\u7a0b\u4e2d\u8fdb\u884c\u8bc4\u4f30\u3002 Prefix Encoding ( \u524d\u7f00\u7f16\u7801 ) \u516c\u5171\u524d\u7f00\u5728\u8fde\u7eed\u5217\u503c\u4e2d\u8fdb\u884c\u538b\u7f29\u3002\u524d\u7f00\u7f16\u7801\u5bf9\u4e8e\u5171\u4eab\u516c\u5171\u524d\u7f00\u7684\u503c\u6216\u4e3b\u952e\u7684\u7b2c\u4e00\u5217\u53ef\u80fd\u6709\u6548\uff0c\u56e0\u4e3a\u884c\u6309 tablet \u5185\u7684\u4e3b\u952e\u6392\u5e8f\u3002 Column Compression ( \u5217\u538b\u7f29 ) Kudu \u5141\u8bb8\u4f7f\u7528 LZ4 \uff0c Snappy \u6216 zlib \u538b\u7f29\u7f16\u89e3\u7801\u5668\u8fdb\u884c\u6bcf\u5217\u538b\u7f29\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5217\u672a\u538b\u7f29\u5b58\u50a8\u3002\u5982\u679c\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\u6bd4\u539f\u59cb\u626b\u63cf\u6027\u80fd\u66f4\u91cd\u8981\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u538b\u7f29\u3002 Primary Key Design ( \u4e3b\u952e\u8bbe\u8ba1 ) \u6bcf\u4e2a Kudu \u8868\u5fc5\u987b\u58f0\u660e\u4e00\u4e2a\u4e3b\u952e\u7d22\u5f15\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u7ec4\u6210\u3002\u4e3b\u952e\u5217\u5fc5\u987b\u4e0d\u53ef\u4e3a\u7a7a\uff0c\u5e76\u4e14\u53ef\u80fd\u4e0d\u662f\u5e03\u5c14\u503c\u6216\u6d6e\u70b9\u578b\u3002\u5728\u8868\u521b\u5efa\u671f\u95f4\u8bbe\u7f6e\u540e\uff0c\u4e3b\u952e\u4e2d\u7684\u5217\u96c6\u5408\u53ef\u80fd\u4e0d\u4f1a\u66f4\u6539\u3002\u50cf RDBMS \u4e3b\u952e\u4e00\u6837\uff0c Kudu \u4e3b\u952e\u5f3a\u5236\u6267\u884c\u552f\u4e00\u6027\u7ea6\u675f;\u5c1d\u8bd5\u63d2\u5165\u4e0e\u73b0\u6709\u884c\u5177\u6709\u76f8\u540c\u4e3b\u952e\u503c\u7684\u884c\u5c06\u5bfc\u81f4\u91cd\u590d\u7684\u952e\u9519\u8bef\u3002 \u4e0e RDBMS \u4e0d\u540c\uff0c Kudu \u4e0d\u63d0\u4f9b\u81ea\u52a8\u9012\u589e\u5217\u529f\u80fd\uff0c\u56e0\u6b64\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u59cb\u7ec8\u5728\u63d2\u5165\u671f\u95f4\u63d0\u4f9b\u5b8c\u6574\u7684\u4e3b\u952e\u3002\u884c\u5220\u9664\u548c\u66f4\u65b0\u64cd\u4f5c\u8fd8\u5fc5\u987b\u6307\u5b9a\u8981\u66f4\u6539\u7684\u884c\u7684\u5b8c\u6574\u4e3b\u952e; Kudu \u672c\u8eab\u4e0d\u652f\u6301\u8303\u56f4\u5220\u9664\u6216\u66f4\u65b0\u3002\u5728\u63d2\u5165\u884c\u4e4b\u540e\uff0c\u5217\u7684\u4e3b\u952e\u503c\u53ef\u80fd\u4e0d\u4f1a\u88ab\u66f4\u65b0;\u4f46\u662f\uff0c\u53ef\u4ee5\u5220\u9664\u8be5\u884c\u5e76\u91cd\u65b0\u63d2\u5165\u66f4\u65b0\u7684\u503c\u3002 Primary Key Index ( \u4e3b\u952e\u7d22\u5f15 ) \u4e0e\u8bb8\u591a\u4f20\u7edf\u5173\u7cfb\u6570\u636e\u5e93\u4e00\u6837\uff0c Kudu \u7684\u4e3b\u952e\u662f clustered index ( \u805a\u96c6\u7d22\u5f15 )\u3002 tablet \u4e2d\u7684\u6240\u6709\u884c\u90fd\u4fdd\u6301\u4e3b\u952e\u6392\u5e8f\u987a\u5e8f\u3002\u5728\u4e3b\u952e\u4e0a\u6307\u5b9a\u76f8\u7b49\u6216\u8303\u56f4\u7ea6\u675f\u7684 Kudu \u626b\u63cf\u5c06\u81ea\u52a8\u8df3\u8fc7\u4e0d\u80fd\u6ee1\u8db3\u8c13\u8bcd\u7684\u884c\u3002\u8fd9\u5141\u8bb8\u901a\u8fc7\u5728\u4e3b\u952e\u5217\u4e0a\u6307\u5b9a\u76f8\u7b49\u7ea6\u675f\u6765\u6709\u6548\u5730\u627e\u5230\u5404\u884c\u3002 \u6ce8\u610f \u4e3b\u952e\u7d22\u5f15\u4f18\u5316\u9002\u7528\u4e8e\u5355\u4e2a tablet \u4e0a\u7684\u626b\u63cf\u3002\u6709\u5173\u626b\u63cf\u5982\u4f55\u4f7f\u7528\u8c13\u8bcd\u8df3\u8fc7\u6574\u4e2a tablet \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5206\u533a\u4fee\u526a \u90e8\u5206\u3002 Partitioning ( \u5206\u533a ) \u4e3a\u4e86\u63d0\u4f9b\u53ef\u6269\u5c55\u6027\uff0c Kudu \u8868\u88ab\u5212\u5206\u4e3a\u79f0\u4e3a tablets \u7684\u5355\u5143\uff0c\u5e76\u5206\u5e03\u5728\u8bb8\u591a tablet servers \u4e0a\u3002\u884c\u603b\u662f\u5c5e\u4e8e\u5355\u4e2a tablet \u3002\u5c06\u884c\u5206\u914d\u7ed9 tablet \u7684\u65b9\u6cd5\u7531\u5728\u8868\u521b\u5efa\u671f\u95f4\u8bbe\u7f6e\u7684\u8868\u7684\u5206\u533a\u51b3\u5b9a\u3002 \u9009\u62e9\u5206\u533a\u7b56\u7565\u9700\u8981\u4e86\u89e3\u6570\u636e\u6a21\u578b\u548c\u8868\u7684\u9884\u671f\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5bf9\u4e8e\u5199\u5165\u7e41\u91cd\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u91cd\u8981\u7684\u662f\u8bbe\u8ba1\u5206\u533a\uff0c\u4ee5\u4f7f\u5199\u5165\u5206\u6563\u5728 tablet \u4e0a\uff0c\u4ee5\u907f\u514d\u5355\u4e2a tablet \u7684\u8d85\u8f7d\u3002\u5bf9\u4e8e\u6d89\u53ca\u8bb8\u591a\u77ed\u626b\u63cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5982\u679c\u6240\u6709\u626b\u63cf\u7684\u6570\u636e\u4f4d\u4e8e\u540c\u4e00\u4e2a tablet \u4e2d\uff0c\u90a3\u4e48\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u5f00\u9500\u5360\u4e3b\u5bfc\u5730\u4f4d\uff0c\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002\u4e86\u89e3\u8fd9\u4e9b\u57fa\u672c\u6743\u8861\u662f\u8bbe\u8ba1\u6709\u6548\u7684\u5206\u533a\u6a21\u5f0f\u7684\u6838\u5fc3\u3002 \u91cd\u8981 \u6ca1\u6709\u9ed8\u8ba4\u5206\u533a Kudu \u5728\u521b\u5efa\u8868\u65f6\u4e0d\u63d0\u4f9b\u9ed8\u8ba4\u5206\u533a\u7b56\u7565\u3002\u5efa\u8bae\u9884\u671f\u5177\u6709\u8f83\u5927\u8bfb\u5199\u5de5\u4f5c\u8d1f\u8377\u7684\u65b0\u8868\u81f3\u5c11\u4e0e tablet servers \u4e00\u6837\u591a\u7684 tablets \u3002 Kudu \u63d0\u4f9b\u4e86\u4e24\u79cd\u7c7b\u578b\u7684\u5206\u533a\uff1a range partitioning ( \u8303\u56f4\u5206\u533a ) \u548c hash partitioning ( \u54c8\u5e0c\u5206\u533a ) \u3002\u8868\u4e5f\u53ef\u80fd\u5177\u6709 \u591a\u7ea7\u5206\u533a \uff0c\u5176\u7ed3\u5408\u8303\u56f4\u548c\u54c8\u5e0c\u5206\u533a\uff0c\u6216\u591a\u4e2a\u6563\u5217\u5206\u533a\u5b9e\u4f8b\u3002 Range Partitioning ( \u8303\u56f4\u5206\u533a ) \u8303\u56f4\u5206\u533a\u4f7f\u7528\u5b8c\u5168\u6709\u5e8f\u7684\u5206\u533a\u952e\u5206\u914d\u884c\u3002\u6bcf\u4e2a\u5206\u533a\u5206\u914d\u4e86\u8303\u56f4\u5206\u533a\u5bc6\u94a5\u7a7a\u95f4\u7684\u8fde\u7eed\u6bb5\u3002\u5bc6\u94a5\u5fc5\u987b\u7531\u4e3b\u952e\u5217\u7684\u5b50\u96c6\u7ec4\u6210\u3002\u5982\u679c\u8303\u56f4\u5206\u533a\u5217\u4e0e\u4e3b\u952e\u5217\u5339\u914d\uff0c\u5219\u884c\u7684\u8303\u56f4\u5206\u533a\u952e\u5c06\u7b49\u4e8e\u5176\u4e3b\u952e\u3002\u5728\u6ca1\u6709\u54c8\u5e0c\u5206\u533a\u7684\u8303\u56f4\u5206\u533a\u8868\u4e2d\uff0c\u6bcf\u4e2a\u8303\u56f4\u5206\u533a\u5c06\u5bf9\u5e94\u4e8e\u4e00\u4e2a tablet \u3002 \u5728\u521b\u5efa\u8868\u65f6\uff0c\u5c06\u521d\u59cb\u7684\u8303\u56f4\u5206\u533a\u96c6\u5408\u6307\u5b9a\u4e3a\u4e00\u7ec4\u5206\u533a\u8fb9\u754c\u548c\u62c6\u5206\u884c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7ed1\u5b9a\uff0c\u5c06\u5728\u8868\u4e2d\u521b\u5efa\u4e00\u4e2a\u8303\u56f4\u5206\u533a\u3002\u6bcf\u4e2a\u5206\u5272\u5c06\u4e24\u4e2a\u8303\u56f4\u5206\u5272\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5206\u533a\u754c\u9650\uff0c\u5219\u8868\u5c06\u9ed8\u8ba4\u4e3a\u8986\u76d6\u6574\u4e2a\u5bc6\u94a5\u7a7a\u95f4\u7684\u5355\u4e2a\u5206\u533a\uff08\u4e0b\u9762\u548c\u4e0b\u9762\u65e0\u754c\u9650\uff09\u3002\u8303\u56f4\u5206\u533a\u5fc5\u987b\u59cb\u7ec8\u4e0d\u91cd\u53e0\uff0c\u62c6\u5206\u884c\u5fc5\u987b\u5728\u8303\u56f4\u5206\u533a\u5185\u3002 \u91cd\u8981 \u8bf7\u53c2\u9605 \u8303\u56f4\u5206\u533a\u793a\u4f8b \uff0c\u4ee5\u8fdb\u4e00\u6b65\u8ba8\u8bba\u8303\u56f4\u5206\u533a\u3002 Range Partition Management ( \u8303\u56f4\u5206\u533a\u7ba1\u7406 ) Kudu \u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u4ece\u8868\u4e2d\u52a8\u6001\u6dfb\u52a0\u548c\u5220\u9664\u8303\u56f4\u5206\u533a\uff0c\u800c\u4e0d\u5f71\u54cd\u5176\u4ed6\u5206\u533a\u7684\u53ef\u7528\u6027\u3002\u5220\u9664\u5206\u533a\u5c06\u5220\u9664\u5c5e\u4e8e\u5206\u533a\u7684 tablet \u4ee5\u53ca\u5176\u4e2d\u5305\u542b\u7684\u6570\u636e\u3002\u968f\u540e\u63d2\u5165\u5230\u4e22\u5f03\u7684\u5206\u533a\u5c06\u5931\u8d25\u3002\u53ef\u4ee5\u6dfb\u52a0\u65b0\u5206\u533a\uff0c\u4f46\u4e0d\u80fd\u4e0e\u4efb\u4f55\u73b0\u6709\u7684\u5206\u533a\u5206\u533a\u91cd\u53e0\u3002 Kudu \u5141\u8bb8\u5728\u5355\u4e2a\u4e8b\u52a1\u6027\u66f4\u6539\u8868\u64cd\u4f5c\u4e2d\u5220\u9664\u5e76\u6dfb\u52a0\u4efb\u610f\u6570\u91cf\u7684\u8303\u56f4\u5206\u533a\u3002 \u52a8\u6001\u6dfb\u52a0\u548c\u5220\u9664\u8303\u56f4\u5206\u533a\u5bf9\u4e8e\u65f6\u95f4\u5e8f\u5217\u4f7f\u7528\u60c5\u51b5\u5c24\u5176\u6709\u7528\u3002\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0c\u53ef\u4ee5\u6dfb\u52a0\u8303\u56f4\u5206\u533a\u4ee5\u8986\u76d6\u5373\u5c06\u5230\u6765\u7684\u65f6\u95f4\u8303\u56f4\u3002\u4f8b\u5982\uff0c\u5b58\u50a8\u4e8b\u4ef6\u65e5\u5fd7\u7684\u8868\u53ef\u4ee5\u5728\u6bcf\u6708\u5f00\u59cb\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u6708\u4efd\u7684\u5206\u533a\uff0c\u4ee5\u4fbf\u4fdd\u5b58\u5373\u5c06\u5230\u6765\u7684\u4e8b\u4ef6\u3002\u5fc5\u8981\u65f6\u53ef\u4ee5\u5220\u9664\u65e7\u8303\u56f4\u5206\u533a\uff0c\u4ee5\u4fbf\u6709\u6548\u5730\u5220\u9664\u5386\u53f2\u6570\u636e\u3002 Hash Partitioning ( \u54c8\u5e0c\u5206\u533a ) \u54c8\u5e0c\u5206\u533a\u901a\u8fc7\u54c8\u5e0c\u503c\u5c06\u884c\u5206\u914d\u5230\u8bb8\u591a buckets ( \u5b58\u50a8\u6876 )\u4e4b\u4e00\u3002\u5728 single-level hash partitioned tables ( \u5355\u7ea7\u6563\u5217\u5206\u533a\u8868 )\u4e2d\uff0c\u6bcf\u4e2a bucket ( \u5b58\u50a8\u6876 ) \u5c06\u5bf9\u5e94\u4e8e\u4e00\u4e2a tablet \u3002\u5728\u521b\u5efa\u8868\u65f6\u8bbe\u7f6e\u6876\u6570\u3002\u901a\u5e38\uff0c\u4e3b\u952e\u5217\u7528\u4f5c\u6563\u5217\u7684\u5217\uff0c\u4f46\u4e0e\u8303\u56f4\u5206\u533a\u4e00\u6837\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e3b\u952e\u5217\u7684\u4efb\u4f55\u5b50\u96c6\u3002 \u54c8\u5e0c\u5206\u533a\u662f\u4e00\u79cd\u6709\u6548\u7684\u7b56\u7565\uff0c\u5f53\u4e0d\u9700\u8981\u5bf9\u8868\u8fdb\u884c\u6709\u5e8f\u8bbf\u95ee\u65f6\u3002\u54c8\u5e0c\u5206\u533a\u5bf9\u4e8e\u5728 tablet \u4e4b\u95f4\u968f\u673a\u6563\u5e03\u8fd9\u4e9b\u529f\u80fd\u662f\u6709\u6548\u7684\uff0c\u8fd9\u6709\u52a9\u4e8e\u51cf\u8f7b\u70ed\u70b9\u548c tablet \u5927\u5c0f\u4e0d\u5747\u5300\u3002 \u6ce8\u610f \u6709\u5173\u54c8\u5e0c\u5206\u533a\u7684\u8fdb\u4e00\u6b65\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 \u54c8\u5e0c\u5206\u533a\u793a\u4f8b \u3002 Multilevel Partitioning ( \u591a\u7ea7\u5206\u533a ) Kudu \u5141\u8bb8\u4e00\u4e2a\u8868\u5728\u5355\u4e2a\u8868\u4e0a\u7ec4\u5408\u591a\u7ea7\u5206\u533a\u3002\u96f6\u4e2a\u6216\u591a\u4e2a\u54c8\u5e0c\u5206\u533a\u7ea7\u522b\u53ef\u4ee5\u4e0e\u53ef\u9009\u7684\u8303\u56f4\u5206\u533a\u7ea7\u522b\u7ec4\u5408\u3002\u9664\u4e86\u5355\u4e2a\u5206\u533a\u7c7b\u578b\u7684\u7ea6\u675f\u4e4b\u5916\uff0c\u591a\u7ea7\u5206\u533a\u7684\u552f\u4e00\u9644\u52a0\u7ea6\u675f\u662f\u591a\u4e2a\u7ea7\u522b\u7684\u54c8\u5e0c\u5206\u533a\u4e0d\u80fd\u5bf9\u76f8\u540c\u7684\u5217\u8fdb\u884c\u54c8\u5e0c\u3002 \u5f53\u6b63\u786e\u4f7f\u7528\u65f6\uff0c\u591a\u7ea7\u5206\u533a\u53ef\u4ee5\u4fdd\u7559\u5404\u4e2a\u5206\u533a\u7c7b\u578b\u7684\u4f18\u70b9\uff0c\u540c\u65f6\u51cf\u5c11\u6bcf\u4e2a\u5206\u533a\u7684\u7f3a\u70b9\u3002\u591a\u7ea7\u5206\u533a\u8868\u4e2d\u7684 tablet \u603b\u6570\u662f\u6bcf\u4e2a\u7ea7\u522b\u4e2d\u5206\u533a\u6570\u91cf\u7684\u4e58\u79ef\u3002 \u6ce8\u610f \u8bf7\u53c2\u9605 \u54c8\u5e0c\u548c\u8303\u56f4\u5206\u533a\u793a\u4f8b \u4ee5\u53ca \u54c8\u5e0c\u548c\u54c8\u5e0c\u5206\u533a\u793a\u4f8b \uff0c\u4ee5\u8fdb\u4e00\u6b65\u8ba8\u8bba\u591a\u7ea7\u5206\u533a\u3002 Partition Pruning ( \u5206\u533a\u4fee\u526a ) \u5f53\u53ef\u4ee5\u786e\u5b9a\u5206\u533a\u53ef\u4ee5\u88ab\u626b\u63cf\u8c13\u8bcd\u5b8c\u5168\u8fc7\u6ee4\u65f6\uff0c Kudu \u626b\u63cf\u5c06\u81ea\u52a8\u8df3\u8fc7\u626b\u63cf\u6574\u4e2a\u5206\u533a\u3002 \u8981\u4fee\u526a\u54c8\u5e0c\u5206\u533a\uff0c\u626b\u63cf\u5fc5\u987b\u5728\u6bcf\u4e2a\u6563\u5217\u5217\u4e0a\u5305\u542b\u76f8\u7b49\u8c13\u8bcd\u3002 \u8981\u4fee\u526a\u8303\u56f4\u5206\u533a\uff0c\u626b\u63cf\u5fc5\u987b\u5728\u8303\u56f4\u5206\u533a\u5217\u4e0a\u5305\u542b\u76f8\u7b49\u6216\u8303\u56f4\u8c13\u8bcd\u3002 \u5bf9\u591a\u7ea7\u5206\u533a\u8868\u7684\u626b\u63cf\u53ef\u4ee5\u72ec\u7acb\u5730\u5229\u7528\u4efb\u4f55\u7ea7\u522b\u7684\u5206\u533a\u4fee\u526a\u3002 Partitioning Examples ( \u5206\u533a\u793a\u4f8b ) \u4e3a\u4e86\u8bf4\u660e\u4e0e\u4e3a\u8868\u8bbe\u8ba1\u5206\u533a\u7b56\u7565\u76f8\u5173\u7684\u56e0\u7d20\u548c\u6743\u8861\uff0c\u6211\u4eec\u5c06\u901a\u8fc7\u4e00\u4e9b\u4e0d\u540c\u7684\u5206\u533a\u65b9\u6848\u3002 \u8003\u8651\u5b58\u50a8\u673a\u5668\u5ea6\u91cf\u6570\u636e\u7684\u4e0b\u8868\u6a21\u5f0f\uff08\u4e3a\u4e86\u6e05\u695a\u8d77\u89c1\uff0c\u4f7f\u7528 SQL \u8bed\u6cd5\u548c\u65e5\u671f\u683c\u5f0f\u7684\u65f6\u95f4\u6233\uff09\uff1a CREATE TABLE metrics ( host STRING NOT NULL, metric STRING NOT NULL, time INT64 NOT NULL, value DOUBLE NOT NULL, PRIMARY KEY (host, metric, time), ); Range Partitioning Example ( \u8303\u56f4\u5206\u533a\u793a\u4f8b ) \u5206\u5272\u5ea6\u91cf\u8868\u7684\u4e00\u79cd\u81ea\u7136\u65b9\u5f0f\u662f\u5728\u65f6\u95f4\u5217\u4e0a\u5bf9\u8303\u56f4\u8fdb\u884c\u5206\u533a\u3002\u5047\u8bbe\u6211\u4eec\u60f3\u8981\u6bcf\u5e74\u90fd\u6709\u4e00\u4e2a\u5206\u533a\uff0c\u8be5\u8868\u5c06\u4fdd\u5b58 2014 \u5e74\uff0c 2015 \u5e74\u548c 2016 \u5e74\u7684\u6570\u636e\u3002\u8868\u683c\u81f3\u5c11\u6709\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u88ab\u5206\u5272\uff1a\u5177\u6709\u65e0\u754c\u8303\u56f4\u7684\u5206\u533a\uff0c\u4e5f\u53ef\u4ee5\u662f\u6709\u9650\u8303\u56f4\u7684\u5206\u533a\u3002 \u4e0a\u56fe\u663e\u793a\u4e86\u5ea6\u91cf\u8868\u53ef\u4ee5\u5728\u65f6\u95f4\u5217\u4e0a\u8fdb\u884c\u8303\u56f4\u5206\u533a\u7684\u4e24\u79cd\u65b9\u5f0f\u3002\u5728\u7b2c\u4e00\u4e2a\u793a\u4f8b\uff08\u84dd\u8272\uff09\u4e2d\uff0c\u4f7f\u7528\u9ed8\u8ba4\u8303\u56f4\u5206\u533a\u8fb9\u754c\uff0c\u5e76\u5728 2015-01-01 \u548c 2014 \u5e74 1 \u6708\u5206\u9694\u3002\u8fd9\u5bfc\u81f4\u4e09\u4e2a tablet \uff1a 2015 \u5e74\u4e4b\u524d\u7684\u7b2c\u4e00\u4e2a\u503c\uff0c 2015 \u5e74\u7684\u7b2c\u4e8c\u4e2a\u503c\uff0c\u4ee5\u53ca 2016 \u5e74\u4ee5\u540e\u7684\u7b2c\u4e09\u4e2a\u503c\u3002\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\uff08\u7eff\u8272\uff09\u4f7f\u7528\u4e86 [(2014-01-01) \uff0c (2017-01-01)] \uff0c\u5e76\u5206\u671f\u4e8e 2015-01-01 \u548c 2016-01-01 \u3002\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u53ef\u4ee5\u7b49\u4ef7\u5730\u901a\u8fc7 [(2014-01-01)\uff0c(2015-01-01)]\uff0c[(2015-01-01) \uff0c (2016-01-01)] \u548c [(2016-01-01)\uff0c(2017-01-01)] \uff0c\u6ca1\u6709\u5206\u88c2\u3002\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u6709\u65e0\u754c\u7684\u4e0b\u9650\u548c\u4e0a\u9650\u5206\u533a\uff0c\u800c\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u5305\u62ec\u8fb9\u754c\u3002 \u4e0a\u8ff0\u8303\u56f4\u5206\u533a\u793a\u4f8b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u5141\u8bb8\u6709\u65f6\u9650\u7684\u626b\u63cf\u6765\u4fee\u526a\u6389\u5728\u626b\u63cf\u65f6\u95f4\u9650\u5236\u4e4b\u5916\u7684\u5206\u533a\u3002\u5f53\u6709\u5f88\u591a\u5206\u533a\u65f6\uff0c\u8fd9\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u6027\u80fd\u3002\u5199\u4f5c\u65f6\uff0c\u4e24\u4e2a\u4f8b\u5b50\u90fd\u6709\u6f5c\u5728\u7684\u70ed\u70b9\u95ee\u9898\u3002\u7531\u4e8e\u5ea6\u91cf\u8d8b\u5411\u4e8e\u59cb\u7ec8\u5728\u5f53\u524d\u65f6\u95f4\u5199\u5165\uff0c\u5927\u591a\u6570\u5199\u5165\u5c06\u8fdb\u5165\u5355\u4e2a\u8303\u56f4\u5206\u533a\u3002 \u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u6bd4\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u66f4\u7075\u6d3b\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u672a\u6765\u51e0\u5e74\u7684\u8303\u56f4\u5206\u533a\u6dfb\u52a0\u5230\u8868\u4e2d\u3002\u5728\u7b2c\u4e00\u4e2a\u793a\u4f8b\u4e2d\uff0c\u5728 2016-01-01 \u4e4b\u540e\u7684\u65f6\u95f4\u7684\u6240\u6709\u5199\u5165\u5c06\u843d\u5165\u6700\u540e\u4e00\u4e2a\u5206\u533a\uff0c\u56e0\u6b64\u5206\u533a\u53ef\u80fd\u6700\u7ec8\u53d8\u5f97\u592a\u5927\uff0c\u4ee5\u81f4\u4e8e\u5355\u4e2a tablet servers \u65e0\u6cd5\u5904\u7406\u3002 Hash Partitioning Example ( \u54c8\u5e0c\u5206\u533a\u793a\u4f8b ) \u5206\u5272 metrics table ( \u5ea6\u91cf\u8868 ) \u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5728 host \u548c metric columns ( \u5ea6\u91cf\u5217 ) \u4e0a\u54c8\u5e0c\u5206\u533a\u3002 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c metrics table \u662f\u5c06 host \u548c metric columns \u4e0a\u7684\u54c8\u5e0c\u5206\u533a\u5206\u4e3a\u56db\u4e2a\u5b58\u50a8\u6876\u3002\u4e0e\u524d\u9762\u7684\u8303\u56f4\u5206\u533a\u793a\u4f8b\u4e0d\u540c\uff0c\u6b64\u5206\u533a\u7b56\u7565\u5c06\u5747\u5300\u5730\u5728\u8868\u4e2d\u7684\u6240\u6709 tablets \u4e0a\u4f20\u64ad\u5199\u5165\uff0c\u8fd9\u6709\u52a9\u4e8e\u603b\u4f53\u5199\u5165\u541e\u5410\u91cf\u3002\u901a\u8fc7\u6307\u5b9a\u76f8\u7b49\u8c13\u8bcd\uff0c\u626b\u63cf\u7279\u5b9a\u7684 host \u548c metric \u53ef\u4ee5\u5229\u7528\u5206\u533a\u4fee\u526a\uff0c\u5c06\u626b\u63cf\u7684 tablet \u6570\u91cf\u51cf\u5c11\u5230\u4e00\u4e2a\u3002\u4f7f\u7528\u7eaf\u54c8\u5e0c\u5206\u533a\u7b56\u7565\u8981\u5c0f\u5fc3\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u968f\u7740\u8d8a\u6765\u8d8a\u591a\u7684\u6570\u636e\u88ab\u63d2\u5165\u5230\u8868\u4e2d\uff0c tablet \u53ef\u4ee5\u65e0\u9650\u671f\u5730\u589e\u957f\u3002\u6700\u7ec8 tablet \u5c06\u53d8\u5f97\u592a\u5927\uff0c\u65e0\u6cd5\u8ba9\u4e2a\u4eba tablet servers \u6301\u6709\u3002 \u6ce8\u610f \u867d\u7136\u8fd9\u4e9b\u793a\u4f8b\u7f16\u53f7\u4e3a tablet \uff0c\u4f46\u5b9e\u9645\u4e0a tablet \u53ea\u63d0\u4f9b UUID \u6807\u8bc6\u7b26\u3002\u54c8\u5e0c\u5206\u533a\u8868\u4e2d\u7684 tablet \u4e4b\u95f4\u6ca1\u6709\u81ea\u7136\u6392\u5e8f\u3002 Hash and Range Partitioning Example ( \u54c8\u5e0c\u548c\u8303\u56f4\u5206\u533a\u793a\u4f8b ) \u4ee5\u524d\u7684\u793a\u4f8b\u663e\u793a\u4e86 metrics table \u5982\u4f55\u5728 time column ( \u65f6\u95f4\u5217 ) \u4e0a\u8fdb\u884c\u8303\u56f4\u5206\u533a\uff0c\u6216\u8005\u5728 host \u548c metrics column \u4e0a\u8fdb\u884c\u54c8\u5e0c\u5206\u533a\u3002\u8fd9\u4e9b\u7b56\u7565\u5177\u6709\u76f8\u5173\u7684\u5b9e\u529b\u548c\u5f31\u70b9\uff1a \u8868 2. Partitioning Strategies ( \u5206\u533a\u7b56\u7565 ) Strategy ( \u7b56\u7565 ) Writes ( \u5199\u5165 ) Reads ( \u8bfb\u53d6 ) Tablet Growth ( tablet \u589e\u957f ) range(time) \u2717 - \u6240\u6709\u5199\u5165\u5230\u6700\u65b0\u5206\u533a \u2713 - \u53ef\u4ee5\u4fee\u526a\u4e0e\u65f6\u95f4\u7ed1\u5b9a\u7684 scan \u2713 - \u53ef\u4ee5\u5728\u672a\u6765\u7684\u65f6\u95f4\u6bb5\u6dfb\u52a0\u65b0\u7684 tablets hash(host, metric) \u2713 - \u5728 tablets \u4e0a\u5747\u5300\u5206\u5e03 \u2713 - \u53ef\u4ee5\u4fee\u526a\u5bf9\u7279\u5b9a hosts \u548c metrics \u7684 scan \u2717 - tablets \u53ef\u4ee5\u589e\u957f\u5230\u5f88\u5927 \u54c8\u5e0c\u5206\u533a\u6709\u5229\u4e8e\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u5199\u5165\u541e\u5410\u91cf\uff0c\u800c\u8303\u56f4\u5206\u533a\u53ef\u907f\u514d tablet \u65e0\u9650\u589e\u957f\u7684\u95ee\u9898\u3002\u8fd9\u4e24\u79cd\u7b56\u7565\u90fd\u53ef\u4ee5\u5229\u7528\u5206\u533a\u4fee\u526a\u6765\u4f18\u5316\u4e0d\u540c\u573a\u666f\u4e2d\u7684\u626b\u63cf\u3002\u4f7f\u7528\u591a\u7ea7\u5206\u533a\uff0c\u53ef\u4ee5\u7ec4\u5408\u8fd9\u4e24\u79cd\u7b56\u7565\uff0c\u4ee5\u83b7\u5f97\u4e24\u8005\u7684\u4f18\u70b9\uff0c\u540c\u65f6\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u6bcf\u4e2a\u7b56\u7565\u7684\u7f3a\u70b9\u3002 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c time column \u4e0a\u7684\u8303\u56f4\u5206\u533a\u4e0e host \u548c metric columns \u4e0a\u7684\u54c8\u5e0c\u5206\u533a\u76f8\u7ed3\u5408\u3002\u8fd9\u4e2a\u7b56\u7565\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u5177\u6709\u4e8c\u7ef4\u5212\u5206\uff1a\u4e00\u4e2a\u7528\u4e8e\u54c8\u5e0c\u7ea7\u522b\uff0c\u4e00\u4e2a\u7528\u4e8e\u8303\u56f4\u7ea7\u522b\u3002\u5728\u5f53\u524d\u65f6\u523b\u5199\u5165\u6b64\u8868\u5c06\u5e76\u884c\u5316\u5230\u54c8\u5e0c\u6876\u7684\u6570\u91cf\uff0c\u5728 4 \u8fd9\u79cd\u60c5\u51b5\u4e0b\u3002\u8bfb\u53d6\u53ef\u4ee5\u5229\u7528\u65f6\u95f4\u9650\u5236\u548c\u7279\u5b9a\u7684 host \u548c metric \u8c13\u8bcd\u6765\u4fee\u526a\u5206\u533a\u3002\u53ef\u4ee5\u6dfb\u52a0\u65b0\u7684\u8303\u56f4\u5206\u533a\uff0c\u8fd9\u5c06\u5bfc\u81f4\u521b\u5efa 4 \u4e2a\u989d\u5916\u7684 tablet \uff08\u597d\u50cf\u65b0\u5217\u5df2\u6dfb\u52a0\u5230\u56fe\u8868\u4e2d\uff09\u3002 Hash and Hash Partitioning Example ( \u54c8\u5e0c\u548c\u54c8\u5e0c\u793a\u4f8b ) Kudu \u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u8868\u4e2d\u652f\u6301\u4efb\u610f\u6570\u91cf\u7684\u54c8\u5e0c\u5206\u533a\u7ea7\u522b\uff0c\u53ea\u8981\u8fd9\u4e9b\u7ea7\u522b\u6ca1\u6709\u5171\u540c\u7684 hashed columns ( \u6563\u5217\u5217 ) \u3002 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u8868\u662f\u4e3b\u673a\u4e0a\u7684\u54c8\u5e0c\u5206\u533a\uff0c\u5206\u4e3a 4 \u4e2a\u6876\uff0c\u6563\u5217\u5728\u516c\u5236\u4e2d\u5206\u533a\u4e3a 3 \u4e2a\u6876\uff0c\u4ece\u800c\u4ea7\u751f12\u4e2a tablet \u3002\u5c3d\u7ba1\u5728\u4f7f\u7528\u6b64\u7b56\u7565\u65f6\uff0c\u6240\u6709 tablets \u4e2d\u7684\u5199\u5165\u5c06\u8d8b\u5411\u4e8e\u4f20\u64ad\uff0c\u4f46\u662f\u6bd4\u5355\u72ec\u7684 host \u6216 metric \u7684\u6240\u6709\u503c\u59cb\u7ec8\u5c5e\u4e8e\u5355\u4e2a tablet \u65f6\uff0c\u4e0e\u591a\u4e2a\u72ec\u7acb\u5217\u7684\u54c8\u5e0c\u5206\u533a\u76f8\u6bd4\uff0c\u5b83\u66f4\u5bb9\u6613\u53d7\u5230\u70ed\u70b9\u67e5\u627e\u3002\u626b\u63cf\u53ef\u4ee5\u5206\u522b\u5229\u7528 host \u548c metric columns \u4e0a\u7684\u7b49\u5f0f\u8c13\u8bcd\u6765\u4fee\u526a\u5206\u533a\u3002 \u591a\u7ea7\u54c8\u5e0c\u5206\u533a\u4e5f\u53ef\u4ee5\u4e0e\u8303\u56f4\u5206\u533a\u76f8\u7ed3\u5408\uff0c\u903b\u8f91\u4e0a\u589e\u52a0\u4e86\u5206\u533a\u7684\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u3002 Schema Alterations ( \u6a21\u5f0f\u53d8\u66f4 ) \u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u66f4\u6539\u8868\u7684\u6a21\u5f0f\uff1a \u91cd\u547d\u540d\u8868 \u91cd\u547d\u540d\u4e3b\u952e\u5217 \u91cd\u547d\u540d\uff0c\u6dfb\u52a0\u6216\u5220\u9664\u975e\u4e3b\u952e\u5217 \u6dfb\u52a0\u548c\u5220\u9664\u8303\u56f4\u5206\u533a \u53ef\u4ee5\u5728\u5355\u4e2a\u4e8b\u52a1\u64cd\u4f5c\u4e2d\u7ec4\u5408\u591a\u4e2a\u66f4\u6539\u6b65\u9aa4\u3002 \u6ce8\u610f \u91cd\u547d\u540d\u4e3b\u952e\u5217 KUDU-1626 \uff1a Kudu \u8fd8\u4e0d\u652f\u6301\u91cd\u547d\u540d\u4e3b\u952e\u5217\u3002 Known Limitations ( \u5df2\u77e5\u9650\u5236 ) Kudu \u76ee\u524d\u6709\u4e00\u4e9b\u5df2\u77e5\u7684\u9650\u5236\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6a21\u5f0f\u8bbe\u8ba1\u3002 Number of Columns ( \u5217\u6570 ) \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c Kudu \u4e0d\u5141\u8bb8\u521b\u5efa 300 \u5217\u4ee5\u4e0a\u7684\u8868\u3002\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u8f83\u5c11\u5217\u7684\u6a21\u5f0f\u8bbe\u8ba1\u6765\u83b7\u5f97\u6700\u4f73\u6027\u80fd\u3002 Size of Cells ( \u5355\u5143\u683c\u5927\u5c0f ) \u5728\u7f16\u7801\u6216\u538b\u7f29\u4e4b\u524d\uff0c\u6ca1\u6709\u5355\u4e2a\u5355\u5143\u683c\u53ef\u80fd\u5927\u4e8e 64KB \u3002\u7ec4\u5408\u5bc6\u94a5\u7684\u5355\u5143\u5728 Kudu \u5b8c\u6210\u7684\u5185\u90e8\u590d\u5408\u5bc6\u94a5\u7f16\u7801\u4e4b\u540e\uff0c\u603b\u5171\u9650\u5236\u5728 16KB \u3002\u63d2\u5165\u4e0d\u7b26\u5408\u8fd9\u4e9b\u9650\u5236\u7684\u884c\u5c06\u5bfc\u81f4\u9519\u8bef\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 Size of Rows ( \u884c\u5927\u5c0f ) \u5c3d\u7ba1\u5355\u4e2a\u5355\u5143\u683c\u53ef\u80fd\u9ad8\u8fbe 64KB \uff0c\u800c Kudu \u6700\u591a\u652f\u6301 300 \u5217\uff0c\u4f46\u5efa\u8bae\u4e0d\u8981\u5355\u884c\u5927\u4e8e\u51e0\u767e KB \u3002 Valid Identifiers ( \u6709\u6548\u6807\u8bc6\u7b26 ) \u8bf8\u5982\u8868\u548c\u5217\u540d\u79f0\u7684\u6807\u8bc6\u7b26\u5fc5\u987b\u662f\u6709\u6548\u7684 UTF-8 \u5e8f\u5217\uff0c\u4e0d\u8d85\u8fc7 256 \u4e2a\u5b57\u8282\u3002 Immutable Primary Keys ( \u4e0d\u53ef\u53d8\u7684\u4e3b\u952e ) Kudu \u4e0d\u5141\u8bb8\u60a8\u66f4\u65b0\u4e00\u884c\u7684\u4e3b\u952e\u5217\u3002 Non-alterable Primary Key ( \u4e0d\u53ef\u66f4\u6539\u7684\u4e3b\u952e ) \u8868\u521b\u5efa\u540e\uff0c Kudu \u4e0d\u5141\u8bb8\u60a8\u66f4\u6539\u4e3b\u952e\u5217\u3002 Non-alterable Partitioning ( \u4e0d\u53ef\u66f4\u6539\u7684\u5206\u533a ) Kudu \u4e0d\u5141\u8bb8\u60a8\u66f4\u6539\u521b\u5efa\u540e\u5982\u4f55\u5206\u533a\u8868\uff0c\u4f46\u6dfb\u52a0\u6216\u5220\u9664\u8303\u56f4\u5206\u533a\u9664\u5916\u3002 Non-alterable Column Types ( \u4e0d\u53ef\u66f4\u6539\u7684\u5217\u7c7b\u578b ) Kudu \u4e0d\u5141\u8bb8\u66f4\u6539\u5217\u7684\u7c7b\u578b\u3002 Partition Splitting ( \u5206\u533a\u5207\u5206 ) \u8868\u521b\u5efa\u540e\uff0c\u5206\u533a\u4e0d\u80fd\u62c6\u5206\u6216\u5408\u5e76\u3002","title":"Kudu Schema Design ( \u6a21\u5f0f\u8bbe\u8ba1 )"},{"location":"9/#kudu-schema-design","text":"\u539f\u6587\u94fe\u63a5 : http://kudu.apache.org/docs/schema_design.html \u8bd1\u6587\u94fe\u63a5 : http://cwiki.apachecn.org/pages/viewpage.action?pageId=10813632 \u8d21\u732e\u8005 : \u5c0f\u7476 ApacheCN Apache\u4e2d\u6587\u7f51","title":"Kudu Schema Design ( \u6a21\u5f0f\u8bbe\u8ba1 )"},{"location":"9/#apache-kudu-schema-design-apache-kudu","text":"Kudu \u8868\u5177\u6709\u4e0e\u4f20\u7edf RDBMS \u4e2d\u7684\u8868\u7c7b\u4f3c\u7684\u7ed3\u6784\u5316\u6570\u636e\u6a21\u578b\u3002\u6a21\u5f0f\u8bbe\u8ba1\u5bf9\u4e8e\u5b9e\u73b0 Kudu \u7684\u6700\u4f73\u6027\u80fd\u548c\u8fd0\u884c\u7a33\u5b9a\u6027\u81f3\u5173\u91cd\u8981\u3002\u6bcf\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c\u6ca1\u6709\u4e00\u4e2a\u6700\u5408\u9002\u6bcf\u4e2a\u8868\u7684\u5355\u4e00\u6a21\u5f0f\u8bbe\u8ba1\u3002\u672c\u6587\u6863\u6982\u8ff0\u4e86 Kudu \u7684\u6709\u6548\u6a21\u5f0f\u8bbe\u8ba1\u7406\u5ff5\uff0c\u7279\u522b\u6ce8\u610f\u4e0e\u4f20\u7edf RDBMS \u6a21\u5f0f\u6240\u91c7\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\u7684\u5730\u65b9\u3002 \u5728\u9ad8\u5c42\u6b21\u4e0a\uff0c\u521b\u5efa Kudu \u8868\u6709\u4e09\u4e2a\u95ee\u9898\uff1a \u5217\u8bbe\u8ba1 \uff0c \u4e3b\u952e\u8bbe\u8ba1 \u548c \u5206\u533a\u8bbe\u8ba1 \u3002\u5176\u4e2d\u53ea\u6709\u5206\u533a\u5bf9\u4e8e\u719f\u6089\u4f20\u7edf\u7684\u975e\u5206\u5e03\u5f0f\u5173\u7cfb\u6570\u636e\u5e93\u7684\u4eba\u6765\u8bf4\u5c06\u662f\u4e00\u4e2a\u65b0\u7684\u6982\u5ff5\u3002\u6700\u540e\u4e00\u8282\u8ba8\u8bba \u6539\u53d8\u73b0\u6709\u8868\u7684\u6a21\u5f0f \uff0c\u4ee5\u53ca\u5173\u4e8e\u6a21\u5f0f\u8bbe\u8ba1\u7684 \u5df2\u77e5\u9650\u5236 \u3002","title":"Apache Kudu Schema Design ( Apache Kudu \u6a21\u5f0f\u8bbe\u8ba1 )"},{"location":"9/#the-perfect-schema","text":"\u5b8c\u7f8e\u7684\u6a21\u5f0f\u5c06\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u6570\u636e\u5c06\u4ee5\u8fd9\u6837\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u53d1\uff0c\u5373\u8bfb\u53d6\u548c\u5199\u5165\u5728 tablet servers \u4e0a\u5747\u5300\u5206\u5e03\u3002\u8fd9\u53d7\u5230\u5206\u533a\u7684\u5f71\u54cd\u3002 Tablets \u5c06\u4ee5\u5747\u5300\uff0c\u53ef\u9884\u6d4b\u7684\u901f\u5ea6\u589e\u957f\uff0c tablets \u7684\u8d1f\u8f7d\u5c06\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u4fdd\u6301\u7a33\u5b9a\u3002\u8fd9\u6700\u53d7\u5f71\u54cd\u5206\u533a\u3002 \u626b\u63cf\u5c06\u8bfb\u53d6\u5b8c\u6210\u67e5\u8be2\u6240\u9700\u7684\u6700\u5c11\u6570\u636e\u91cf\u3002\u8fd9\u4e3b\u8981\u53d7\u5230\u4e3b\u952e\u8bbe\u8ba1\u7684\u5f71\u54cd\uff0c\u4f46\u5206\u533a\u4e5f\u901a\u8fc7\u5206\u533a\u4fee\u526a\u6765\u8d77\u4f5c\u7528\u3002 \u5b8c\u7f8e\u7684\u6a21\u5f0f\u53d6\u51b3\u4e8e\u6570\u636e\u7684\u7279\u6027\uff0c\u9700\u8981\u505a\u7684\u4e8b\u60c5\u4ee5\u53ca\u96c6\u7fa4\u7684\u62d3\u6251\u3002\u6a21\u5f0f\u8bbe\u8ba1\u662f\u60a8\u6700\u5927\u9650\u5ea6\u5730\u53d1\u6325 Kudu \u96c6\u7fa4\u6027\u80fd\u7684\u6700\u91cd\u8981\u7684\u4e00\u4ef6\u4e8b\u3002","title":"The Perfect Schema ( \u5b8c\u7f8e\u7684\u6a21\u5f0f )"},{"location":"9/#column-design","text":"Kudu \u8868\u7531\u4e00\u4e2a\u5217\u6216\u591a\u4e2a\u5217\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5217\u90fd\u6709\u4e00\u4e2a\u5b9a\u4e49\u7684\u7c7b\u578b\u3002\u4e0d\u5c5e\u4e8e\u4e3b\u952e\u7684\u5217\u53ef\u80fd\u4e3a\u7a7a\u3002\u652f\u6301\u7684\u5217\u7c7b\u578b\u5305\u62ec\uff1a boolean 8-bit signed integer 16-bit signed integer 32-bit signed integer 64-bit signed integer unixtime_micros (\u4ece UNIX \u65f6\u4ee3\u8d77\uff0c64 \u4f4d\u5fae\u79d2) single-precision (32-bit) IEEE-754 floating-point number ( \u5355\u7cbe\u5ea6\uff0c32\u4f4d\uff0cIEEE-754 \u6d6e\u70b9\u6570 ) double-precision (64-bit) IEEE-754 floating-point number ( \u53cc\u7cbe\u5ea6\uff0c64\u4f4d\uff0cIEEE-754 \u6d6e\u70b9\u6570 ) UTF-8 encoded string (up to 64KB uncompressed) ( UTF-8 \u7f16\u7801\u5b57\u7b26\u4e32\uff08\u9ad8\u8fbe 64KB \u672a\u538b\u7f29\uff09 ) binary (up to 64KB uncompressed) ( \u4e8c\u8fdb\u5236\uff08\u9ad8\u8fbe 64KB \u672a\u538b\u7f29\uff09 ) Kudu \u5229\u7528\u5f3a\u7c7b\u578b\u7684\u5217\u548c\u67f1\u72b6\u78c1\u76d8\u5b58\u50a8\u683c\u5f0f\u6765\u63d0\u4f9b\u9ad8\u6548\u7684\u7f16\u7801\u548c\u5e8f\u5217\u5316\u3002\u4e3a\u4e86\u5145\u5206\u5229\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u5217\u5e94\u8be5\u88ab\u6307\u5b9a\u4e3a\u9002\u5f53\u7684\u7c7b\u578b\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u5b57\u7b26\u4e32\u6216\u4e8c\u8fdb\u5236\u5217\u6765\u6a21\u62df ' schemaless ' \u8868\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u8fdb\u884c\u7ed3\u6784\u5316\u3002\u9664\u4e86\u7f16\u7801\u4e4b\u5916\uff0cKudu \u5141\u8bb8\u6309\u7167\u6bcf\u5217\u8fdb\u884c\u538b\u7f29\u3002","title":"Column Design ( \u5217\u8bbe\u8ba1 )"},{"location":"9/#column-encoding","text":"\u53ef\u4ee5\u6839\u636e\u5217\u7684\u7c7b\u578b\uff0c\u4f7f\u7528\u7f16\u7801\u521b\u5efa Kudu \u8868\u4e2d\u7684\u6bcf\u4e2a\u5217\u3002 \u8868 1. Encoding type ( \u7f16\u7801\u7c7b\u578b ) Column Type ( \u5217\u7c7b\u578b ) Encoding ( \u7f16\u7801 ) Default ( \u9ed8\u8ba4 ) int8, int16, int32 plain, bitshuffle, run length bitshuffle int64, unixtime_micros plain, bitshuffle, run length bitshuffle float, double plain, bitshuffle bitshuffle bool plain, run length run length string, binary plain, prefix, dictionary dictionary plain Encoding ( \u666e\u901a\u7f16\u7801 ) \u6570\u636e\u4ee5\u5176\u81ea\u7136\u683c\u5f0f\u5b58\u50a8\u3002\u4f8b\u5982\uff0c int32 values \u4f5c\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684 32 \u4f4d little-endian integers \u5b58\u50a8\u3002 Bitshuffle Encoding \u91cd\u65b0\u6392\u5217\u4e00\u7ec4\u503c\u4ee5\u5b58\u50a8\u6bcf\u4e2a\u503c\u7684\u6700\u9ad8\u6709\u6548\u4f4d\uff0c\u5176\u6b21\u662f\u6bcf\u4e2a\u503c\u7684\u7b2c\u4e8c\u4e2a\u6700\u9ad8\u6709\u6548\u4f4d\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002\u6700\u540e\uff0c\u7ed3\u679c\u662f LZ4 \u538b\u7f29\u3002 Bitshuffle \u7f16\u7801\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u91cd\u590d\u503c\u7684\u5217\u6216\u6309\u4e3b\u952e\u6392\u5e8f\u65f6\u5c11\u91cf\u66f4\u6539\u7684\u5217\u662f\u4e0d\u9519\u7684\u9009\u62e9\u3002 bithuffle \u9879\u76ee\u5bf9\u6027\u80fd\u548c\u7528\u4f8b\u6709\u5f88\u597d\u7684\u6982\u8ff0\u3002 Run Length Encoding ( \u8fd0\u884c\u957f\u5ea6\u7f16\u7801 ) \u901a\u8fc7\u4ec5\u5b58\u50a8\u503c\u548c\u8ba1\u6570\uff0c\u5728\u5217\u4e2d\u538b\u7f29\u8fd0\u884c\uff08\u8fde\u7eed\u91cd\u590d\u503c\uff09\u3002\u5f53\u6309\u4e3b\u952e\u6392\u5e8f\u65f6\uff0c\u8fd0\u884c\u957f\u5ea6\u7f16\u7801\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u8fde\u7eed\u91cd\u590d\u503c\u7684\u5217\u662f\u6709\u6548\u7684\u3002 Dictionary Encoding ( \u5b57\u5178\u7f16\u7801 ) \u6784\u5efa\u4e86\u552f\u4e00\u503c\u7684\u5b57\u5178\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5217\u503c\u90fd\u88ab\u7f16\u7801\u4e3a\u5b57\u5178\u4e2d\u7684\u76f8\u5e94\u7d22\u5f15\u3002\u5b57\u5178\u7f16\u7801\u5bf9\u4e8e\u57fa\u6570\u8f83\u4f4e\u7684\u5217\u662f\u6709\u6548\u7684\u3002\u5982\u679c\u7ed9\u5b9a\u884c\u96c6\u7684\u5217\u503c\u7531\u4e8e\u552f\u4e00\u503c\u7684\u6570\u91cf\u592a\u9ad8\u800c\u65e0\u6cd5\u538b\u7f29\uff0c\u5219 Kudu \u5c06\u900f\u660e\u5730\u56de\u9000\u5230\u8be5\u884c\u96c6\u7684\u7eaf\u7f16\u7801\u3002\u8fd9\u5728 flush \u8fc7\u7a0b\u4e2d\u8fdb\u884c\u8bc4\u4f30\u3002 Prefix Encoding ( \u524d\u7f00\u7f16\u7801 ) \u516c\u5171\u524d\u7f00\u5728\u8fde\u7eed\u5217\u503c\u4e2d\u8fdb\u884c\u538b\u7f29\u3002\u524d\u7f00\u7f16\u7801\u5bf9\u4e8e\u5171\u4eab\u516c\u5171\u524d\u7f00\u7684\u503c\u6216\u4e3b\u952e\u7684\u7b2c\u4e00\u5217\u53ef\u80fd\u6709\u6548\uff0c\u56e0\u4e3a\u884c\u6309 tablet \u5185\u7684\u4e3b\u952e\u6392\u5e8f\u3002","title":"Column Encoding ( \u5217\u7f16\u7801 )"},{"location":"9/#column-compression","text":"Kudu \u5141\u8bb8\u4f7f\u7528 LZ4 \uff0c Snappy \u6216 zlib \u538b\u7f29\u7f16\u89e3\u7801\u5668\u8fdb\u884c\u6bcf\u5217\u538b\u7f29\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5217\u672a\u538b\u7f29\u5b58\u50a8\u3002\u5982\u679c\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\u6bd4\u539f\u59cb\u626b\u63cf\u6027\u80fd\u66f4\u91cd\u8981\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u538b\u7f29\u3002","title":"Column Compression ( \u5217\u538b\u7f29 )"},{"location":"9/#primary-key-design","text":"\u6bcf\u4e2a Kudu \u8868\u5fc5\u987b\u58f0\u660e\u4e00\u4e2a\u4e3b\u952e\u7d22\u5f15\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u7ec4\u6210\u3002\u4e3b\u952e\u5217\u5fc5\u987b\u4e0d\u53ef\u4e3a\u7a7a\uff0c\u5e76\u4e14\u53ef\u80fd\u4e0d\u662f\u5e03\u5c14\u503c\u6216\u6d6e\u70b9\u578b\u3002\u5728\u8868\u521b\u5efa\u671f\u95f4\u8bbe\u7f6e\u540e\uff0c\u4e3b\u952e\u4e2d\u7684\u5217\u96c6\u5408\u53ef\u80fd\u4e0d\u4f1a\u66f4\u6539\u3002\u50cf RDBMS \u4e3b\u952e\u4e00\u6837\uff0c Kudu \u4e3b\u952e\u5f3a\u5236\u6267\u884c\u552f\u4e00\u6027\u7ea6\u675f;\u5c1d\u8bd5\u63d2\u5165\u4e0e\u73b0\u6709\u884c\u5177\u6709\u76f8\u540c\u4e3b\u952e\u503c\u7684\u884c\u5c06\u5bfc\u81f4\u91cd\u590d\u7684\u952e\u9519\u8bef\u3002 \u4e0e RDBMS \u4e0d\u540c\uff0c Kudu \u4e0d\u63d0\u4f9b\u81ea\u52a8\u9012\u589e\u5217\u529f\u80fd\uff0c\u56e0\u6b64\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u59cb\u7ec8\u5728\u63d2\u5165\u671f\u95f4\u63d0\u4f9b\u5b8c\u6574\u7684\u4e3b\u952e\u3002\u884c\u5220\u9664\u548c\u66f4\u65b0\u64cd\u4f5c\u8fd8\u5fc5\u987b\u6307\u5b9a\u8981\u66f4\u6539\u7684\u884c\u7684\u5b8c\u6574\u4e3b\u952e; Kudu \u672c\u8eab\u4e0d\u652f\u6301\u8303\u56f4\u5220\u9664\u6216\u66f4\u65b0\u3002\u5728\u63d2\u5165\u884c\u4e4b\u540e\uff0c\u5217\u7684\u4e3b\u952e\u503c\u53ef\u80fd\u4e0d\u4f1a\u88ab\u66f4\u65b0;\u4f46\u662f\uff0c\u53ef\u4ee5\u5220\u9664\u8be5\u884c\u5e76\u91cd\u65b0\u63d2\u5165\u66f4\u65b0\u7684\u503c\u3002","title":"Primary Key Design ( \u4e3b\u952e\u8bbe\u8ba1 )"},{"location":"9/#primary-key-index","text":"\u4e0e\u8bb8\u591a\u4f20\u7edf\u5173\u7cfb\u6570\u636e\u5e93\u4e00\u6837\uff0c Kudu \u7684\u4e3b\u952e\u662f clustered index ( \u805a\u96c6\u7d22\u5f15 )\u3002 tablet \u4e2d\u7684\u6240\u6709\u884c\u90fd\u4fdd\u6301\u4e3b\u952e\u6392\u5e8f\u987a\u5e8f\u3002\u5728\u4e3b\u952e\u4e0a\u6307\u5b9a\u76f8\u7b49\u6216\u8303\u56f4\u7ea6\u675f\u7684 Kudu \u626b\u63cf\u5c06\u81ea\u52a8\u8df3\u8fc7\u4e0d\u80fd\u6ee1\u8db3\u8c13\u8bcd\u7684\u884c\u3002\u8fd9\u5141\u8bb8\u901a\u8fc7\u5728\u4e3b\u952e\u5217\u4e0a\u6307\u5b9a\u76f8\u7b49\u7ea6\u675f\u6765\u6709\u6548\u5730\u627e\u5230\u5404\u884c\u3002 \u6ce8\u610f \u4e3b\u952e\u7d22\u5f15\u4f18\u5316\u9002\u7528\u4e8e\u5355\u4e2a tablet \u4e0a\u7684\u626b\u63cf\u3002\u6709\u5173\u626b\u63cf\u5982\u4f55\u4f7f\u7528\u8c13\u8bcd\u8df3\u8fc7\u6574\u4e2a tablet \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5206\u533a\u4fee\u526a \u90e8\u5206\u3002","title":"Primary Key Index ( \u4e3b\u952e\u7d22\u5f15 )"},{"location":"9/#partitioning","text":"\u4e3a\u4e86\u63d0\u4f9b\u53ef\u6269\u5c55\u6027\uff0c Kudu \u8868\u88ab\u5212\u5206\u4e3a\u79f0\u4e3a tablets \u7684\u5355\u5143\uff0c\u5e76\u5206\u5e03\u5728\u8bb8\u591a tablet servers \u4e0a\u3002\u884c\u603b\u662f\u5c5e\u4e8e\u5355\u4e2a tablet \u3002\u5c06\u884c\u5206\u914d\u7ed9 tablet \u7684\u65b9\u6cd5\u7531\u5728\u8868\u521b\u5efa\u671f\u95f4\u8bbe\u7f6e\u7684\u8868\u7684\u5206\u533a\u51b3\u5b9a\u3002 \u9009\u62e9\u5206\u533a\u7b56\u7565\u9700\u8981\u4e86\u89e3\u6570\u636e\u6a21\u578b\u548c\u8868\u7684\u9884\u671f\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5bf9\u4e8e\u5199\u5165\u7e41\u91cd\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u91cd\u8981\u7684\u662f\u8bbe\u8ba1\u5206\u533a\uff0c\u4ee5\u4f7f\u5199\u5165\u5206\u6563\u5728 tablet \u4e0a\uff0c\u4ee5\u907f\u514d\u5355\u4e2a tablet \u7684\u8d85\u8f7d\u3002\u5bf9\u4e8e\u6d89\u53ca\u8bb8\u591a\u77ed\u626b\u63cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5982\u679c\u6240\u6709\u626b\u63cf\u7684\u6570\u636e\u4f4d\u4e8e\u540c\u4e00\u4e2a tablet \u4e2d\uff0c\u90a3\u4e48\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u5f00\u9500\u5360\u4e3b\u5bfc\u5730\u4f4d\uff0c\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002\u4e86\u89e3\u8fd9\u4e9b\u57fa\u672c\u6743\u8861\u662f\u8bbe\u8ba1\u6709\u6548\u7684\u5206\u533a\u6a21\u5f0f\u7684\u6838\u5fc3\u3002 \u91cd\u8981 \u6ca1\u6709\u9ed8\u8ba4\u5206\u533a Kudu \u5728\u521b\u5efa\u8868\u65f6\u4e0d\u63d0\u4f9b\u9ed8\u8ba4\u5206\u533a\u7b56\u7565\u3002\u5efa\u8bae\u9884\u671f\u5177\u6709\u8f83\u5927\u8bfb\u5199\u5de5\u4f5c\u8d1f\u8377\u7684\u65b0\u8868\u81f3\u5c11\u4e0e tablet servers \u4e00\u6837\u591a\u7684 tablets \u3002 Kudu \u63d0\u4f9b\u4e86\u4e24\u79cd\u7c7b\u578b\u7684\u5206\u533a\uff1a range partitioning ( \u8303\u56f4\u5206\u533a ) \u548c hash partitioning ( \u54c8\u5e0c\u5206\u533a ) \u3002\u8868\u4e5f\u53ef\u80fd\u5177\u6709 \u591a\u7ea7\u5206\u533a \uff0c\u5176\u7ed3\u5408\u8303\u56f4\u548c\u54c8\u5e0c\u5206\u533a\uff0c\u6216\u591a\u4e2a\u6563\u5217\u5206\u533a\u5b9e\u4f8b\u3002","title":"Partitioning ( \u5206\u533a )"},{"location":"9/#range-partitioning","text":"\u8303\u56f4\u5206\u533a\u4f7f\u7528\u5b8c\u5168\u6709\u5e8f\u7684\u5206\u533a\u952e\u5206\u914d\u884c\u3002\u6bcf\u4e2a\u5206\u533a\u5206\u914d\u4e86\u8303\u56f4\u5206\u533a\u5bc6\u94a5\u7a7a\u95f4\u7684\u8fde\u7eed\u6bb5\u3002\u5bc6\u94a5\u5fc5\u987b\u7531\u4e3b\u952e\u5217\u7684\u5b50\u96c6\u7ec4\u6210\u3002\u5982\u679c\u8303\u56f4\u5206\u533a\u5217\u4e0e\u4e3b\u952e\u5217\u5339\u914d\uff0c\u5219\u884c\u7684\u8303\u56f4\u5206\u533a\u952e\u5c06\u7b49\u4e8e\u5176\u4e3b\u952e\u3002\u5728\u6ca1\u6709\u54c8\u5e0c\u5206\u533a\u7684\u8303\u56f4\u5206\u533a\u8868\u4e2d\uff0c\u6bcf\u4e2a\u8303\u56f4\u5206\u533a\u5c06\u5bf9\u5e94\u4e8e\u4e00\u4e2a tablet \u3002 \u5728\u521b\u5efa\u8868\u65f6\uff0c\u5c06\u521d\u59cb\u7684\u8303\u56f4\u5206\u533a\u96c6\u5408\u6307\u5b9a\u4e3a\u4e00\u7ec4\u5206\u533a\u8fb9\u754c\u548c\u62c6\u5206\u884c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7ed1\u5b9a\uff0c\u5c06\u5728\u8868\u4e2d\u521b\u5efa\u4e00\u4e2a\u8303\u56f4\u5206\u533a\u3002\u6bcf\u4e2a\u5206\u5272\u5c06\u4e24\u4e2a\u8303\u56f4\u5206\u5272\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5206\u533a\u754c\u9650\uff0c\u5219\u8868\u5c06\u9ed8\u8ba4\u4e3a\u8986\u76d6\u6574\u4e2a\u5bc6\u94a5\u7a7a\u95f4\u7684\u5355\u4e2a\u5206\u533a\uff08\u4e0b\u9762\u548c\u4e0b\u9762\u65e0\u754c\u9650\uff09\u3002\u8303\u56f4\u5206\u533a\u5fc5\u987b\u59cb\u7ec8\u4e0d\u91cd\u53e0\uff0c\u62c6\u5206\u884c\u5fc5\u987b\u5728\u8303\u56f4\u5206\u533a\u5185\u3002 \u91cd\u8981 \u8bf7\u53c2\u9605 \u8303\u56f4\u5206\u533a\u793a\u4f8b \uff0c\u4ee5\u8fdb\u4e00\u6b65\u8ba8\u8bba\u8303\u56f4\u5206\u533a\u3002","title":"Range Partitioning ( \u8303\u56f4\u5206\u533a )"},{"location":"9/#range-partition-management","text":"Kudu \u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u4ece\u8868\u4e2d\u52a8\u6001\u6dfb\u52a0\u548c\u5220\u9664\u8303\u56f4\u5206\u533a\uff0c\u800c\u4e0d\u5f71\u54cd\u5176\u4ed6\u5206\u533a\u7684\u53ef\u7528\u6027\u3002\u5220\u9664\u5206\u533a\u5c06\u5220\u9664\u5c5e\u4e8e\u5206\u533a\u7684 tablet \u4ee5\u53ca\u5176\u4e2d\u5305\u542b\u7684\u6570\u636e\u3002\u968f\u540e\u63d2\u5165\u5230\u4e22\u5f03\u7684\u5206\u533a\u5c06\u5931\u8d25\u3002\u53ef\u4ee5\u6dfb\u52a0\u65b0\u5206\u533a\uff0c\u4f46\u4e0d\u80fd\u4e0e\u4efb\u4f55\u73b0\u6709\u7684\u5206\u533a\u5206\u533a\u91cd\u53e0\u3002 Kudu \u5141\u8bb8\u5728\u5355\u4e2a\u4e8b\u52a1\u6027\u66f4\u6539\u8868\u64cd\u4f5c\u4e2d\u5220\u9664\u5e76\u6dfb\u52a0\u4efb\u610f\u6570\u91cf\u7684\u8303\u56f4\u5206\u533a\u3002 \u52a8\u6001\u6dfb\u52a0\u548c\u5220\u9664\u8303\u56f4\u5206\u533a\u5bf9\u4e8e\u65f6\u95f4\u5e8f\u5217\u4f7f\u7528\u60c5\u51b5\u5c24\u5176\u6709\u7528\u3002\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0c\u53ef\u4ee5\u6dfb\u52a0\u8303\u56f4\u5206\u533a\u4ee5\u8986\u76d6\u5373\u5c06\u5230\u6765\u7684\u65f6\u95f4\u8303\u56f4\u3002\u4f8b\u5982\uff0c\u5b58\u50a8\u4e8b\u4ef6\u65e5\u5fd7\u7684\u8868\u53ef\u4ee5\u5728\u6bcf\u6708\u5f00\u59cb\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u6708\u4efd\u7684\u5206\u533a\uff0c\u4ee5\u4fbf\u4fdd\u5b58\u5373\u5c06\u5230\u6765\u7684\u4e8b\u4ef6\u3002\u5fc5\u8981\u65f6\u53ef\u4ee5\u5220\u9664\u65e7\u8303\u56f4\u5206\u533a\uff0c\u4ee5\u4fbf\u6709\u6548\u5730\u5220\u9664\u5386\u53f2\u6570\u636e\u3002","title":"Range Partition Management ( \u8303\u56f4\u5206\u533a\u7ba1\u7406\u00a0)"},{"location":"9/#hash-partitioning","text":"\u54c8\u5e0c\u5206\u533a\u901a\u8fc7\u54c8\u5e0c\u503c\u5c06\u884c\u5206\u914d\u5230\u8bb8\u591a buckets ( \u5b58\u50a8\u6876 )\u4e4b\u4e00\u3002\u5728 single-level hash partitioned tables ( \u5355\u7ea7\u6563\u5217\u5206\u533a\u8868 )\u4e2d\uff0c\u6bcf\u4e2a bucket ( \u5b58\u50a8\u6876 ) \u5c06\u5bf9\u5e94\u4e8e\u4e00\u4e2a tablet \u3002\u5728\u521b\u5efa\u8868\u65f6\u8bbe\u7f6e\u6876\u6570\u3002\u901a\u5e38\uff0c\u4e3b\u952e\u5217\u7528\u4f5c\u6563\u5217\u7684\u5217\uff0c\u4f46\u4e0e\u8303\u56f4\u5206\u533a\u4e00\u6837\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e3b\u952e\u5217\u7684\u4efb\u4f55\u5b50\u96c6\u3002 \u54c8\u5e0c\u5206\u533a\u662f\u4e00\u79cd\u6709\u6548\u7684\u7b56\u7565\uff0c\u5f53\u4e0d\u9700\u8981\u5bf9\u8868\u8fdb\u884c\u6709\u5e8f\u8bbf\u95ee\u65f6\u3002\u54c8\u5e0c\u5206\u533a\u5bf9\u4e8e\u5728 tablet \u4e4b\u95f4\u968f\u673a\u6563\u5e03\u8fd9\u4e9b\u529f\u80fd\u662f\u6709\u6548\u7684\uff0c\u8fd9\u6709\u52a9\u4e8e\u51cf\u8f7b\u70ed\u70b9\u548c tablet \u5927\u5c0f\u4e0d\u5747\u5300\u3002 \u6ce8\u610f \u6709\u5173\u54c8\u5e0c\u5206\u533a\u7684\u8fdb\u4e00\u6b65\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 \u54c8\u5e0c\u5206\u533a\u793a\u4f8b \u3002","title":"Hash Partitioning ( \u54c8\u5e0c\u5206\u533a )"},{"location":"9/#multilevel-partitioning","text":"Kudu \u5141\u8bb8\u4e00\u4e2a\u8868\u5728\u5355\u4e2a\u8868\u4e0a\u7ec4\u5408\u591a\u7ea7\u5206\u533a\u3002\u96f6\u4e2a\u6216\u591a\u4e2a\u54c8\u5e0c\u5206\u533a\u7ea7\u522b\u53ef\u4ee5\u4e0e\u53ef\u9009\u7684\u8303\u56f4\u5206\u533a\u7ea7\u522b\u7ec4\u5408\u3002\u9664\u4e86\u5355\u4e2a\u5206\u533a\u7c7b\u578b\u7684\u7ea6\u675f\u4e4b\u5916\uff0c\u591a\u7ea7\u5206\u533a\u7684\u552f\u4e00\u9644\u52a0\u7ea6\u675f\u662f\u591a\u4e2a\u7ea7\u522b\u7684\u54c8\u5e0c\u5206\u533a\u4e0d\u80fd\u5bf9\u76f8\u540c\u7684\u5217\u8fdb\u884c\u54c8\u5e0c\u3002 \u5f53\u6b63\u786e\u4f7f\u7528\u65f6\uff0c\u591a\u7ea7\u5206\u533a\u53ef\u4ee5\u4fdd\u7559\u5404\u4e2a\u5206\u533a\u7c7b\u578b\u7684\u4f18\u70b9\uff0c\u540c\u65f6\u51cf\u5c11\u6bcf\u4e2a\u5206\u533a\u7684\u7f3a\u70b9\u3002\u591a\u7ea7\u5206\u533a\u8868\u4e2d\u7684 tablet \u603b\u6570\u662f\u6bcf\u4e2a\u7ea7\u522b\u4e2d\u5206\u533a\u6570\u91cf\u7684\u4e58\u79ef\u3002 \u6ce8\u610f \u8bf7\u53c2\u9605 \u54c8\u5e0c\u548c\u8303\u56f4\u5206\u533a\u793a\u4f8b \u4ee5\u53ca \u54c8\u5e0c\u548c\u54c8\u5e0c\u5206\u533a\u793a\u4f8b \uff0c\u4ee5\u8fdb\u4e00\u6b65\u8ba8\u8bba\u591a\u7ea7\u5206\u533a\u3002","title":"Multilevel Partitioning ( \u591a\u7ea7\u5206\u533a )"},{"location":"9/#partition-pruning","text":"\u5f53\u53ef\u4ee5\u786e\u5b9a\u5206\u533a\u53ef\u4ee5\u88ab\u626b\u63cf\u8c13\u8bcd\u5b8c\u5168\u8fc7\u6ee4\u65f6\uff0c Kudu \u626b\u63cf\u5c06\u81ea\u52a8\u8df3\u8fc7\u626b\u63cf\u6574\u4e2a\u5206\u533a\u3002 \u8981\u4fee\u526a\u54c8\u5e0c\u5206\u533a\uff0c\u626b\u63cf\u5fc5\u987b\u5728\u6bcf\u4e2a\u6563\u5217\u5217\u4e0a\u5305\u542b\u76f8\u7b49\u8c13\u8bcd\u3002 \u8981\u4fee\u526a\u8303\u56f4\u5206\u533a\uff0c\u626b\u63cf\u5fc5\u987b\u5728\u8303\u56f4\u5206\u533a\u5217\u4e0a\u5305\u542b\u76f8\u7b49\u6216\u8303\u56f4\u8c13\u8bcd\u3002 \u5bf9\u591a\u7ea7\u5206\u533a\u8868\u7684\u626b\u63cf\u53ef\u4ee5\u72ec\u7acb\u5730\u5229\u7528\u4efb\u4f55\u7ea7\u522b\u7684\u5206\u533a\u4fee\u526a\u3002","title":"Partition Pruning ( \u5206\u533a\u4fee\u526a )"},{"location":"9/#partitioning-examples","text":"\u4e3a\u4e86\u8bf4\u660e\u4e0e\u4e3a\u8868\u8bbe\u8ba1\u5206\u533a\u7b56\u7565\u76f8\u5173\u7684\u56e0\u7d20\u548c\u6743\u8861\uff0c\u6211\u4eec\u5c06\u901a\u8fc7\u4e00\u4e9b\u4e0d\u540c\u7684\u5206\u533a\u65b9\u6848\u3002 \u8003\u8651\u5b58\u50a8\u673a\u5668\u5ea6\u91cf\u6570\u636e\u7684\u4e0b\u8868\u6a21\u5f0f\uff08\u4e3a\u4e86\u6e05\u695a\u8d77\u89c1\uff0c\u4f7f\u7528 SQL \u8bed\u6cd5\u548c\u65e5\u671f\u683c\u5f0f\u7684\u65f6\u95f4\u6233\uff09\uff1a CREATE TABLE metrics ( host STRING NOT NULL, metric STRING NOT NULL, time INT64 NOT NULL, value DOUBLE NOT NULL, PRIMARY KEY (host, metric, time), );","title":"Partitioning Examples ( \u5206\u533a\u793a\u4f8b )"},{"location":"9/#range-partitioning-example","text":"\u5206\u5272\u5ea6\u91cf\u8868\u7684\u4e00\u79cd\u81ea\u7136\u65b9\u5f0f\u662f\u5728\u65f6\u95f4\u5217\u4e0a\u5bf9\u8303\u56f4\u8fdb\u884c\u5206\u533a\u3002\u5047\u8bbe\u6211\u4eec\u60f3\u8981\u6bcf\u5e74\u90fd\u6709\u4e00\u4e2a\u5206\u533a\uff0c\u8be5\u8868\u5c06\u4fdd\u5b58 2014 \u5e74\uff0c 2015 \u5e74\u548c 2016 \u5e74\u7684\u6570\u636e\u3002\u8868\u683c\u81f3\u5c11\u6709\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u88ab\u5206\u5272\uff1a\u5177\u6709\u65e0\u754c\u8303\u56f4\u7684\u5206\u533a\uff0c\u4e5f\u53ef\u4ee5\u662f\u6709\u9650\u8303\u56f4\u7684\u5206\u533a\u3002 \u4e0a\u56fe\u663e\u793a\u4e86\u5ea6\u91cf\u8868\u53ef\u4ee5\u5728\u65f6\u95f4\u5217\u4e0a\u8fdb\u884c\u8303\u56f4\u5206\u533a\u7684\u4e24\u79cd\u65b9\u5f0f\u3002\u5728\u7b2c\u4e00\u4e2a\u793a\u4f8b\uff08\u84dd\u8272\uff09\u4e2d\uff0c\u4f7f\u7528\u9ed8\u8ba4\u8303\u56f4\u5206\u533a\u8fb9\u754c\uff0c\u5e76\u5728 2015-01-01 \u548c 2014 \u5e74 1 \u6708\u5206\u9694\u3002\u8fd9\u5bfc\u81f4\u4e09\u4e2a tablet \uff1a 2015 \u5e74\u4e4b\u524d\u7684\u7b2c\u4e00\u4e2a\u503c\uff0c 2015 \u5e74\u7684\u7b2c\u4e8c\u4e2a\u503c\uff0c\u4ee5\u53ca 2016 \u5e74\u4ee5\u540e\u7684\u7b2c\u4e09\u4e2a\u503c\u3002\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\uff08\u7eff\u8272\uff09\u4f7f\u7528\u4e86 [(2014-01-01) \uff0c (2017-01-01)] \uff0c\u5e76\u5206\u671f\u4e8e 2015-01-01 \u548c 2016-01-01 \u3002\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u53ef\u4ee5\u7b49\u4ef7\u5730\u901a\u8fc7 [(2014-01-01)\uff0c(2015-01-01)]\uff0c[(2015-01-01) \uff0c (2016-01-01)] \u548c [(2016-01-01)\uff0c(2017-01-01)] \uff0c\u6ca1\u6709\u5206\u88c2\u3002\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u6709\u65e0\u754c\u7684\u4e0b\u9650\u548c\u4e0a\u9650\u5206\u533a\uff0c\u800c\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u5305\u62ec\u8fb9\u754c\u3002 \u4e0a\u8ff0\u8303\u56f4\u5206\u533a\u793a\u4f8b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u5141\u8bb8\u6709\u65f6\u9650\u7684\u626b\u63cf\u6765\u4fee\u526a\u6389\u5728\u626b\u63cf\u65f6\u95f4\u9650\u5236\u4e4b\u5916\u7684\u5206\u533a\u3002\u5f53\u6709\u5f88\u591a\u5206\u533a\u65f6\uff0c\u8fd9\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u6027\u80fd\u3002\u5199\u4f5c\u65f6\uff0c\u4e24\u4e2a\u4f8b\u5b50\u90fd\u6709\u6f5c\u5728\u7684\u70ed\u70b9\u95ee\u9898\u3002\u7531\u4e8e\u5ea6\u91cf\u8d8b\u5411\u4e8e\u59cb\u7ec8\u5728\u5f53\u524d\u65f6\u95f4\u5199\u5165\uff0c\u5927\u591a\u6570\u5199\u5165\u5c06\u8fdb\u5165\u5355\u4e2a\u8303\u56f4\u5206\u533a\u3002 \u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u6bd4\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u66f4\u7075\u6d3b\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u672a\u6765\u51e0\u5e74\u7684\u8303\u56f4\u5206\u533a\u6dfb\u52a0\u5230\u8868\u4e2d\u3002\u5728\u7b2c\u4e00\u4e2a\u793a\u4f8b\u4e2d\uff0c\u5728 2016-01-01 \u4e4b\u540e\u7684\u65f6\u95f4\u7684\u6240\u6709\u5199\u5165\u5c06\u843d\u5165\u6700\u540e\u4e00\u4e2a\u5206\u533a\uff0c\u56e0\u6b64\u5206\u533a\u53ef\u80fd\u6700\u7ec8\u53d8\u5f97\u592a\u5927\uff0c\u4ee5\u81f4\u4e8e\u5355\u4e2a tablet servers \u65e0\u6cd5\u5904\u7406\u3002","title":"Range Partitioning Example ( \u8303\u56f4\u5206\u533a\u793a\u4f8b )"},{"location":"9/#hash-partitioning-example","text":"\u5206\u5272 metrics table ( \u5ea6\u91cf\u8868 ) \u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5728 host \u548c metric columns ( \u5ea6\u91cf\u5217 ) \u4e0a\u54c8\u5e0c\u5206\u533a\u3002 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c metrics table \u662f\u5c06 host \u548c metric columns \u4e0a\u7684\u54c8\u5e0c\u5206\u533a\u5206\u4e3a\u56db\u4e2a\u5b58\u50a8\u6876\u3002\u4e0e\u524d\u9762\u7684\u8303\u56f4\u5206\u533a\u793a\u4f8b\u4e0d\u540c\uff0c\u6b64\u5206\u533a\u7b56\u7565\u5c06\u5747\u5300\u5730\u5728\u8868\u4e2d\u7684\u6240\u6709 tablets \u4e0a\u4f20\u64ad\u5199\u5165\uff0c\u8fd9\u6709\u52a9\u4e8e\u603b\u4f53\u5199\u5165\u541e\u5410\u91cf\u3002\u901a\u8fc7\u6307\u5b9a\u76f8\u7b49\u8c13\u8bcd\uff0c\u626b\u63cf\u7279\u5b9a\u7684 host \u548c metric \u53ef\u4ee5\u5229\u7528\u5206\u533a\u4fee\u526a\uff0c\u5c06\u626b\u63cf\u7684 tablet \u6570\u91cf\u51cf\u5c11\u5230\u4e00\u4e2a\u3002\u4f7f\u7528\u7eaf\u54c8\u5e0c\u5206\u533a\u7b56\u7565\u8981\u5c0f\u5fc3\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u968f\u7740\u8d8a\u6765\u8d8a\u591a\u7684\u6570\u636e\u88ab\u63d2\u5165\u5230\u8868\u4e2d\uff0c tablet \u53ef\u4ee5\u65e0\u9650\u671f\u5730\u589e\u957f\u3002\u6700\u7ec8 tablet \u5c06\u53d8\u5f97\u592a\u5927\uff0c\u65e0\u6cd5\u8ba9\u4e2a\u4eba tablet servers \u6301\u6709\u3002 \u6ce8\u610f \u867d\u7136\u8fd9\u4e9b\u793a\u4f8b\u7f16\u53f7\u4e3a tablet \uff0c\u4f46\u5b9e\u9645\u4e0a tablet \u53ea\u63d0\u4f9b UUID \u6807\u8bc6\u7b26\u3002\u54c8\u5e0c\u5206\u533a\u8868\u4e2d\u7684 tablet \u4e4b\u95f4\u6ca1\u6709\u81ea\u7136\u6392\u5e8f\u3002","title":"Hash Partitioning Example ( \u54c8\u5e0c\u5206\u533a\u793a\u4f8b )"},{"location":"9/#hash-and-range-partitioning-example","text":"\u4ee5\u524d\u7684\u793a\u4f8b\u663e\u793a\u4e86 metrics table \u5982\u4f55\u5728 time column ( \u65f6\u95f4\u5217 ) \u4e0a\u8fdb\u884c\u8303\u56f4\u5206\u533a\uff0c\u6216\u8005\u5728 host \u548c metrics column \u4e0a\u8fdb\u884c\u54c8\u5e0c\u5206\u533a\u3002\u8fd9\u4e9b\u7b56\u7565\u5177\u6709\u76f8\u5173\u7684\u5b9e\u529b\u548c\u5f31\u70b9\uff1a \u8868 2. Partitioning Strategies ( \u5206\u533a\u7b56\u7565 ) Strategy ( \u7b56\u7565 ) Writes ( \u5199\u5165 ) Reads ( \u8bfb\u53d6 ) Tablet Growth ( tablet \u589e\u957f ) range(time) \u2717 - \u6240\u6709\u5199\u5165\u5230\u6700\u65b0\u5206\u533a \u2713 - \u53ef\u4ee5\u4fee\u526a\u4e0e\u65f6\u95f4\u7ed1\u5b9a\u7684 scan \u2713 - \u53ef\u4ee5\u5728\u672a\u6765\u7684\u65f6\u95f4\u6bb5\u6dfb\u52a0\u65b0\u7684 tablets hash(host, metric) \u2713 - \u5728 tablets \u4e0a\u5747\u5300\u5206\u5e03 \u2713 - \u53ef\u4ee5\u4fee\u526a\u5bf9\u7279\u5b9a hosts \u548c metrics \u7684 scan \u2717 - tablets \u53ef\u4ee5\u589e\u957f\u5230\u5f88\u5927 \u54c8\u5e0c\u5206\u533a\u6709\u5229\u4e8e\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u5199\u5165\u541e\u5410\u91cf\uff0c\u800c\u8303\u56f4\u5206\u533a\u53ef\u907f\u514d tablet \u65e0\u9650\u589e\u957f\u7684\u95ee\u9898\u3002\u8fd9\u4e24\u79cd\u7b56\u7565\u90fd\u53ef\u4ee5\u5229\u7528\u5206\u533a\u4fee\u526a\u6765\u4f18\u5316\u4e0d\u540c\u573a\u666f\u4e2d\u7684\u626b\u63cf\u3002\u4f7f\u7528\u591a\u7ea7\u5206\u533a\uff0c\u53ef\u4ee5\u7ec4\u5408\u8fd9\u4e24\u79cd\u7b56\u7565\uff0c\u4ee5\u83b7\u5f97\u4e24\u8005\u7684\u4f18\u70b9\uff0c\u540c\u65f6\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u6bcf\u4e2a\u7b56\u7565\u7684\u7f3a\u70b9\u3002 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c time column \u4e0a\u7684\u8303\u56f4\u5206\u533a\u4e0e host \u548c metric columns \u4e0a\u7684\u54c8\u5e0c\u5206\u533a\u76f8\u7ed3\u5408\u3002\u8fd9\u4e2a\u7b56\u7565\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u5177\u6709\u4e8c\u7ef4\u5212\u5206\uff1a\u4e00\u4e2a\u7528\u4e8e\u54c8\u5e0c\u7ea7\u522b\uff0c\u4e00\u4e2a\u7528\u4e8e\u8303\u56f4\u7ea7\u522b\u3002\u5728\u5f53\u524d\u65f6\u523b\u5199\u5165\u6b64\u8868\u5c06\u5e76\u884c\u5316\u5230\u54c8\u5e0c\u6876\u7684\u6570\u91cf\uff0c\u5728 4 \u8fd9\u79cd\u60c5\u51b5\u4e0b\u3002\u8bfb\u53d6\u53ef\u4ee5\u5229\u7528\u65f6\u95f4\u9650\u5236\u548c\u7279\u5b9a\u7684 host \u548c metric \u8c13\u8bcd\u6765\u4fee\u526a\u5206\u533a\u3002\u53ef\u4ee5\u6dfb\u52a0\u65b0\u7684\u8303\u56f4\u5206\u533a\uff0c\u8fd9\u5c06\u5bfc\u81f4\u521b\u5efa 4 \u4e2a\u989d\u5916\u7684 tablet \uff08\u597d\u50cf\u65b0\u5217\u5df2\u6dfb\u52a0\u5230\u56fe\u8868\u4e2d\uff09\u3002","title":"Hash and Range Partitioning Example ( \u54c8\u5e0c\u548c\u8303\u56f4\u5206\u533a\u793a\u4f8b )"},{"location":"9/#hash-and-hash-partitioning-example","text":"Kudu \u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u8868\u4e2d\u652f\u6301\u4efb\u610f\u6570\u91cf\u7684\u54c8\u5e0c\u5206\u533a\u7ea7\u522b\uff0c\u53ea\u8981\u8fd9\u4e9b\u7ea7\u522b\u6ca1\u6709\u5171\u540c\u7684 hashed columns ( \u6563\u5217\u5217 ) \u3002 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u8868\u662f\u4e3b\u673a\u4e0a\u7684\u54c8\u5e0c\u5206\u533a\uff0c\u5206\u4e3a 4 \u4e2a\u6876\uff0c\u6563\u5217\u5728\u516c\u5236\u4e2d\u5206\u533a\u4e3a 3 \u4e2a\u6876\uff0c\u4ece\u800c\u4ea7\u751f12\u4e2a tablet \u3002\u5c3d\u7ba1\u5728\u4f7f\u7528\u6b64\u7b56\u7565\u65f6\uff0c\u6240\u6709 tablets \u4e2d\u7684\u5199\u5165\u5c06\u8d8b\u5411\u4e8e\u4f20\u64ad\uff0c\u4f46\u662f\u6bd4\u5355\u72ec\u7684 host \u6216 metric \u7684\u6240\u6709\u503c\u59cb\u7ec8\u5c5e\u4e8e\u5355\u4e2a tablet \u65f6\uff0c\u4e0e\u591a\u4e2a\u72ec\u7acb\u5217\u7684\u54c8\u5e0c\u5206\u533a\u76f8\u6bd4\uff0c\u5b83\u66f4\u5bb9\u6613\u53d7\u5230\u70ed\u70b9\u67e5\u627e\u3002\u626b\u63cf\u53ef\u4ee5\u5206\u522b\u5229\u7528 host \u548c metric columns \u4e0a\u7684\u7b49\u5f0f\u8c13\u8bcd\u6765\u4fee\u526a\u5206\u533a\u3002 \u591a\u7ea7\u54c8\u5e0c\u5206\u533a\u4e5f\u53ef\u4ee5\u4e0e\u8303\u56f4\u5206\u533a\u76f8\u7ed3\u5408\uff0c\u903b\u8f91\u4e0a\u589e\u52a0\u4e86\u5206\u533a\u7684\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u3002","title":"Hash and Hash Partitioning Example ( \u54c8\u5e0c\u548c\u54c8\u5e0c\u793a\u4f8b\u00a0)"},{"location":"9/#schema-alterations","text":"\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u66f4\u6539\u8868\u7684\u6a21\u5f0f\uff1a \u91cd\u547d\u540d\u8868 \u91cd\u547d\u540d\u4e3b\u952e\u5217 \u91cd\u547d\u540d\uff0c\u6dfb\u52a0\u6216\u5220\u9664\u975e\u4e3b\u952e\u5217 \u6dfb\u52a0\u548c\u5220\u9664\u8303\u56f4\u5206\u533a \u53ef\u4ee5\u5728\u5355\u4e2a\u4e8b\u52a1\u64cd\u4f5c\u4e2d\u7ec4\u5408\u591a\u4e2a\u66f4\u6539\u6b65\u9aa4\u3002 \u6ce8\u610f \u91cd\u547d\u540d\u4e3b\u952e\u5217 KUDU-1626 \uff1a Kudu \u8fd8\u4e0d\u652f\u6301\u91cd\u547d\u540d\u4e3b\u952e\u5217\u3002","title":"Schema Alterations ( \u6a21\u5f0f\u53d8\u66f4 )"},{"location":"9/#known-limitations","text":"Kudu \u76ee\u524d\u6709\u4e00\u4e9b\u5df2\u77e5\u7684\u9650\u5236\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6a21\u5f0f\u8bbe\u8ba1\u3002 Number of Columns ( \u5217\u6570 ) \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c Kudu \u4e0d\u5141\u8bb8\u521b\u5efa 300 \u5217\u4ee5\u4e0a\u7684\u8868\u3002\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u8f83\u5c11\u5217\u7684\u6a21\u5f0f\u8bbe\u8ba1\u6765\u83b7\u5f97\u6700\u4f73\u6027\u80fd\u3002 Size of Cells ( \u5355\u5143\u683c\u5927\u5c0f ) \u5728\u7f16\u7801\u6216\u538b\u7f29\u4e4b\u524d\uff0c\u6ca1\u6709\u5355\u4e2a\u5355\u5143\u683c\u53ef\u80fd\u5927\u4e8e 64KB \u3002\u7ec4\u5408\u5bc6\u94a5\u7684\u5355\u5143\u5728 Kudu \u5b8c\u6210\u7684\u5185\u90e8\u590d\u5408\u5bc6\u94a5\u7f16\u7801\u4e4b\u540e\uff0c\u603b\u5171\u9650\u5236\u5728 16KB \u3002\u63d2\u5165\u4e0d\u7b26\u5408\u8fd9\u4e9b\u9650\u5236\u7684\u884c\u5c06\u5bfc\u81f4\u9519\u8bef\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 Size of Rows ( \u884c\u5927\u5c0f ) \u5c3d\u7ba1\u5355\u4e2a\u5355\u5143\u683c\u53ef\u80fd\u9ad8\u8fbe 64KB \uff0c\u800c Kudu \u6700\u591a\u652f\u6301 300 \u5217\uff0c\u4f46\u5efa\u8bae\u4e0d\u8981\u5355\u884c\u5927\u4e8e\u51e0\u767e KB \u3002 Valid Identifiers ( \u6709\u6548\u6807\u8bc6\u7b26 ) \u8bf8\u5982\u8868\u548c\u5217\u540d\u79f0\u7684\u6807\u8bc6\u7b26\u5fc5\u987b\u662f\u6709\u6548\u7684 UTF-8 \u5e8f\u5217\uff0c\u4e0d\u8d85\u8fc7 256 \u4e2a\u5b57\u8282\u3002 Immutable Primary Keys ( \u4e0d\u53ef\u53d8\u7684\u4e3b\u952e ) Kudu \u4e0d\u5141\u8bb8\u60a8\u66f4\u65b0\u4e00\u884c\u7684\u4e3b\u952e\u5217\u3002 Non-alterable Primary Key ( \u4e0d\u53ef\u66f4\u6539\u7684\u4e3b\u952e ) \u8868\u521b\u5efa\u540e\uff0c Kudu \u4e0d\u5141\u8bb8\u60a8\u66f4\u6539\u4e3b\u952e\u5217\u3002 Non-alterable Partitioning ( \u4e0d\u53ef\u66f4\u6539\u7684\u5206\u533a ) Kudu \u4e0d\u5141\u8bb8\u60a8\u66f4\u6539\u521b\u5efa\u540e\u5982\u4f55\u5206\u533a\u8868\uff0c\u4f46\u6dfb\u52a0\u6216\u5220\u9664\u8303\u56f4\u5206\u533a\u9664\u5916\u3002 Non-alterable Column Types ( \u4e0d\u53ef\u66f4\u6539\u7684\u5217\u7c7b\u578b ) Kudu \u4e0d\u5141\u8bb8\u66f4\u6539\u5217\u7684\u7c7b\u578b\u3002 Partition Splitting ( \u5206\u533a\u5207\u5206 ) \u8868\u521b\u5efa\u540e\uff0c\u5206\u533a\u4e0d\u80fd\u62c6\u5206\u6216\u5408\u5e76\u3002","title":"Known Limitations ( \u5df2\u77e5\u9650\u5236 )"}]}